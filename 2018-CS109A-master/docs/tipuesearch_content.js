var tipuesearch = {"pages":[{"title":"GitHub","text":"All course contents are in: GitHup repo We suggest that you clone this repository.","tags":"pages","url":"pages/github.html"},{"title":"Projects","text":"At end of the semester, students gather in small groups (max 4 per group) and apply what they have learned. Students had the chance to select one of the following 7 projects and show us what they got. Project Guidelines Project 1 | Alzheimer's Disease and Cognitive Impairment Prediction Project 2 | Automatic Playlist Recommender for Spotify Project 3 | Dog Breed Classification Project 4 | Lending Club Investments Project 5 | Predicting the Midterm Election Project 6 | Machine Learning & Analysis for Predicting the 2018 FIFA World Cup Project 7 | Machine Learning & Analysis for Twitter Bot Detection Below is a selection of the most impressive work done by the students, check'em out! Project 1 | Alzheimer's Prediction Project 2 | Spotify Song Recommendation Project Project 3 | Dog Breed Classification Project 4 | Toward Fair AND Profitable Investment Strategies Project 5 | 2018 Midterms Predictive Model Project 6 | Predicting the 2018 FIFA World Cup Results Project 7 | Twitter Bot Detection Thanks everybody for these great results! 109A Team","tags":"pages","url":"pages/projects.html"},{"title":"Schedule","text":"Week Lecture (Mon) Lecture (Wed) Lab (Thu-Fri) Advanced Section (Wed) Assignment (R:Released Tue - D:Due Wed) 1 Lecture 0: What is Data Science? Lab 1: Introduction to Python and its Numerical Stack R:HW0 2 Lecture 1: Data, Summaries and Visuals Lecture 2: Data Engineering - The Grammar of Data Lab 2: Python for Data Collection and Cleaning R:HW1 - D:HW0 3 Lecture 3: Effective Exploratory Data Analysis and Visualization Lecture 4: Linear Regression, kNN Regression and Inference Lab 3: Scikit-learn for Regression Advanced Section 1: Linear Algebra and Hypothesis Testing R:HW2 - D:HW1 4 Lecture 5: Linear Regression, Confidence Intervals and Standard Errors Lecture 6: Multiple Linear Regression, Polynomial Regression and Model Selection Lab 4: Multiple Linear Regression and Polynomial Regression Advanced Section 2: Model Selection and Information Criteria R:HW3 - D:HW2 5 Lecture 7: Regularization Lecture 8: High Dimensionality and Principal Component Analysis (PCA) Lab 5: Regularization and Cross-Validation Advanced Section 3: Methods of Regularization and Justifications R:HW4(individual) D:HW3 6 No Lecture: Columbus Day Lecture 9: Visualization for Communication No Lab No Advanced Section No Assignment 7 Lecture 10: Logistic Regression 1 Lecture 11: Logistic Regression 2 Lab 6: Logistic Regression and Principal Component Analysis Advanced Section 4: Methods of Dimensionality Reduction - Principal Component Analysis R:HW5 - D:HW4 8 Lecture 12: Artificial Neural Networks 1 - Perceptron and Back Propagation Lecture 13: k-NN for Classification and Dealing with Missingness Lab 7: NumPy for Building Artificial Neural Networks and Dealing with Missing Values Advanced Section 5: Generalized Linear Models, Logistic Regression and Beyond R:HW6 - D:HW5 9 Lecture 14: Discriminant Analysis - Linear and Quadratic (LDA/QDA) Lecture 15: Classification Trees Lab 8: Discriminant Analysis [and Classification Trees] Advanced Section 6: Topics in Supervised Classification R:HW7 - D:HW6 10 Lecture 16: Regression Trees, Bagging and Random Forest Lecture 17: Boosting Methods Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting Advanced Section 7: Decision Trees and Ensemble Methods R:HW8 - D:HW7 11 Lecture 18: Artificial Neural Networks 2 - Anatomy of ANN Lecture 19: Artificial Neural Networks 3 - Regularization Methods for ANN Lab 10: Keras for Artificial Neural Network Advanced Section 8: Artificial Neural Networks for Image Analysis R:HW9(individual) D:HW8 12 Lecture 20: Support Vector Machines No Lecture: Thanksgiving No Lab No Advanced Section No Assignment 13 Lecture 21: Stacking Lecture 22: Responsible Data Science - Guest Lecture (Julia Stoyanovich) No Lab Advanced Section 9: Support Vector Machines D:HW9 14 Lecture 23: A/B Testing Lecture 24: Final Lecture 15 Reading Period 16 Finals Week","tags":"pages","url":"pages/schedule.html"},{"title":"Syllabus","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } List of Contents Prerequisites Software Course Activities Recommended Textbook Assignments Getting Help Course Policies Prerequisites You are expected to have programming experience at the level of CS 50 or above, and statistics knowledge at the level of Stat 100 or above (Stat 110 recommended). HW0 is designed to test your knowledge on the prerequisites. Successful completion of this assignment will show that this course is suitable for you. HW0 will not be graded but you are required to submit to enroll in the class. Software We will be using Python 3 run on Jupyter Notebooks. You can access the notebook viewer either in your own machine by installing the Anaconda Platform which includes Jupyter/IPython as well all packages that will be required for the course, or by using the SEAS JupyterHub from Canvas. More details in class. Course Activities The course is structured in three different types of activities that repeat themselves each week and they are: Lectures , Labs , and Sections . Lectures are held on Mon and Wed from 1:30-2:45 pm in Northwest Building, Lecture Hall B-103. Attendance is mandatory for FAS students and for DCE students recorded lectures will be available and must be visioned within 2 days after the lectures. There will be quizzes at the end of each lecture to assess the understanding of the material that will help us identify gaps. Lectures will be recorded and made available real time for DCE students and 24 hours later for in-campus students via Canvas. Labs are held on Thur 4:30-6:00 pm and Fri 10:30-11:45 am in Pierce 301. The two labs have identical contents and you should plan to attend one of the two. Attendance is optional , however it is strongly encouraged . Labs are designed as hands-on activities and are useful to practice with problems similar to the homework. Labs will be videotaped only for distant students. Sections are supplementary activities led by teaching fellows to elaborate upon the lectures material. There are two types of sections: 3a. Standard Sections are held on Monday and will cover a blend of lecture material and practice problems. 3b. Advanced Sections are held on Wednesday and will cover advanced topics about mathematical underpinnings of the methods presented in lecture and lab. The Advanced Section material is required for AC209A students . Recommended Textbook An Introduction to Statistical Learning by James, Witten, Hastie, Tibshirani. The book is available here: Free version Hollis Amazon Assignments The final grade will be calculated using the following weights for each assignment: Assignment Final Grade Weight Homework 40% Quizzes 10% Project 50% Total 100% Homework There are 9 homework to complete. There will be an initial self-assessment homework called HW0 and 8 more graded homework assignments. Some of them will be due in a week and some of them in two weeks. You have the option to work and submit the homework in pairs for all the assignments except two which you will do individually. You will be working in Jupyter Notebooks which you can run in your own environment or in the SEAS JupyterHub cloud. The homework are graded on a scale 1 to 5, where 5 is the highest grade. Quizzes There will be a quiz at the end of the class based on what was discussed in lecture. Students will have a limited amount of time to complete the quiz (DCE students will have 72 hours). 40% of the quizzes will be dropped before calculating your final grade. Final Project There will be a final group project (2-4 students) due during Exams period encompassing all the material learned in class. Submitting an Assignment Instructions for turning in assignments will be posted when the semester starts. Grading Guidelines Homework will be graded based on: How correct your code is and whether the cells in your notebook run (we are not troubleshooting code). How you have interpreted the results (we want text not just code). How well you present the results (as you would do in a report). Getting Help For questions about homework, course content, package installation, and after you have tried to troubleshoot yourselves, the process to get help is: Post the question in Piazza and hopefully your peers will answer. Note that in Piazza questions are visible to everyone. The TFs monitor the posts. Go to Office Hours , this is the best way to get help. For private matters send an email to the Helpline: cs109a2018@gmail.com. The Helpline is monitored by TFs. For personal and confidential matters send an email to the instructors . Course Policies Collaboration Policy We encourage you to talk and discuss the assignments with your fellow students (and on Piazza), but you are not allowed to look at any other students assignment or code outside of your pair. Discussion is encouraged, copying is not allowed . Please refer to Academic Honesty in The CS109A Grade linked here The CS109A Grade . Late Day Policy Homework is due on Tuesdays. You are allowed 1 late day per homework for a total of 5 late days. Re-Grading Policy We take great care in making sure all homework are graded properly. However if you feel that your assignment was not fairly graded you may contact the grader by emailing the helpline with subject line \"Regrade HW1: Grader=johnsmith\" within 48 hours of the grade release . If still unhappy with the initial response, then submit a reason via email to the Helpline with subject line \"Regrade HW1: Second request\" within 2 days of receiving the initial response. Important Note: once regrading is done, you may receive a grade that is higher or lower than the initial grade. Communication from Staff to Students Class announcements will be through Canvas . All homework and quizzes will be posted and submitted in Canvas. Also all feedback forms. Important note : make sure you have your settings set so you can receive emails from Canvas. Academic Honesty Ethical behavior is an important trait of a Data Scientist, from ethically handling data to attribution of code and work of others. Thus, in CS109 we give a strong emphasis to Academic Honesty. As a student your best guidelines are to be reasonable and fair. We encourage teamwork for problem sets, but you should not split the homework and you should work on all the problems together. For more detailed expectations, please refer to Academic Honesty section in The CS109A Grade link above. Accommodations for students with disabilities Students needing academic adjustments or accommodations because of a documented disability must present their Faculty Letter from the Accessible Education Office (AEO) and speak with Kevin by the end of the third week of the term: Friday, September 15. Failure to do so may result in us being unable to respond in a timely manner. All discussions will remain confidential.","tags":"pages","url":"pages/syllabus.html"},{"title":"CS109A: Introduction to Data Science","text":"Fall 2018 Pavlos Protopapas and Kevin A. Rader pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } .contentA { flex: 1; flex-direction:column; } .contentB { flex: 3; } Welcome to CS109a/STAT121a/AC209a, also offered by the DCE as CSCI E-109a, Introduction to Data Science. This course is the first half of a one‐year course to data science. We will focus on the analysis of data to perform predictions using statistical and machine learning methods. Topics include data scraping, data management, data visualization, regression and classification methods, and deep neural networks (see the schedule ). You will get ample practice through weekly homework assignments. The class material integrates the five key facets of an investigation using data: 1. Data Collection ‐ data wrangling, cleaning, and sampling to get a suitable data set 2. Data Management ‐ accessing data quickly and reliably 3. Exploratory Data Analysis – generating hypotheses and building intuition 4. Prediction or Statistical Learning 5. Communication – summarizing results through visualization, stories, and interpretable summaries Only one of CS 109a, AC 209a, or Stat 121a can be taken for credit. Students who have previously taken CS 109, AC 209, or Stat 121 cannot take CS 109a, AC 209a, or Stat 121a for credit. Lectures: Mon and Wed 1:30‐2:45 pm in Harvard Northwest Building, NW B-103 Labs : Thur 4:30-6:00 pm and Fri 10:30-11:45 am in Pierce 301 (content is identical, students should only attend one) Head TFs : Eleni Kaxiras -DCE Head TF : Sol Girouard Office Hours: IACS student lobby in Maxwell-Dworkin's ground. Just follow the signs. Online Office Hours zoom link: https://harvard-dce.zoom.us/j/7607382317 Class meetings have concluded! Thank you all for a great semester! Guest Lecture on Nov 28th: Ethics and Critical Thinking, Julia Stoyanovich , Assistant Professor in the Department of Computer Science and Engineering at the Tandon School of Engineering, and the Center for Data Science. Course material can be viewed in the public GitHub repository . REGULAR SECTIONS Cover the material presented in class. All 2 sessions are identical. Standard Sections have concluded. Thank you! ADVANCED SECTIONS Cover a different topic per week and are required for 209a students. Advanced Sections have concluded. Thank you! Instructor Office Hours Pavlos : Mon. 4:00-5:00 pm Kevin : Mon. 3:00-4:00 pm. TF Office Hours See the Weekly Schedule Please be aware, that we will not publicly release the homework assignments this year. If you want to follow the course online without registering, you can use the assignments from 2013 and 2014, available at the links below. Additionally, the material from 2015 is also available. Previous Years Material 2017 2015 2014 . 2013","tags":"pages","url":"pages/cs109a-introduction-to-data-science/"},{"title":"Lecture 24: Final Lecture","text":"Slides PDF | Lecture 24: Final Lecture PPTX | Lecture 24: Final Lecture","tags":"lectures","url":"lectures/lecture-24/"},{"title":"Lecture 23: A/B Testing","text":"Slides PDF | Lecture 23: A/B Testing PPTX | Lecture 23: A/B Testing Jupyter Notebook Lecture 23: A/B Testing Demo","tags":"lectures","url":"lectures/lecture-23/"},{"title":"EDA","text":"Contents {:.no_toc} * % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) Italian Olives I found this data set in the RGGobi book (http://www.ggobi.org/book/), from which the above diagram is taken. It has \"the percentage composition of fatty acids found in the lipid fraction of Italian olive oils', with oils from 3 regions of Italy: the North, the South, and Sardinia. The regions themselves are subdivided into areas as shown in the map above. The source for this data is: Forina, M., Armanino, C., Lanteri, S. & Tiscornia, E. (1983), Classification of Olive Oils from their Fatty Acid Composition, in Martens, H. and Russwurm Jr., H., eds, Food Research and Data Analysis, Applied Science Publishers, London, pp. 189–214. Exploratory Viz df = pd . read_csv ( \"local-olives-cleaned.csv\" ) df . head () .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South exploring globally pd . crosstab ( df . areastring , df . regionstring ) .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } regionstring North Sardinia South areastring Calabria 0 0 56 Coast-Sardinia 0 33 0 East-Liguria 50 0 0 Inland-Sardinia 0 65 0 North-Apulia 0 0 25 Sicily 0 0 36 South-Apulia 0 0 206 Umbria 51 0 0 West-Liguria 50 0 0 pd . value_counts ( df . areastring , sort = False ) . plot ( kind = \"bar\" ); pd . value_counts ( df . regionstring , sort = False ) . plot ( kind = \"barh\" ); acidlist = [ 'palmitic' , 'palmitoleic' , 'stearic' , 'oleic' , 'linoleic' , 'linolenic' , 'arachidic' , 'eicosenoic' ] df [ acidlist ] . median () . plot ( kind = \"bar\" ); Or one can use aggregate to pass an arbitrary function of to the sub-dataframe. The function is applied columnwise. dfbymean = df . groupby ( \"regionstring\" ) . aggregate ( np . mean ) dfbymean . head () .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring North 3.0 8.006623 10.948013 0.837351 2.308013 77.930530 7.270331 0.217881 0.375762 0.019735 Sardinia 2.0 5.336735 11.113469 0.967449 2.261837 72.680204 11.965306 0.270918 0.731735 0.019388 South 1.0 2.783282 13.322879 1.548019 2.287740 71.000093 10.334985 0.380650 0.631176 0.273220 with sns . axes_style ( \"white\" , { 'grid' : False }): dfbymean [ acidlist ] . plot ( kind = 'barh' , stacked = True ); sns . despine () Figuring the dataset by Region g = sns . FacetGrid ( df , col = \"region\" ) g . map ( plt . scatter , \"eicosenoic\" , \"linoleic\" ); Clearly, region 1 or the South can visually be separated out by eicosenoic fraction itself. with sns . axes_style ( \"white\" ): g = sns . FacetGrid ( df , col = \"region\" ) g . map ( sns . distplot , \"eicosenoic\" ) We make a SPLOM using seaborn to see in what space the regions may be separated. Note that linoleic and oleic seem promising. And perhaps arachidic paired with eicosenoic. sns . pairplot ( df , vars = acidlist , hue = \"regionstring\" , size = 2.5 , diag_kind = 'kde' ); Pandas supports conditional indexing: documentation . Lets use it to follow up on the clear pattern of Southern oils seeeming to be separable by just the eicosenoic feature. Indeed this is the case! Can also be seen using parallel co-ordinates: from pandas.tools.plotting import parallel_coordinates dfna = df [ acidlist ] #normalizing by range dfna_norm = ( dfna - dfna . mean ()) / ( dfna . max () - dfna . min ()) with sns . axes_style ( \"white\" ): parallel_coordinates ( df [[ 'regionstring' ]] . join ( dfna_norm ), 'regionstring' , alpha = 0.3 ) Figuring the South of Italy by Area dfsouth = df [ df . regionstring == 'South' ] dfsouth . head () .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South We make a couple of SPLOM's, one with sicily and one without sicily, to see whats separable. Sicily seems to be a problem. As before, see the KDE's first to see if separability exists and then let the eye look for patterns. sns . pairplot ( dfsouth , hue = \"areastring\" , size = 2.5 , vars = acidlist , diag_kind = 'kde' ); sns . pairplot ( dfsouth [ dfsouth . areastring != \"Sicily\" ], hue = \"areastring\" , size = 2.5 , vars = acidlist , diag_kind = 'kde' ); Seems that combinations of oleic, palmitic, palmitoleic might be useful?","tags":"pages","url":"pages/eda/"},{"title":"Lab 11: Italian Olives","text":"title: The Case of the Italian Olives This is the home page Lets have fun here is a quote Here is emph and bold . Here is some inline math $\\alpha = \\frac{\\beta}{\\gamma}$ and, of-course, E rules: $$ G_{\\mu\\nu} + \\Lambda g_{\\mu\\nu} = 8 \\pi T_{\\mu\\nu} . $$","tags":"labs","url":"labs/lab11/"},{"title":"Lab 11 README","text":"gpages Script for the Lab: Preamble Set up a github account Create a Public repository called testgpages with a README.md and a Jekyll .gitignore . Download the github app and clone this repository down. Also fork-clone/clone the repository https://github.com/rahuldave/gpages . Open both repositories side by side in the Finder (File Manager) Make an edit to the README.md in testgpages and commit and push to understand the git flow. Web Pages, Version 1 Open a terminal from the github app for testgpages . Copy the notebooks folder from gpages into testgpages Using that terminal, convert the notebooks to html: jupyter nbconvert --output-dir . --to html notebooks/olives-eda.ipynb jupyter nbconvert --output-dir . --to html notebooks/olives-model.ipynb Copy oldondex.html from gpages to index.html in testgpages Commit and push Go to the hithub user interface for settings and enable a website on the master branch of testgpages . Go to https://username.github.io/testgpages/index.html to see your website Web Site Version 2 Delete the html files in the main testgpages folder. We will generate markdown instead From gpages copy the _layouts folder, index.md , and _config.yml . Using the testgpages terminal, convert the notebooks into markdown using our custom template. jupyter nbconvert --output-dir . --to markdown --template ../gpages/_support/markdown.tpl notebooks/olives-eda.ipynb jupyter nbconvert --output-dir . --to markdown --template ../gpages/_support/markdown.tpl notebooks/olives-model.ipynb Add YAML preambles and some TOC frontmatter to our markdown files python ../gpages/_support/nbmd.py olives-eda.md python ../gpages/_support/nbmd.py olives-model.md Edit the markdown files to add a YAML tag nav_include: 1 and nav_include: 2 respectively to the above markdown files.The 1 and 2 reflect the position on the navigation menu in the default.html template in _layouts . Commit and push everything Go to the website in a bit to check the improvements Things for you to do Hide some cells: see our nbconvert template to see how to do this. Use another theme from the github defaults ADVANCED: use your own jekyll theme. More Info http://jmcglone.com/guides/github-pages/","tags":"labs","url":"labs/lab11/readme/"},{"title":"Models","text":"Contents {:.no_toc} * #!pip install seaborn % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) df = pd . read_csv ( \"local-olives-cleaned.csv\" ) df . head () .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South acidlist = [ 'palmitic' , 'palmitoleic' , 'stearic' , 'oleic' , 'linoleic' , 'linolenic' , 'arachidic' , 'eicosenoic' ] dfsouth = df [ df . regionstring == 'South' ] dfsouth . head () .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South Predicting via SVM dfnew = df [[ 'eicosenoic' , 'region' , 'regionstring' ]] dfnew [ 'linoarch' ] = ( 0.969 / 1022.0 ) * df . linoleic + ( 0.245 / 105.0 ) * df . arachidic dfnew . head () eicosenoic region regionstring linoarch 0 0.29 1 South 0.007772 1 0.29 1 South 0.008828 2 0.29 1 South 0.006675 3 0.35 1 South 0.007689 4 0.46 1 South 0.008238 dfnosouth = df [ df . regionstring != 'South' ] dfnosouth . head () .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 323 Inland-Sardinia 2 5 11.29 1.20 2.22 72.72 11.12 0.43 0.98 0.02 Sardinia 324 Inland-Sardinia 2 5 10.42 1.35 2.10 73.76 11.16 0.35 0.90 0.03 Sardinia 325 Inland-Sardinia 2 5 11.03 0.96 2.10 73.80 10.85 0.32 0.94 0.03 Sardinia 326 Inland-Sardinia 2 5 11.18 0.97 2.21 72.79 11.54 0.35 0.94 0.02 Sardinia 327 Inland-Sardinia 2 5 10.52 0.95 2.15 73.88 11.26 0.31 0.92 0.01 Sardinia plt . scatter ( dfnosouth . linoleic , dfnosouth . arachidic , c = dfnosouth . region , s = 50 ); from sklearn.cross_validation import train_test_split from sklearn.metrics import confusion_matrix from sklearn.svm import SVC # \"Support Vector Classifier\" def plot_svc_decision_function ( clf , ax = None ): \"\"\"Plot the decision function for a 2D SVC\"\"\" if ax is None : ax = plt . gca () x = np . linspace ( plt . xlim ()[ 0 ], plt . xlim ()[ 1 ], 30 ) y = np . linspace ( plt . ylim ()[ 0 ], plt . ylim ()[ 1 ], 30 ) Y , X = np . meshgrid ( y , x ) P = np . zeros_like ( X ) for i , xi in enumerate ( x ): for j , yj in enumerate ( y ): P [ i , j ] = clf . decision_function ([[ xi , yj ]]) return ax . contour ( X , Y , P , colors = 'k' , levels = [ - 1 , 0 , 1 ], alpha = 0.5 , linestyles = [ '--' , '-' , '--' ]) X = dfnosouth [[ 'linoleic' , 'arachidic' ]] y = ( dfnosouth . regionstring . values == 'Sardinia' ) * 1 Xtrain , Xtest , ytrain , ytest = train_test_split ( X . values , y ) clf = SVC ( kernel = \"linear\" ) clf . fit ( Xtrain , ytrain ) plt . scatter ( Xtrain [:, 0 ], Xtrain [:, 1 ], c = ytrain , s = 50 , cmap = 'spring' , alpha = 0.3 ) plot_svc_decision_function ( clf , plt . gca ()) plt . scatter ( clf . support_vectors_ [:, 0 ], clf . support_vectors_ [:, 1 ], s = 200 , facecolors = 'none' ) plt . scatter ( Xtest [:, 0 ], Xtest [:, 1 ], c = ytest , s = 50 , marker = \"s\" , cmap = 'spring' , alpha = 0.5 ); clf . score ( Xtest , ytest ) 1 . 0 confusion_matrix ( clf . predict ( Xtest ), ytest ) array ([[ 31 , 0 ], [ 0 , 32 ]]) Allowing for crossovers from sklearn.model_selection import GridSearchCV def cv_optimize_svm ( X , y , n_folds = 10 , num_p = 50 ): #clf = SVC() #parameters = {\"C\": np.logspace(-4, 3, num=num_p), \"gamma\": np.logspace(-4, 3, num=10)} clf = SVC ( kernel = \"linear\" , probability = True ) parameters = { \"C\" : np . logspace ( - 4 , 3 , num = num_p )} gs = GridSearchCV ( clf , param_grid = parameters , cv = n_folds ) gs . fit ( X , y ) return gs def get_optim_classifier_svm ( indf , inacidlist , clon , clonval ): subdf = indf [ inacidlist ] subdfstd = ( subdf - subdf . mean ()) / subdf . std () X = subdfstd . values y = ( indf [ clon ] . values == clonval ) * 1 Xtrain , Xtest , ytrain , ytest = train_test_split ( X , y , train_size = 0.8 ) #Xtrain, Xtest, ytrain, ytest=X,X,y,y fitted = cv_optimize_svm ( Xtrain , ytrain ) return fitted , Xtrain , ytrain , Xtest , ytest thesvcfit , Xtr , ytr , Xte , yte = get_optim_classifier_svm ( dfnosouth , [ 'linoleic' , 'arachidic' ], 'regionstring' , \"Sardinia\" ) #thesvcfit, Xtr, ytr, Xte, yte = get_optim_classifier_binary(dfsouthns, ['palmitic','palmitoleic'],'area', 3) thesvcfit . best_estimator_ , thesvcfit . best_params_ , thesvcfit . best_score_ ( SVC ( C = 0 . 071968567300115138 , cache_size = 200 , class_weight = None , coef0 = 0 . 0 , decision_function_shape = None , degree = 3 , gamma = 'auto' , kernel = 'linear' , max_iter =- 1 , probability = True , random_state = None , shrinking = True , tol = 0 . 001 , verbose = False ), { 'C' : 0 . 071968567300115138 } , 1 . 0 ) def plot_svm_new ( clf , Xtr , ytr , Xte , yte ): plt . scatter ( Xtr [:, 0 ], Xtr [:, 1 ], c = ytr , s = 50 , cmap = 'spring' , alpha = 0.5 ) plt . scatter ( Xte [:, 0 ], Xte [:, 1 ], marker = 's' , c = yte , s = 50 , cmap = 'spring' , alpha = 0.5 ) #plt.xlim(-1, 4) #plt.ylim(-1, 6) plot_svc_decision_function ( clf , plt . gca ()) plt . scatter ( clf . support_vectors_ [:, 0 ], clf . support_vectors_ [:, 1 ], s = 100 , facecolors = None , lw = 2 , alpha = 0.4 ) print ( dict ( kernel = \"linear\" , ** thesvcfit . best_params_ )) clsvc = SVC ( ** dict ( kernel = \"linear\" , ** thesvcfit . best_params_ )) . fit ( Xtr , ytr ) plot_svm_new ( clsvc , Xtr , ytr , Xte , yte ) { 'kernel' : 'linear' , 'C' : 0 . 071968567300115138 } The best fit allows for a bigger margin by allowing some inbetween penalization. If we use the standard C=1 in scikit-learn you see that we are allowing for less penalization.","tags":"pages","url":"pages/models/"},{"title":"Advanced Section 9: Support Vector Machine","text":"Slides PDF | Advanced Section 9: Support Vector Machine PPTX | Advanced Section 9: Support Vector Machine Jupyter Notebook Advanced Section 9: Support Vector Machine Demo","tags":"a-sections","url":"a-sections/a-section-9/"},{"title":"Lecture 22: Responsible Data Science","text":"Slides PDF | Lecture 22: Responsible Data Science","tags":"lectures","url":"lectures/lecture-22/"},{"title":"Lecture 21: Stacking","text":"Slides PDF | Lecture 21: Stacking PPTX | Lecture 21: Stacking Jupyter Notebook Lecture 21: Stacking Demo","tags":"lectures","url":"lectures/lecture-21/"},{"title":"Lecture 20: Support Vector Machine (SVM)","text":"Slides PDF | Lecture 20: Support Vector Machine PPTX | Lecture 20: Support Vector Machine Jupuyter Notebook Lecture 20: Support Vector Machine Demo","tags":"lectures","url":"lectures/lecture-20/"},{"title":"Standard Section 9: Artificial Neural Networks Continued","text":"Jupyter Notebooks Standard Section 9: Artificial Neural Networks Continued","tags":"sections","url":"sections/section-9/"},{"title":"Standard Section 9: Artificial Neural Networks Continued","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 9: Neural Networks Continued Harvard University Fall 2018 Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan Motwani, Cecilia Garraffo Instructors: Pavlos Protopapas, Kevin Rader Author: Mehul Smriti Raje In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In this section, we will revisit some of the problems we did in previous sections and try to do them again using Keras. The goal is to familiarize you with building Neural Networks using Keras. The exercises below will help you be able to answer parts of Homework 9. Specifically, we will: 1. Use Keras to build a NN for linear regression and extend it to MLP. 2. Use Keras to build a NN that solves a classification problem This notebook can also be run on Google Colab at https://colab.research.google.com/ . Colab is helpful if your machine does not have a GPU and you want to try out more complex models, though it has a memory limit. JupyterHub and JupyterLab are other useful options, as are AWS, Google Cloud, etc. Feel free to explore and tell us if you liked something/found any platform configuration interesting or useful and why. In [1]: import random random . seed ( 112358 ) import numpy as np import pandas as pd import matplotlib.pyplot as plt from sklearn.model_selection import cross_val_score from sklearn.linear_model import LogisticRegression , LinearRegression , Ridge from sklearn.model_selection import train_test_split import statsmodels.api as sm import keras from keras.models import Sequential from keras.layers import Dense from keras import regularizers % matplotlib inline import seaborn as sns pd . set_option ( 'display.width' , 1500 ) pd . set_option ( 'display.max_columns' , 100 ) from sklearn.utils import shuffle /Users/mehulsmritiraje/anaconda/lib/python3.6/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead. from pandas.core import datetools Using TensorFlow backend. Neural Networks are flexible structures that can be used to solve probelms of different complexities. 1. Linear Regression as a Neural Net Let's first load the Titanic dataset from Section 3 and do the same pre-processing, as described before. In [2]: # Loading dataset and keeping a copy of the original titanic = sns . load_dataset ( \"titanic\" ) # Selecting predictors which are not redundant and don't have missing values titanic = titanic [[ 'age' , 'sex' , 'class' , 'embark_town' , 'alone' , 'fare' , 'alive' ]] titanic = titanic . dropna () # Remove outliers titanic = titanic [ titanic . fare < 100 ] # Replacing columns with categorical variables titanic = pd . get_dummies ( titanic , columns = [ 'sex' , 'class' ], drop_first = True ) In [3]: # Use 4 predictors X = titanic [[ 'age' , 'sex_male' , 'class_Second' , 'class_Third' ]] # Normalising variables (note: this is learning normalization params using test data, but we're just exploring here.) X = (( X - X . mean ()) / ( X . std ())) # Define our regression task y_reg = titanic . fare . values . reshape ( - 1 , 1 ) In [4]: sns . distplot ( y_reg ) Out[4]: In [5]: X_train , X_val , y_train_reg , y_val_reg = train_test_split ( X , y_reg , test_size = 1 / 3 , random_state = 0 ) In [6]: print ( X_train . shape , y_train_reg . shape ) X_train . head () (442, 4) (442, 1) Out[6]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } age sex_male class_Second class_Third 608 -0.516021 -1.381811 1.683412 -1.071045 721 -0.861196 0.722598 -0.593137 0.932262 385 -0.792161 0.722598 1.683412 -1.071045 273 0.519504 0.722598 -0.593137 -1.071045 336 -0.032776 0.722598 -0.593137 -1.071045 Now, we fit a multiple linear regression model as before, on our numerical predictors. In [7]: linreg_sm = sm . OLS ( y_train_reg , sm . add_constant ( X_train )) . fit () linreg_sm . summary () Out[7]: OLS Regression Results Dep. Variable: y R-squared: 0.579 Model: OLS Adj. R-squared: 0.575 Method: Least Squares F-statistic: 150.4 Date: Sun, 18 Nov 2018 Prob (F-statistic): 8.85e-81 Time: 06:17:12 Log-Likelihood: -1790.4 No. Observations: 442 AIC: 3591. Df Residuals: 437 BIC: 3611. Df Model: 4 Covariance Type: nonrobust coef std err t P>|t| [0.025 0.975] const 24.1693 0.666 36.296 0.000 22.861 25.478 age -2.6490 0.733 -3.615 0.000 -4.089 -1.209 sex_male -2.1448 0.674 -3.184 0.002 -3.469 -0.821 class_Second -15.4677 0.888 -17.415 0.000 -17.213 -13.722 class_Third -21.9663 0.961 -22.864 0.000 -23.855 -20.078 Omnibus: 83.833 Durbin-Watson: 2.172 Prob(Omnibus): 0.000 Jarque-Bera (JB): 182.864 Skew: 0.994 Prob(JB): 1.96e-40 Kurtosis: 5.444 Cond. No. 2.49 Note: we get an R&#94;2 of 0.58 and, intercept of about 24, and coefficients of about [-2.7, -2.1, -15.5, -21.9]. Now, let's try to build a neural network for this linear regression. Let's first answer some questions to make this easier for us. Question 1: What is the input-output size we should use to build our model? In [8]: print ( 'Each input sample has dimensionality: ' , X_train . shape [ 1 ]) print ( 'Each output sample has dimensionality: ' , y_train_reg . shape [ 1 ]) Each input sample has dimensionality: 4 Each output sample has dimensionality: 1 Do you recall the feed-forward network we made in Section 6? Question 2: What transformation will help us get linear regression? Ans: A linear transformation can be obtained by mapping the input to the output layer without using any non-linear transformations. Building a NN for this linear transformation In [9]: trials = {} # We'll keep track of our results here. In [10]: batch_size = 32 epochs = 40 # reset the model linreg_nn = Sequential () # single layer linreg_nn . add ( Dense ( 1 , activation = 'linear' , input_shape = ( X_train . shape [ 1 ],))) # Summary linreg_nn . summary () # compile it linreg_nn . compile ( optimizer = 'sgd' , loss = 'mse' , metrics = [ 'mse' ]) # fit it trials [ 'linreg' ] = linreg_nn . fit ( X_train . values , y_train_reg , epochs = epochs , validation_data = ( X_val , y_val_reg ), verbose = False ) _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= dense_1 (Dense) (None, 1) 5 ================================================================= Total params: 5 Trainable params: 5 Non-trainable params: 0 _________________________________________________________________ Question : Why does the output shape and the number of params make sense? Answer : The output is a single scalar (1) for each input sample ( None ). To get 1 output from 4 inputs requires $4*1=4$ weights plus one bias term for each output, so 5 params. In [11]: # Plotting the train and validation errors plt . plot ( trials [ 'linreg' ] . history [ 'mean_squared_error' ], '-o' , label = 'train mse' ) plt . plot ( trials [ 'linreg' ] . history [ 'val_mean_squared_error' ], '-*' , label = 'val mse' ) plt . xlabel ( 'epochs' ) plt . ylabel ( 'MSE' ) plt . legend (); print ( \"MSE: train= {:.1f} , val= {:.1f} \" . format ( trials [ 'linreg' ] . history [ 'mean_squared_error' ][ - 1 ], trials [ 'linreg' ] . history [ 'val_mean_squared_error' ][ - 1 ])) MSE: train=193.9, val=214.4 Question : When I first tried this, I got validation MSE much lower than train MSE. I checked and they were being computed completely correctly. Why might that have happened? (Hint: both MSEs were around 2000...) In [12]: # This happens to be slightly different from the *training* MSE reported in the log. The difference is due to a subtlety in how error is logged *during* an epoch. train_mse = np . mean (( linreg_nn . predict ( X_train ) - y_train_reg ) ** 2 ) train_mse Out[12]: 193.4575943275504 In [13]: np . mean (( linreg_nn . predict ( X_val ) - y_val_reg ) ** 2 ) Out[13]: 214.36590034734365 In [14]: # train R&#94;2 1 - train_mse / np . var ( y_train_reg ) Out[14]: 0.57856417058393617 Does that R&#94;2 number look familiar? Ok, what just happened here? We just created a neural network where the input layer takes a 5-dimensional input (4 parameters and 1 constant) and output layer produces a 1-dimensional output (regression value). The mapping is activated by a linear activation function. Optimisation of coeffients are done using sgd or stochastic gradient descent where the mse of fit is optimised. Question 3: Why did we choose the activation function? Ans: We want to produce a linear transformation, which motivates us to pick the linear activation. Question 4: Why did we normalise our data? Ans: For a single linear layer, it didn't matter much. But when we add a nonlinearity, the scale of whatever gets passed through the nonlinearity will matter a lot. Question 5: How do we pick the number of epochs and batch size? Ans: The number of epochs usually depends on the complexity of function being fitted and the structure of model. The batch size is often governed by the number of parameters one is trying to fit, since it determines how much memory is required for the backward pass. Question 6: Why dooes the training MSE keep decreasing with the number of epochs, while the validation MSE flattens out? Ans: The NN is likely overfitting. What function is the linear regression actually computing? In [15]: weights , bias = linreg_nn . get_weights () print ( \"NN model weights:\" , weights . flatten ()) print ( \"NN model bias:\" , bias ) print ( \"Statsmodels weights:\" , linreg_sm . params . values ) NN model weights: [ -2.33316636 -2.22144699 -14.82039928 -21.18075752] NN model bias: [ 24.1122303] Statsmodels weights: [ 24.16932019 -2.6490289 -2.14478285 -15.46766422 -21.96628353] Question: In what ways are these similar or different? Why? In [16]: linreg_sm . predict ( sm . add_constant ( X_train . values )[: 4 ]) Out[16]: array([ 25.98838135, 13.59695769, 22.20638358, 53.94464295]) In [17]: # Predict the first 4 outputs linreg_nn . predict ( X_train . values [: 4 ]) Out[17]: array([[ 26.12251663], [ 13.5608511 ], [ 22.09196281], [ 52.77099609]], dtype=float32) In [18]: # Let's do this ourselves in NumPy # output layer y_pred = np . dot ( X_train . values , weights ) + bias y_pred [: 4 ] Out[18]: array([[ 26.12251514], [ 13.56084995], [ 22.09196243], [ 52.77099705]]) From linear regression to MLP Now recall our MLP from section 6: we also had a linear output layer, but we added some hidden nodes. Let's do that in Keras. In [19]: batch_size = 32 epochs = 40 n_hidden = 5 # reset the model model = Sequential () # HIDDEN LAYER (new this time) model . add ( Dense ( n_hidden , activation = 'sigmoid' , input_shape = ( X_train . shape [ 1 ],))) # output layer (same as last time, except now we don't need to specify input_shape) model . add ( Dense ( 1 , activation = 'linear' )) # Summary model . summary () # compile it model . compile ( optimizer = 'sgd' , loss = 'mse' , metrics = [ 'mse' ]) # fit it trials [ 'mlp' ] = model . fit ( X_train . values , y_train_reg , epochs = epochs , validation_data = ( X_val , y_val_reg ), verbose = False ) _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= dense_2 (Dense) (None, 5) 25 _________________________________________________________________ dense_3 (Dense) (None, 1) 6 ================================================================= Total params: 31 Trainable params: 31 Non-trainable params: 0 _________________________________________________________________ Question : Why do those shapes and #params make sense? In [20]: # Plotting the train and validation errors metrics_to_plot = [ 'mean_squared_error' , 'val_mean_squared_error' ] fig , axs = plt . subplots ( 1 , 2 , figsize = ( 16 , 6 )) trials_to_plot = [ ( 'Linear Regression' , 'linreg' ), ( 'MLP (5 hidden) Regression' , 'mlp' ) ] for ax , metric in zip ( axs , metrics_to_plot ): for title , trial_name in trials_to_plot : h = trials [ trial_name ] . history [ metric ] ax . plot ( h , marker = '.' , label = title ) ax . set ( xlabel = \"epoch\" , ylabel = metric , title = metric ) ax . legend () print ( f \" {title:30s} : {metric:30s} = {h[-1]:.2f} \" ) Linear Regression : mean_squared_error = 193.95 MLP (5 hidden) Regression : mean_squared_error = 184.51 Linear Regression : val_mean_squared_error = 214.37 MLP (5 hidden) Regression : val_mean_squared_error = 211.27 How did our training and validation error compare with the linear model? In [21]: weights_hidden , bias_hidden = model . layers [ 0 ] . get_weights () weights_output , bias_output = model . layers [ 1 ] . get_weights () print ( weights_hidden . shape , bias_hidden . shape ) print ( weights_output . shape , bias_output . shape ) (4, 5) (5,) (5, 1) (1,) In [22]: # Let's do this ourselves in NumPy # defining activation function sigmoid = lambda x : ( 1 / ( 1 + np . exp ( - x ))) # hidden layer hidden_activations = np . dot ( X_train , weights_hidden ) + bias_hidden hidden_layer_outputs = sigmoid ( hidden_activations ) # output layer y_pred = np . dot ( hidden_layer_outputs , weights_output ) + bias_output print ( y_pred [: 4 ]) [[ 24.37598051] [ 14.5750539 ] [ 25.69390443] [ 52.14439611]] In [23]: # Predict the first 4 outputs print ( model . predict ( X_train . values [: 4 ])) [[ 24.37598038] [ 14.57505417] [ 25.69390106] [ 52.14439774]] In [24]: xx = np . linspace ( - 10 , 10 , 100 ) plt . plot ( xx , sigmoid ( xx )) Out[24]: [ ] Classification Doing classification instead of regression is as easy as changing the loss! In [25]: # Change the output to a classification task y_clf = titanic . alive == 'yes' y_clf = y_clf . astype ( int ) # same train-test split X_train , X_val , y_train_clf , y_val_clf = train_test_split ( X , y_clf , test_size = 1 / 3 , random_state = 0 ) In [26]: y_train_clf [: 10 ] Out[26]: 608 1 721 0 385 0 273 0 336 0 439 0 139 0 418 0 600 1 0 0 Name: alive, dtype: int64 In [27]: # Logistic Regression = sigmoid activation + binary-cross-entropy loss. batch_size = 32 epochs = 500 # reset the model logreg_nn = Sequential () # single layer logreg_nn . add ( Dense ( 1 , activation = 'sigmoid' , input_shape = ( X_train . shape [ 1 ],))) # Summary logreg_nn . summary () # compile it logreg_nn . compile ( optimizer = 'sgd' , loss = 'binary_crossentropy' , metrics = [ 'accuracy' ]) # fit it logreg_history = logreg_nn . fit ( X_train . values , y_train_clf , epochs = epochs , validation_data = ( X_val , y_val_clf ), verbose = False ) _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= dense_4 (Dense) (None, 1) 5 ================================================================= Total params: 5 Trainable params: 5 Non-trainable params: 0 _________________________________________________________________ In [28]: # Plotting the train and validation errors fig , axs = plt . subplots ( 1 , 2 , figsize = ( 16 , 6 )) plot_data = [ ( 'Loss' , 'loss' ), ( 'Accuracy' , 'acc' ) ] for ax , ( title , metric ) in zip ( axs , plot_data ): ax . plot ( logreg_history . history [ metric ], '-o' , label = 'train' ) ax . plot ( logreg_history . history [ 'val_' + metric ], '-*' , label = 'val' ) ax . set ( xlabel = 'epochs' , ylabel = metric , title = title ) ax . legend () print ( \" {} : train= {:.3f} \" . format ( title , logreg_history . history [ metric ][ - 1 ])) Loss: train=0.433 Accuracy: train=0.826 In [29]: sklearn_clf = LogisticRegression ( C = 1e6 , multi_class = 'multinomial' , solver = 'lbfgs' ) . fit ( X_train . values , y_train_clf ) sklearn_clf . score ( X_train . values , y_train_clf ) Out[29]: 0.82805429864253388 In [30]: weights , bias = logreg_nn . get_weights () In [31]: # Let's do this ourselves in NumPy # defining activation function sigmoid = lambda x : ( 1 / ( 1 + np . exp ( - x ))) # output layer y_pred = sigmoid ( np . dot ( X_train , weights ) + bias ) y_pred [: 4 ] Out[31]: array([[ 0.85839098], [ 0.12585531], [ 0.3012295 ], [ 0.39244429]]) In [32]: logreg_nn . predict ( X_train [: 4 ]) Out[32]: array([[ 0.85839099], [ 0.12585531], [ 0.30122948], [ 0.39244428]], dtype=float32) In [33]: sklearn_clf . predict_proba ( X_train . values [: 4 ]) Out[33]: array([[ 0.28729876, 0.71270124], [ 0.72664773, 0.27335227], [ 0.60409152, 0.39590848], [ 0.54767552, 0.45232448]]) In [34]: sklearn_clf . coef_ Out[34]: array([[-0.31652555, -0.67405513, -0.28395378, -0.61070231]]) In [35]: weights . flatten () Out[35]: array([-0.60320753, -1.33529627, -0.52518368, -1.16502988], dtype=float32) Regularization Question 7: What happens if we increase the number of hidden nodes in the regression problem above? Building a model with 100 hidden nodes: In [36]: batch_size = 32 epochs = 40 n_hidden = 100 # reset the model model = Sequential () # HIDDEN LAYER (new this time) model . add ( Dense ( n_hidden , activation = 'sigmoid' , input_shape = ( X_train . shape [ 1 ],))) # output layer (same as last time, except now we don't need to specify input_shape) model . add ( Dense ( 1 , activation = 'linear' )) # Summary model . summary () # compile it model . compile ( optimizer = 'sgd' , loss = 'mse' , metrics = [ 'mse' ]) # fit it trials [ 'mlp_100' ] = model . fit ( X_train . values , y_train_reg , epochs = epochs , validation_data = ( X_val , y_val_reg ), verbose = False ) _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= dense_5 (Dense) (None, 100) 500 _________________________________________________________________ dense_6 (Dense) (None, 1) 101 ================================================================= Total params: 601 Trainable params: 601 Non-trainable params: 0 _________________________________________________________________ In [37]: # Plotting the train and validation errors metrics_to_plot = [ 'mean_squared_error' , 'val_mean_squared_error' ] fig , axs = plt . subplots ( 1 , 2 , figsize = ( 16 , 6 )) trials_to_plot = [ ( 'Linear Regression' , 'linreg' ), ( 'MLP (5 hidden) Regression' , 'mlp' ), ( 'MLP (100 hidden) Regression' , 'mlp_100' ) ] for ax , metric in zip ( axs , metrics_to_plot ): for title , trial_name in trials_to_plot : h = trials [ trial_name ] . history [ metric ] ax . plot ( h , marker = '.' , label = title ) ax . set ( xlabel = \"epoch\" , ylabel = metric , title = metric ) ax . legend () print ( f \" {title:30s} : {metric:30s} = {h[-1]:.2f} \" ) Linear Regression : mean_squared_error = 193.95 MLP (5 hidden) Regression : mean_squared_error = 184.51 MLP (100 hidden) Regression : mean_squared_error = 194.43 Linear Regression : val_mean_squared_error = 214.37 MLP (5 hidden) Regression : val_mean_squared_error = 211.27 MLP (100 hidden) Regression : val_mean_squared_error = 214.37 Question 8: What happens if we increase the number of hidden layers? Building a model with 10 hidden layers having 5 units each (You may need to run this on a GPU - Eg. Google Colab) In [38]: batch_size = 32 epochs = 40 n_hidden = 10 # reset the model model = Sequential () # HIDDEN LAYER (new this time) model . add ( Dense ( n_hidden , activation = 'sigmoid' , input_shape = ( X_train . shape [ 1 ],))) # more hidden layers for layer in range ( 10 ): model . add ( Dense ( n_hidden , activation = 'sigmoid' )) # output layer (same as last time, except now we don't need to specify input_shape) model . add ( Dense ( 1 , activation = 'linear' )) # Summary model . summary () # compile it model . compile ( optimizer = 'sgd' , loss = 'mse' , metrics = [ 'mse' ]) # fit it trials [ 'mlp_5x10' ] = model . fit ( X_train . values , y_train_reg , epochs = epochs , validation_data = ( X_val , y_val_reg ), verbose = False ) _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= dense_7 (Dense) (None, 10) 50 _________________________________________________________________ dense_8 (Dense) (None, 10) 110 _________________________________________________________________ dense_9 (Dense) (None, 10) 110 _________________________________________________________________ dense_10 (Dense) (None, 10) 110 _________________________________________________________________ dense_11 (Dense) (None, 10) 110 _________________________________________________________________ dense_12 (Dense) (None, 10) 110 _________________________________________________________________ dense_13 (Dense) (None, 10) 110 _________________________________________________________________ dense_14 (Dense) (None, 10) 110 _________________________________________________________________ dense_15 (Dense) (None, 10) 110 _________________________________________________________________ dense_16 (Dense) (None, 10) 110 _________________________________________________________________ dense_17 (Dense) (None, 10) 110 _________________________________________________________________ dense_18 (Dense) (None, 1) 11 ================================================================= Total params: 1,161 Trainable params: 1,161 Non-trainable params: 0 _________________________________________________________________ In [39]: # Plotting the train and validation errors metrics_to_plot = [ 'mean_squared_error' , 'val_mean_squared_error' ] fig , axs = plt . subplots ( 1 , 2 , figsize = ( 16 , 6 )) trials_to_plot = [ ( 'Linear Regression' , 'linreg' ), ( 'MLP (5 hidden) Regression' , 'mlp' ), ( 'MLP (5 hidden, 10 layers) Regression' , 'mlp_5x10' ) ] for ax , metric in zip ( axs , metrics_to_plot ): for title , trial_name in trials_to_plot : h = trials [ trial_name ] . history [ metric ] ax . plot ( h , marker = '.' , label = title ) ax . set ( xlabel = \"epoch\" , ylabel = metric , title = metric ) ax . legend () print ( f \" {title:30s} : {metric:30s} = {h[-1]:.2f} \" ) Linear Regression : mean_squared_error = 193.95 MLP (5 hidden) Regression : mean_squared_error = 184.51 MLP (5 hidden, 10 layers) Regression: mean_squared_error = 460.75 Linear Regression : val_mean_squared_error = 214.37 MLP (5 hidden) Regression : val_mean_squared_error = 211.27 MLP (5 hidden, 10 layers) Regression: val_mean_squared_error = 411.91 From both the above experiments, we can see that NNs can overfit very quickly. Question 9: Based on the above, what are some obvious methods of regularising NNs? Ans: Choosing the right number of hidden layers and hidden nodes! Unfortunately, picking the right number of parameters is a hard problem itself. Question 10: Does this give you a hint of another method to prevent overfitting? Ans: Stopping the process early could likely be helpful. This is known as 'early stopping' and is typically used in combination with other regularisation techniques. As intution suggests, it means 'Stopping the process when the model starts overfitting'. Question 11: Think of how we prevented overfitting and helped regularise parameters in regression. Can you remember any? (Hint: Norms) Ans: Using L2 regularisation can be helpful in regularising parameters, like we have observed in regression. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-9/solutions/"},{"title":"Lab 10: Keras for Artificial Neural Network","text":"Associated Materials Notebook | Lab 10: Keras for Artificial Neural Network","tags":"labs","url":"labs/lab-10/"},{"title":"Standard Section 8: Bagging and Random Forest","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 8: Bagging and Random Forest Harvard University Fall 2017 Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan R. Motwani, Cecilia Garraffo Instructors: Pavlos Protopapas, Kevin Rader In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } This section will work with a spam email dataset. Our ultimate goal is to be able to build models so that we can predict whether an email is spam or not spam based on word characteristics within each email. We will cover the Adaboost and Random Forest methods and allow you to apply it to the homework. Specifically, we will: 1. Load in the spam dataset and split the data into train and test. 2. Find the optimal depth for the Decision Tree model and evaluate performance. 3. Fit the Bagging model using multiple bootstrapped datasets and ensemble. 4. Fit the Random Forest Model and compare with Bagging. 5. Use the Adaboost method to visualize Bias-Variance tradeoff. 6. Example to better understand Bias vs Variance tradeoff. In [1]: import numpy as np import pandas as pd import matplotlib import matplotlib.pyplot as plt import sklearn.metrics as metrics from sklearn.model_selection import cross_val_score from sklearn.metrics import accuracy_score from sklearn import tree from sklearn.tree import DecisionTreeClassifier from sklearn.ensemble import RandomForestClassifier from sklearn.ensemble import AdaBoostClassifier from sklearn.linear_model import LogisticRegressionCV from sklearn.model_selection import KFold from sklearn.metrics import confusion_matrix % matplotlib inline from tqdm import tqdm pd . set_option ( 'display.width' , 1500 ) pd . set_option ( 'display.max_columns' , 100 ) from sklearn.model_selection import learning_curve ! pip install tqdm to install the tqdm package. Part 0 : Introduction to the Spam Dataset We will be working with a spam email dataset. The dataset has 57 predictors with a response variable called Spam that indicates whether an email is spam or not spam. The goal is to be able to create a classifier or method that acts as a spam filter. In [2]: #Import Dataframe and Set Column Names spam_df = pd . read_csv ( 'data/spam.csv' , header = None ) columns = [ \"Column_\" + str ( i + 1 ) for i in range ( spam_df . shape [ 1 ] - 1 )] + [ 'Spam' ] spam_df . columns = columns display ( spam_df . head ()) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Column_1 Column_2 Column_3 Column_4 Column_5 Column_6 Column_7 Column_8 Column_9 Column_10 Column_11 Column_12 Column_13 Column_14 Column_15 Column_16 Column_17 Column_18 Column_19 Column_20 Column_21 Column_22 Column_23 Column_24 Column_25 Column_26 Column_27 Column_28 Column_29 Column_30 Column_31 Column_32 Column_33 Column_34 Column_35 Column_36 Column_37 Column_38 Column_39 Column_40 Column_41 Column_42 Column_43 Column_44 Column_45 Column_46 Column_47 Column_48 Column_49 Column_50 Column_51 Column_52 Column_53 Column_54 Column_55 Column_56 Column_57 Spam 0 0.00 0.64 0.64 0.0 0.32 0.00 0.00 0.00 0.00 0.00 0.00 0.64 0.00 0.00 0.00 0.32 0.00 1.29 1.93 0.00 0.96 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.00 0.00 0.0 0.0 0.00 0.000 0.0 0.778 0.000 0.000 3.756 61 278 1 1 0.21 0.28 0.50 0.0 0.14 0.28 0.21 0.07 0.00 0.94 0.21 0.79 0.65 0.21 0.14 0.14 0.07 0.28 3.47 0.00 1.59 0.0 0.43 0.43 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.07 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.00 0.00 0.0 0.0 0.00 0.132 0.0 0.372 0.180 0.048 5.114 101 1028 1 2 0.06 0.00 0.71 0.0 1.23 0.19 0.19 0.12 0.64 0.25 0.38 0.45 0.12 0.00 1.75 0.06 0.06 1.03 1.36 0.32 0.51 0.0 1.16 0.06 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.06 0.0 0.0 0.12 0.0 0.06 0.06 0.0 0.0 0.01 0.143 0.0 0.276 0.184 0.010 9.821 485 2259 1 3 0.00 0.00 0.00 0.0 0.63 0.00 0.31 0.63 0.31 0.63 0.31 0.31 0.31 0.00 0.00 0.31 0.00 0.00 3.18 0.00 0.31 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.00 0.00 0.0 0.0 0.00 0.137 0.0 0.137 0.000 0.000 3.537 40 191 1 4 0.00 0.00 0.00 0.0 0.63 0.00 0.31 0.63 0.31 0.63 0.31 0.31 0.31 0.00 0.00 0.31 0.00 0.00 3.18 0.00 0.31 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.00 0.00 0.0 0.0 0.00 0.135 0.0 0.135 0.000 0.000 3.537 40 191 1 The predictor variabes are all continuous. They represent certain features like the frequency of the word \" discount \". The exact specification and description of each predictor can be found online. We are not so much interested in the exact inference of each predictor so we will omit the exact names of each of the predictors. We are more interested in the prediction of the algorithm so we will treat each as predictor without going into too much exact detail in each. Link to description : https://archive.ics.uci.edu/ml/datasets/spambase Let us split the dataset into a 70-30 split by using the following: Note : While you will use train_test_split in your homeworks, the code below should help you visualize splitting/masking of a dataframe which will be helpful in general. In [4]: #Split data into train and test np . random . seed ( 42 ) msk = np . random . rand ( len ( spam_df )) < 0.7 data_train = spam_df [ msk ] data_test = spam_df [ ~ msk ] #Split predictor and response columns x_train , y_train = data_train . drop ([ 'Spam' ], axis = 1 ), data_train [ 'Spam' ] x_test , y_test = data_test . drop ([ 'Spam' ], axis = 1 ), data_test [ 'Spam' ] print ( \"Shape of Training Set :\" , data_train . shape ) print ( \"Shape of Testing Set :\" , data_test . shape ) Shape of Training Set : (3262, 58) Shape of Testing Set : (1339, 58) In [13]: spam_df . iloc [ np . arange ( 10 )] Out[13]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Column_1 Column_2 Column_3 Column_4 Column_5 Column_6 Column_7 Column_8 Column_9 Column_10 Column_11 Column_12 Column_13 Column_14 Column_15 Column_16 Column_17 Column_18 Column_19 Column_20 Column_21 Column_22 Column_23 Column_24 Column_25 Column_26 Column_27 Column_28 Column_29 Column_30 Column_31 Column_32 Column_33 Column_34 Column_35 Column_36 Column_37 Column_38 Column_39 Column_40 Column_41 Column_42 Column_43 Column_44 Column_45 Column_46 Column_47 Column_48 Column_49 Column_50 Column_51 Column_52 Column_53 Column_54 Column_55 Column_56 Column_57 Spam 0 0.00 0.64 0.64 0.0 0.32 0.00 0.00 0.00 0.00 0.00 0.00 0.64 0.00 0.00 0.00 0.32 0.00 1.29 1.93 0.00 0.96 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.00 0.00 0.00 0.0 0.0 0.00 0.000 0.0 0.778 0.000 0.000 3.756 61 278 1 1 0.21 0.28 0.50 0.0 0.14 0.28 0.21 0.07 0.00 0.94 0.21 0.79 0.65 0.21 0.14 0.14 0.07 0.28 3.47 0.00 1.59 0.0 0.43 0.43 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.07 0.0 0.0 0.00 0.0 0.0 0.00 0.00 0.00 0.00 0.0 0.0 0.00 0.132 0.0 0.372 0.180 0.048 5.114 101 1028 1 2 0.06 0.00 0.71 0.0 1.23 0.19 0.19 0.12 0.64 0.25 0.38 0.45 0.12 0.00 1.75 0.06 0.06 1.03 1.36 0.32 0.51 0.0 1.16 0.06 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.06 0.0 0.0 0.12 0.00 0.06 0.06 0.0 0.0 0.01 0.143 0.0 0.276 0.184 0.010 9.821 485 2259 1 3 0.00 0.00 0.00 0.0 0.63 0.00 0.31 0.63 0.31 0.63 0.31 0.31 0.31 0.00 0.00 0.31 0.00 0.00 3.18 0.00 0.31 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.00 0.00 0.00 0.0 0.0 0.00 0.137 0.0 0.137 0.000 0.000 3.537 40 191 1 4 0.00 0.00 0.00 0.0 0.63 0.00 0.31 0.63 0.31 0.63 0.31 0.31 0.31 0.00 0.00 0.31 0.00 0.00 3.18 0.00 0.31 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.00 0.00 0.00 0.0 0.0 0.00 0.135 0.0 0.135 0.000 0.000 3.537 40 191 1 5 0.00 0.00 0.00 0.0 1.85 0.00 0.00 1.85 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.00 0.00 0.00 0.0 0.0 0.00 0.223 0.0 0.000 0.000 0.000 3.000 15 54 1 6 0.00 0.00 0.00 0.0 1.92 0.00 0.00 0.00 0.00 0.64 0.96 1.28 0.00 0.00 0.00 0.96 0.00 0.32 3.85 0.00 0.64 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.00 0.00 0.00 0.0 0.0 0.00 0.054 0.0 0.164 0.054 0.000 1.671 4 112 1 7 0.00 0.00 0.00 0.0 1.88 0.00 0.00 1.88 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.0 0.00 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.00 0.00 0.00 0.0 0.0 0.00 0.206 0.0 0.000 0.000 0.000 2.450 11 49 1 8 0.15 0.00 0.46 0.0 0.61 0.00 0.30 0.00 0.92 0.76 0.76 0.92 0.00 0.00 0.00 0.00 0.00 0.15 1.23 3.53 2.00 0.0 0.00 0.15 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.15 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.30 0.00 0.00 0.00 0.0 0.0 0.00 0.271 0.0 0.181 0.203 0.022 9.744 445 1257 1 9 0.06 0.12 0.77 0.0 0.19 0.32 0.38 0.00 0.06 0.00 0.00 0.64 0.25 0.00 0.12 0.00 0.00 0.12 1.67 0.06 0.71 0.0 0.19 0.00 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.00 0.0 0.0 0.0 0.00 0.0 0.0 0.00 0.0 0.0 0.00 0.06 0.00 0.00 0.0 0.0 0.04 0.030 0.0 0.244 0.081 0.000 1.729 43 749 1 We can check that the number of spam cases is roughly evenly represented in both the training and test set. In [11]: #Check Percentage of Spam in Train and Test Set print ( \"Percentage of Spam in Training Set :\" , str ( 100 * y_train . sum () / len ( y_train )) + '%' ) print ( \"Percentage of Spam in Testing Set :\" , str ( 100 * y_test . sum () / len ( y_test )) + '%' ) Percentage of Spam in Training Set : 39.17841814837523% Percentage of Spam in Testing Set : 39.955190440627334% Part 1 : Fitting an Optimal Single Decision Tree (by Depth) : We fit here a single tree to our spam dataset and perform 5-fold cross validation on the training set. For EACH depth of the tree, we fit a tree and then compute the 5-fold CV scores. These scores are then averaged and compared across different depths. In [6]: #Find optimal depth of trees depth , tree_start , tree_end = {}, 3 , 20 for i in range ( tree_start , tree_end ): model = DecisionTreeClassifier ( max_depth = i ) scores = cross_val_score ( estimator = model , X = x_train , y = y_train , cv = 5 , n_jobs =- 1 ) depth [ i ] = scores . mean () #Plot lists = sorted ( depth . items ()) x , y = zip ( * lists ) plt . ylabel ( \"Cross Validation Accuracy\" ) plt . xlabel ( \"Maximum Depth\" ) plt . title ( 'Variation of Accuracy with Depth - Simple Decision Tree' ) plt . plot ( x , y , 'b-' , marker = 'o' ) plt . show () As we can see, the optimal depth is found to be a depth of 7. Although, does it makes sense to choose 6? Let us set best_depth as a new parameter. Can you see why we coded the best depth parameter as we did below? (Hint: Think about reproducibility.) Also, of we wanted to get the Confidence Bands of these results, how would we? It's as simple as a combination of getting variance using scores.std() and plt.fill_between() . In [7]: #Make best depth a variable best_depth = sorted ( depth , key = depth . get , reverse = True )[ 0 ] print ( \"The best depth was found to be:\" , best_depth ) The best depth was found to be: 7 In [8]: #Evalaute the performance at the best depth model = DecisionTreeClassifier ( max_depth = best_depth ) model . fit ( x_train , y_train ) #Check Accuracy of Spam Detection in Train and Test Set print ( \"Accuracy, Training Set: {:.2%} \" . format ( accuracy_score ( y_train , model . predict ( x_train )))) print ( \"Accuracy, Testing Set: {:.2%} \" . format ( accuracy_score ( y_test , model . predict ( x_test )))) Accuracy, Training Set: 94.39% Accuracy, Testing Set: 90.81% In [9]: #Get Performance by Class (Lookup Confusion Matrix) pd . crosstab ( y_test , model . predict ( x_test ), margins = True , rownames = [ 'Actual' ], colnames = [ 'Predicted' ]) Out[9]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Predicted 0 1 All Actual 0 758 46 804 1 77 458 535 All 835 504 1339 Part 2: Bagging and Voting Let's bootstrap our training dataset to create multiple, fit Decision Tree models to each. (Resampling: we showed live that different samples give different results for things like sums, varying more when the things we sum over have high variance themselves.) In [80]: # Stat on all data data_train . sum ( axis = 0 ) . to_frame ( 'sum' ) . T Out[80]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Column_1 Column_2 Column_3 Column_4 Column_5 Column_6 Column_7 Column_8 Column_9 Column_10 Column_11 Column_12 Column_13 Column_14 Column_15 Column_16 Column_17 Column_18 Column_19 Column_20 Column_21 Column_22 Column_23 Column_24 Column_25 Column_26 Column_27 Column_28 Column_29 Column_30 Column_31 Column_32 Column_33 Column_34 Column_35 Column_36 Column_37 Column_38 Column_39 Column_40 Column_41 Column_42 Column_43 Column_44 Column_45 Column_46 Column_47 Column_48 Column_49 Column_50 Column_51 Column_52 Column_53 Column_54 Column_55 Column_56 Column_57 Spam sum 345.72 673.94 929.37 215.52 1009.71 314.66 365.93 360.02 289.45 793.26 204.28 1754.83 313.3 183.96 162.91 867.46 455.96 615.97 5516.65 317.18 2661.76 392.17 319.55 289.32 1723.59 836.14 2532.76 419.81 319.23 361.45 211.09 164.33 334.18 165.17 367.15 334.49 443.42 48.39 266.91 224.98 129.31 402.75 148.0 236.4 1005.45 596.8 18.29 104.09 118.468 462.011 61.189 905.649 232.714 167.588 17290.936 172106.0 907663.0 1278.0 In [83]: data_train . sample ( frac = 1. , replace = True ) . sum ( axis = 0 ) . to_frame ( 'sum' ) . T Out[83]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Column_1 Column_2 Column_3 Column_4 Column_5 Column_6 Column_7 Column_8 Column_9 Column_10 Column_11 Column_12 Column_13 Column_14 Column_15 Column_16 Column_17 Column_18 Column_19 Column_20 Column_21 Column_22 Column_23 Column_24 Column_25 Column_26 Column_27 Column_28 Column_29 Column_30 Column_31 Column_32 Column_33 Column_34 Column_35 Column_36 Column_37 Column_38 Column_39 Column_40 Column_41 Column_42 Column_43 Column_44 Column_45 Column_46 Column_47 Column_48 Column_49 Column_50 Column_51 Column_52 Column_53 Column_54 Column_55 Column_56 Column_57 Spam sum 346.47 717.69 895.14 420.09 987.02 348.81 358.03 329.81 286.01 749.9 187.9 1761.05 341.26 194.12 163.01 813.03 428.91 635.57 5493.24 312.82 2628.2 418.56 335.29 281.29 1744.44 797.15 2110.56 442.27 341.18 360.57 196.14 147.81 338.25 149.91 370.14 328.65 429.03 45.06 240.01 218.37 144.31 449.42 145.63 196.12 1080.91 665.12 14.31 118.5 124.247 452.753 67.43 903.126 240.119 158.87 15532.539 180343.0 942985.0 1275.0 Now we actually fit the samples In [85]: #Creating model np . random . seed ( 0 ) model = DecisionTreeClassifier ( max_depth = 5 ) # we tried a variety of depths here #Initializing variables n_trees = 100 # we tried a variety of numbers here predictions_train = np . zeros (( data_train . shape [ 0 ], n_trees )) predictions_test = np . zeros (( data_test . shape [ 0 ], n_trees )) #Conduct bootstraping iterations for i in range ( n_trees ): temp = data_train . sample ( frac = 1 , replace = True ) response_variable = temp [ 'Spam' ] temp = temp . drop ([ 'Spam' ], axis = 1 ) model . fit ( temp , response_variable ) predictions_train [:, i ] = model . predict ( x_train ) predictions_test [:, i ] = model . predict ( x_test ) #Make Predictions Dataframe columns = [ \"Bootstrap-Model_\" + str ( i + 1 ) for i in range ( n_trees )] predictions_train = pd . DataFrame ( predictions_train , columns = columns ) predictions_test = pd . DataFrame ( predictions_test , columns = columns ) In [86]: y_train = data_train [ 'Spam' ] . values y_test = data_test [ 'Spam' ] . values In [76]: num_to_avg = 100 # we varied this line, from 1, 2, 3, 100, n_trees fig , axs = plt . subplots ( 1 , 2 , figsize = ( 16 , 7 )) for ( ax , label , predictions , y ) in [ ( axs [ 0 ], 'train' , predictions_train , y_train ), ( axs [ 1 ], 'test' , predictions_test , y_test ) ]: mean_predictions = predictions . iloc [:,: num_to_avg ] . mean ( axis = 1 ) mean_predictions [ y == 1 ] . hist ( density = True , histtype = 'step' , range = [ 0 , 1 ], label = 'Spam' , lw = 2 , ax = ax ) mean_predictions [ y == 0 ] . hist ( density = True , histtype = 'step' , range = [ 0 , 1 ], label = 'Not-Spam' , lw = 2 , ax = ax ) ax . legend ( loc = 'upper center' ); ax . set_xlabel ( \"Mean of ensemble predictions\" ) ax . set_title ( label ) (Try 100 trees of depth 1. Why do the plots look similar to when we did 2 trees of higher depth?) And now vote! In [58]: #Function to ensemble the prediction of each bagged decision tree model def get_prediction ( df , count =- 1 ): count = df . shape [ 1 ] if count ==- 1 else count temp = df . iloc [:, 0 : count ] return np . mean ( temp , axis = 1 ) > 0.5 #Check Accuracy of Spam Detection in Train and Test Set print ( \"Accuracy, Training Set :\" , str ( 100 * accuracy_score ( y_train , get_prediction ( predictions_train , count =- 1 ))) + '%' ) print ( \"Accuracy, Testing Set :\" , str ( 100 * accuracy_score ( y_test , get_prediction ( predictions_test , count =- 1 ))) + '%' ) Accuracy, Training Set : 94.54322501532802% Accuracy, Testing Set : 92.3076923076923% Count in the above code can be use to define the number of models the voting in the dataframe should be based on. In [59]: #Get Performance by Class (Lookup Confusion Matrix) pd . crosstab ( np . array ( y_test ), model . predict ( x_test ), margins = True , rownames = [ 'Actual' ], colnames = [ 'Predicted' ]) Out[59]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Predicted 0 1 All Actual 0 760 44 804 1 83 452 535 All 843 496 1339 Is there a variation between the accuracy and number of bagging columns we consider? Food for Thought : Are these bagging models independent of each other, can they be trained in a parallel fashion? Part 3 : Random Forest vs Bagging Now, we will fit an ensemble method, the Random Forest technique, which is different from the decision tree. Refer to the lectures slides for a full treatment on how they are different. Let's use n_estimators = predictor_count/2 and max_depth = best_depth . In [15]: #Fit a Random Forest Model #Training model = RandomForestClassifier ( n_estimators = int ( x_train . shape [ 1 ] / 2 ), max_depth = best_depth ) model . fit ( x_train , y_train ) #Predict y_pred_train = model . predict ( x_train ) y_pred_test = model . predict ( x_test ) #Perfromance Evaluation train_score = accuracy_score ( y_train , y_pred_train ) * 100 test_score = accuracy_score ( y_test , y_pred_test ) * 100 print ( \"Accuracy, Training Set :\" , str ( train_score ) + '%' ) print ( \"Accuracy, Testing Set :\" , str ( test_score ) + '%' ) Accuracy, Training Set : 94.78847332924586% Accuracy, Testing Set : 93.42793129200896% In [16]: #Top Features feature_importance = model . feature_importances_ feature_importance = 100.0 * ( feature_importance / feature_importance . max ()) sorted_idx = np . argsort ( feature_importance ) pos = np . arange ( sorted_idx . shape [ 0 ]) + . 5 #Plot plt . figure ( figsize = ( 10 , 12 )) plt . barh ( pos , feature_importance [ sorted_idx ], align = 'center' ) plt . yticks ( pos , x_train . columns [ sorted_idx ]) plt . xlabel ( 'Relative Importance' ) plt . title ( 'Variable Importance' ) Out[16]: Text(0.5,1,'Variable Importance') Random Forest gives the above values as feature_importance where it normalizes the impact of a predictor to the number of times it is useful and thus gives overvall significance for free. Explore the attributes of the Random Forest model object for the best nodes. As we see above, the performance of both Bagging and Random Forest was similar, so what is the difference? Do both overfit the data just as much? Hints : What is the only extra parameter we declared when defining a Random Forest Model vs Bagging? Does it have an impact on overfitting? When we ensembled trees using bagging, we used the class labels to get the majority vote. Can you think of an advantage to using prediction probabilities? Does Random Forest use labels or probabilities? Part 5 : Fitting an Adaboost Model Now let's try Boosting! In [17]: #Fit an Adaboost Model #Training model = AdaBoostClassifier ( base_estimator = DecisionTreeClassifier ( max_depth = 5 ), n_estimators = 100 , learning_rate = 0.05 ) model . fit ( x_train , y_train ) #Predict y_pred_train = model . predict ( x_train ) y_pred_test = model . predict ( x_test ) #Perfromance Evaluation train_score = accuracy_score ( y_train , y_pred_train ) * 100 test_score = accuracy_score ( y_test , y_pred_test ) * 100 print ( \"Accuracy, Training Set :\" , str ( train_score ) + '%' ) print ( \"Accuracy, Testing Set :\" , str ( test_score ) + '%' ) Accuracy, Training Set : 99.72409564684243% Accuracy, Testing Set : 94.39880507841673% In [18]: #Plot Iteration based score train_scores = list ( model . staged_score ( x_train , y_train )) test_scores = list ( model . staged_score ( x_test , y_test )) plt . plot ( train_scores , label = 'train' ) plt . plot ( test_scores , label = 'test' ) plt . xlabel ( 'Iteration' ) plt . ylabel ( 'Accuracy' ) plt . title ( \"Variation of Accuracy with Iterations\" ) plt . legend (); AdaBoost seems to be performing better than Simple Decision Trees and Random Forest considering Test Set Accuracy, what is the difference in approach it takes? In [19]: #Find Optimal Depth of trees for Boosting score_train , score_test , depth_start , depth_end = {}, {}, 2 , 20 for i in tqdm ( range ( depth_start , depth_end )): model = AdaBoostClassifier ( base_estimator = DecisionTreeClassifier ( max_depth = i ), n_estimators = 100 , learning_rate = 0.05 ) model . fit ( x_train , y_train ) score_train [ i ] = accuracy_score ( y_train , model . predict ( x_train )) score_test [ i ] = accuracy_score ( y_test , model . predict ( x_test )) 100%|██████████| 18/18 [00:51<00:00, 2.85s/it] In [20]: #Plot lists1 = sorted ( score_train . items ()) lists2 = sorted ( score_test . items ()) x1 , y1 = zip ( * lists1 ) x2 , y2 = zip ( * lists2 ) plt . ylabel ( \"Accuracy\" ) plt . xlabel ( \"Depth\" ) plt . title ( 'Variation of Accuracy with Depth - Adaboost Classifier' ) plt . plot ( x1 , y1 , 'b-' , label = 'Train' ) plt . plot ( x2 , y2 , 'g-' , label = 'Test' ) plt . legend () plt . show () Adaboost complexity depends on both the number of estimators and the base estimator. As our model complexity increases, we observe an increase in accuracy but as we go further to the right of the graph, our model will overfit the data. To formally understand what is going on here, we will give a brief treatment of how the bias and variance are related in the next section. What would happen if we varied depth and estimators simulataneously? Is that the right way to assess the trade-off between performance and overfitting? Food for Thought : Are boosted models independent of one another? Do they need to wait for the previous model's residuals? Part 6 : The Bias-Variance tradeoff A central notion underlying what we've been learning in lectures and sections so far is the trade-off between overfitting and underfitting. If you remember back to Homework 3, we had a model that seemed to represent our data accurately. However, we saw that as we made it more and more accurate on the training set, it did not generalize well to unobserved data. As a different example, in face recognition algorithms, such as that on the iPhone X, a too-accurate model would be unable to identity someone who styled their hair differently that day. The reason is that our model may learn irrelevant features in the training data. On the contrary, an insufficiently trained model would not generalize well either. For example, it was recently reported that a face mask could sufficiently fool the iPhone X. A widely used solution in statistics to reduce overfitting consists of adding structure to the model, with something like regularization. This method favors simpler models during training. The bias-variance dilemma is closely related. The bias of a model quantifies how precise a model is across training sets. The variance quantifies how sensitive the model is to small changes in the training set. A robust model is not overly sensitive to small changes. The dilemma involves minimizing both bias and variance; we want a precise and robust model. Simpler models tend to be less accurate but more robust. Complex models tend to be more accurate but less robust. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-8/student/"},{"title":"Advanced Section 8: Artificial Neural Networks for Image Analysis","text":"Slides PDF | Artificial Neural Networks for Image Analysis PPTX | Artificial Neural Networks for Image Analysis","tags":"a-sections","url":"a-sections/a-section-8/"},{"title":"Lecture 19: Artificial Neural Networks 3 - Regularization Methods for ANN","text":"Slides PDF | Lecture 19: Artificial Neural Networks 3 - Regularization Methods for ANN PPTX | Lecture 19: Artificial Neural Networks 3 - Regularization Methods for ANN Associated Materials PDF | Lecture 19: Artificial Neural Networks 3 - Optimization PPTX | Lecture 19: Artificial Neural Networks 3 - Optimization Notebook | Standard Section 9: Artificial Neural Networks Continued","tags":"lectures","url":"lectures/lecture-19/"},{"title":"Lecture 18: Artificial Neural Networks 2 - Anatomy of ANN","text":"Slides PDF | Lecture 18: Artificial Neural Networks 2 - Anatomy of NN PPTX | Lecture 18: Artificial Neural Networks 2 - Anatomy of NN Associated Materials Notebook | Standard Section 9: Artificial Neural Networks Continued Notebook | Lab 10: Keras for Artificial Neural Network Notebook | Lab 7: NumPy for Building an Artificial Neural Network and Dealing with Missing Values Notebook | Standard Section 6: Feed Forward Artificial Neural Networks","tags":"lectures","url":"lectures/lecture-18/"},{"title":"Standard Section 8: Bagging and Random Forest","text":"Jupyter Notebooks Standard Section 8: Bagging and Random Forest","tags":"sections","url":"sections/section-8/"},{"title":"Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting","text":"Jupyter Notebooks Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting - Student Version Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting - Solutions","tags":"labs","url":"labs/lab-9/"},{"title":"Advanced Section 7: Decision Trees and Ensemble Methods","text":"Slides PDF | Advanced Section 7: Decision Trees and Ensemble Methods PPTX | Advanced Section 7: Decision Trees and Ensemble Methods","tags":"a-sections","url":"a-sections/a-section-7/"},{"title":"Lecture 17: Boosting Methods","text":"Slides PDF | Lecture 17: Boosting Methods PPTX | Lecture 17: Boosting Methods Jupyter Notebook Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting","tags":"lectures","url":"lectures/lecture-17/"},{"title":"Lecture 16: Regression Trees, Bagging and Random Forest","text":"Slides PDF | Lecture 16: Regression Trees, Bagging and Random Forest PPTX | Lecture 16: Regression Trees, Bagging and Random Forest Jupyter Notebook Standard Section 8: Bagging and Random Forest Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting","tags":"lectures","url":"lectures/lecture-16/"},{"title":"Standard Section 7: Multiclass Classification Methods","text":"Jupyter Notebooks Standard Section 7: Multiclass Classification Methods","tags":"sections","url":"sections/section-7/"},{"title":"Lab 8: Discriminant Analysis - A tale of two cities","text":"Jupyter Notebooks Lab 8: Discriminant Analysis - Student Version Lab 8: Discriminant Analysis - Solutions","tags":"labs","url":"labs/lab-8/"},{"title":"Lecture 15: Classification Trees","text":"Slides PDF | Lecture 15: Classification Trees PPTX | Lecture 15: Classification Trees Jupyter Notebook Lecture 15: Decision Trees Demo Standard Section 8: Bagging and Random Forest Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting","tags":"lectures","url":"lectures/lecture-15/"},{"title":"Advanced Section 6: Topics in Supervised Classification","text":"Lecture Notes PDF | Advanced Section 6: Topics in Supervised Classification","tags":"a-sections","url":"a-sections/a-section-6/"},{"title":"Lecture 14: Discriminant Analysis - Linear and Quadratic (LDA/QDA)","text":"Slides PDF | Lecture 14: Linear and Quadratic Discriminant Analysis PPTX | Lecture 14: Linear and Quadratic Discriminant Analysis Jupyter Notebook Lecture 14: Discriminant Analysis Demo Standard Section 7: Multiclass Classification Lab 8: Discriminant Analysis - A tale of two cities","tags":"lectures","url":"lectures/lecture-14/"},{"title":"Lab 7: NumPy for Building Artificial Neural Network and Dealing with Missing Values","text":"Jupyter Notebooks Prep for Lab 7: Numpy for Tensor and Artificial Neural Networks Lab 7: NumPy for Building an Artificial Neural Network and Dealing with Missing Values","tags":"labs","url":"labs/lab-7/"},{"title":"Standard Section 6: Feed Forward Artificial Neural Networks Demo","text":"Jupyter Notebook Standard Section 6: Feed Forward Artificial Neural Networks - Solutions","tags":"sections","url":"sections/section-6/"},{"title":"Lecture 13: k-NN for Classification and Dealing with Missingness","text":"Slides PDF | Lecture 13: k-NN for Classification and Dealing with Missingness PPTX | Lecture 13: k-NN for Classification and Dealing with Missingness Jupyter Notebooks Lecture 13: Classification with KNN Demo Standard Section 7: Multiclass Classification","tags":"lectures","url":"lectures/lecture-13/"},{"title":"Advanced Section 5: Generalized Linear Models, Logistic Regression and Beyond","text":"Slides PDF | Advanced Section 5: Generalized Linear Models, Logistic Regression and Beyond PPTX | Advanced Section 5: Generalized Linear Models, Logistic Regression and Beyond Section Notes PDF | Advanced Section 5: Generalized Linear Models, Logistic Regression and Beyond","tags":"a-sections","url":"a-sections/a-section-5/"},{"title":"Lecture 12: Artificial Neural Networks 1 - Perceptron and Back Propagation","text":"Slides PDF | Lecture 12: Artificial Neural Networks 1 - Perceptron and Back Propagation PPTX | Lecture 12: Artificial Neural Networks 1 - Perceptron and Back Propagation Jupyter Notebook Preparation for Lab 7: Tensor and Neural Networks Lab 7: NumPy for Building an Artificial Neural Network and Dealing with Missing Values Standard Section 6: Feed Forward Artificial Neural Networks","tags":"lectures","url":"lectures/lecture-12/"},{"title":"Standard Section 5: Logistic Regression and Principal Component Analysis (PCA)","text":"Slides PDF | Standard Section 5: Linear and Logistic Regression Recap Jupyter Notebooks [Standard Section 5: Logistic Regression and Principal Component Analysis (PCA) Solutions]({filename}notebook/solutions/section5_solutions.ipynb)","tags":"sections","url":"sections/section-5/"},{"title":"Lab 6: Classification and Dimensionality Reduction","text":"Jupyter Notebooks Lab 6: Classification and Dimensionality Reduction - Student Version","tags":"labs","url":"labs/lab-6/"},{"title":"Advanced Section 4: Methods of Dimensionality Reduction - Principal Component Analysis","text":"Slides PDF | Advanced Section 4: Methods of Dimensionality Reduction - Principal Component Analysis (PCA) PPTX | Advanced Section 4: Methods of Dimensionality Reduction - Principal Component Analysis (PCA) Section Notes PDF | Advanced Section 4: Methods of Dimensionality Reduction - Principal Component Analysis (PCA)","tags":"a-sections","url":"a-sections/a-section-4/"},{"title":"Lecture 11: Logistic Regression 2","text":"Slides PDF | Lecture 11: Logistic Regression 2 PPTX | Lecture 11: Logistic Regression 2 Jupyter Notebooks Lecture 11: Logistic Regression 2 Demo Lab 6: Classification and Dimensionality Reduction - Student Version","tags":"lectures","url":"lectures/lecture-11/"},{"title":"Lecture 10: Logistic Regression 1","text":"Slides PDF | Lecture 10: Logistic Regression 1 PPTX | Lecture 10: Logistic Regression 1 Jupyter Notebooks Lecture 10: Logistic Regression 1 Demo Standard Section 5: Logistic Regression and Principal Component Analysis (PCA) - Solutions Lab 6: Classification and Dimensionality Reduction - Student Version","tags":"lectures","url":"lectures/lecture-10/"},{"title":"Standard Section 4: Model Selection","text":"Slides HTML | Standard Section 4: Model Selection Jupyter Notebooks Standard Section 4: Model Selection Demo","tags":"sections","url":"sections/section-4/"},{"title":"Lecture 9: Visualization for Communication","text":"Slides PDF | Lecture 9: Visualization for Communication","tags":"lectures","url":"lectures/lecture-9/"},{"title":"Lab 1: Introduction to Python and its Numerical Stack","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 1: Introduction to Python and its Numerical Stack Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Programming Expectations All assignments for this class will use Python and the browser-based iPython notebook format you are currently viewing. Python experience is not a prerequisite for this course, as long as you are comfortable learning on your own as needed. Note though that the programming at the level of CS 50 is a prerequisite for this course. If you have concerns about the prerequisite, please come speak with any of the instructors. We will refer to the Python 3 documentation in this lab and throughout the course. There are also many introductory tutorials to help build programming skills, which we are listed in the last section of this lab. Table of Contents Learning Goals Getting Started Lists Simple Functions Numpy Scipy.stats and plotting distributions Conclusions Additional Stuff Dictionaries Reading CSVs using pandas Learning Goals This introductory lab is a condensed introduction to Python numerical programming. By the end of this lab, you will feel more comfortable: Writing short Python code using functions, loops, lists, numpy arrays, and dictionaries. Manipulating Python lists and numpy arrays and understanding the difference between them. Using probability distributions from scipy.stats Making very simple plots using matplotlib Reading and writing CSV files using pandas Learning and reading Python documentation. Lab 1 relates to material in lecture 0,1,2,3 and homework 0. Part 1: Getting Started Importing modules All notebooks should begin with code that imports modules , collections of built-in, commonly-used Python functions. Below we import the Numpy module, a fast numerical programming library for scientific computing. Future labs will require additional modules, which we'll import with the same import MODULE_NAME as MODULE_NICKNAME syntax. In [2]: import numpy as np #imports a fast numerical programming library Now that Numpy has been imported, we can access some useful functions. For example, we can use mean to calculate the mean of a set of numbers. In [3]: np . mean ([ 1.2 , 2 , 3.3 ]) Out[3]: 2.1666666666666665 to calculate the mean of 1.2, 2, and 3.3. The code above is not particularly efficient, and efficiency will be important for you when dealing with large data sets. Later and in lab 2 we will see more efficient options. Calculations and variables In [4]: # // is integer division 1 / 2 , 1 // 2 , 1.0 / 2.0 , 3 * 3.2 Out[4]: (0.5, 0, 0.5, 9.600000000000001) The last line in a cell is returned as the output value, as above. For cells with multiple lines of results, we can display results using print , as can be seen below. In [5]: print ( 1 + 3.0 , \" \\n \" , 9 , 7 ) 5 / 3 4.0 9 7 Out[5]: 1.6666666666666667 We can store integer or floating point values as variables. The other basic Python data types -- booleans, strings, lists -- can also be stored as variables. (more on types here: http://www.diveintopython3.net/native-datatypes.html ) In [6]: a = 1 b = 2.0 Here is the storing of a list (more about what a list is later): In [7]: a = [ 1 , 2 , 3 ] Think of a variable as a label for a value, not a box in which you put the value (image taken from Fluent Python by Luciano Ramalho) In [8]: b = a b Out[8]: [1, 2, 3] This DOES NOT create a new copy of a . It merely puts a new label on the memory at a, as can be seen by the following code: In [9]: print ( \"a\" , a ) print ( \"b\" , b ) a [ 1 ] = 7 print ( \"a after change\" , a ) print ( \"b after change\" , b ) a [1, 2, 3] b [1, 2, 3] a after change [1, 7, 3] b after change [1, 7, 3] Tuples Multiple items on one line in the interface are returned as a tuple , an immutable sequence of Python objects. In [10]: a = 1 b = 2.0 a + a , a - b , b * b , 10 * a Out[10]: (2, -1.0, 4.0, 10) We can obtain the type of a variable, and use boolean comparisons to test these types. In [11]: type ( a ) == float Out[11]: False In [12]: type ( a ) == int Out[12]: True For reference, below are common arithmetic and comparison operations. EXERCISE**: Create a tuple called `tup` with the following seven objects: . The first element is an integer of your choice The second element is a float of your choice The third element is the sum of the first two elements The fourth element is the difference of the first two elements The fifth element is first element divided by the second element Display the output of tup . What is the type of the variable tup ? What happens if you try and chage an item in the tuple? In [13]: # your code here a = 1 b = 2.0 tup = ( a , b , a + b , a - b , a / a ) print ( tup , type ( tup )) print ( type ( a )) tup [ 1 ] = 4 (1, 2.0, 3.0, -1.0, 1.0) --------------------------------------------------------------------------- TypeError Traceback (most recent call last) in () 5 print ( tup , type ( tup ) ) 6 print ( type ( a ) ) ----> 7 tup [ 1 ] = 4 TypeError : 'tuple' object does not support item assignment Part 2: Lists Much of Python is based on the notion of a list. In Python, a list is a sequence of items separated by commas, all within square brackets. The items can be integers, floating points, or another type. Unlike in C arrays, items in a Python list can be different types, so Python lists are more versatile than traditional arrays in C or in other languages. Let's start out by creating a few lists. In [14]: empty_list = [] float_list = [ 1. , 3. , 5. , 4. , 2. ] int_list = [ 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ] mixed_list = [ 1 , 2. , 3 , 4. , 5 ] print ( empty_list ) print ( int_list ) print ( mixed_list , float_list ) [] [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] [1, 2.0, 3, 4.0, 5] [1.0, 3.0, 5.0, 4.0, 2.0] Lists in Python are zero-indexed, as in C. The first entry of the list has index 0, the second has index 1, and so on. In [15]: print ( int_list [ 0 ]) print ( float_list [ 1 ]) 1 3.0 What happens if we try to use an index that doesn't exist for that list? Python will complain! In [16]: print ( float_list [ 10 ]) --------------------------------------------------------------------------- IndexError Traceback (most recent call last) in () ----> 1 print ( float_list [ 10 ] ) IndexError : list index out of range You can find the length of a list using the builtin function len : In [17]: print ( float_list ) len ( float_list ) [1.0, 3.0, 5.0, 4.0, 2.0] Out[17]: 5 Indexing on lists And since Python is zero-indexed, the last element of float_list is In [18]: float_list [ len ( float_list ) - 1 ] Out[18]: 2.0 It is more idiomatic in python to use -1 for the last element, -2 for the second last, and so on In [19]: float_list [ - 1 ] Out[19]: 2.0 We can use the : operator to access a subset of the list. This is called slicing. In [20]: print ( float_list [ 1 : 5 ]) print ( float_list [ 0 : 2 ]) [3.0, 5.0, 4.0, 2.0] [1.0, 3.0] Below is a summary of list slicing operations: You can slice \"backwards\" as well: In [21]: float_list [: - 2 ] # up to second last Out[21]: [1.0, 3.0, 5.0] In [22]: float_list [: 4 ] # up to but not including 5th element Out[22]: [1.0, 3.0, 5.0, 4.0] You can also slice with a stride: In [23]: float_list [: 4 : 2 ] # above but skipping every second element Out[23]: [1.0, 5.0] We can iterate through a list using a loop. Here's a for loop. In [24]: for ele in float_list : print ( ele ) 1.0 3.0 5.0 4.0 2.0 Or, if we like, we can iterate through a list using the indices using a for loop with in range . This is not idiomatic and is not recommended, but accomplishes the same thing as above. In [25]: for i in range ( len ( float_list )): print ( float_list [ i ]) 1.0 3.0 5.0 4.0 2.0 What if you wanted the index as well? Use the built-in python method enumerate , which can be used to create a list of tuples with each tuple of the form (index, value) . In [26]: for i , ele in enumerate ( float_list ): print ( i , ele ) 0 1.0 1 3.0 2 5.0 3 4.0 4 2.0 In [27]: # or make a list from it using the list constructor list ( enumerate ( float_list )) Out[27]: [(0, 1.0), (1, 3.0), (2, 5.0), (3, 4.0), (4, 2.0)] Appending and deleting We can also append items to the end of the list using the + operator or with append . In [28]: float_list + [ . 333 ] Out[28]: [1.0, 3.0, 5.0, 4.0, 2.0, 0.333] In [29]: float_list . append ( . 444 ) In [30]: print ( float_list ) len ( float_list ) [1.0, 3.0, 5.0, 4.0, 2.0, 0.444] Out[30]: 6 Go and run the cell with float_list.append a second time. Then run the next line. What happens? To remove an item from the list, use del. In [31]: del ( float_list [ 2 ]) print ( float_list ) [1.0, 3.0, 4.0, 2.0, 0.444] List Comprehensions Lists can be constructed in a compact way using a list comprehension . Here's a simple example. In [32]: squaredlist = [ i * i for i in int_list ] squaredlist Out[32]: [1, 4, 9, 16, 25, 36, 49, 64, 81, 100] And here's a more complicated one, requiring a conditional. In [33]: comp_list1 = [ 2 * i for i in squaredlist if i % 2 == 0 ] print ( comp_list1 ) [8, 32, 72, 128, 200] This is entirely equivalent to creating comp_list1 using a loop with a conditional, as below: In [34]: comp_list2 = [] for i in squaredlist : if i % 2 == 0 : comp_list2 . append ( 2 * i ) print ( comp_list2 ) [8, 32, 72, 128, 200] The list comprehension syntax [expression for item in list if conditional] is equivalent to the syntax for item in list: if conditional: expression Exercise: Build a list that contains every prime number between 1 and 100, in two different ways: Using for loops and conditional if statements. (Stretch Goal) Using a list comprehension. You should be able to do this in one line of code, and it may be helpful to look up the function all in the documentation. In [35]: # your code here N = 100 ; # using loops and if statements primes = []; for j in range ( 2 , N ): count = 0 ; for i in range ( 2 , j ): if j % i == 0 : count = count + 1 ; if count == 0 : primes . append ( j ) print ( primes ) [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] In [36]: # your code here # using list comprehension primes_lc = [ j for j in range ( 2 , N ) if all ( j % i != 0 for i in range ( 2 , j ))] print ( primes ) print ( primes_lc ) [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] Part 4: Simple Functions A function object is a reusable block of code that does a specific task. Functions are all over Python, either on their own or on other objects. To invoke a function func , you call it as func(arguments) . We've seen built-in Python functions and methods. For example, len and print are built-in Python functions. And at the beginning, you called np.mean to calculate the mean of three numbers, where mean is a function in the numpy module and numpy was abbreviated as np . This syntax allows us to have multiple \"mean\" functions in different modules; calling this one as np.mean guarantees that we will pick up numpy's mean function, as opposed to a mean function from a different module. Methods A function that belongs to an object is called a method . By \"object\" here we mean an \"instance\" of a list, or integer, or floating point variable. An example of this is append on an existing list. In other words, a method is a function on an instance of a type of object (also called class , in this case, list type). In [37]: float_list = [ 1.0 , 2.09 , 4.0 , 2.0 , 0.444 ] print ( float_list ) float_list . append ( 56.7 ) float_list [1.0, 2.09, 4.0, 2.0, 0.444] Out[37]: [1.0, 2.09, 4.0, 2.0, 0.444, 56.7] User-defined functions We'll now learn to write our own user-defined functions. Below is the syntax for defining a basic function with one input argument and one output. You can also define functions with no input or output arguments, or multiple input or output arguments. def name_of_function(arg): ... return(output) We can write functions with one input and one output argument. Here are two such functions. In [38]: def square ( x ): x_sqr = x * x return ( x_sqr ) def cube ( x ): x_cub = x * x * x return ( x_cub ) square ( 5 ), cube ( 5 ) Out[38]: (25, 125) What if you want to return two variables at a time? The usual way is to return a tuple: In [39]: def square_and_cube ( x ): x_cub = x * x * x x_sqr = x * x return ( x_sqr , x_cub ) square_and_cube ( 5 ) Out[39]: (25, 125) Lambda functions Often we quickly define mathematical functions with a one-line function called a lambda function. Lambda functions are great because they enable us to write functions without having to name them, ie, they're anonymous . No return statement is needed. In [40]: # create an anonymous function and assign it to the variable square square = lambda x : x * x print ( square ( 3 )) hypotenuse = lambda x , y : x * x + y * y ## Same as # def hypotenuse(x, y): # return(x*x + y*y) hypotenuse ( 3 , 4 ) 9 Out[40]: 25 Refactoring using functions In an exercise from Lab 0, you wrote code that generated a list of the prime numbers between 1 and 100. For the excercise below, it may help to revisit that code. Write a function called `isprime` that takes in a positive integer $N$, and determines whether or not it is prime. Return `True` if it's prime and return `False` if it isn't. Then, using a list comprehension and `isprime`, create a list `myprimes` that contains all the prime numbers less than 100. In [41]: # your code here def isprime ( N ): count = 0 ; if not isinstance ( N , int ): return False if N <= 1 : return False for i in range ( 2 , N ): if N % i == 0 : count = count + 1 ; if count == 0 : return ( True ) else : return ( False ) print ( isprime ( 3.0 ), isprime ( \"rahul\" ), isprime ( 0 ), isprime ( - 1 ), isprime ( 1 ), isprime ( 2 ), isprime ( 93 ), isprime ( 97 )) myprimes = [ j for j in range ( 1 , 100 ) if isprime ( j )] print ( myprimes ) False False False False False True False True [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] Part 5: Introduction to Numpy Scientific Python code uses a fast array structure, called the numpy array. Those who have worked in Matlab will find this very natural. For reference, the numpy documention can be found here . Let's make a numpy array. In [42]: my_array = np . array ([ 1 , 2 , 3 , 4 ]) my_array Out[42]: array([1, 2, 3, 4]) In [43]: # works as in lists len ( my_array ) Out[43]: 4 The shape array of an array is very useful (we'll see more of it later when we talk about 2D and higher dimensional arrays). In [44]: my_array . shape Out[44]: (4,) Numpy arrays are typed . This means that by default, all the elements will be assumed to be of one type In [45]: my_array . dtype Out[45]: dtype('int64') Numpy arrays are listy (i.e. they act like lists)! Below we compute length, slice, and iterate. In [46]: print ( len ( my_array )) print ( my_array [ 2 : 4 ]) for ele in my_array : print ( ele ) 4 [3 4] 1 2 3 4 In general you should manipulate numpy arrays by using numpy module functions ( np.mean , for example). This is for efficiency purposes, and a discussion about this will happen in Lab2. You can calculate the mean of the array elements either by calling the method .mean on a numpy array or by applying the function np.mean with the numpy array as an argument. In [47]: print ( my_array . mean ()) print ( np . mean ( my_array )) 2.5 2.5 The way we constructed the numpy array above seems redundant. After all we already had a regular python list. Indeed, it is the other ways we have to construct numpy arrays that make them super useful. There are many such numpy array constructors . Here are some commonly used constructors. Look them up in the documentation. In [48]: np . ones ( 10 ) # generates 10 floating point ones Out[48]: array([ 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]) Numpy gains a lot of its efficiency from being typed. That is, all elements in the array have the same type, such as integer or floating point. The default type, as can be seen above, is a float of size appropriate for the machine (64 bit on a 64 bit machine). In [49]: np . dtype ( float ) . itemsize # in bytes Out[49]: 8 In [50]: np . ones ( 10 , dtype = 'int' ) # generates 10 integer ones Out[50]: array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1]) In [51]: np . zeros ( 10 ) Out[51]: array([ 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]) Often you will want random numbers. Use the random constructor! In [52]: np . random . random ( 10 ) # uniform on [0,1] Out[52]: array([ 0.31176998, 0.21638225, 0.26116532, 0.10280535, 0.94187203, 0.0879914 , 0.83332411, 0.6822109 , 0.01607741, 0.18671593]) You can generate random numbers from a normal distribution with mean 0 and variance 1: In [53]: normal_array = np . random . randn ( 1000 ) print ( \"The sample mean and standard devation are %f and %f , respectively.\" % ( np . mean ( normal_array ), np . std ( normal_array ))) The sample mean and standard devation are 0.009083 and 0.963996, respectively. You can sample with and without replacement from an array. Lets first construct a grid: In [54]: grid = np . arange ( 0. , 1.01 , 0.1 ) grid Out[54]: array([ 0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ]) Without replacement In [55]: np . random . choice ( grid , 5 , replace = False ) Out[55]: array([ 0.5, 0.8, 1. , 0.3, 0.6]) In [56]: np . random . choice ( grid , 20 , replace = False ) --------------------------------------------------------------------------- ValueError Traceback (most recent call last) in () ----> 1 np . random . choice ( grid , 20 , replace = False ) mtrand.pyx in mtrand.RandomState.choice () ValueError : Cannot take a larger sample than population when 'replace=False' With replacement: In [57]: np . random . choice ( grid , 12 , replace = True ) Out[57]: array([ 0.3, 1. , 0.9, 0.6, 0.5, 0.3, 0. , 0.2, 0.2, 0.5, 0.7, 0.8]) Numpy supports vector operations What does this mean? It means that instead of adding two arrays, element by element, you can just say: add the two arrays. Note that this behavior is very different from python lists. In [58]: first = np . ones ( 5 ) second = np . ones ( 5 ) first + second Out[58]: array([ 2., 2., 2., 2., 2.]) In [59]: first_list = [ 1. , 1. , 1. , 1. , 1. ] second_list = [ 1. , 1. , 1. , 1. , 1. ] first_list + second_list #not what u want Out[59]: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0] On some computer chips this addition actually happens in parallel, so speedups can be high. But even on regular chips, the advantage of greater readability is important. Numpy supports a concept known as broadcasting , which dictates how arrays of different sizes are combined together. There are too many rules to list here, but importantly, multiplying an array by a number multiplies each element by the number. Adding a number adds the number to each element. In [60]: first + 1 Out[60]: array([ 2., 2., 2., 2., 2.]) In [61]: first * 5 Out[61]: array([ 5., 5., 5., 5., 5.]) This means that if you wanted the distribution $N(5, 7)$ you could do: In [62]: normal_5_7 = 5 + 7 * normal_array np . mean ( normal_5_7 ), np . std ( normal_5_7 ) Out[62]: (5.0635814209889638, 6.7479731270809724) Multiplying two arrays multiplies them element-by-element In [63]: ( first + 1 ) * ( first * 5 ) Out[63]: array([ 10., 10., 10., 10., 10.]) You might have wanted to compute the dot product instead: In [64]: np . dot (( first + 1 ) , ( first * 5 )) Out[64]: 50.0 You can also use the @ operator for this purpose In [65]: ( first + 1 ) @ ( first * 5 ) Out[65]: 50.0 Part 6: Probabilitiy Distributions from scipy.stats Since we'll be using many distributions, we'll want to access the pdf/pmf functions of these distributions and obtain samples from them. We already saw how to obtain samples from the continuous uniform and normal distributions. But we might want to obtain their pdfs as well. scipy.stats allows us to obtain the pdf function as well as samples. The programming interface is identical for all the distributions. To plot samples from and the pdfs of these distributions, we'll first import matplotlib , python's plotting library. The %matplotlib inline incantation ensures that plots are rendered inline in the browser. In [66]: % matplotlib inline import matplotlib.pyplot as plt Lets get the normal distribution namespace from scipy.stats . Docs here . In [67]: from scipy.stats import norm Lets create 1000 points between -10 and 10 In [68]: x = np . linspace ( - 10 , 10 , 1000 ) x [: 10 ], x [ - 10 :] Out[68]: (array([-10. , -9.97997998, -9.95995996, -9.93993994, -9.91991992, -9.8998999 , -9.87987988, -9.85985986, -9.83983984, -9.81981982]), array([ 9.81981982, 9.83983984, 9.85985986, 9.87987988, 9.8998999 , 9.91991992, 9.93993994, 9.95995996, 9.97997998, 10. ])) Lets get the pdf of a normal distribution with a mean of 1 and standard deviation 3 and plot it using the grid points computed before... In [69]: pdf_x = norm . pdf ( x , 1 , 3 ) plt . plot ( x , pdf_x ); And you can get random variables using the rvs function. In [70]: norm . rvs ( size = 30 , loc = 1 , scale = 3 ) Out[70]: array([ 5.573023 , 4.29531407, 4.43464578, 2.66244624, 3.17804368, 2.01153664, 1.70429786, -1.1068918 , 1.48327465, 5.2732645 , 0.16261476, 3.40829003, 2.72399696, 0.51872854, 1.97602175, 1.14958871, -4.76595075, -0.17920129, 0.12951578, -3.0681983 , -1.23802565, -0.03562756, -0.35102633, 2.95950176, 5.23549116, -3.45444166, -3.00271711, 3.41801596, -2.57430954, 5.85658124]) We can use a more instance based way of getting both the pdf and samples. The documentation calls this instance a \"frozen\" distribution: In [71]: frozen_norm = norm ( loc = 1 , scale = 3 ) type ( frozen_norm ) Out[71]: scipy.stats._distn_infrastructure.rv_frozen In [72]: plt . plot ( x , frozen_norm . pdf ( x )) Out[72]: [ ] In [73]: frozen_norm . rvs ( 10 ) Out[73]: array([ 0.10703243, 0.87118319, 3.20669615, -3.89861921, -0.80555171, -2.70902483, 2.01685775, 2.51382032, -0.77747291, 1.18538112]) We can now plot a histogram of the samples using matplotlib: (see docs on plt.hist by typing ?plt.hist in a cell by itself) In [74]: plt . hist ( frozen_norm . rvs ( 1000 ), bins = 30 ); By default the histogram gives us counts. We can re-normalize these counts to get an approximation to the probability distribution from the samples. In [75]: plt . hist ( frozen_norm . rvs ( 1000 ), bins = 30 , normed = True ); Part 7: Conclusions For more practice exercises (with solutions) and discussion, see this page . Some of these exercises are particularly relevant. Check them out! Don't forget to look up Jake's book . Finally, we would like to suggest using Chris Albon's web site as a reference. Lots of useful information there. Additional Stuff Part 1: Dictionaries A dictionary is another storage container. Like a list, a dictionary is a sequence of items. Unlike a list, a dictionary is unordered and its items are accessed with keys and not integer positions. Dictionaries are the closest container we have to a database. Let's make a dictionary with a few Harvard courses and their corresponding enrollment numbers. In [76]: enroll2017_dict = { 'CS50' : 692 , 'CS109A / Stat 121A / AC 209A' : 352 , 'Econ1011a' : 95 , 'AM21a' : 153 , 'Stat110' : 485 } enroll2017_dict Out[76]: {'AM21a': 153, 'CS109A / Stat 121A / AC 209A': 352, 'CS50': 692, 'Econ1011a': 95, 'Stat110': 485} One can obtain the value corrsponding to a key thus: In [77]: enroll2017_dict [ 'CS50' ] Out[77]: 692 Or thus, which allows for the key to not be in the dictionary In [78]: enroll2017_dict . get ( 'CS01' , 5 ), enroll2017_dict . get ( 'CS01' ) Out[78]: (5, None) In [79]: enroll2017_dict . get ( 'CS50' ) Out[79]: 692 All sorts of iterations are supported: In [80]: enroll2017_dict . values () Out[80]: dict_values([692, 352, 95, 153, 485]) In [81]: enroll2017_dict . items () Out[81]: dict_items([('CS50', 692), ('CS109A / Stat 121A / AC 209A', 352), ('Econ1011a', 95), ('AM21a', 153), ('Stat110', 485)]) We can iterate over the tuples obtained above: (to read more about how the print formatting works , look at https://docs.python.org/3/library/stdtypes.html#old-string-formatting and https://docs.python.org/3/tutorial/inputoutput.html ) In [82]: for key , value in enroll2017_dict . items (): print ( \" %s : %d \" % ( key , value )) CS50: 692 CS109A / Stat 121A / AC 209A: 352 Econ1011a: 95 AM21a: 153 Stat110: 485 Simply iterating over a dictionary gives us the keys. This is useful when we want to do something with each item: In [83]: second_dict = {} for key in enroll2017_dict : second_dict [ key ] = enroll2017_dict [ key ] second_dict Out[83]: {'AM21a': 153, 'CS109A / Stat 121A / AC 209A': 352, 'CS50': 692, 'Econ1011a': 95, 'Stat110': 485} The above is an actual copy to another part of memory, unlike, second_dict = enroll2017_dict which would have made both variables label the same memory location. In this example, the keys were strings corresponding to course names. Keys don't have to be strings though. Like lists, you can construct dictionaries using a dictionary comprehension , which is similar to a list comprehension. Notice the brackets {} and the use of zip , which is another iterator that combines two lists together. In [84]: my_dict = { k : v for ( k , v ) in zip ( int_list , float_list )} my_dict Out[84]: {1: 1.0, 2: 2.09, 3: 4.0, 4: 2.0, 5: 0.444, 6: 56.7} You can also create dictionaries using the constructor function dict . In [85]: dict ( a = 1 , b = 2 ) Out[85]: {'a': 1, 'b': 2} Part 2: Introduction to Pandas Often data is stored in comma separated values (CSV) files. For the remainder of this lab, we'll be working with automobile data , where we've extracted relevant parts below. Note that CSV files can be output by any spreadsheet software, and are plain text, hence are a great way to share data. Importing data with pandas Now let's read in our automobile data as a pandas dataframe structure. In [86]: import pandas as pd In [87]: # Read in the csv files dfcars = pd . read_csv ( \"data/mtcars.csv\" ) type ( dfcars ) Out[87]: pandas.core.frame.DataFrame In [88]: dfcars . head () Out[88]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Unnamed: 0 mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 What we have now is a spreadsheet with indexed rows and named columns, called a dataframe in pandas. dfcars is an instance of the pd.DataFrame class , created by calling the pd.read_csv \"constructor function\". The take-away is that dfcars is a dataframe object, and it has methods (functions) belonging to it. For example, df.head() is a method that shows the first 5 rows of the dataframe. A pandas dataframe is a set of columns pasted together into a spreadsheet, as shown in the schematic below, which is taken from the cheatsheet above. The columns in pandas are called series objects. Let's look again at the first five rows of dfcars . In [89]: dfcars . head () Out[89]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Unnamed: 0 mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Notice the poorly named first column: \"Unnamed: 0\". Why did that happen? The first column, which seems to be the name of the car, does not have a name. Here are the first 3 lines of the file: \"\",\"mpg\",\"cyl\",\"disp\",\"hp\",\"drat\",\"wt\",\"qsec\",\"vs\",\"am\",\"gear\",\"carb\" \"Mazda RX4\",21,6,160,110,3.9,2.62,16.46,0,1,4,4 \"Mazda RX4 Wag\",21,6,160,110,3.9,2.875,17.02,0,1,4,4 Lets clean that up: In [90]: dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () Out[90]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 In the above, the argument columns = {\"Unnamed: 0\": \"name\"} of rename changed the name of the first column in the dataframe from Unnamed: 0 to name . Lets save this cleaned dataframe out to a CSV file. In [91]: # dont store the 0,1,2,3,4.. index dfcars . to_csv ( \"data/cleaned-mtcars.csv\" , index = False , header = True ) The output will look something like this: name,mpg,cyl,disp,hp,drat,wt,qsec,vs,am,gear,carb Mazda RX4,21.0,6,160.0,110,3.9,2.62,16.46,0,1,4,4 Mazda RX4 Wag,21.0,6,160.0,110,3.9,2.875,17.02,0,1,4,4 Datsun 710,22.8,4,108.0,93,3.85,2.32,18.61,1,1,4,1 Hornet 4 Drive,21.4,6,258.0,110,3.08,3.215,19.44,1,0,3,1 Hornet Sportabout,18.7,8,360.0,175,3.15,3.44,17.02,0,0,3,2 Valiant,18.1,6,225.0,105,2.76,3.46,20.22,1,0,3,1 To access a series (column), you can use either dictionary syntax or instance-variable syntax. Dictionary syntax is very useful when column names have spaces: Python variables cannot have spaces in them. In [92]: dfcars . mpg Out[92]: 0 21.0 1 21.0 2 22.8 3 21.4 4 18.7 5 18.1 6 14.3 7 24.4 8 22.8 9 19.2 10 17.8 11 16.4 12 17.3 13 15.2 14 10.4 15 10.4 16 14.7 17 32.4 18 30.4 19 33.9 20 21.5 21 15.5 22 15.2 23 13.3 24 19.2 25 27.3 26 26.0 27 30.4 28 15.8 29 19.7 30 15.0 31 21.4 Name: mpg, dtype: float64 In [93]: dfcars [ 'mpg' ] Out[93]: 0 21.0 1 21.0 2 22.8 3 21.4 4 18.7 5 18.1 6 14.3 7 24.4 8 22.8 9 19.2 10 17.8 11 16.4 12 17.3 13 15.2 14 10.4 15 10.4 16 14.7 17 32.4 18 30.4 19 33.9 20 21.5 21 15.5 22 15.2 23 13.3 24 19.2 25 27.3 26 26.0 27 30.4 28 15.8 29 19.7 30 15.0 31 21.4 Name: mpg, dtype: float64 You can get a numpy array of values from the Pandas Series: In [94]: dfcars . mpg . values Out[94]: array([ 21. , 21. , 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.8, 16.4, 17.3, 15.2, 10.4, 10.4, 14.7, 32.4, 30.4, 33.9, 21.5, 15.5, 15.2, 13.3, 19.2, 27.3, 26. , 30.4, 15.8, 19.7, 15. , 21.4]) And we can produce a histogram from these values In [95]: # the .values isnt really need, a series behaves like a list for # plotting purposes plt . hist ( dfcars . mpg . values , bins = 20 ); plt . xlabel ( \"mpg\" ); plt . ylabel ( \"Frequency\" ) plt . title ( \"Miles per Gallon\" ); But pandas is very cool: you can get a histogram directly: In [96]: dfcars . mpg . hist ( bins = 20 ); plt . xlabel ( \"mpg\" ); plt . ylabel ( \"Frequency\" ) plt . title ( \"Miles per Gallon\" ); We can also get sub-dataframes by choosing a set of series. We pass a list of the columns we want as \"dictionary keys\" to the dataframe. In [97]: dfcars [[ 'am' , 'mpg' ]] Out[97]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } am mpg 0 1 21.0 1 1 21.0 2 1 22.8 3 0 21.4 4 0 18.7 5 0 18.1 6 0 14.3 7 0 24.4 8 0 22.8 9 0 19.2 10 0 17.8 11 0 16.4 12 0 17.3 13 0 15.2 14 0 10.4 15 0 10.4 16 0 14.7 17 1 32.4 18 1 30.4 19 1 33.9 20 0 21.5 21 0 15.5 22 0 15.2 23 0 13.3 24 0 19.2 25 1 27.3 26 1 26.0 27 1 30.4 28 1 15.8 29 1 19.7 30 1 15.0 31 1 21.4 Scatter plots We often want to see co-variation among our columns, for example, miles/gallon versus weight. This can be done with a scatter plot. In [98]: plt . scatter ( dfcars . wt , dfcars . mpg ); plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); You could have used plot instead of scatter . In [99]: plt . plot ( dfcars . wt , dfcars . mpg , 'o' ); plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); Usually we use plt.show() at the end of every plot to display the plot. Our magical incantation %matplotlib inline takes care of this for us, and we don't have to do it in the Jupyter notebook. But if you run your Python program from a file, you will need to explicitly have a call to show. We include it for completion. In [100]: plt . plot ( dfcars . wt , dfcars . mpg , 'ko' ) #black dots plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); plt . show () Suppose we'd like to save a figure to a file. We do this by including the savefig command in the same cell as the plotting commands. The file extension tells you how the file will be saved. In [101]: plt . plot ( dfcars . wt , dfcars . mpg , 'o' ) plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); plt . savefig ( 'images/foo1.pdf' ) plt . savefig ( 'images/foo1.png' , bbox_inches = 'tight' ) #less whitespace around image And this is what the saved png looks like. Code in Markdown to show this is: ![](images/foo1.png) Below is a summary of the most commonly used matplotlib plotting routines. Exercise Create a scatter plot showing the co-variation between two columns of your choice. Label the axes. See if you can do this without copying and pasting code from earlier in the lab. What can you conclude, if anything, from your scatter plot? In [102]: # your code here # The columns to plot col1 = 'drat' col2 = 'wt' # Plot plt . plot ( dfcars [ col1 ], dfcars [ col2 ], 'o' ) plt . xlabel ( 'Rear axle ratio (drat)' ) plt . ylabel ( 'Weight (wt)' ) Out[102]: if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-1/solutions/"},{"title":"Lecture 10: Logistic Regression 1 Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 10: Logistic Regression 1 Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [2]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[2]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [3]: #from PandasToPowerpoint import df_to_powerpoint import numpy as np import pandas as pd from sklearn import datasets from sklearn.neighbors import NearestNeighbors from sklearn import neighbors from sklearn import linear_model import matplotlib.pylab as plt % pylab inline Populating the interactive namespace from numpy and matplotlib In [5]: df_heart = pd . read_csv ( '../data/heart.csv' ) In [6]: df_heart . head () Out[6]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Unnamed: 0 Age Sex ChestPain RestBP Chol Fbs RestECG MaxHR ExAng Oldpeak Slope Ca Thal AHD 0 1 63 1 typical 145 233 1 2 150 0 2.3 3 0.0 fixed No 1 2 67 1 asymptomatic 160 286 0 2 108 1 1.5 2 3.0 normal Yes 2 3 67 1 asymptomatic 120 229 0 2 129 1 2.6 2 2.0 reversable Yes 3 4 37 1 nonanginal 130 250 0 0 187 0 3.5 3 0.0 normal No 4 5 41 0 nontypical 130 204 0 2 172 0 1.4 1 0.0 normal No In [7]: df_heart . AHD . values Out[7]: array(['No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'No', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'No', 'No', 'No', 'No', 'No', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'No', 'No', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'No', 'No', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'No', 'No', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'No', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'No', 'No', 'No', 'No', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'No', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'No', 'No', 'No', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No'], dtype=object) In [8]: plt . plot ( df_heart . MaxHR , df_heart . AHD , 'o' , alpha = 0.1 ) #uh-ih, that's not good :( Out[8]: [ ] In [18]: from sklearn import linear_model fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) host = fig . add_subplot ( 111 ) par1 = host . twinx () host . set_xlabel ( \"MaxHR\" ) host . set_ylabel ( \"Probability\" ) par1 . set_ylabel ( \"AHD\" ) color1 = plt . cm . viridis ( 0 ) data_x = df_heart . MaxHR data_y = df_heart . AHD . map ( lambda x : 0 if x == 'No' else 1 ) regr = linear_model . LinearRegression ( fit_intercept = True ) regr . fit ( data_x . values . reshape ( - 1 , 1 ), data_y . values . reshape ( - 1 , 1 )) # Make predictions using the testing set x = np . linspace ( np . min ( data_x ), np . max ( data_x )) y_ = regr . predict ( x . reshape ( - 1 , 1 )) host . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ) host . plot ( x , y_ , label = 'LinReg' ) host . legend ( loc = 3 ) labels = [ 'No' , 'Yes' ] # You can specify a rotation for the tick labels in degrees or with keywords. par1 . set_yticks ( [ 0.061 , 0.83 ]) par1 . set_yticklabels ( labels ) #plt.savefig('fig/FittingLR.png', dpi=300, transparent=True) Out[18]: [Text(1, 0, 'No'), Text(1, 0, 'Yes')] Plot for linear regression -> Log Regression In [20]: fig , ax1 = plt . subplots () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) x = np . linspace ( - 100 , 100 , 100 ) y = x yl = 1 / ( 1 + np . exp ( - y )) ax1 . plot ( x , y , label = 'Y=X' ) ax1 . set_xlabel ( 'X' ) ax1 . set_ylabel ( 'Y' ) ax1 . legend (); #plt.savefig('fig/LinR.png', dpi=300, transparent=True) In [21]: fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) plt . plot ( x , yl , label = 'Y=f(x)' ) plt . xlabel ( 'X' ) plt . ylabel ( 'Y' ) plt . legend () plt . grid () #plt.savefig('fig/LogR.png', dpi=300, transparent=True) In [22]: from matplotlib.animation import FuncAnimation fig , ax = plt . subplots () fig . patch . set_alpha ( 1.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) line , = ax . plot ( x , yl , label = r '$Y=\\frac {1} {1+e&#94;{-(X+\\beta_0) }}$' ) plt . xlabel ( 'X' ) plt . ylabel ( 'Y' ) #plt.legend(loc=5) def update ( i ): b0 = 2 * i label = r '$\\beta_0=$ {0} ' . format ( b0 ) print ( label ) # Update the line and the axes (with a new xlabel). Return a tuple of # \"artists\" that have to be redrawn for this frame. line . set_ydata ( 1 / ( 1 + np . exp ( - x + b0 ))) ax . set_title ( label ) return line , ax # FuncAnimation will call the 'update' function for each frame; here # animating over 10 frames, with an interval of 200ms between frames. anim = FuncAnimation ( fig , update , frames = np . arange ( - 20 , 20 , 2 ), interval = 300 , blit = False ) #anim.save('fig/LogBeta0.gif', dpi=120, writer='imagemagick', savefig_kwargs={'transparent': True, 'facecolor': '#F9F9F9'}) #plt.savefig('fig/LogRBeta.png', dpi=300, transparent=True) $\\beta_0=$ -40 In [24]: from matplotlib.animation import FuncAnimation fig , ax = plt . subplots () fig . patch . set_alpha ( 1.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) line , = ax . plot ( x , yl , label = r '$Y=\\frac {1} {1+e&#94;{-(X+\\beta_0) }}$' ) plt . xlabel ( 'X' ) plt . ylabel ( 'Y' ) #plt.legend(loc=5) def update ( i ): b1 = 2 * i label = r '$\\beta_1=$ {0} ' . format ( np . round ( b1 , decimals = 2 )) print ( label ) # Update the line and the axes (with a new xlabel). Return a tuple of # \"artists\" that have to be redrawn for this frame. line . set_ydata ( 1 / ( 1 + np . exp ( - b1 * x ))) ax . set_title ( label ) return line , ax # FuncAnimation will call the 'update' function for each frame; here # animating over 10 frames, with an interval of 200ms between frames. anim = FuncAnimation ( fig , update , frames = np . arange ( . 2 , -. 2 , -. 03 ), interval = 200 , blit = False ) #anim.save('fig/LogBeta1.gif', dpi=120, writer='imagemagick', savefig_kwargs={'transparent': True, 'facecolor': '#F9F9F9'}) #plt.savefig('fig/LogRBeta.png', dpi=300, transparent=True) $\\beta_1=$ 0.4 Likelihood function In [41]: fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) x = np . linspace ( - 10 , 10 , 100 ) y = x yl = 1 / ( 1 + np . exp ( - 0.5 * y )) plt . plot ( x , yl , label = r '$P(Y=1)=\\frac {1} {1+e&#94;{-X\\beta}}$' ) plt . plot ( x , yl ) plt . xlabel ( 'X' ) plt . ylabel ( 'P(Y=1)' ) plt . legend () plt . ylim (( - 0.2 , 1.1 )) plt . savefig ( '../fig/Likelihood1.png' , dpi = 300 , transparent = True ) ### FRAME 2 plt . axvline ( x = 3 , color = '#A2A2A2' , ls = '-.' ) #plt.savefig('fig/Likelihood2.png', dpi=300, transparent=True) ### FRAME 3 plt . annotate ( r ' $P(y=1|x=3)$' , xy = ( 3 , . 83 ), \\ xytext = ( - 8 , . 81 ), arrowprops = dict ( facecolor = 'black' , shrink = 0.05 ), ) plt . savefig ( '../fig/Likelihood3.png' , dpi = 300 , transparent = True ) ### FRAME 4 plt . annotate ( r ' $p=P(y=1|x=3)$' , xy = ( 3 , . 83 ), \\ xytext = ( - 10 , . 81 ), arrowprops = dict ( facecolor = 'black' , shrink = 0.05 ), ) plt . savefig ( '../fig/Likelihood4.png' , dpi = 300 , transparent = True ) ### FRAME 5 plt . clf () plt . ylim (( - 0.2 , 1.1 )) plt . plot ( x , yl ) plt . xlabel ( 'X' ) plt . ylabel ( 'P(Y=1)' ) plt . axvline ( x = 3 , color = '#A2A2A2' , ls = '-.' ) coinf = np . random . binomial ( 1 , 0.7 , size = 1 ) plt . plot ( [ 3 ], [ 0 ], 'ko' ) plt . plot ( [ 3 ], [ 1 ], 'ko' ) plt . annotate ( r ' $p$' , xy = ( 2.7 , 1 ), \\ xytext = ( - 3 , 0.98 ), arrowprops = dict ( facecolor = 'white' , shrink = 0.0 ), ) plt . annotate ( r ' $1-p$' , xy = ( 2.8 , . 00 ), \\ xytext = ( - 4 , -. 02 ), arrowprops = dict ( facecolor = 'white' , shrink = 0.05 ), ) plt . savefig ( '../fig/Likelihood5.png' , dpi = 300 , transparent = True ) plt . clf () Plots for simple model In [27]: from sklearn import linear_model fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) plt . ylim (( - 0.1 , 1.1 )) plt . xlabel ( \"MaxHR\" ) plt . ylabel ( \"Heart disease (AHD)\" ) data_x = df_heart . MaxHR data_y = df_heart . AHD . map ( lambda x : 0 if x == 'No' else 1 ) plt . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ); #plt.legend(loc=3) #plt.savefig('fig/FittingLogR1.png', dpi=300, transparent=True) In [29]: from sklearn.linear_model import LogisticRegression logreg = LogisticRegression ( C = 100000 , fit_intercept = True , solver = 'newton-cg' ) logreg . fit ( data_x . values . reshape ( - 1 , 1 ), data_y ); print ( 'Estimated beta1: \\n ' , logreg . coef_ ) print ( 'Estimated beta0: \\n ' , logreg . intercept_ ) Estimated beta1: [[-0.04341112]] Estimated beta0: [6.32494975] In [31]: fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) x = np . linspace ( np . min ( data_x ), np . max ( data_x )) y_ = logreg . predict ( x . reshape ( - 1 , 1 )) plt . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ) plt . plot ( x , y_ , label = 'Model' ) plt . legend () plt . xlabel ( \"MaxHR\" ) plt . ylabel ( \"Heart disease (AHD)\" ); #plt.savefig('fig/FittingLogR2.png', dpi=300, transparent=True) Categorical predictors In [ ]: fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) plt . ylim (( - 0.1 , 1.1 )) plt . xlabel ( \"xxx\" ) plt . ylabel ( \"Heart disease (AHD)\" ) data_x = df_heart . Sex . values data_y = df_heart . AHD . map ( lambda x : 0 if x == 'No' else 1 ) . values idx = np . where ( data_x == 0 ) print ( idx [ 0 ] . shape ) print ( \"percentage of females with HD\" , data_y [ idx ] . sum () / idx [ 0 ] . shape ) idx = np . where ( data_x == 1 ) print ( idx [ 0 ] . shape ) print ( \"percentage of males with HD\" , data_y [ idx ] . sum () / idx [ 0 ] . shape ) In [ ]: logreg = LogisticRegression ( C = 100000 , fit_intercept = True ) logreg . fit ( data_x . reshape ( - 1 , 1 ), data_y ); print ( 'Estimated beta1: \\n ' , logreg . coef_ ) print ( 'Estimated beta0: \\n ' , logreg . intercept_ ) Probit In [43]: from scipy.stats import logistic from scipy.stats import norm fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) x = np . linspace ( logistic . ppf ( 0.01 ), logistic . ppf ( 0.99 ), 100 ) plt . plot ( x , logistic . pdf ( x , loc = 0 , scale = 1 ), 'r-' , lw = 5 , alpha = 0.6 , label = 'logistic pdf' ) plt . plot ( x , norm . pdf ( x , loc = 0 , scale = 1 ), 'b-' , lw = 5 , alpha = 0.6 , label = 'normal pdf' ) plt . xlabel ( 'X' ) plt . ylabel ( 'Probability' ) plt . legend () plt . savefig ( '../fig/NormVsLog.png' , dpi = 300 , transparent = True ) Multi-regression In [46]: data_x = df_heart [[ 'MaxHR' , 'Sex' ]] data_y = df_heart [ 'AHD' ] logreg = LogisticRegression ( C = 100000 , fit_intercept = True , solver = 'newton-cg' ) logreg . fit ( data_x , data_y ); print ( 'Estimated beta1, beta2: \\n ' , logreg . coef_ ) print ( 'Estimated beta0: \\n ' , logreg . intercept_ ) Estimated beta1, beta2: [[-0.04508903 1.40620882]] Estimated beta0: [5.6018574] In [48]: df_heart [ 'Interaction' ] = df_heart . MaxHR * df_heart . Sex data_x = df_heart [[ 'MaxHR' , 'Sex' , 'Interaction' ]] data_y = df_heart [ 'AHD' ] logreg = LogisticRegression ( C = 100000 , fit_intercept = True , solver = 'newton-cg' ) logreg . fit ( data_x , data_y ); print ( 'Estimated beta1, beta2, beta3: \\n ' , logreg . coef_ ) print ( 'Estimated beta0: \\n ' , logreg . intercept_ ) Estimated beta1, beta2, beta3: [[-0.02660848 5.41771042 -0.02708728]] Estimated beta0: [2.904446] In [58]: #Regularization Example beta1_l1 = [] beta1_l2 = [] Cs = [] for i in range ( 1 , 500 ): C = i / 10 logitm_l1 = LogisticRegression ( C = C , penalty = \"l1\" ) logitm_l1 . fit ( data_x , data_y ) logitm_l2 = LogisticRegression ( C = C , penalty = \"l2\" , solver = 'newton-cg' ) logitm_l2 . fit ( data_x , data_y ) beta1_l1 . append ( logitm_l1 . coef_ [ 0 ]) beta1_l2 . append ( logitm_l2 . coef_ [ 0 ]) Cs . append ( C ) plt . plot ( Cs , beta1_l1 , color = 'black' , lw = 3 ) plt . plot ( Cs , beta1_l2 , color = 'blue' , lw = 3 ) plt . xlabel ( \"C\" ) plt . ylabel ( \"beta1\" ) plt . show () /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) /anaconda3/lib/python3.7/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations. \"the number of iterations.\", ConvergenceWarning) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) In [59]: # Response for Multinomial Logistic Regression Example print ( df_heart . RestECG . values ) hist ( df_heart . RestECG . values ) [2 2 2 0 2 0 2 0 2 2 0 2 2 0 0 0 0 0 0 0 2 2 2 2 2 0 0 0 0 2 0 0 0 0 0 0 2 2 0 0 2 0 0 0 2 2 0 2 2 2 0 0 2 2 0 2 0 2 2 2 0 2 2 0 0 2 2 2 2 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2 2 0 0 2 0 2 2 0 2 2 2 2 2 0 0 0 2 0 0 2 2 2 2 0 0 2 0 2 2 2 2 0 0 2 2 2 0 0 0 2 0 2 2 0 2 0 2 0 2 0 2 0 0 2 0 2 0 2 0 0 2 2 2 2 2 0 2 2 0 0 2 0 2 0 0 0 2 2 0 0 2 0 2 2 0 0 2 0 2 2 2 2 2 2 0 0 0 2 2 0 0 2 0 2 2 2 2 0 2 2 0 0 0 0 2 2 2 0 0 0 0 2 0 0 2 0 2 0 2 2 2 0 0 0 0 0 0 2 2 2 1 2 2 0 2 2 2 0 0 0 0 0 0 0 0 0 2 0 2 0 0 0 2 0 0 0 1 2 0 0 2 0 0 2 0 0 0 0 0 2 2 0 0 0 2 2 0 2 0 0 0 1 0 0 1 2 0 2 0 2 0 0 2 0 0 2 0 0 0 0 2 0] Out[59]: (array([151., 0., 0., 0., 0., 4., 0., 0., 0., 148.]), array([0. , 0.2, 0.4, 0.6, 0.8, 1. , 1.2, 1.4, 1.6, 1.8, 2. ]), ) In [61]: # Multinomial Logistic Regression Example data_y = df_heart [ 'RestECG' ] logitm = LogisticRegression ( C = 10000000 , solver = 'newton-cg' ) logitm . fit ( data_x , data_y ) # The coefficients print ( 'Estimated beta1: \\n ' , logitm . coef_ ) print ( 'Estimated beta0: \\n ' , logitm . intercept_ ) /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:460: FutureWarning: Default multi_class will be changed to 'auto' in 0.22. Specify the multi_class option to silence this warning. \"this warning.\", FutureWarning) Estimated beta1: [[ 1.07595643e-02 4.25714523e-01 -2.95712951e-03] [-6.82063916e-02 -9.13761371e+00 5.38462940e-02] [-1.17653846e-03 1.08250475e+00 -6.31864120e-03]] Estimated beta0: [-1.60689128 5.89016854 0.03332403] In [63]: logitm = LogisticRegression ( C = 10000000 , so ) logitm . fit ( df_heart [ 'Sex' ] . values . reshape ( - 1 , 1 ), df_heart [ 'AHD' ]) # The coefficients print ( 'Estimated beta1: \\n ' , logitm . coef_ ) print ( 'Estimated beta0: \\n ' , logitm . intercept_ ) Estimated beta1: [[1.27219937]] Estimated beta0: [-1.0577895] /anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning. FutureWarning) In [65]: logitm . predict ( df_heart [ 'Sex' ] . values . reshape ( - 1 , 1 )) Out[65]: array(['Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'No', 'Yes', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes'], dtype=object) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-10/demo/"},{"title":"Lecture 11: Logistic Regression 2 Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 11: Logistic Regression 2 Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [2]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[2]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [3]: import sys import numpy as np import pandas as pd import statsmodels.api as sm import sklearn.linear_model as sk import matplotlib.pyplot as plt % matplotlib inline In [4]: df_heart = pd . read_csv ( '../data/heart.csv' ) df_heart . head () Out[4]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Unnamed: 0 Age Sex ChestPain RestBP Chol Fbs RestECG MaxHR ExAng Oldpeak Slope Ca Thal AHD 0 1 63 1 typical 145 233 1 2 150 0 2.3 3 0.0 fixed No 1 2 67 1 asymptomatic 160 286 0 2 108 1 1.5 2 3.0 normal Yes 2 3 67 1 asymptomatic 120 229 0 2 129 1 2.6 2 2.0 reversable Yes 3 4 37 1 nonanginal 130 250 0 0 187 0 3.5 3 0.0 normal No 4 5 41 0 nontypical 130 204 0 2 172 0 1.4 1 0.0 normal No In [5]: plt . plot ( df_heart . MaxHR , df_heart . AHD , 'o' , alpha = 0.1 ) Out[5]: [ ] In [4]: from sklearn import linear_model fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) host = fig . add_subplot ( 111 ) par1 = host . twinx () host . set_xlabel ( \"MaxHR\" ) host . set_ylabel ( \"Probability\" ) par1 . set_ylabel ( \"AHD\" ) color1 = plt . cm . viridis ( 0 ) data_x = df_heart . MaxHR data_y = df_heart . AHD . map ( lambda x : 0 if x == 'No' else 1 ) regr = linear_model . LinearRegression ( fit_intercept = True ) regr . fit ( data_x . reshape ( - 1 , 1 ), data_y . reshape ( - 1 , 1 )) # Make predictions using the testing set x = np . linspace ( np . min ( data_x ), np . max ( data_x )) y_ = regr . predict ( x . reshape ( - 1 , 1 )) host . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ) host . plot ( x , y_ , label = 'LinReg' ) host . legend ( loc = 3 ) labels = [ 'No' , 'Yes' ] # You can specify a rotation for the tick labels in degrees or with keywords. par1 . set_yticks ( [ 0.061 , 0.83 ]) par1 . set_yticklabels ( labels ) /Users/krader/anaconda/lib/python3.6/site-packages/ipykernel_launcher.py:27: FutureWarning: reshape is deprecated and will raise in a subsequent release. Please use .values.reshape(...) instead Out[4]: [ , ] In [5]: from sklearn.linear_model import LogisticRegression logreg = LogisticRegression ( C = 100000 , fit_intercept = True ) logreg . fit ( data_x . values . reshape ( - 1 , 1 ), data_y ); print ( 'Estimated beta1: \\n ' , logreg . coef_ ) print ( 'Estimated beta0: \\n ' , logreg . intercept_ ) Estimated beta1: [[-0.04326016]] Estimated beta0: [ 6.30193148] In [12]: fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) x = np . linspace ( np . min ( data_x ), np . max ( data_x )) y_ = logreg . predict_proba ( x . reshape ( - 1 , 1 ))[:, 0 ] plt . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ) plt . plot ( x , y_ , label = 'Model' ) plt . legend () plt . xlabel ( \"MaxHR\" ) plt . ylabel ( \"Heart disease (AHD)\" ) plt . savefig ( 'FittingLogR2.png' , dpi = 300 , transparent = True ) Multiple Logistic Regression Just like in linear regression, the logistic regression model can be extended to incorporate multiple predictors/features. The logistic model (written in the log-odds format) can then be written as: $$ \\ln\\left(\\frac{P(Y=1)}{1-P(Y=1)}\\right) = \\beta_0+\\beta_1 X_1+\\dots+\\beta_p X_p .$$ Maximum likelihood methods can still be used to generate estimates for the $p+1$ parameters: $\\beta_0,\\beta_1,\\dots,\\beta_p $. In [13]: data_x = df_heart [[ 'MaxHR' , 'Sex' ]] data_y = df_heart [ 'AHD' ] logreg = LogisticRegression ( C = 100000 , fit_intercept = True ) logreg . fit ( data_x , data_y ); print ( 'Estimated beta1, beta2: \\n ' , logreg . coef_ ) print ( 'Estimated beta0: \\n ' , logreg . intercept_ ) Estimated beta1, beta2: [[-0.04496354 1.40079047]] Estimated beta0: [ 5.58662464] Regularization in Logistic Regression In [104]: beta1_l1 = [] beta1_l2 = [] Cs = [] data_x = df_heart [[ 'MaxHR' ]] data_y = df_heart [ 'AHD' ] for i in range ( 1 , 500 ): C = i / 100 logitm_l1 = sk . LogisticRegression ( C = C , penalty = \"l1\" ) logitm_l1 . fit ( data_x , data_y ) logitm_l2 = sk . LogisticRegression ( C = C , penalty = \"l2\" ) logitm_l2 . fit ( data_x , data_y ) beta1_l1 . append ( logitm_l1 . coef_ [ 0 ]) beta1_l2 . append ( logitm_l2 . coef_ [ 0 ]) Cs . append ( C ) plt . plot ( np . array ( Cs ), beta1_l1 , color = 'black' , lw = 3 ) plt . plot ( np . array ( Cs ), beta1_l2 , color = 'blue' , lw = 3 ) plt . xlabel ( \"lambda = C\" ) plt . ylabel ( \"beta1\" ) plt . show () In [93]: print ( 1.0 / np . array ( Cs )) [ 100. 50. 33.33333333 25. 20. 16.66666667 14.28571429 12.5 11.11111111 10. 9.09090909 8.33333333 7.69230769 7.14285714 6.66666667 6.25 5.88235294 5.55555556 5.26315789 5. 4.76190476 4.54545455 4.34782609 4.16666667 4. 3.84615385 3.7037037 3.57142857 3.44827586 3.33333333 3.22580645 3.125 3.03030303 2.94117647 2.85714286 2.77777778 2.7027027 2.63157895 2.56410256 2.5 2.43902439 2.38095238 2.3255814 2.27272727 2.22222222 2.17391304 2.12765957 2.08333333 2.04081633 2. 1.96078431 1.92307692 1.88679245 1.85185185 1.81818182 1.78571429 1.75438596 1.72413793 1.69491525 1.66666667 1.63934426 1.61290323 1.58730159 1.5625 1.53846154 1.51515152 1.49253731 1.47058824 1.44927536 1.42857143 1.4084507 1.38888889 1.36986301 1.35135135 1.33333333 1.31578947 1.2987013 1.28205128 1.26582278 1.25 1.2345679 1.2195122 1.20481928 1.19047619 1.17647059 1.1627907 1.14942529 1.13636364 1.12359551 1.11111111 1.0989011 1.08695652 1.07526882 1.06382979 1.05263158 1.04166667 1.03092784 1.02040816 1.01010101 1. 0.99009901 0.98039216 0.97087379 0.96153846 0.95238095 0.94339623 0.93457944 0.92592593 0.91743119 0.90909091 0.9009009 0.89285714 0.88495575 0.87719298 0.86956522 0.86206897 0.85470085 0.84745763 0.84033613 0.83333333 0.82644628 0.81967213 0.81300813 0.80645161 0.8 0.79365079 0.78740157 0.78125 0.7751938 0.76923077 0.76335878 0.75757576 0.7518797 0.74626866 0.74074074 0.73529412 0.72992701 0.72463768 0.71942446 0.71428571 0.70921986 0.70422535 0.6993007 0.69444444 0.68965517 0.68493151 0.68027211 0.67567568 0.67114094 0.66666667 0.66225166 0.65789474 0.65359477 0.64935065 0.64516129 0.64102564 0.63694268 0.63291139 0.62893082 0.625 0.62111801 0.61728395 0.61349693 0.6097561 0.60606061 0.60240964 0.5988024 0.5952381 0.59171598 0.58823529 0.58479532 0.58139535 0.57803468 0.57471264 0.57142857 0.56818182 0.56497175 0.56179775 0.55865922 0.55555556 0.55248619 0.54945055 0.54644809 0.54347826 0.54054054 0.53763441 0.53475936 0.53191489 0.52910053 0.52631579 0.52356021 0.52083333 0.51813472 0.51546392 0.51282051 0.51020408 0.50761421 0.50505051 0.50251256 0.5 0.49751244 0.4950495 0.49261084 0.49019608 0.48780488 0.48543689 0.48309179 0.48076923 0.4784689 0.47619048 0.47393365 0.47169811 0.46948357 0.46728972 0.46511628 0.46296296 0.46082949 0.4587156 0.456621 0.45454545 0.45248869 0.45045045 0.44843049 0.44642857 0.44444444 0.44247788 0.44052863 0.43859649 0.43668122 0.43478261 0.43290043 0.43103448 0.42918455 0.42735043 0.42553191 0.42372881 0.42194093 0.42016807 0.41841004 0.41666667 0.41493776 0.41322314 0.41152263 0.40983607 0.40816327 0.40650407 0.4048583 0.40322581 0.40160643 0.4 0.39840637 0.3968254 0.39525692 0.39370079 0.39215686 0.390625 0.38910506 0.3875969 0.38610039 0.38461538 0.38314176 0.38167939 0.38022814 0.37878788 0.37735849 0.37593985 0.37453184 0.37313433 0.37174721 0.37037037 0.36900369 0.36764706 0.36630037 0.3649635 0.36363636 0.36231884 0.36101083 0.35971223 0.35842294 0.35714286 0.35587189 0.35460993 0.35335689 0.35211268 0.35087719 0.34965035 0.34843206 0.34722222 0.34602076 0.34482759 0.34364261 0.34246575 0.34129693 0.34013605 0.33898305 0.33783784 0.33670034 0.33557047 0.33444816 0.33333333 0.33222591 0.33112583 0.330033 0.32894737 0.32786885 0.32679739 0.3257329 0.32467532 0.3236246 0.32258065 0.32154341 0.32051282 0.31948882 0.31847134 0.31746032 0.3164557 0.31545741 0.31446541 0.31347962 0.3125 0.31152648 0.31055901 0.30959752 0.30864198 0.30769231 0.30674847 0.3058104 0.30487805 0.30395137 0.3030303 0.3021148 0.30120482 0.3003003 0.2994012 0.29850746 0.29761905 0.29673591 0.29585799 0.29498525 0.29411765 0.29325513 0.29239766 0.29154519 0.29069767 0.28985507 0.28901734 0.28818444 0.28735632 0.28653295 0.28571429 0.28490028 0.28409091 0.28328612 0.28248588 0.28169014 0.28089888 0.28011204 0.27932961 0.27855153 0.27777778 0.27700831 0.27624309 0.27548209 0.27472527 0.2739726 0.27322404 0.27247956 0.27173913 0.27100271 0.27027027 0.26954178 0.2688172 0.26809651 0.26737968 0.26666667 0.26595745 0.26525199 0.26455026 0.26385224 0.26315789 0.26246719 0.2617801 0.26109661 0.26041667 0.25974026 0.25906736 0.25839793 0.25773196 0.25706941 0.25641026 0.25575448 0.25510204 0.25445293 0.25380711 0.25316456 0.25252525 0.25188917 0.25125628 0.25062657 0.25 0.24937656 0.24875622 0.24813896 0.24752475 0.24691358 0.24630542 0.24570025 0.24509804 0.24449878 0.24390244 0.243309 0.24271845 0.24213075 0.24154589 0.24096386 0.24038462 0.23980815 0.23923445 0.23866348 0.23809524 0.23752969 0.23696682 0.23640662 0.23584906 0.23529412 0.23474178 0.23419204 0.23364486 0.23310023 0.23255814 0.23201856 0.23148148 0.23094688 0.23041475 0.22988506 0.2293578 0.22883295 0.2283105 0.22779043 0.22727273 0.22675737 0.22624434 0.22573363 0.22522523 0.2247191 0.22421525 0.22371365 0.22321429 0.22271715 0.22222222 0.22172949 0.22123894 0.22075055 0.22026432 0.21978022 0.21929825 0.21881838 0.21834061 0.21786492 0.2173913 0.21691974 0.21645022 0.21598272 0.21551724 0.21505376 0.21459227 0.21413276 0.21367521 0.21321962 0.21276596 0.21231423 0.21186441 0.21141649 0.21097046 0.21052632 0.21008403 0.20964361 0.20920502 0.20876827 0.20833333 0.20790021 0.20746888 0.20703934 0.20661157 0.20618557 0.20576132 0.20533881 0.20491803 0.20449898 0.20408163 0.20366599 0.20325203 0.20283976 0.20242915 0.2020202 0.2016129 0.20120724 0.20080321 0.2004008 ] Logistic Regression for $Y$ with more than 2 Categories There are several extensions to standard logistic regression when the response variable $Y$ has more than 2 categories. The two most common are ordinal logistic regression and multinomial logistic regression. Ordinal logistic regression is used when the categories have a specific hierarchy (like class year: Freshman, Sophomore, Junior, Senior; or a 7-point rating scale from strongly disagree to strongly agree). Multinomial logistic regression is used when the categories have no inherent order (like eye color: blue, green, brown, hazel, et...). In [21]: #read the NFL play-by-play data nfldata = pd . read_csv ( \"NFLplaybyplay-2015.csv\" ) # shuffle the data nfldata = nfldata . reindex ( np . random . permutation ( nfldata . index )) # For simplicity, we will select only 500 points form the dataset. N = 500 X = nfldata [[ \"YardLine\" ]] nfldata [ \"PlayType\" ] = nfldata [ \"IsPass\" ] + 2 * nfldata [ \"IsRush\" ] logitm = sk . LogisticRegression ( C = 10000000 ) logitm . fit ( X , nfldata [ \"PlayType\" ]) # The coefficients print ( 'Estimated beta1: \\n ' , logitm . coef_ ) print ( 'Estimated beta0: \\n ' , logitm . intercept_ ) Estimated beta1: [[-0.01460736] [ 0.00635893] [ 0.00652455]] Estimated beta0: [-0.26422696 -0.61186328 -1.20051275] In [33]: X = np . arange ( 100 ) print ( logitm . predict_proba ( X . reshape ( - 1 , 1 ))[ 0 : 10 ,:]) print ( logitm . predict ( X . reshape ( - 1 , 1 ))) [[ 0.42692074 0.34563977 0.22743948] [ 0.42380137 0.34739801 0.22880062] [ 0.42067735 0.34915746 0.23016519] [ 0.41754902 0.35091792 0.23153306] [ 0.41441671 0.35267918 0.23290411] [ 0.41128078 0.35444103 0.23427819] [ 0.40814155 0.35620326 0.23565519] [ 0.40499938 0.35796565 0.23703497] [ 0.40185462 0.35972799 0.23841739] [ 0.39870763 0.36149006 0.23980231]] [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1] In [43]: #read in party ID data party_df = pd . read_csv ( \"gsspartyid.csv\" ) party_df . head () Out[43]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } politicalparty income educ abortion republican 0 Republican 2152 9 0 1 1 Republican 906 6 0 1 2 Democrat 1373 6 0 0 3 Democrat 1941 4 0 0 4 Democrat 355 7 0 0 In [46]: #quick summaries of party ID data print ( party_df [ 'politicalparty' ] . value_counts ()) party_df . describe () Democrat 775 Republican 532 Name: politicalparty, dtype: int64 Out[46]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } income educ abortion republican count 1307.000000 1307.000000 1307.000000 1307.000000 mean 1088.351186 7.970926 0.456006 0.407039 std 714.286949 3.767038 0.498251 0.491470 min 1.000000 1.000000 0.000000 0.000000 25% 451.500000 5.000000 0.000000 0.000000 50% 1083.000000 7.000000 0.000000 0.000000 75% 1725.000000 9.000000 1.000000 1.000000 max 2315.000000 21.000000 1.000000 1.000000 In [49]: #estimating logistic regression for party ID classification party_df [ 'logincome' ] = np . log ( party_df [ 'income' ] . values ()) train_x = party_df [[ 'income' , 'educ' , 'abortion' ]] train_y = party_df [[ 'republican' ]] logitm = sk . LogisticRegression ( C = 10000000 ) logitm . fit ( train_x , party_df [ 'republican' ]) # The coefficients print ( 'Estimated beta1: \\n ' , logitm . coef_ ) print ( 'Estimated beta0: \\n ' , logitm . intercept_ ) Estimated beta1: [[ -5.35180582e-05 -1.22975923e-02 -9.96214452e-01]] Estimated beta0: [ 0.20927611] In [61]: #calculating confusion matrices import sklearn.metrics as met yhat = logitm . predict_proba ( train_x )[:, 0 ] print ( met . confusion_matrix ( party_df [ 'republican' ], yhat > 0.5 )) print ( met . confusion_matrix ( party_df [ 'republican' ], yhat > 0.48 )) print ( met . confusion_matrix ( party_df [ 'republican' ], yhat > 0.72 )) [[288 487] [311 221]] [[143 632] [138 394]] [[539 236] [455 77]] In [82]: #ROC curve on the train set fpr , tpr , thresholds = met . roc_curve ( party_df [ 'republican' ], yhat ) x = np . arange ( 0 , 100 ) / 100 plt . plot ( x , x , '--' , color = \"gray\" , alpha = 0.3 ) plt . plot ( tpr , fpr ) plt . ylabel ( \"True Positive Rate\" ) plt . xlabel ( \"False Positive Rate\" ) plt . title ( \"ROC Curve for the Party ID Logistic Regression Model\" ) Out[82]: if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-11/demo/"},{"title":"Lecture 13: Classification with KNN Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 13: Classification with KNN Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [3]: % matplotlib inline import sys import numpy as np import pylab as pl import pandas as pd import statsmodels.api as sm import matplotlib.pyplot as plt import matplotlib import sklearn.linear_model as lm import sklearn as sk import sklearn.neighbors In [3]: df_heart = pd . read_csv ( 'Heart.csv' ) df_heart . head () Out[3]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } Unnamed: 0 Age Sex ChestPain RestBP Chol Fbs RestECG MaxHR ExAng Oldpeak Slope Ca Thal AHD 0 1 63 1 typical 145 233 1 2 150 0 2.3 3 0.0 fixed No 1 2 67 1 asymptomatic 160 286 0 2 108 1 1.5 2 3.0 normal Yes 2 3 67 1 asymptomatic 120 229 0 2 129 1 2.6 2 2.0 reversable Yes 3 4 37 1 nonanginal 130 250 0 0 187 0 3.5 3 0.0 normal No 4 5 41 0 nontypical 130 204 0 2 172 0 1.4 1 0.0 normal No In [4]: from sklearn import linear_model fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) host = fig . add_subplot ( 111 ) par1 = host . twinx () host . set_xlabel ( \"MaxHR\" ) host . set_ylabel ( \"Probability\" ) par1 . set_ylabel ( \"AHD\" ) color1 = plt . cm . viridis ( 0 ) data_x = df_heart . MaxHR data_y = df_heart . AHD . map ( lambda x : 0 if x == 'No' else 1 ) regr = linear_model . LinearRegression ( fit_intercept = True ) regr . fit ( data_x . reshape ( - 1 , 1 ), data_y . reshape ( - 1 , 1 )) # Make predictions using the testing set x = np . linspace ( np . min ( data_x ), np . max ( data_x )) y_ = regr . predict ( x . reshape ( - 1 , 1 )) host . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ) host . plot ( x , y_ , label = 'LinReg' ) host . legend ( loc = 3 ) labels = [ 'No' , 'Yes' ] # You can specify a rotation for the tick labels in degrees or with keywords. par1 . set_yticks ( [ 0.061 , 0.83 ]) par1 . set_yticklabels ( labels ) /Users/krader/anaconda/lib/python3.6/site-packages/ipykernel_launcher.py:27: FutureWarning: reshape is deprecated and will raise in a subsequent release. Please use .values.reshape(...) instead Out[4]: [ , ] In [11]: from sklearn.linear_model import LogisticRegression logreg = LogisticRegression ( C = 100000 , fit_intercept = True ) logreg . fit ( data_x . values . reshape ( - 1 , 1 ), data_y ) print ( 'Estimated beta1: \\n ' , logreg . coef_ ) print ( 'Estimated beta0: \\n ' , logreg . intercept_ ) Estimated beta1: [[-0.04326016]] Estimated beta0: [ 6.30193148] In [6]: fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) x = np . linspace ( np . min ( data_x ), np . max ( data_x )) y_ = logreg . predict_proba ( x . reshape ( - 1 , 1 ))[:, 0 ] plt . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ) plt . plot ( x , y_ , label = 'Model' ) plt . legend () plt . xlabel ( \"MaxHR\" ) plt . ylabel ( \"Heart disease (AHD)\" ) plt . savefig ( 'FittingLogR2.png' , dpi = 300 , transparent = True ) In [19]: from sklearn import neighbors data_x = df_heart . MaxHR data_y = df_heart . AHD . map ( lambda x : 0 if x == 'No' else 1 ) knn1 = neighbors . KNeighborsClassifier ( n_neighbors = 1 ) knn5 = neighbors . KNeighborsClassifier ( n_neighbors = 5 ) knn10 = neighbors . KNeighborsClassifier ( n_neighbors = 10 ) knn50 = neighbors . KNeighborsClassifier ( n_neighbors = 50 ) knn1 . fit ( data_x . values . reshape ( - 1 , 1 ), data_y ); knn5 . fit ( data_x . values . reshape ( - 1 , 1 ), data_y ); knn10 . fit ( data_x . values . reshape ( - 1 , 1 ), data_y ); knn50 . fit ( data_x . values . reshape ( - 1 , 1 ), data_y ); fig = plt . figure () fig . patch . set_alpha ( 0.0 ) plt . xkcd ( scale = 0.1 , length = 0.0 ) plt . gcf () . subplots_adjust ( bottom = 0.20 , left = 0.16 , right = 0.86 ) x = np . linspace ( np . min ( data_x ), np . max ( data_x )) yhat1 = knn1 . predict ( x . reshape ( - 1 , 1 )) yhat5 = knn5 . predict ( x . reshape ( - 1 , 1 )) yhat10 = knn10 . predict ( x . reshape ( - 1 , 1 )) yhat50 = knn50 . predict ( x . reshape ( - 1 , 1 )) plt . plot ( data_x , data_y , 'o' , alpha = 0.1 , label = 'Data' ) plt . plot ( x , yhat1 , label = 'knn1' ) plt . plot ( x , yhat5 , label = 'knn5' ) plt . plot ( x , yhat10 , label = 'knn10' ) plt . plot ( x , yhat50 , label = 'knn50' ) plt . legend () plt . xlabel ( \"MaxHR\" ) plt . ylabel ( \"Heart disease (AHD)\" ) Out[19]: In [25]: #two predictors from sklearn import neighbors knn1 = neighbors . KNeighborsClassifier ( n_neighbors = 1 ) knn5 = neighbors . KNeighborsClassifier ( n_neighbors = 5 ) knn10 = neighbors . KNeighborsClassifier ( n_neighbors = 10 ) knn50 = neighbors . KNeighborsClassifier ( n_neighbors = 50 ) data_x = df_heart [[ 'MaxHR' , 'RestBP' ]] data_y = df_heart . AHD . map ( lambda x : 0 if x == 'No' else 1 ) knn1 . fit ( data_x , data_y ); knn5 . fit ( data_x , data_y ); knn10 . fit ( data_x , data_y ); knn50 . fit ( data_x , data_y ); print ( knn1 . score ( data_x , data_y )) print ( knn5 . score ( data_x , data_y )) print ( knn10 . score ( data_x , data_y )) print ( knn50 . score ( data_x , data_y )) 0.960396039604 0.712871287129 0.716171617162 0.706270627063 In [ ]: #Don't forget to split into train and \"test\" to evaluate what k is best! if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-13/demo/"},{"title":"Lecture 14: Discriminant Analysis Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 14: Discriminant Analysis Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [ ]: import sys import numpy as np import pylab as pl import pandas as pd import statsmodels.api as sm import matplotlib.pyplot as plt import matplotlib import sklearn as sk import sklearn.discriminant_analysis as da import sklearn.neighbors as knn In [ ]: #read in the GSS data gssdata = pd . read_csv ( \"gsspartyid.csv\" ) gssdata . head () In [ ]: LDA = da . LinearDiscriminantAnalysis () X = gssdata [[ \"income\" , \"educ\" , \"abortion\" ]] model_LDA = LDA . fit ( X , gssdata [ 'republican' ]) print ( \"Specificity is\" , np . mean ( model_LDA . predict ( X [ gssdata [ 'republican' ] == 0 ]))) print ( \"Sensitivity is\" , 1 - np . mean ( model_LDA . predict ( X [ gssdata [ 'republican' ] == 1 ]))) print ( \"False positive rate is\" , np . mean ( gssdata [ 'republican' ][ model_LDA . predict ( X ) == 1 ])) print ( \"False negative rate is\" , 1 - np . mean ( gssdata [ 'republican' ][ model_LDA . predict ( X ) == 0 ])) In [ ]: #read in the first simulation data set data1 = pd . read_csv ( \"dataset1.csv\" ) X = data1 [[ 'x1' , 'x2' ]] data1 [ 'x1sq' ] = data1 [ 'x1' ] ** 2 data1 [ 'x2sq' ] = data1 [ 'x2' ] ** 2 X2 = data1 [[ 'x1' , 'x2' , 'x1sq' , 'x2sq' ]] y = data1 [ 'y' ] n = data1 . shape [ 0 ] data1 . head () In [ ]: lda = da . LinearDiscriminantAnalysis () qda = da . QuadraticDiscriminantAnalysis () lda . fit ( X , y ) qda . fit ( X , y ) logit1 = sk . linear_model . LogisticRegression ( C = 1000000 ) logit2 = sk . linear_model . LogisticRegression ( C = 1000000 ) logit1 . fit ( X , y ) logit2 . fit ( X2 , y ) print ( \"Overall misclassification rate of Logit1 is\" ,( 1 - logit1 . score ( X , y ))) print ( \"Overall misclassification rate of Logit2 is\" ,( 1 - logit2 . score ( X2 , y ))) print ( \"Overall misclassification rate of LDA is\" ,( 1 - lda . score ( X , y ))) print ( \"Overall misclassification rate of QDA is\" ,( 1 - qda . score ( X , y ))) In [ ]: knn3 = knn . KNeighborsClassifier ( 3 ) knn25 = knn . KNeighborsClassifier ( 25 ) knn3 . fit ( X , y ) knn25 . fit ( X , y ) #note, the KNNs are not correct :( print ( \"Overall misclassification rate of kNN3 is\" ,( 1 - knn3 . score ( X , y ))) print ( \"Overall misclassification rate of kNN25 is\" ,( 1 - knn25 . score ( X , y ))) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-14/demo/"},{"title":"Lecture 15: Decision Trees Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lecture 15: Decision Trees Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [2]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[2]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [1]: import pandas as pd import sys import numpy as np import scipy as sp import matplotlib.pyplot as plt import sklearn as sk from sklearn import tree import seaborn as sns pd . set_option ( 'display.width' , 1500 ) pd . set_option ( 'display.max_columns' , 100 ) sns . set_context ( 'poster' ) sns . set ( style = \"ticks\" ) % matplotlib inline In [ ]: from sklearn.preprocessing import MinMaxScaler from sklearn.model_selection import KFold from sklearn.linear_model import LinearRegression from sklearn.linear_model import Ridge from sklearn.linear_model import Lasso from sklearn.preprocessing import PolynomialFeatures from sklearn.neighbors import KNeighborsRegressor import statsmodels.api as sm from statsmodels.tools import add_constant from statsmodels.regression.linear_model import RegressionResults from sklearn.decomposition import PCA from sklearn import ensemble In [2]: #-------- fit_and_plot_dt # Fit decision tree with on given data set with given depth, and plot the data/model # Input: # fname (string containing file name) # depth (depth of tree) def fit_and_plot_dt ( x , y , depth , title , ax , plot_data = True , fill = True , color = 'Blues' ): # FIT DECISION TREE MODEL dt = tree . DecisionTreeClassifier ( max_depth = depth ) dt . fit ( x , y ) # PLOT DECISION TREE BOUNDARY ax = plot_tree_boundary ( x , y , dt , title , ax , plot_data , fill , color ) return ax In [3]: #-------- plot_tree_boundary # A function that visualizes the data and the decision boundaries # Input: # x (predictors) # y (labels) # model (the classifier you want to visualize) # title (title for plot) # ax (a set of axes to plot on) # Returns: # ax (axes with data and decision boundaries) def plot_tree_boundary ( x , y , model , title , ax , plot_data = True , fill = True , color = 'Greens' ): if plot_data : # PLOT DATA ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'grey' ) # CREATE MESH interval = np . arange ( min ( x . min (), y . min ()), max ( x . max (), y . max ()), 0.01 ) n = np . size ( interval ) x1 , x2 = np . meshgrid ( interval , interval ) x1 = x1 . reshape ( - 1 , 1 ) x2 = x2 . reshape ( - 1 , 1 ) xx = np . concatenate (( x1 , x2 ), axis = 1 ) # PREDICT ON MESH POINTS yy = model . predict ( xx ) yy = yy . reshape (( n , n )) # PLOT DECISION SURFACE x1 = x1 . reshape ( n , n ) x2 = x2 . reshape ( n , n ) if fill : ax . contourf ( x1 , x2 , yy , alpha = 0.1 , cmap = color ) else : ax . contour ( x1 , x2 , yy , alpha = 0.1 , cmap = color ) # LABEL AXIS, TITLE ax . set_title ( title ) ax . set_xlabel ( 'Latitude' ) ax . set_ylabel ( 'Longitude' ) return ax In [4]: npoints = 200 #Sample two independent N(0,5&#94;2) r.v. using the MultiVariate Normal data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = npoints ) data = np . hstack (( data , np . zeros (( npoints , 1 )))) data [ data [:, 0 ] ** 2 + data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( data [ data [:, 0 ] ** 2 + data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) In [15]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 8 )) x = data [:, : - 1 ] y = data [:, - 1 ] ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' , label = 'vegetation' ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'black' , label = 'non vegetation' , alpha = 0.25 ) ax . set_xlabel ( 'longitude' ) ax . set_ylabel ( 'latitude' ) ax . set_title ( 'satellite image' ) ax . legend () plt . tight_layout () plt . show () In [13]: #Different Depths depths = [ 1 , 2 , 5 , 100000 ] fig , ax = plt . subplots ( 1 , len ( depths ), figsize = ( 20 , 4 )) x = data [:, : - 1 ] y = data [:, - 1 ] ind = 0 for i in depths : ax [ ind ] = fit_and_plot_dt ( x , y , i , 'Depth {} ' . format ( i ), ax [ ind ]) ax [ ind ] . set_xlim ( - 6 , 6 ) ax [ ind ] . set_ylim ( - 6 , 6 ) ind += 1 In [16]: #Overfitting depths = [ 1 , 2 , 5 , 10 , 50 , 100 , 1000 , 100000 ] test_data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 1000 ) test_data = np . hstack (( test_data , np . zeros (( 1000 , 1 )))) test_data [ test_data [:, 0 ] ** 2 + test_data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( test_data [ test_data [:, 0 ] ** 2 + test_data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) x_test = test_data [:, : - 1 ] y_test = test_data [:, - 1 ] scores = [] scores_train = [] for depth in depths : dt = tree . DecisionTreeClassifier ( max_depth = depth ) dt . fit ( x , y ) scores . append ( dt . score ( x_test , y_test )) scores_train . append ( dt . score ( x , y )) plt . plot ( depths , scores , 'b*-' , label = 'Test' ) plt . plot ( depths , scores_train , 'g*-' , label = 'Train' ) plt . xlabel ( 'Depth' ) plt . ylabel ( 'Score' ) plt . xscale ( 'log' ) plt . legend (); In [17]: #Variance comparison between simple and complex models depths = [ 3 , 5 , 1000 ] fig , ax = plt . subplots ( 1 , len ( depths ), figsize = ( 15 , 5 )) for d in range ( len ( depths )): for i in range ( 10 ): new_data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 200 ) new_data = np . hstack (( new_data , np . zeros (( 200 , 1 )))) new_data [ new_data [:, 0 ] ** 2 + new_data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( new_data [ new_data [:, 0 ] ** 2 + new_data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) x = new_data [:, : - 1 ] y = new_data [:, - 1 ] ax [ d ] = fit_and_plot_dt ( x , y , depths [ d ], 'Depth {} ' . format ( depths [ d ]), ax [ d ], plot_data = False , fill = False ) ax [ d ] . set_xlim ( - 4 , 4 ) ax [ d ] . set_ylim ( - 4 , 4 ) plt . tight_layout () plt . show () In [18]: #Different Splitting Criteria depth = 5 fig , ax = plt . subplots ( 1 , 2 , figsize = ( 10 , 5 )) new_data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 200 ) new_data = np . hstack (( new_data , np . zeros (( 200 , 1 )))) new_data [ new_data [:, 0 ] ** 2 + new_data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( new_data [ new_data [:, 0 ] ** 2 + new_data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) x = new_data [:, : - 1 ] y = new_data [:, - 1 ] dt = tree . DecisionTreeClassifier ( max_depth = depth ) dt . fit ( x , y ) ax [ 0 ] = plot_tree_boundary ( x , y , dt , 'Gini' , ax [ 0 ], color = 'Reds' ) dt = tree . DecisionTreeClassifier ( max_depth = depth , criterion = 'entropy' ) dt . fit ( x , y ) ax [ 1 ] = plot_tree_boundary ( x , y , dt , 'Entropy' , ax [ 1 ], color = 'Reds' ) ax [ 0 ] . set_xlim ( - 4 , 4 ) ax [ 0 ] . set_ylim ( - 4 , 4 ) ax [ 1 ] . set_xlim ( - 4 , 4 ) ax [ 1 ] . set_ylim ( - 4 , 4 ) plt . tight_layout () plt . show () In [19]: #Different Stopping Conditions fig , ax = plt . subplots ( 1 , 3 , figsize = ( 15 , 5 )) new_data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 200 ) new_data = np . hstack (( new_data , np . zeros (( 200 , 1 )))) new_data [ new_data [:, 0 ] ** 2 + new_data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( new_data [ new_data [:, 0 ] ** 2 + new_data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) x = new_data [:, : - 1 ] y = new_data [:, - 1 ] dt = tree . DecisionTreeClassifier () dt . fit ( x , y ) ax [ 0 ] = plot_tree_boundary ( x , y , dt , 'No Stopping Conditions' , ax [ 0 ]) dt = tree . DecisionTreeClassifier ( min_impurity_split = 0.32 ) dt . fit ( x , y ) ax [ 1 ] = plot_tree_boundary ( x , y , dt , 'Minimum Purity Split = 0.32' , ax [ 1 ]) dt = tree . DecisionTreeClassifier ( min_samples_leaf = 2 ) dt . fit ( x , y ) ax [ 2 ] = plot_tree_boundary ( x , y , dt , 'Minimum Samples per Leaf = 10' , ax [ 2 ]) ax [ 0 ] . set_xlim ( - 4 , 4 ) ax [ 0 ] . set_ylim ( - 4 , 4 ) ax [ 1 ] . set_xlim ( - 4 , 4 ) ax [ 1 ] . set_ylim ( - 4 , 4 ) ax [ 2 ] . set_xlim ( - 4 , 4 ) ax [ 2 ] . set_ylim ( - 4 , 4 ) plt . tight_layout () plt . show () if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-15/demo/"},{"title":"Lecture 20: Support Vector Machine Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lecture 20: Support Vector Machine Demo Harvard University Falll 2018 Instructors : Pavlos Protopapas and Kevin Rader In [3]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[3]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Import libraries In [19]: import pandas as pd import sys import numpy as np import scipy as sp import matplotlib.pyplot as plt import seaborn as sns from sklearn.preprocessing import MinMaxScaler from sklearn.model_selection import KFold from sklearn.linear_model import LinearRegression from sklearn.linear_model import Ridge from sklearn.linear_model import LogisticRegression from sklearn.linear_model import Lasso from sklearn.preprocessing import PolynomialFeatures from sklearn.neighbors import KNeighborsRegressor from sklearn.decomposition import PCA from sklearn import tree from sklearn import ensemble from sklearn.tree import DecisionTreeClassifier from sklearn import svm sns . set ( style = \"ticks\" ) % matplotlib inline % matplotlib inline In [20]: #-------- plot_decision_boundary # A function that visualizes the data and the decision boundaries # Input: # x (predictors) # y (labels) # model (classifier) # poly_flag (fits quadratic model if true, otherwise linear) # title (title for plot) # ax (a set of axes to plot on) # Returns: # ax (axes with data and decision boundaries) def plot_decision_boundary ( x , y , model , title , ax , bounds = ( 0 , 1 ), poly_flag = False ): # Plot data ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'gray' , alpha = 0.3 ) # Create mesh interval = np . arange ( bounds [ 0 ], bounds [ 1 ], 0.01 ) n = np . size ( interval ) x1 , x2 = np . meshgrid ( interval , interval ) x1 = x1 . reshape ( - 1 , 1 ) x2 = x2 . reshape ( - 1 , 1 ) xx = np . concatenate (( x1 , x2 ), axis = 1 ) # Predict on mesh points if ( poly_flag ): quad_features = preprocessing . PolynomialFeatures ( degree = 2 ) xx = quad_features . fit_transform ( xx ) yy = model . predict ( xx ) yy = yy . reshape (( n , n )) # Plot decision surface x1 = x1 . reshape ( n , n ) x2 = x2 . reshape ( n , n ) ax . contourf ( x1 , x2 , yy , alpha = 0.1 , cmap = 'Greens' ) # Label axes, set title ax . set_title ( title ) ax . set_xlabel ( 'Latitude' ) ax . set_ylabel ( 'Longitude' ) return ax Examples: linearly separable vs non-separable explore role of support vectors explore the margin vs misclassification trade-off comparison with other models 1. Linearly Separable vs. Nonseparable In [21]: # Load dataset_1 data_1 = pd . read_csv ( 'lec19_data1_train.csv' , delimiter = ',' ) # Load dataset_2 data_2 = pd . read_csv ( 'lec19_data2_train.csv' , delimiter = ',' ) data_1 . head () Out[21]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } y x1 x2 0 1 0.626331 0.675644 1 1 0.906825 0.784378 2 0 0.163387 0.156809 3 0 0.009464 0.320792 4 0 0.196253 0.259401 In [22]: # Plot data fig , ax = plt . subplots ( 1 , 2 , figsize = ( 12 , 3 )) #Plot dataset 1 x = data_1 . values [:, [ 1 , 2 ]] y = data_1 . values [:, 0 ] ax [ 0 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'gray' , alpha = 0.4 ) ax [ 0 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' ) ax [ 0 ] . set_xlabel ( 'Longitude' ) ax [ 0 ] . set_ylabel ( 'Latitude' ) ax [ 0 ] . set_title ( 'Dataset 1' ) #Plot dataset 2 x = data_2 . values [:, [ 1 , 2 ]] y = data_2 . values [:, 0 ] ax [ 1 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'gray' , alpha = 0.4 ) ax [ 1 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' ) ax [ 1 ] . set_xlabel ( 'Longitude' ) ax [ 1 ] . set_ylabel ( 'Latitude' ) ax [ 1 ] . set_title ( 'Dataset 2' ) plt . show () It looks like the classes in Dataset 1 can be separated by a line, while the classes in Dataset 2 cannot. In Dataset 1, it's possible to find a subset of points from the two classes that are well separated, SVM chooses the subset in which the classes are maximally separated (the margin between points from different classes is maximized). In Dataset 2 it is not possible. Any decision boundary will have some errors (a mix of classes on either side). 2. The role of support vectors In [23]: # Load dataset_1 x = data_1 . values [:, [ 1 , 2 ]] y = data_1 . values [:, 0 ] # Fit SVM model with C = 1000, linear kernel model = svm . SVC ( C = 1000 , kernel = 'linear' ) model . fit ( x , y ) # Plot decision boundary fig , ax = plt . subplots ( 1 , 2 , figsize = ( 12 , 3 )) ax [ 0 ] = plot_decision_boundary ( x , y , model , 'dataset_1 (fit with entire data)' , ax [ 0 ]) # Highlight the support vectors sv_indices = model . support_ # retrieve the support vector indices ax [ 0 ] . scatter ( x [ sv_indices , 0 ], x [ sv_indices , 1 ], color = 'red' , alpha = 0.15 , s = 100 ) # draw circles around SVs # Isolate only support vectors and their labels x_svs = x [ sv_indices , :] y_svs = y [ sv_indices ] model . fit ( x_svs , y_svs ) # Plot decision boundary with only support vectors ax [ 1 ] = plot_decision_boundary ( x_svs , y_svs , model , 'dataset_1 (refit with only support vectors)' , ax [ 1 ]) # Highlight the support vectors ax [ 1 ] . scatter ( x_svs [:, 0 ], x_svs [:, 1 ], color = 'red' , alpha = 0.15 , s = 100 ) # draw circles around SVs plt . show () In [28]: # Load dataset_2 x = data_2 . values [:, [ 1 , 2 ]] y = data_2 . values [:, 0 ] # Fit SVM model with C = 1000, linear kernel model = svm . SVC ( C = 10000 , kernel = 'linear' ) model . fit ( x , y ) # Plot decision boundary fig , ax = plt . subplots ( 1 , 2 , figsize = ( 12 , 3 )) ax [ 0 ] = plot_decision_boundary ( x , y , model , 'dataset_2 (fit with entire data)' , ax [ 0 ]) # Highlight the support vectors sv_indices = model . support_ # retrieve the support vector indices ax [ 0 ] . scatter ( x [ sv_indices , 0 ], x [ sv_indices , 1 ], color = 'red' , alpha = 0.15 , s = 100 ) # draw circles around SVs # Isolate only support vectors and their labels x_svs = x [ sv_indices , :] y_svs = y [ sv_indices ] model . fit ( x_svs , y_svs ) # Plot decision boundary with only support vectors ax [ 1 ] = plot_decision_boundary ( x_svs , y_svs , model , 'dataset_2 (refit with only support vectors)' , ax [ 1 ]) # Highlight the support vectors ax [ 1 ] . scatter ( x_svs [:, 0 ], x_svs [:, 1 ], color = 'red' , alpha = 0.15 , s = 100 ) # draw circles around SVs plt . show () In both cases, the decision boundary of an SVM is completely determined by a subset of data points - the support vectors. 3. Margin vs misclassification trade-off In [29]: #-------- fit_and_plot_svm_for_c # Fit and plot SVM model for value of 'C', overlayed on a scatter plot of data # (fit on train set and evaluate on test set) # # Input: # x_train (array of train predictors) # y_train (array of train responses)# # x_test (array of test predictors) # y_test (array of test responses) # bounds (tuple of bounds for plotting) # C (value for parameter C) # ax (axes to plot on) def fit_and_plot_svm_for_c ( x_train , y_train , x_test , y_test , C , ax , bounds = ( 0 , 1 )): # Fit SVM model model = svm . SVC ( C = C , kernel = 'linear' ) model . fit ( x_train , y_train ) # Train and test error tr_acc = model . score ( x_train , y_train ) ts_acc = model . score ( x_test , y_test ) # Plot decision boundary plot_decision_boundary ( x_train , y_train , model , \\ 'C = ' + str ( C ) \\ + ', train acc = ' + str ( tr_acc ) \\ + ', test acc = ' + str ( ts_acc ), ax , bounds ) # Plot support vectors sv_indices = model . support_ # retrieve the support vector indices ax . scatter ( x_train [ sv_indices , 0 ], x_train [ sv_indices , 1 ], color = 'red' , alpha = 0.15 , s = 100 ) # draw circles around SVs return ax In [7]: # Load train data data_train = data_2 . values x_train = data_train [:, [ 1 , 2 ]] y_train = data_train [:, 0 ] # Load test data data_test = pd . read_csv ( \"lec19_data2_test.csv\" , delimiter = ',' ) . values x_test = data_test [:, [ 1 , 2 ]] y_test = data_test [:, 0 ] # Fit and plot for different 'C' values fig , ax = plt . subplots ( 2 , 3 , figsize = ( 15 , 10 )) ax [ 0 , 0 ] = fit_and_plot_svm_for_c ( x_train , y_train , x_test , y_test , 0.1 , ax [ 0 , 0 ], ( - 10 , 10 )) ax [ 0 , 1 ] = fit_and_plot_svm_for_c ( x_train , y_train , x_test , y_test , 0.5 , ax [ 0 , 1 ]) ax [ 0 , 2 ] = fit_and_plot_svm_for_c ( x_train , y_train , x_test , y_test , 1 , ax [ 0 , 2 ]) ax [ 1 , 0 ] = fit_and_plot_svm_for_c ( x_train , y_train , x_test , y_test , 10 , ax [ 1 , 0 ]) ax [ 1 , 1 ] = fit_and_plot_svm_for_c ( x_train , y_train , x_test , y_test , 100 , ax [ 1 , 1 ]) ax [ 1 , 2 ] = fit_and_plot_svm_for_c ( x_train , y_train , x_test , y_test , 1000 , ax [ 1 , 2 ]) plt . tight_layout () For dataset_2 , any linear decision boundary would have some errors. In this case, SVM chooses a decision boundary by trading-off the errors for margin (i.e. balancing minimizing error with maximizing margin). The parameter $C$ controls the trade-off. Increasing $C$ puts more emphasis on accuracy (note that after $C=10$, train accuracy cannot be improved upon by a linear classifier and thus the decision boundary stops changing) and less emphasis on the margin of separation. As a result, the model tends to overfit the train set, and perform poorly on the test set. 4. Comparison with other models In [30]: def fit_logistic_plot ( x_train , x_test , y_train , y_test , C , ax ): logreg = LogisticRegression ( C = C ) logreg . fit ( x_train , y_train ) test_score = logreg . score ( x_test , y_test ) train_score = logreg . score ( x_train , y_train ) ax = plot_decision_boundary ( x_train , y_train , logreg , 'Logistic Regression, C = ' + str ( C ) + ', train acc = ' + str ( train_score ) + ', test acc = ' + str ( test_score ), ax , bounds = ( 0 , 1 ), poly_flag = False ) return ax fig , ax = plt . subplots ( 1 , 3 , figsize = ( 20 , 5 )) ax [ 0 ] = fit_logistic_plot ( x_train , x_test , y_train , y_test , 0.01 , ax [ 0 ]) ax [ 1 ] = fit_logistic_plot ( x_train , x_test , y_train , y_test , 1 , ax [ 1 ]) ax [ 2 ] = fit_logistic_plot ( x_train , x_test , y_train , y_test , 10000 , ax [ 2 ]) plt . show () Adjusting the margin-accuracy trade-off in SVM and the $\\ell_2$ regularization parameter in logistic regression produce similar decision boundaries for Dataset 2. In this sense, considering the margin when training the model is another form of regularization. Other dimensions along which we can compare SVM with logistic regression: training time time to classify a single test data point space complexity, when we store each 'model' what do we need to store? ease of updating model, when the training data set changes slightly, how easy is it to retrain each model? In [31]: def fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , C , ax , bounds = ( 0 , 1 ), degree = 2 ): # Fit SVM model model = svm . SVC ( C = C , kernel = 'poly' , degree = degree ) model . fit ( x_train , y_train ) # Train and test error tr_acc = model . score ( x_train , y_train ) ts_acc = model . score ( x_test , y_test ) # Plot decision boundary plot_decision_boundary ( x_train , y_train , model , \\ 'C = ' + str ( C ) \\ + ', train acc = ' + str ( tr_acc ) \\ + ', test acc = ' + str ( ts_acc ), ax , bounds ) # Plot support vectors sv_indices = model . support_ # retrieve the support vector indices ax . scatter ( x_train [ sv_indices , 0 ], x_train [ sv_indices , 1 ], color = 'red' , alpha = 0.15 , s = 100 ) # draw circles around SVs return ax In [32]: # Fit and plot for different 'C' values when polynomial degree is 2 fig , ax = plt . subplots ( 2 , 3 , figsize = ( 15 , 10 )) deg = 4 ax [ 0 , 0 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 0.5 , ax [ 0 , 0 ], ( - 10 , 10 ), degree = deg ) ax [ 0 , 1 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 1 , ax [ 0 , 1 ], degree = deg ) ax [ 0 , 2 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 10 , ax [ 0 , 2 ], degree = deg ) ax [ 1 , 0 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 100 , ax [ 1 , 0 ], degree = deg ) ax [ 1 , 1 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 1000 , ax [ 1 , 1 ], degree = deg ) ax [ 1 , 2 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 10000 , ax [ 1 , 2 ], degree = deg ) plt . tight_layout () In [33]: # Fit and plot for different degrees for polynomial boundary...this takes a while fig , ax = plt . subplots ( 2 , 2 , figsize = ( 15 , 10 )) ax [ 0 , 0 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 1000 , ax [ 0 , 0 ], degree = 1 ) ax [ 0 , 1 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 1000 , ax [ 0 , 1 ], degree = 2 ) ax [ 1 , 0 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 1000 , ax [ 1 , 0 ], degree = 3 ) ax [ 1 , 1 ] = fit_and_plot_svm_for_poly_c ( x_train , y_train , x_test , y_test , 1000 , ax [ 1 , 1 ], degree = 4 ) plt . tight_layout () In [34]: # What about other kernels? def fit_and_plot_svm_for_kernels ( x_train , y_train , x_test , y_test , C , ax , bounds = ( 0 , 1 ), kernel = 'rbf' ): # Fit SVM model model = svm . SVC ( C = C , kernel = kernel ) model . fit ( x_train , y_train ) # Train and test error tr_acc = model . score ( x_train , y_train ) ts_acc = model . score ( x_test , y_test ) # Plot decision boundary plot_decision_boundary ( x_train , y_train , model , \\ 'C = ' + str ( C ) \\ + ', train acc = ' + str ( tr_acc ) \\ + ', test acc = ' + str ( ts_acc ), ax , bounds ) # Plot support vectors sv_indices = model . support_ # retrieve the support vector indices ax . scatter ( x_train [ sv_indices , 0 ], x_train [ sv_indices , 1 ], color = 'red' , alpha = 0.15 , s = 100 ) # draw circles around SVs return ax In [35]: fig , ax = plt . subplots ( 2 , 3 , figsize = ( 15 , 10 )) ax [ 0 , 0 ] = fit_and_plot_svm_for_kernels ( x_train , y_train , x_test , y_test , 100 , ax [ 0 , 0 ], kernel = \"poly\" ) ax [ 0 , 1 ] = fit_and_plot_svm_for_kernels ( x_train , y_train , x_test , y_test , 100 , ax [ 0 , 1 ], kernel = \"rbf\" ) ax [ 0 , 2 ] = fit_and_plot_svm_for_kernels ( x_train , y_train , x_test , y_test , 100 , ax [ 0 , 2 ], kernel = \"sigmoid\" ) ax [ 1 , 0 ] = fit_and_plot_svm_for_kernels ( x_train , y_train , x_test , y_test , 1000 , ax [ 1 , 0 ], kernel = \"poly\" ) ax [ 1 , 1 ] = fit_and_plot_svm_for_kernels ( x_train , y_train , x_test , y_test , 1000 , ax [ 1 , 1 ], kernel = \"rbf\" ) ax [ 1 , 2 ] = fit_and_plot_svm_for_kernels ( x_train , y_train , x_test , y_test , 1000 , ax [ 1 , 2 ], kernel = \"sigmoid\" ) plt . tight_layout () In [ ]: # of course, a cross-validation should be used to determine how much penalty # (what sklearn calls '1/C') should be used for each method if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-20/demo/"},{"title":"Lecture 23: A/B Testing Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lecture 23: A/B Testing Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [2]: import pandas as pd import sys import numpy as np import scipy as sp import statsmodels as sm import matplotlib.pyplot as plt import seaborn as sns from statsmodels.stats.proportion import proportions_ztest % matplotlib inline Read in the data In [3]: # Load dataset_1 data_bone = pd . read_csv ( 'bone.csv' , delimiter = ',' ) data_bone . head () Out[3]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } rat group treatment bone density lowjump highjump 0 1 Control 1 611 0 0 1 2 Control 1 621 0 0 2 3 Control 1 614 0 0 3 4 Control 1 593 0 0 4 5 Control 1 593 0 0 In [4]: #creating the bone density measures for each group controlgroup = data_bone [ 'bone density' ][ data_bone [ 'group' ] == 'Control' ] trt1group = data_bone [ 'bone density' ][ data_bone [ 'group' ] == 'Lowjump' ] trt2group = data_bone [ 'bone density' ][ data_bone [ 'group' ] == 'Highjump' ] #two sample t-test sp . stats . ttest_ind ( controlgroup , trt2group ) Out[4]: Ttest_indResult(statistic=-3.7154746787634116, pvalue=0.001583142292646354) In [5]: sp . stats . ttest_ind ( controlgroup , trt2group ) Out[5]: Ttest_indResult(statistic=-3.7154746787634116, pvalue=0.001583142292646354) In [6]: #ANOVA F-test sp . stats . f_oneway ( controlgroup , trt1group , trt2group ) Out[6]: F_onewayResult(statistic=7.977836956953773, pvalue=0.0018951062682877964) In [7]: #creating indicator variables for each group ybar = np . mean ( data_bone [ 'bone density' ]) controlgroup_ind = 1 * ( data_bone [ 'bone density' ][ data_bone [ 'group' ] == 'Control' ] > ybar ) trt1group_ind = 1 * ( data_bone [ 'bone density' ][ data_bone [ 'group' ] == 'Lowjump' ] > ybar ) trt2group_ind = 1 * ( data_bone [ 'bone density' ][ data_bone [ 'group' ] == 'Highjump' ] > ybar ) #let's see if the indicator is different across Control vs. Other mytable1 = pd . crosstab ( data_bone [ 'group' ] == 'Control' , data_bone [ 'bone density' ] > ybar ) mytable1 Out[7]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } bone density False True group False 6 14 True 8 2 In [8]: mytable1 . iloc [:, 1 ] Out[8]: group False 14 True 2 Name: True, dtype: int64 In [9]: # z-test for proportions xs = mytable1 . iloc [:, 1 ] ns = mytable1 . sum ( axis = 1 ) proportions_ztest ( xs , ns ) Out[9]: (2.587745847533828, 0.0096606229974849581) In [10]: #Fisher Exact test mytable = pd . crosstab ( data_bone [ 'group' ] == 'Control' , data_bone [ 'bone density' ] > ybar ) sp . stats . fisher_exact ( mytable1 ) Out[10]: (0.10714285714285714, 0.018690654672663655) In [11]: mytable2 = pd . crosstab ( data_bone [ 'group' ], data_bone [ 'bone density' ] > ybar ) sp . stats . chi2_contingency ( mytable2 ) Out[11]: (13.928571428571431, 0.00094503772154749571, 2, array([[ 4.66666667, 5.33333333], [ 4.66666667, 5.33333333], [ 4.66666667, 5.33333333]])) In [12]: mytable2 Out[12]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } bone density False True group Control 8 2 Highjump 0 10 Lowjump 6 4 In [28]: #chi-sq goodness of fit sp . stats . chisquare ( data_bone [ 'group' ] . value_counts ()) Out[28]: Power_divergenceResult(statistic=0.0, pvalue=1.0) In [27]: data_bone [ 'group' ] . value_counts () Out[27]: Lowjump 10 Control 10 Highjump 10 Name: group, dtype: int64 if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-23/demo/"},{"title":"Lecture 4: Regression Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science: Lecture 4: Lecture Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas, Kevin Rader The following examples are intended to complement the lecture. They can be used to clarify important steps from the lecture. You are strongly encouraged to do them. In the first example below, I give you a lot of the necessary code to help familiarize you with python and its primary libraries. Lecture 3 contained an example of the $k$ nearest neighbors algorithm for a prediction problem. The initial example considered $k=1$ and was applied to the advertising dataset in an attempt to predict sales from TV budgets. Here I reproduce the results from the lecture. In particular, generate the following figure: Part 1: Load Basic Python Modules In [1]: # Access to pandas dataframes import pandas as pd # (see https://pandas.pydata.org/ for documentation) # Access to matplotlib for plotting capabilities # The inline command below allows you to display plots # in the notebook. Without this command, the plots wouldn't # show up % pylab inline import matplotlib.pylab as plt # (see https://matplotlib.org/ for documentation) # Access to numpy for basic numerical algorithms import numpy as np # (see http://www.numpy.org/ for documentation) Populating the interactive namespace from numpy and matplotlib Part 2: Load data In [4]: # Read data df_adv = pd . read_csv ( '../data/Advertising.csv' ) Now get a subset of the data. The code below is incomplete and will not work. You need to introduce a stride of data to access. For example, if you want to access indices $2$ through $5$ of an array called x , you would write x [ 2 : 5 ] Note that if you just wanted to access index $2$, you would write x [ 2 ] In place of your_stride1 below, you should introduce your own stride. Keep it small (e.g. 5-10 numbers). In [5]: # Get a subset of the data data_x = df_adv . TV [ 5 : 13 ] data_y = df_adv . sales [ 5 : 13 ] Part 3: Sort the Data We need to sort the data in order to apply the KNN algorithm. In [6]: # Sort the data idx = np . argsort ( data_x ) . values # Get indices ordered from lowest to highest values # Note: You may find it helpful to print out idx to see what's in it In [7]: # Get the actual data in the order from above data_x = data_x . iloc [ idx ] data_y = data_y . iloc [ idx ] In [8]: # Here's a function that finds the index of the nearest neighbor # and returns the value of the nearest neighbor. Note that this # is just for k = 1 and the distance function is simply the # absolute value. def find_nearest ( array , value ): idx = ( np . abs ( array - value )) . idxmin () return idx , array [ idx ] In [9]: # Note that we have used the idxmin method in our function. This is # because `array' is a pandas dataframe and idxmin() is designed to # work with pandas dataframes. If we are working with a numpy array # then the appropriate method would be `argmin()'. # Create some artificial x-values (might not be in the actual dataset) x = np . linspace ( np . min ( data_x ), np . max ( data_x )) # Initialize the y-values to zero y = np . zeros ( ( len ( x ))) In [10]: # Apply the KNN algorithm. Try to predict the y-value at a given x-value # Note: You may have tried to use the `range' method in your code. Enumerate # is far better in this case. Try to understand why. for i , xi in enumerate ( x ): y [ i ] = data_y [ find_nearest ( data_x , xi )[ 0 ]] In [12]: # Plot your solution plt . plot ( x , y , '-.' ) # Plot the original data using black x's. plt . plot ( df_adv . TV [ 5 : 13 ], df_adv . sales [ 5 : 13 ], 'kx' ) plt . title ( '' ) plt . xlabel ( 'TV budget in $1000' ) plt . ylabel ( 'Sales in $1000' ) # Save the figure if savefig=True if ( savefig ): plt . savefig ( '../fig/E1.png' , dpi = 300 ) Solutions to Exercise 2 To derive the result from lecture, take the derivatives with respect to the parameters $\\beta_{0}$ and $\\beta_{1}$ and set to zero, $\\dfrac{\\partial L}{\\partial \\beta_{j}} = 0$. Remember that the loss function is $$L\\left(\\beta_{0}, \\beta_{1}\\right) = \\frac{1}{n}\\sum_{i=1}&#94;{n}{\\left(y_{i} - \\left(\\beta_{1}x_{1} + \\beta_{0}\\right)\\right)&#94;{2}}.$$ The result of this is, $$\\dfrac{\\partial L}{\\partial \\beta_{0}} = \\frac{2}{n}\\sum_{i=1}&#94;{n}{y_{i} - \\left(\\beta_{1}x_{i} + \\beta_{0}\\right)} = 0$$ and $$\\dfrac{\\partial L}{\\partial \\beta_{1}} = -\\frac{2}{n}\\sum_{i=1}&#94;{n}{x_{i}\\left[y_{i} - \\left(\\beta_{1}x_{i} + \\beta_{0}\\right)\\right]} = 0.$$ This is just two equations in two unknowns. Solving for $\\beta_{0}$ and $\\beta_{1}$ gives the desired result: $$\\widehat{\\beta}_{1} = \\dfrac{\\displaystyle\\sum_{i=1}&#94;{n}{\\left(x_{i} - \\overline{x}\\right)\\left(y_{i} - \\overline{y}\\right)}}{\\displaystyle\\sum_{i=1}&#94;{n}{\\left(x_{i} - \\overline{x}\\right)&#94;{2}}} \\quad \\textrm{and} \\quad \\widehat{\\beta}_{0} = \\overline{y} - \\beta_{1}\\overline{x}$$ with $$\\overline{x} = \\frac{1}{n}\\sum_{i=1}&#94;{n}{x_{i}} \\quad \\textrm{and} \\quad \\overline{y} = \\frac{1}{n}\\sum_{i=1}&#94;{n}{y_{i}}.$$ To make the desired plot, we need to select some value of $\\beta_{0}$ and create a grid over $\\beta_{1}$. In [13]: import numpy as np beta_0 = 7.10 beta_1 = np . linspace ( 0.0 , 0.075 , 10000 ) Let's get the data. In [14]: x = df_adv . TV [ 5 : 13 ] . values y = df_adv . sales [ 5 : 13 ] . values n = len ( x ) Next, we compute the loss function. In [15]: L = np . zeros ( len ( beta_1 )) for idx , xi in enumerate ( x ): L += ( y [ idx ] - beta_1 * xi - beta_0 ) ** 2.0 L /= n print ( L [ np . argmin ( L )], beta_1 [ np . argmin ( L )]) 4.91691344875 0.0371512151215 Now plot and save. In [17]: plt . plot ( beta_1 , L ) plt . title ( r '$\\beta_0 = {0:5.3f} $' . format ( beta_0 )) plt . ylabel ( r '$L\\left(\\beta_ {1} \\right)$' ) plt . xlabel ( r '$\\beta_ {1} $' ) plt . savefig ( '../fig/Exercise1-2.png' , dpi = 300 ) Extra! We can compute the actual values of $\\beta_{0}$ and $\\beta_{1}$ from the formulas we derived. In [18]: def beta_hat ( x , y ): # Mean of x and y xbar = np . mean ( x ) ybar = np . mean ( y ) xi_minus_xbar = x - xbar yi_minus_ybar = y - ybar # Numerator of beta_1 expression num = xi_minus_xbar * yi_minus_ybar num = np . sum ( num ) # Denominator of beta_1 expression den = np . linalg . norm ( xi_minus_xbar ) ** 2.0 # beta_1 and beta_0 beta_hat_1 = num / den beta_hat_0 = ybar - beta_hat_1 * xbar return [ beta_hat_0 , beta_hat_1 ] beta = beta_hat ( x , y ) print ( beta [ 0 ], beta [ 1 ]) 7.10417977738 0.0371269113254 Now calculate the true minimum of $L$. In [19]: L = 0.0 for idx , xi in enumerate ( x ): L += ( y [ idx ] - beta [ 1 ] * xi - beta [ 0 ]) ** 2.0 L /= n print ( L ) 4.91690570297 if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-4/demo/"},{"title":"Lecture 8: Principal Component Analysis Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 8: Principal Component Analysis Demo Harvard University Summer 2018 Instructors : Pavlos Protopapas and Kevin Rader In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [1]: import pandas as pd import sys import numpy as np import scipy as sp import matplotlib.pyplot as plt import statsmodels.api as sm from statsmodels.tools import add_constant from statsmodels.regression.linear_model import RegressionResults import seaborn as sns import sklearn as sk from sklearn.preprocessing import MinMaxScaler from sklearn.model_selection import KFold from sklearn.linear_model import LinearRegression from sklearn.linear_model import Ridge from sklearn.linear_model import Lasso from sklearn.preprocessing import PolynomialFeatures from sklearn.neighbors import KNeighborsRegressor from sklearn.decomposition import PCA sns . set ( style = \"ticks\" ) % matplotlib inline /Users/krader/anaconda/lib/python3.6/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead. from pandas.core import datetools In [2]: nyc_cab_df = pd . read_csv ( 'nyc_car_hire_data.csv' , low_memory = False ) In [11]: print ( nyc_cab_df . shape ) nyc_cab_df . head () (1873671, 30) Out[11]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } AWND Base Day Dropoff_latitude Dropoff_longitude Ehail_fee Extra Fare_amount Lpep_dropoff_datetime MTA_tax ... TMIN Tip_amount Tolls_amount Total_amount Trip_distance Trip_type Type VendorID lpep_pickup_datetime Trip Length (min) 0 4.7 B02512 1 NaN NaN NaN NaN 33.863498 2014-04-01 00:24:00 NaN ... 39 NaN NaN NaN 4.083561 NaN 1 NaN 2014-04-01 00:11:00 13.0 1 4.7 B02512 1 NaN NaN NaN NaN 19.022892 2014-04-01 00:29:00 NaN ... 39 NaN NaN NaN 3.605694 NaN 1 NaN 2014-04-01 00:17:00 12.0 2 4.7 B02512 1 NaN NaN NaN NaN 25.498981 2014-04-01 00:34:00 NaN ... 39 NaN NaN NaN 4.221763 NaN 1 NaN 2014-04-01 00:21:00 13.0 3 4.7 B02512 1 NaN NaN NaN NaN 28.024628 2014-04-01 00:39:00 NaN ... 39 NaN NaN NaN 2.955510 NaN 1 NaN 2014-04-01 00:28:00 11.0 4 4.7 B02512 1 NaN NaN NaN NaN 12.083589 2014-04-01 00:40:00 NaN ... 39 NaN NaN NaN 1.922292 NaN 1 NaN 2014-04-01 00:33:00 7.0 5 rows × 30 columns In [3]: def train_test_split ( df , n_samples , validation = False ): if validation : nyc_cab_sample = df . sample ( n = n_samples ) nyc_cab_sample [ 'lpep_pickup_datetime' ] = nyc_cab_sample [ 'lpep_pickup_datetime' ] . apply ( lambda dt : pd . to_datetime ( dt ) . hour ) nyc_cab_sample [ 'Lpep_dropoff_datetime' ] = nyc_cab_sample [ 'Lpep_dropoff_datetime' ] . apply ( lambda dt : pd . to_datetime ( dt ) . hour ) msk = np . random . rand ( len ( nyc_cab_sample )) < 0.8 non_test = nyc_cab_sample [ msk ] test = nyc_cab_sample [ ~ msk ] msk = np . random . rand ( len ( non_test )) < 0.7 train = non_test [ msk ] validation = non_test [ ~ msk ] return train , validation , test else : nyc_cab_sample = df . sample ( n = n_samples ) nyc_cab_sample [ 'lpep_pickup_datetime' ] = nyc_cab_sample [ 'lpep_pickup_datetime' ] . apply ( lambda dt : pd . to_datetime ( dt ) . hour ) nyc_cab_sample [ 'Lpep_dropoff_datetime' ] = nyc_cab_sample [ 'Lpep_dropoff_datetime' ] . apply ( lambda dt : pd . to_datetime ( dt ) . hour ) msk = np . random . rand ( len ( nyc_cab_sample )) < 0.8 train = nyc_cab_sample [ msk ] test = nyc_cab_sample [ ~ msk ] return train , test Dimensionality Reduction: PCA In [4]: train , validation , test = train_test_split ( nyc_cab_df , 1000 , validation = True ) y_train = train [ 'Fare_amount' ] . values y_val = validation [ 'Fare_amount' ] . values y_test = test [ 'Fare_amount' ] . values regression_model = LinearRegression ( fit_intercept = True ) all_predictors = [ 'Trip Length (min)' , 'Type' , 'Trip_distance' , 'TMAX' , 'TMIN' , 'lpep_pickup_datetime' , 'Lpep_dropoff_datetime' , 'Pickup_longitude' , 'Pickup_latitude' , 'SNOW' , 'SNWD' , 'PRCP' ] train . describe () Out[4]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } AWND Day Dropoff_latitude Dropoff_longitude Ehail_fee Extra Fare_amount Lpep_dropoff_datetime MTA_tax PRCP ... TMIN Tip_amount Tolls_amount Total_amount Trip_distance Trip_type Type VendorID lpep_pickup_datetime Trip Length (min) count 533.000000 533.000000 381.000000 381.000000 0.0 381.000000 533.000000 533.000000 381.000000 533.000000 ... 533.000000 381.000000 381.000000 381.000000 533.000000 360.000000 533.000000 381.000000 533.000000 533.000000 mean 6.272983 15.260788 40.647671 -73.737406 NaN 0.393701 14.927224 13.962477 0.486877 0.261332 ... 43.530957 1.028740 0.118320 14.544698 3.007122 1.025000 0.285178 1.784777 13.699812 11.818011 std 1.770641 8.697804 2.088787 3.787967 NaN 0.376776 8.881933 6.688455 0.080039 0.864190 ... 6.127520 1.860855 0.774411 9.926822 2.512425 0.156342 0.451923 0.411517 6.679557 8.243857 min 2.000000 1.000000 0.000000 -74.016167 NaN 0.000000 0.000000 0.000000 0.000000 0.000000 ... 31.000000 0.000000 0.000000 0.000000 0.000000 1.000000 0.000000 1.000000 0.000000 0.000000 25% 4.900000 8.000000 40.714752 -73.968994 NaN 0.000000 8.000000 10.000000 0.500000 0.000000 ... 40.000000 0.000000 0.000000 8.000000 1.520000 1.000000 0.000000 2.000000 9.000000 7.000000 50% 5.800000 15.000000 40.754448 -73.943794 NaN 0.500000 13.000000 16.000000 0.500000 0.000000 ... 43.000000 0.000000 0.000000 11.900000 2.406727 1.000000 0.000000 2.000000 15.000000 10.000000 75% 8.300000 23.000000 40.801552 -73.901405 NaN 0.500000 20.275281 19.000000 0.500000 0.070000 ... 46.000000 1.500000 0.000000 17.100000 3.630000 1.000000 1.000000 2.000000 19.000000 14.000000 max 9.400000 30.000000 40.932575 0.000000 NaN 1.000000 58.500000 23.000000 0.500000 4.970000 ... 59.000000 11.620000 5.330000 69.330000 20.880000 2.000000 1.000000 2.000000 23.000000 54.000000 8 rows × 28 columns 1. Variable Selection: Backwards In [12]: def get_aic ( X_train , y_train ): X_train = add_constant ( X_train ) model = sm . OLS ( y_train , X_train ) . fit () return model . aic X_train = train [ all_predictors ] . values predictors = [( all_predictors , get_aic ( X_train , y_train ))] for k in range ( len ( all_predictors ), 1 , - 1 ): best_k_predictors = predictors [ - 1 ][ 0 ] aics = [] for predictor in best_k_predictors : k_minus_1 = list ( set ( best_k_predictors ) - set ([ predictor ])) X_train = train [ k_minus_1 ] . values aics . append ( get_aic ( X_train , y_train )) best_k_minus_1 = list ( set ( best_k_predictors ) - set ([ best_k_predictors [ np . argmin ( aics )]])) predictors . append (( best_k_minus_1 , np . min ( aics ))) best_predictor_set = sorted ( predictors , key = lambda t : t [ 1 ])[ - 1 ] In [13]: best_predictor_set = sorted ( predictors , key = lambda t : t [ 1 ])[ 0 ] X_train = train [ best_predictor_set [ 0 ]] . values X_val = validation [ best_predictor_set [ 0 ]] . values X_test = test [ best_predictor_set [ 0 ]] . values regression_model . fit ( np . vstack (( X_train , X_val )), np . hstack (( y_train , y_val ))) print ( 'best predictor set: {} \\n test R&#94;2: {} ' . format ( best_predictor_set [ 0 ], regression_model . score ( X_test , y_test ))) best predictor set: ['Type', 'Pickup_latitude', 'Trip_distance', 'SNWD', 'SNOW', 'Trip Length (min)'] test R&#94;2: 0.8696564260764411 2. Variable Selection: LASSO Regression In [14]: X_train = train [ all_predictors ] . values X_val = validation [ all_predictors ] . values X_non_test = np . vstack (( X_train , X_val )) X_test = test [ all_predictors ] . values y_non_test = np . hstack (( y_train , y_val )) lasso_regression = Lasso ( alpha = 1.0 , fit_intercept = True ) lasso_regression . fit ( X_non_test , y_non_test ) print ( 'Lasso regression model: \\n {} + {} &#94;T . x' . format ( lasso_regression . intercept_ , lasso_regression . coef_ )) Lasso regression model: 0.8989838454858443 + [ 0.29912786 4.55900377 1.92934513 -0. -0. 0.00758634 0. -0.04644646 0. 0. 0. 0. ]&#94;T . x In [15]: print ( 'Test R&#94;2: {} ' . format ( lasso_regression . score ( X_test , y_test ))) Test R&#94;2: 0.8253541202656242 3. Principal Component Regression In [24]: pca_all = PCA () pca_all . fit ( X_non_test ) print ( 'First 4 principal components: \\n ' , pca_all . components_ [ 0 : 4 ]) print ( 'Explained variance ratio: \\n ' , pca_all . explained_variance_ratio_ ) First 4 principal components: [[ 2.39129056e-02 -1.52589992e-03 2.87820181e-03 8.15273795e-01 5.30856898e-01 -1.66247307e-01 -1.57138583e-01 1.63510006e-02 -9.18124937e-03 -0.00000000e+00 0.00000000e+00 -1.59625033e-02] [ -4.81556857e-02 -1.64875776e-03 8.71237863e-03 -1.95383366e-01 -1.16363766e-01 -6.82620696e-01 -6.92730264e-01 -2.87939549e-03 2.04933364e-03 -0.00000000e+00 -0.00000000e+00 5.33823735e-03] [ 9.62900731e-01 -5.74858553e-03 2.52808711e-01 -2.66439844e-02 -2.31060283e-02 -4.15207358e-02 -1.18366711e-02 6.63443885e-02 -3.68951248e-02 -0.00000000e+00 -0.00000000e+00 -2.48879974e-03] [ -4.24750484e-03 -1.28064076e-03 -8.79072218e-03 5.43141125e-01 -8.38916835e-01 2.59209473e-04 -1.26252332e-02 1.35518981e-02 -7.80620455e-03 -0.00000000e+00 -0.00000000e+00 -2.67441606e-02]] Explained variance ratio: [ 3.52498964e-01 3.12127677e-01 2.40830333e-01 4.55437699e-02 3.29216180e-02 7.43824785e-03 4.94773071e-03 2.95866750e-03 7.23712321e-04 9.27988146e-06 0.00000000e+00 0.00000000e+00] In [18]: pca = PCA ( n_components = 4 ) pca . fit ( X_non_test ) X_non_test_pca = pca . transform ( X_non_test ) X_test_pca = pca . transform ( X_test ) print ( 'Explained variance ratio:' , pca . explained_variance_ratio_ ) PCA(copy=True, iterated_power='auto', n_components=4, random_state=None, svd_solver='auto', tol=0.0, whiten=False) Explained variance ratio: [ 0.35249896 0.31212768 0.24083033 0.04554377] In [10]: fig , ax = plt . subplots ( 1 , 3 , figsize = ( 20 , 5 )) ax [ 0 ] . scatter ( X_non_test_pca [:, 0 ], X_non_test_pca [:, 1 ], color = 'blue' , alpha = 0.2 , label = 'train R&#94;2' ) ax [ 0 ] . set_title ( 'Dimension Reduced Data' ) ax [ 0 ] . set_xlabel ( '1st Principal Component' ) ax [ 0 ] . set_ylabel ( '2nd Principal Component' ) ax [ 1 ] . scatter ( X_non_test_pca [:, 1 ], X_non_test_pca [:, 2 ], color = 'red' , alpha = 0.2 , label = 'train R&#94;2' ) ax [ 1 ] . set_title ( 'Dimension Reduced Data' ) ax [ 1 ] . set_xlabel ( '2nd Principal Component' ) ax [ 1 ] . set_ylabel ( '3rd Principal Component' ) ax [ 2 ] . scatter ( X_non_test_pca [:, 2 ], X_non_test_pca [:, 3 ], color = 'green' , alpha = 0.2 , label = 'train R&#94;2' ) ax [ 2 ] . set_title ( 'Dimension Reduced Data' ) ax [ 2 ] . set_xlabel ( '3rd Principal Component' ) ax [ 2 ] . set_ylabel ( '4th Principal Component' ) plt . show () In [11]: print ( 'first pca component: \\n ' , pca . components_ [ 0 ]) print ( ' \\n second pca component: \\n ' , pca . components_ [ 1 ]) print ( ' \\n third pca component: \\n ' , pca . components_ [ 2 ]) print ( ' \\n fourth pca component: \\n ' , pca . components_ [ 3 ]) first pca component: [ 3.74459823e-02 -4.41680583e-05 2.16391700e-02 8.35277165e-01 5.47286695e-01 -1.78422690e-02 4.50116839e-03 -7.50954187e-03 3.85373480e-03 -0.00000000e+00 0.00000000e+00 -2.25615177e-02] second pca component: [ 0.01158085 -0.0015665 0.00907282 -0.00353292 -0.01300583 -0.69904073 -0.71471348 -0.00889443 0.00538608 0. 0. -0.00424857] third pca component: [ 0.96840104 -0.00701913 0.24273393 -0.01677791 -0.05000027 0.01389631 0.00638976 -0.01300467 0.00652527 -0. -0. 0.00179659] fourth pca component: [ 0.03770161 -0.00150158 -0.0110018 -0.54346678 0.83106525 0.00340984 -0.01702313 0.08682468 -0.0476665 -0. 0. 0.04814222] In [12]: regression_model = LinearRegression ( fit_intercept = True ) regression_model . fit ( X_non_test_pca , y_non_test ) print ( 'Test R&#94;2: {} ' . format ( regression_model . score ( X_test_pca , y_test ))) Test R&#94;2: 0.40557538786466474 3. Principal Component Regression With Polynomial and Interaction Terms In [13]: gen_poly_terms = PolynomialFeatures ( degree = 6 , interaction_only = False ) min_max_scaler = MinMaxScaler () X_non_test = min_max_scaler . fit_transform ( X_non_test ) X_test = min_max_scaler . fit_transform ( X_test ) X_train_full_poly = gen_poly_terms . fit_transform ( X_non_test ) X_test_full_poly = gen_poly_terms . fit_transform ( X_test ) print ( 'number of total predictors' , X_train_full_poly . shape [ 1 ]) number of total predictors 18564 In [14]: pca = PCA ( n_components = 15 ) pca . fit ( X_train_full_poly ) X_train_pca = pca . transform ( X_train_full_poly ) X_test_pca = pca . transform ( X_test_full_poly ) print ( 'Explained variance ratio:' , pca . explained_variance_ratio_ ) Explained variance ratio: [ 0.34831056 0.24251642 0.15148248 0.07090097 0.03067547 0.02483512 0.02305216 0.01774889 0.01396757 0.01272761 0.0091228 0.00720203 0.00629478 0.00476078 0.00378663] In [15]: regression_model = LinearRegression ( fit_intercept = True ) regression_model . fit ( X_train_pca , y_non_test ) print ( 'Test R&#94;2: {} ' . format ( regression_model . score ( X_test_pca , y_test ))) Test R&#94;2: 0.4443195849969769 In [16]: pca = PCA ( n_components = 45 ) pca . fit ( X_train_full_poly ) X_train_pca = pca . transform ( X_train_full_poly ) X_test_pca = pca . transform ( X_test_full_poly ) print ( 'Explained variance ratio:' , pca . explained_variance_ratio_ ) Explained variance ratio: [ 3.48310557e-01 2.42516417e-01 1.51482483e-01 7.09009680e-02 3.06754681e-02 2.48351214e-02 2.30521576e-02 1.77488894e-02 1.39675683e-02 1.27276083e-02 9.12279857e-03 7.20203211e-03 6.29478250e-03 4.76078391e-03 3.78662733e-03 3.27993352e-03 2.90603203e-03 2.61411456e-03 2.32813418e-03 2.05116201e-03 1.63615945e-03 1.35600233e-03 1.34275193e-03 1.25477268e-03 1.22923808e-03 1.17257812e-03 1.09869059e-03 1.01089645e-03 9.86534786e-04 8.17733249e-04 7.15182513e-04 6.12904664e-04 5.14975819e-04 4.38835395e-04 3.85043656e-04 3.69533207e-04 2.96446551e-04 2.81314538e-04 2.42052561e-04 2.24695889e-04 2.10274027e-04 2.05524834e-04 1.98641522e-04 1.82731790e-04 1.69984079e-04] In [17]: regression_model = LinearRegression ( fit_intercept = True ) regression_model . fit ( X_train_pca , y_non_test ) print ( 'Test R&#94;2: {} ' . format ( regression_model . score ( X_test_pca , y_test ))) Test R&#94;2: 0.38504851218590935 Selecting the Components of PCA Using Cross Validation In [18]: regression_model = LinearRegression ( fit_intercept = True ) kf = KFold ( n_splits = 5 ) x_val_scores = [] for n in range ( 1 , 80 , 5 ): out = n * 1. / 80 * 100 sys . stdout . write ( \" \\r %d%% \" % out ) sys . stdout . flush () pca = PCA ( n_components = 15 ) pca . fit ( X_train_full_poly ) validation_R_sqs = [] for train_index , val_index in kf . split ( X_train_pca ): X_train , X_val = X_train_full_poly [ train_index ], X_train_full_poly [ val_index ] y_train , y_val = y_non_test [ train_index ], y_non_test [ val_index ] X_train_pca = pca . transform ( X_train ) X_val_pca = pca . transform ( X_val ) regression_model . fit ( X_train_pca , y_train ) validation_R_sqs . append ( regression_model . score ( X_val_pca , y_val )) x_val_scores . append ( np . mean ( validation_R_sqs )) sys . stdout . write ( \" \\r %d%% \" % 100 ) 100% In [19]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 5 , 5 )) ax . plot ( range ( 1 , 80 , 5 ), x_val_scores , color = 'blue' ) ax . set_title ( 'Log Cross Validation Score vs. Number of PCA Components' ) ax . set_xlabel ( 'number of components' ) ax . set_ylabel ( 'Cross Validation Score' ) ax . set_yscale ( 'log' ) plt . show () In [20]: best_n = range ( 1 , 80 , 5 )[ np . argmax ( x_val_scores )] pca = PCA ( n_components = best_n ) pca . fit ( X_train_full_poly ) X_train_pca = pca . transform ( X_train_full_poly ) X_test_pca = pca . transform ( X_test_full_poly ) regression_model . fit ( X_train_pca , y_non_test ) test_R_sq = regression_model . score ( X_test_pca , y_test ) print ( 'best regularization param is:' , best_n ) print ( 'the test R&#94;2 for PC regression with n = {} is: {} ' . format ( best_n , test_R_sq )) best regularization param is: 16 the test R&#94;2 for PC regression with n = 16 is: 0.42404700452151367 In [ ]: if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-8/demo/"},{"title":"Lecture 21 Notebook","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 21: Stacking Examples Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [103]: import pandas as pd import sys import numpy as np import scipy as sp import matplotlib import matplotlib.pyplot as plt import seaborn as sns from sklearn.preprocessing import MinMaxScaler from sklearn.model_selection import KFold from sklearn.linear_model import LinearRegression from sklearn.linear_model import Ridge from sklearn.linear_model import Lasso from sklearn.preprocessing import PolynomialFeatures from sklearn.neighbors import KNeighborsRegressor from sklearn.decomposition import PCA from sklearn import tree from sklearn import ensemble from sklearn.tree import DecisionTreeClassifier sns . set ( style = \"ticks\" ) % matplotlib inline from sklearn.tree import DecisionTreeClassifier from sklearn.tree import export_graphviz from io import StringIO #import pydot from IPython.display import display from IPython.display import Image import seaborn as sns pd . set_option ( 'display.width' , 1500 ) pd . set_option ( 'display.max_columns' , 100 ) sns . set_context ( 'poster' ) In [2]: #-------- fit_and_plot_dt # Fit decision tree with on given data set with given depth, and plot the data/model # Input: # fname (string containing file name) # depth (depth of tree) def fit_and_plot_dt ( x , y , depth , title , ax , plot_data = True , fill = True , color = 'Greens' ): # FIT DECISION TREE MODEL dt = tree . DecisionTreeClassifier ( max_depth = depth ) dt . fit ( x , y ) # PLOT DECISION TREE BOUNDARY ax = plot_tree_boundary ( x , y , dt , title , ax , plot_data , fill , color ) return ax In [3]: #-------- plot_tree_boundary # A function that visualizes the data and the decision boundaries # Input: # x (predictors) # y (labels) # model (the classifier you want to visualize) # title (title for plot) # ax (a set of axes to plot on) # Returns: # ax (axes with data and decision boundaries) def plot_tree_boundary ( x , y , model , title , ax , plot_data = True , fill = True , color = 'Greens' , alpha = 0.1 ): if plot_data : # PLOT DATA ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'white' ) # CREATE MESH interval = np . arange ( min ( x . min (), y . min ()), max ( x . max (), y . max ()), 0.01 ) n = np . size ( interval ) x1 , x2 = np . meshgrid ( interval , interval ) x1 = x1 . reshape ( - 1 , 1 ) x2 = x2 . reshape ( - 1 , 1 ) xx = np . concatenate (( x1 , x2 ), axis = 1 ) # PREDICT ON MESH POINTS yy = model . predict ( xx ) yy = yy . reshape (( n , n )) # PLOT DECISION SURFACE x1 = x1 . reshape ( n , n ) x2 = x2 . reshape ( n , n ) if fill : ax . contourf ( x1 , x2 , yy , alpha = alpha , cmap = color ) else : ax . contour ( x1 , x2 , yy , alpha = alpha , cmap = color ) # LABEL AXIS, TITLE ax . set_title ( title ) ax . set_xlabel ( 'Latitude' ) ax . set_ylabel ( 'Longitude' ) return ax In [4]: data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 1000 ) data = np . hstack (( data , np . zeros (( 1000 , 1 )))) data [ data [:, 0 ] ** 2 + data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = 1 In [5]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 5 , 5 )) x = data [:, : - 1 ] y = data [:, - 1 ] ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' , label = 'vegetation' , alpha = 0.5 ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'gray' , label = 'non vegetation' , alpha = 0.1 ) ax . set_xlabel ( 'longitude' ) ax . set_ylabel ( 'latitude' ) ax . set_title ( 'satellite image' ) ax . legend () plt . tight_layout () plt . show () In [6]: #Variance reduction: Baggining, RF, Tree, Adaboost depth = None fig , ax = plt . subplots ( 1 , 4 , figsize = ( 20 , 5 )) for i in range ( 8 ): new_data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 100 ) new_data = np . hstack (( new_data , np . zeros (( 100 , 1 )))) new_data [ new_data [:, 0 ] ** 2 + new_data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = 1 x = new_data [:, : - 1 ] y = new_data [:, - 1 ] ax [ 0 ] = fit_and_plot_dt ( x , y , depth , 'Variance of Single Decision Tree' , ax [ 0 ], plot_data = False , fill = False ) bag = ensemble . BaggingClassifier ( n_estimators = 30 ) bag . fit ( x , y ) ax [ 1 ] = plot_tree_boundary ( x , y , bag , 'Variance of Bagging' , ax [ 1 ], plot_data = False , fill = False , color = 'Reds' ) rf = ensemble . RandomForestClassifier ( n_estimators = 30 ) rf . fit ( x , y ) ax [ 2 ] = plot_tree_boundary ( x , y , rf , 'Variance of RF' , ax [ 2 ], plot_data = False , fill = False , color = 'Blues' ) rf = ensemble . RandomForestClassifier ( n_estimators = 30 ) rf . fit ( x , y ) ax [ 2 ] = plot_tree_boundary ( x , y , rf , 'Variance of RF' , ax [ 2 ], plot_data = False , fill = False , color = 'Blues' ) adaboost = ensemble . AdaBoostClassifier ( tree . DecisionTreeClassifier ( max_depth = 2 ), n_estimators = 30 ) adaboost . fit ( x , y ) ax [ 3 ] = plot_tree_boundary ( x , y , adaboost , 'Variance of AdaBoost' , ax [ 3 ], plot_data = False , fill = False , color = 'Greys' ) ax [ 0 ] . set_xlim ( - 3.2 , 3.2 ) ax [ 0 ] . set_ylim ( - 3.2 , 3.2 ) ax [ 1 ] . set_xlim ( - 3.2 , 3.2 ) ax [ 1 ] . set_ylim ( - 3.2 , 3.2 ) ax [ 2 ] . set_xlim ( - 3.2 , 3.2 ) ax [ 2 ] . set_ylim ( - 3.2 , 3.2 ) ax [ 3 ] . set_xlim ( - 3.2 , 3.2 ) ax [ 3 ] . set_ylim ( - 3.2 , 3.2 ) plt . show () In [42]: #Error comparison data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 200 ) data = np . hstack (( data , np . zeros (( 200 , 1 )))) data [ data [:, 0 ] ** 2 + data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( data [ data [:, 0 ] ** 2 + data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) x = data [:, : - 1 ] y = data [:, - 1 ] test_data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 1000 ) test_data = np . hstack (( test_data , np . zeros (( 1000 , 1 )))) test_data [ test_data [:, 0 ] ** 2 + test_data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( test_data [ test_data [:, 0 ] ** 2 + test_data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) x_test = test_data [:, : - 1 ] y_test = test_data [:, - 1 ] dt = tree . DecisionTreeClassifier () dt . fit ( x , y ) tree_score = np . array ([ dt . score ( x_test , y_test )] * len ( range ( 20 , 320 , 10 ))) bag_score = [] bag_oob = [] rf_score = [] rf_oob = [] boost_score = [] for i in range ( 20 , 320 , 10 ): bag = ensemble . BaggingClassifier ( n_estimators = i , oob_score = True ) bag . fit ( x , y ) bag_score . append ( bag . score ( x_test , y_test )) bag_oob . append ( bag . oob_score_ ) rf = ensemble . RandomForestClassifier ( n_estimators = i , oob_score = True ) rf . fit ( x , y ) rf_score . append ( rf . score ( x_test , y_test )) rf_oob . append ( rf . oob_score_ ) adaboost = ensemble . AdaBoostClassifier ( tree . DecisionTreeClassifier ( max_depth = 2 ), n_estimators = i , learning_rate = 0.5 ) adaboost . fit ( x , y ) boost_score . append ( adaboost . score ( x_test , y_test )) In [8]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 10 )) ax . plot ( range ( 20 , 320 , 10 ), tree_score , color = 'black' , linestyle = '--' , label = 'Single Tree' ) ax . plot ( range ( 20 , 320 , 10 ), bag_score , color = 'red' , alpha = 0.8 , label = 'Bagging' ) ax . plot ( range ( 20 , 320 , 10 ), rf_score , color = 'green' , alpha = 0.8 , label = 'Random Forest' ) ax . plot ( range ( 20 , 320 , 10 ), bag_oob , color = 'red' , alpha = 0.2 , label = 'Bagging OOB' ) ax . plot ( range ( 20 , 320 , 10 ), rf_oob , color = 'green' , alpha = 0.2 , label = 'RF OOB' ) ax . plot ( range ( 20 , 320 , 10 ), boost_score , color = 'grey' , alpha = 0.8 , label = 'AdaBoost' ) ax . set_title ( 'Comparison of Errors' ) ax . set_xlabel ( 'Number of Trees in Ensemble' ) ax . legend ( loc = 'best' ) plt . show () In [9]: #Choosing learning rate boost_score_small = [] boost_score = [] boost_score_large = [] for i in range ( 20 , 120 , 5 ): adaboost = ensemble . AdaBoostClassifier ( tree . DecisionTreeClassifier ( max_depth = 2 ), n_estimators = i , learning_rate = 1e-1 ) adaboost . fit ( x , y ) boost_score_small . append ( adaboost . score ( x , y )) adaboost = ensemble . AdaBoostClassifier ( tree . DecisionTreeClassifier ( max_depth = 2 ), n_estimators = i , learning_rate = 0.5 ) adaboost . fit ( x , y ) boost_score . append ( adaboost . score ( x , y )) adaboost = ensemble . AdaBoostClassifier ( tree . DecisionTreeClassifier ( max_depth = 2 ), n_estimators = i , learning_rate = 0.5e1 ) adaboost . fit ( x , y ) boost_score_large . append ( adaboost . score ( x , y )) In [10]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 10 )) ax . plot ( range ( 20 , 220 , 10 ), boost_score_small , color = 'blue' , label = 'lambda=1e-1' ) ax . plot ( range ( 20 , 220 , 10 ), boost_score , color = 'red' , alpha = 0.8 , label = 'lambda=0.5' ) ax . plot ( range ( 20 , 220 , 10 ), boost_score_large , color = 'green' , alpha = 0.8 , label = 'lambda=0.5e1' ) ax . set_title ( 'Comparison of Learning Rates' ) ax . set_xlabel ( 'Number of Trees in Ensemble' ) ax . legend ( loc = 'best' ) plt . show () In [56]: t1 = bag . predict_proba ( x_test )[:, 1 ] t2 = adaboost . predict_proba ( x_test )[:, 1 ] t3 = rf . predict_proba ( x_test )[:, 1 ] logistic = LogisticRegression ( C = 100 ) . fit ( x , y ) t4 = logistic . predict_proba ( x_test )[:, 1 ] T_test = np . column_stack (( t1 , t2 , t3 , t4 )) #X = pd.concat([t1, t2, t3], axis=1) In [57]: print ( t1 . shape , t2 . shape , t3 . shape , T_test . shape ) (1000,) (1000,) (1000,) (1000, 4) In [71]: from sklearn.linear_model import LogisticRegression logit = LogisticRegression ( C = 1000 ) . fit ( T_test , y_test ) In [76]: newtest_data = np . random . multivariate_normal ([ 0 , 0 ], np . eye ( 2 ) * 5 , size = 5000 ) newtest_data = np . hstack (( newtest_data , np . zeros (( 5000 , 1 )))) newtest_data [ newtest_data [:, 0 ] ** 2 + newtest_data [:, 1 ] ** 2 < 3 ** 2 , 2 ] = np . random . choice ([ 0 , 1 ], len ( newtest_data [ newtest_data [:, 0 ] ** 2 + newtest_data [:, 1 ] ** 2 < 3 ** 2 ]), p = [ 0.2 , 0.8 ]) x_newtest = newtest_data [:, : - 1 ] y_newtest = newtest_data [:, - 1 ] In [77]: print ( bag . score ( x_newtest , y_newtest ), adaboost . score ( x_newtest , y_newtest ), rf . score ( x_newtest , y_newtest ), logistic . score ( x_newtest , y_newtest )) 0.803 0.7772 0.8054 0.4808 In [78]: t1_new = bag . predict_proba ( x_newtest )[:, 1 ] t2_new = adaboost . predict_proba ( x_newtest )[:, 1 ] t3_new = rf . predict_proba ( x_newtest )[:, 1 ] t4_new = logistic . predict_proba ( x_newtest )[:, 1 ] T_new = np . column_stack (( t1_new , t2_new , t3_new , t4_new )) In [79]: logit . score ( T_new , y_newtest ) Out[79]: 0.80800000000000005 In [95]: def overlay_decision_boundary ( ax , model , colors = None , nx = 200 , ny = 200 , desaturate =. 5 , xlim = None , ylim = None ): \"\"\" A function that visualizes the decision boundaries of a classifier. ax: Matplotlib Axes to plot on model: Classifier to use. - if `model` has a `.predict` method, like an sklearn classifier, we call `model.predict(X)` - otherwise, we simply call `model(X)` colors: list or dict of colors to use. Use color `colors[i]` for class i. - If colors is not provided, uses the current color cycle nx, ny: number of mesh points to evaluated the classifier on desaturate: how much to desaturate each of the colors (for better contrast with the sample points) xlim, ylim: range to plot on. (If the default, None, is passed, the limits will be taken from `ax`.) \"\"\" # Create mesh. xmin , xmax = ax . get_xlim () if xlim is None else xlim ymin , ymax = ax . get_ylim () if ylim is None else ylim xx , yy = np . meshgrid ( np . linspace ( xmin , xmax , nx ), np . linspace ( ymin , ymax , ny )) X = np . c_ [ xx . flatten (), yy . flatten ()] # Predict on mesh of points. model = getattr ( model , 'predict' , model ) y = model ( X ) y = y . astype ( int ) # This may be necessary for 32-bit Python. y = y . reshape (( nx , ny )) # Generate colormap. if colors is None : # If colors not provided, use the current color cycle. # Shift the indices so that the lowest class actually predicted gets the first color. # &#94; This is a bit magic, consider removing for next year. colors = ([ 'white' ] * np . min ( y )) + sns . utils . get_color_cycle () if isinstance ( colors , dict ): missing_colors = [ idx for idx in np . unique ( y ) if idx not in colors ] assert len ( missing_colors ) == 0 , f \"Color not specified for predictions {missing_colors} .\" # Make a list of colors, filling in items from the dict. color_list = [ 'white' ] * ( np . max ( y ) + 1 ) for idx , val in colors . items (): color_list [ idx ] = val else : assert len ( colors ) >= np . max ( y ) + 1 , \"Insufficient colors passed for all predictions.\" color_list = colors color_list = [ sns . utils . desaturate ( color , desaturate ) for color in color_list ] cmap = matplotlib . colors . ListedColormap ( color_list ) # Plot decision surface ax . pcolormesh ( xx , yy , y , zorder =- 2 , cmap = cmap , norm = matplotlib . colors . NoNorm (), vmin = 0 , vmax = y . max () + 1 ) xx = xx . reshape ( nx , ny ) yy = yy . reshape ( nx , ny ) if len ( np . unique ( y )) > 1 : ax . contour ( xx , yy , y , colors = \"black\" , linewidths = 1 , zorder =- 1 ) else : print ( \"Warning: only one class predicted, so not plotting contour lines.\" ) def plot_decision_boundary ( x , y , model , title , ax ): plot_data ( ax , x , y ) overlay_decision_boundary ( ax , model , colors = class_colors ) ax . set_title ( title ) In [111]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 5 , 5 )) x = data [:, : - 1 ] y = data [:, - 1 ] ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'green' , label = 'vegetation' , alpha = 0.5 ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'gray' , label = 'non vegetation' , alpha = 0.1 ) ax . set_xlabel ( 'longitude' ) ax . set_ylabel ( 'latitude' ) ax . set_title ( 'satellite image' ) ax . legend () plt . tight_layout () c = [ 'white' , 'green' ] overlay_decision_boundary ( ax , bag , colors = c , desaturate =. 3 ) plt . show () if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture21/notebook/"},{"title":"Standard Section 1: Introduction to Web Scraping - Solutions","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 1: Introduction to Web Scraping Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader Section Leaders : Cecilia Garraffo, Mehul Smriti Raje, Ken Arnold, Karan Motwani In [5]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"http://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[5]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } When we're done today, you will approach messy real-world data with confidence that you can get it into a format that you can manipulate. Specifically, our learning objectives are: Understand the structure of an HTML document and use that structure to extract desired information Use Python data structures such as lists, dictionaries, and Pandas DataFrames to store and manipulate information Identify some other (semi-)structured formats commonly used for storing and transferring data, such as JSON and CSV Practice using Python packages such as BeautifulSoup and Pandas , including how to navigate their documentation to find functionality. In [ ]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"notebook\" ) import requests from bs4 import BeautifulSoup from IPython.display import HTML In [ ]: # Setting up 'requests' to make HTTPS requests properly takes some extra steps... we'll skip them for now. requests . packages . urllib3 . disable_warnings () Our goals today Is science becoming more collaborative over time? How about literature? Are there a few \"geniuses\" or lots of hard workers? One way we might answer those questions is by looking at Nobel Prizes. We could ask questions like: How has the number of recipients per award changed over time? Has anyone won a prize more than once? To answer these questions, we'll need data: who received what award when . Before we dive into acquiring this data the way we've been teaching in class, let's pause to ask: what are 5 different approaches we could take to acquiring Nobel Prize data ? Ingesting data (and what is JSON?) Turns out that https://www.nobelprize.org/prizes/lists/all-nobel-prizes/ has the data we want. But the nobelprize.org server is a little slow sometimes. Fortunately, the Internet Archive periodically crawls most of the Internet and saves what it finds. (That's a lot of data!) So let's grab the data from the Archive's \"Wayback Machine\" (great name!). We could go to http://archive.org , search for our URL, and get the URL for the archived version there. But since you'll often need to talk with APIs, let's take this opportunity to use the Wayback Machine's API for the . This will also give us a chance to practice working with JSON. In [ ]: url = \"https://www.nobelprize.org/prizes/lists/all-nobel-prizes/\" # All 3 of these do the same thing. The third is my (KCA's) favorite new feature of Python 3.6. wayback_query_url = 'http://archive.org/wayback/available?url= {} ' . format ( url ) wayback_query_url = 'http://archive.org/wayback/available?url= {url} ' . format ( url = url ) wayback_query_url = f 'http://archive.org/wayback/available?url= {url} ' r = requests . get ( wayback_query_url ) We got some kind of response... what is it? In [ ]: r . text Yay, JSON ! It's usually pretty easy to work with JSON, once we parse it. In [ ]: import json json . loads ( r . text ) Loading responses as JSON is so common that requests has a convenience method for it: In [ ]: response_json = r . json () response_json What kind of object is this? A little Python syntax review: How can we get the snapshot URL? In [ ]: snapshot_url = response_json [ 'archived_snapshots' ][ 'closest' ][ 'url' ] snapshot = requests . get ( snapshot_url ) Always remember to \"not to be evil\" when scraping with requests! If downloading multiple pages (like you will be on HW1), always put a delay between requests (e.g, time.sleep(1) , with the time library) so you don't unwittingly hammer someone's webserver and/or get blocked. In [ ]: raw_html = snapshot . text print ( raw_html [: 500 ]) Now, we have all our data in the notebook. Unfortunately, it is the form of one really long string, which is hard to work with directly. This is where BeautifulSoup comes in. Parse the HTML with BeautifulSoup In [ ]: soup = BeautifulSoup ( raw_html , 'html.parser' ) Key BeautifulSoup functions we'll be using in this section: node.prettify() : Returns cleaned-up version of raw HTML, useful for printing node.select(selector) : Return a list of nodes matching a CSS selector node.select_one(selector) : Return the first node matching a CSS selector node.text/soup.get_text() : Returns visible text of an object (e.g.,\" Some text \" -> \"Some text\") node.contents : A list of the immediate children of this node You can also use these functions to find nodes. node.find_all( ,attrs= ) : Returns a list of matching objects node.find( ,attrs= ) : Returns first matching object BeautifulSoup is a very powerful library -- much more info here: https://www.crummy.com/software/BeautifulSoup/bs4/doc/ Let's practice some BeautifulSoup commands... Print a cleaned-up version of raw HTML In [ ]: print ( soup . prettify ()[: 500 ]) Find the first \"title\" object In [ ]: soup . select_one ( 'title' ) Extract the text of first \"title\" object In [ ]: soup . select_one ( 'title' ) . text Extracting award data Let's use the structure of the HTML document to extract the data we want. From inspecting the page in DevTools, we found that each award is in a div with a by_year class. Let's get all of them. In [ ]: award_nodes = soup . select ( '.by_year' ) len ( award_nodes ) Let's pull out a few examples. In [ ]: award_nodes [ 200 : 202 ] How about just a single example? In [ ]: award_node = award_nodes [ 200 ] In [ ]: HTML ( award_node . prettify ()) Individual Activity 1 Let's practice getting data out of a BS Node Extract the prize title Start by getting the full title including the year. In [ ]: # Your code here Now try to separate the title from the year In [ ]: def get_award_title ( award_node ): # Your code here In [ ]: def get_award_year ( award_node ): # Your code here Make a list of titles for all awards In [ ]: # Your code here Make a list of dictionaries of the title and year for all awards. In [ ]: # Your code here Back together... The recipients how do we handle there being more than one? In [ ]: [ node . text for node in award_node . select ( 'h6 a' )] We'll leave them as a list for now, to return to this later. The prize \"motivation\" In [ ]: award_node . select_one ( 'p' ) . text What are those weird quotes at either end? In [ ]: print ( json . dumps ( award_node . select_one ( 'p' ) . text )) Ah, they're \"smart quotes\". Let's strip them off. In [ ]: award_node . select_one ( 'p' ) . text . lstrip ( ' \\u201c ' ) . rstrip ( ' \\u201d ' ) In [ ]: def get_award_motivation ( award_node ): award_node = award_node . select_one ( 'p' ) if not award_node : return None return award_node . text . lstrip ( ' \\u201c ' ) . rstrip ( ' \\u201d ' ) In [ ]: def get_recipients ( award_node ): return [ node . text for node in award_node . select ( 'h6 a' )] Now let's get all of the awards. In [ ]: awards = [] for award_node in soup . select ( '.by_year' ): recipients = get_recipients ( award_node ) awards . append ( dict ( title = get_award_title ( award_node ), year = get_award_year ( award_node ), recipients = recipients , num_recipients = len ( recipients ), motivation = get_award_motivation ( award_node ) )) In [ ]: df_awards_raw = pd . DataFrame ( awards ) Some quick EDA. In [ ]: df_awards_raw . info () In [ ]: df_awards_raw . year . min () Hm, that's suspiciously close to a round number. Are we missing some? How about recipients? In [ ]: df_awards_raw . num_recipients . value_counts () Why do some have no recipients? In [ ]: df_awards_raw [ df_awards_raw . num_recipients == 0 ] Ok: 2018 awards have no recipients because they haven't been awarded yet. Some past years lack awards because there actually were none that year. Let's keep only meaningful data: In [ ]: df_awards_past = df_awards_raw [ df_awards_raw . year != 2018 ] df_awards_past . info () Hm, motivation has a different number of items... why? In [ ]: df_awards_past [ df_awards_past . motivation . isnull ()] . head () Looks like it's fine that those motivations were missing. Individual Activity 2 Sort the awards by year. In [ ]: # Your code here How many awards of each type were given? In [ ]: # Your code here When was each award first given? In [ ]: # Your code here Back together... How many recipients per year? Let's include the years with missing awards; if we were to analyze further, we'd have to decide whether to include them. In [ ]: df_awards_past . plot . scatter ( x = 'year' , y = 'num_recipients' ) It's hard to see a trend when there are multiple observations per year ( why? ). Let's try looking at mean num recipients by year. In [ ]: df_awards_past . groupby ( 'year' ) . num_recipients . mean () . plot . line () A complete answer to our question would involve fitting regression models, breaking down by kind of award, etc... here's a quick preview. In [ ]: sns . lmplot ( x = 'year' , y = 'num_recipients' , hue = 'title' , data = df_awards_past ) #, scatter_kws=dict(alpha=.1)) plt . xlim ( 1900 , 2018 ); Did anyone recive the Nobel Prize more than once? Here's where it bites us that our original DataFrame isn't \"tidy\". Let's make a tidy one. In [ ]: tidy_awards = [] for idx , row in df_awards_past . iterrows (): for recipient in row [ 'recipients' ]: tidy_awards . append ( dict ( recipient = recipient , year = row [ 'year' ])) tidy_awards_df = pd . DataFrame ( tidy_awards ) tidy_awards_df . info () In [ ]: tidy_awards_df . recipient . value_counts () Other structured data formats: JSON and CSV CSV CSV is the lowest-common-denominator data format. In [ ]: df_awards_past . to_csv ( 'awards.csv' , index = False ) with open ( 'awards.csv' , 'r' ) as f : print ( f . read ()[: 1000 ]) It loses some info, though: the recipients list became a plain string. In [ ]: pd . read_csv ( 'awards.csv' ) . recipients . iloc [ 20 ] JSON JSON preserves structured data, but fewer data-science tools speak it. In [ ]: df_awards_past . to_json ( 'awards.json' , orient = 'records' ) with open ( 'awards.json' , 'r' ) as f : print ( f . read ()[: 1000 ]) Lists are preserved. In [ ]: pd . read_json ( 'awards.json' ) . recipients . iloc [ 20 ] Pickle For temporary data storage in a single version of Python, pickle s will preserve your data even more faithfully. But don't count on it for exchanging data (in fact, don't try to load untrusted pickle s -- they can run arbitrary code!). In [ ]: df_awards_past . to_pickle ( 'awards.pkl' , protocol = 0 ) with open ( 'awards.pkl' , 'r' , encoding = 'latin1' ) as f : print ( f . read ()[: 200 ]) Formatted data output Let's make a textual table of Physics laureates by year, earliest first: In [ ]: for idx , row in df_awards_past . sort_values ( 'year' ) . iterrows (): if 'Physics' in row [ 'title' ]: print ( ' {} : {} ' . format ( row [ 'year' ], ', ' . join ( row [ 'recipients' ]))) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-1/solutions/"},{"title":"Standard Section 1: Introduction to Web Scraping - Student Version","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 1: Introduction to Web Scraping Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader Section Leaders : Cecilia Garraffo, Mehul Smriti Raje, Ken Arnold, Karan Motwani In [5]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"http://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[5]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } When we're done today, you will approach messy real-world data with confidence that you can get it into a format that you can manipulate. Specifically, our learning objectives are: Understand the structure of an HTML document and use that structure to extract desired information Use Python data structures such as lists, dictionaries, and Pandas DataFrames to store and manipulate information Identify some other (semi-)structured formats commonly used for storing and transferring data, such as JSON and CSV Practice using Python packages such as BeautifulSoup and Pandas , including how to navigate their documentation to find functionality. In [ ]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"notebook\" ) import requests from bs4 import BeautifulSoup from IPython.display import HTML In [ ]: # Setting up 'requests' to make HTTPS requests properly takes some extra steps... we'll skip them for now. requests . packages . urllib3 . disable_warnings () Our goals today Is science becoming more collaborative over time? How about literature? Are there a few \"geniuses\" or lots of hard workers? One way we might answer those questions is by looking at Nobel Prizes. We could ask questions like: How has the number of recipients per award changed over time? Has anyone won a prize more than once? To answer these questions, we'll need data: who received what award when . Before we dive into acquiring this data the way we've been teaching in class, let's pause to ask: what are 5 different approaches we could take to acquiring Nobel Prize data ? Ingesting data (and what is JSON?) Turns out that https://www.nobelprize.org/prizes/lists/all-nobel-prizes/ has the data we want. But the nobelprize.org server is a little slow sometimes. Fortunately, the Internet Archive periodically crawls most of the Internet and saves what it finds. (That's a lot of data!) So let's grab the data from the Archive's \"Wayback Machine\" (great name!). We could go to http://archive.org , search for our URL, and get the URL for the archived version there. But since you'll often need to talk with APIs, let's take this opportunity to use the Wayback Machine's API for the . This will also give us a chance to practice working with JSON. In [ ]: url = \"https://www.nobelprize.org/prizes/lists/all-nobel-prizes/\" # All 3 of these do the same thing. The third is my (KCA's) favorite new feature of Python 3.6. wayback_query_url = 'http://archive.org/wayback/available?url= {} ' . format ( url ) wayback_query_url = 'http://archive.org/wayback/available?url= {url} ' . format ( url = url ) wayback_query_url = f 'http://archive.org/wayback/available?url= {url} ' r = requests . get ( wayback_query_url ) We got some kind of response... what is it? In [ ]: r . text Yay, JSON ! It's usually pretty easy to work with JSON, once we parse it. In [ ]: import json json . loads ( r . text ) Loading responses as JSON is so common that requests has a convenience method for it: In [ ]: response_json = r . json () response_json What kind of object is this? A little Python syntax review: How can we get the snapshot URL? In [ ]: snapshot_url = response_json [ 'archived_snapshots' ][ 'closest' ][ 'url' ] snapshot = requests . get ( snapshot_url ) Always remember to \"not to be evil\" when scraping with requests! If downloading multiple pages (like you will be on HW1), always put a delay between requests (e.g, time.sleep(1) , with the time library) so you don't unwittingly hammer someone's webserver and/or get blocked. In [ ]: raw_html = snapshot . text print ( raw_html [: 500 ]) Now, we have all our data in the notebook. Unfortunately, it is the form of one really long string, which is hard to work with directly. This is where BeautifulSoup comes in. Parse the HTML with BeautifulSoup In [ ]: soup = BeautifulSoup ( raw_html , 'html.parser' ) Key BeautifulSoup functions we'll be using in this section: node.prettify() : Returns cleaned-up version of raw HTML, useful for printing node.select(selector) : Return a list of nodes matching a CSS selector node.select_one(selector) : Return the first node matching a CSS selector node.text/soup.get_text() : Returns visible text of an object (e.g.,\" Some text \" -> \"Some text\") node.contents : A list of the immediate children of this node You can also use these functions to find nodes. node.find_all( ,attrs= ) : Returns a list of matching objects node.find( ,attrs= ) : Returns first matching object BeautifulSoup is a very powerful library -- much more info here: https://www.crummy.com/software/BeautifulSoup/bs4/doc/ Let's practice some BeautifulSoup commands... Print a cleaned-up version of raw HTML In [ ]: print ( soup . prettify ()[: 500 ]) Find the first \"title\" object In [ ]: soup . select_one ( 'title' ) Extract the text of first \"title\" object In [ ]: soup . select_one ( 'title' ) . text Extracting award data Let's use the structure of the HTML document to extract the data we want. From inspecting the page in DevTools, we found that each award is in a div with a by_year class. Let's get all of them. In [ ]: award_nodes = soup . select ( '.by_year' ) len ( award_nodes ) Let's pull out a few examples. In [ ]: award_nodes [ 200 : 202 ] How about just a single example? In [ ]: award_node = award_nodes [ 200 ] In [ ]: HTML ( award_node . prettify ()) Individual Activity 1 Let's practice getting data out of a BS Node Extract the prize title Start by getting the full title including the year. In [ ]: # Your code here Now try to separate the title from the year In [ ]: def get_award_title ( award_node ): # Your code here In [ ]: def get_award_year ( award_node ): # Your code here Make a list of titles for all awards In [ ]: # Your code here Make a list of dictionaries of the title and year for all awards. In [ ]: # Your code here Back together... The recipients how do we handle there being more than one? In [ ]: [ node . text for node in award_node . select ( 'h6 a' )] We'll leave them as a list for now, to return to this later. The prize \"motivation\" In [ ]: award_node . select_one ( 'p' ) . text What are those weird quotes at either end? In [ ]: print ( json . dumps ( award_node . select_one ( 'p' ) . text )) Ah, they're \"smart quotes\". Let's strip them off. In [ ]: award_node . select_one ( 'p' ) . text . lstrip ( ' \\u201c ' ) . rstrip ( ' \\u201d ' ) In [ ]: def get_award_motivation ( award_node ): award_node = award_node . select_one ( 'p' ) if not award_node : return None return award_node . text . lstrip ( ' \\u201c ' ) . rstrip ( ' \\u201d ' ) In [ ]: def get_recipients ( award_node ): return [ node . text for node in award_node . select ( 'h6 a' )] Now let's get all of the awards. In [ ]: awards = [] for award_node in soup . select ( '.by_year' ): recipients = get_recipients ( award_node ) awards . append ( dict ( title = get_award_title ( award_node ), year = get_award_year ( award_node ), recipients = recipients , num_recipients = len ( recipients ), motivation = get_award_motivation ( award_node ) )) In [ ]: df_awards_raw = pd . DataFrame ( awards ) Some quick EDA. In [ ]: df_awards_raw . info () In [ ]: df_awards_raw . year . min () Hm, that's suspiciously close to a round number. Are we missing some? How about recipients? In [ ]: df_awards_raw . num_recipients . value_counts () Why do some have no recipients? In [ ]: df_awards_raw [ df_awards_raw . num_recipients == 0 ] Ok: 2018 awards have no recipients because they haven't been awarded yet. Some past years lack awards because there actually were none that year. Let's keep only meaningful data: In [ ]: df_awards_past = df_awards_raw [ df_awards_raw . year != 2018 ] df_awards_past . info () Hm, motivation has a different number of items... why? In [ ]: df_awards_past [ df_awards_past . motivation . isnull ()] . head () Looks like it's fine that those motivations were missing. Individual Activity 2 Sort the awards by year. In [ ]: # Your code here How many awards of each type were given? In [ ]: # Your code here When was each award first given? In [ ]: # Your code here Back together... How many recipients per year? Let's include the years with missing awards; if we were to analyze further, we'd have to decide whether to include them. In [ ]: df_awards_past . plot . scatter ( x = 'year' , y = 'num_recipients' ) It's hard to see a trend when there are multiple observations per year ( why? ). Let's try looking at mean num recipients by year. In [ ]: df_awards_past . groupby ( 'year' ) . num_recipients . mean () . plot . line () A complete answer to our question would involve fitting regression models, breaking down by kind of award, etc... here's a quick preview. In [ ]: sns . lmplot ( x = 'year' , y = 'num_recipients' , hue = 'title' , data = df_awards_past ) #, scatter_kws=dict(alpha=.1)) plt . xlim ( 1900 , 2018 ); Did anyone recive the Nobel Prize more than once? Here's where it bites us that our original DataFrame isn't \"tidy\". Let's make a tidy one. In [ ]: tidy_awards = [] for idx , row in df_awards_past . iterrows (): for recipient in row [ 'recipients' ]: tidy_awards . append ( dict ( recipient = recipient , year = row [ 'year' ])) tidy_awards_df = pd . DataFrame ( tidy_awards ) tidy_awards_df . info () In [ ]: tidy_awards_df . recipient . value_counts () Other structured data formats: JSON and CSV CSV CSV is the lowest-common-denominator data format. In [ ]: df_awards_past . to_csv ( 'awards.csv' , index = False ) with open ( 'awards.csv' , 'r' ) as f : print ( f . read ()[: 1000 ]) It loses some info, though: the recipients list became a plain string. In [ ]: pd . read_csv ( 'awards.csv' ) . recipients . iloc [ 20 ] JSON JSON preserves structured data, but fewer data-science tools speak it. In [ ]: df_awards_past . to_json ( 'awards.json' , orient = 'records' ) with open ( 'awards.json' , 'r' ) as f : print ( f . read ()[: 1000 ]) Lists are preserved. In [ ]: pd . read_json ( 'awards.json' ) . recipients . iloc [ 20 ] Pickle For temporary data storage in a single version of Python, pickle s will preserve your data even more faithfully. But don't count on it for exchanging data (in fact, don't try to load untrusted pickle s -- they can run arbitrary code!). In [ ]: df_awards_past . to_pickle ( 'awards.pkl' , protocol = 0 ) with open ( 'awards.pkl' , 'r' , encoding = 'latin1' ) as f : print ( f . read ()[: 200 ]) Formatted data output Let's make a textual table of Physics laureates by year, earliest first: In [ ]: for idx , row in df_awards_past . sort_values ( 'year' ) . iterrows (): if 'Physics' in row [ 'title' ]: print ( ' {} : {} ' . format ( row [ 'year' ], ', ' . join ( row [ 'recipients' ]))) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-1/student/"},{"title":"Prep for Lab 7: Numpy for Tensor and Artificial Neural Networks","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Preparation for Lab 7: Numpy for Tensor and Neural Networks Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Eleni Kaxiras Authors: David Sondak and Pavlos Protopapas In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [3]: import numpy as np import matplotlib.pyplot as plt import matplotlib.image as mpimg import pandas as pd % matplotlib inline Learning Goals In this lab, we'll revise matrix operations and talk about tensors. We will also talk about handling missing data. By the end of this lab, you should: Be able to think of vectors and arrays as tensors. Understand how a simple neural network works and code its functions from scratch. Know how to use simple pandas and scikit-learn functions to handle missing values. REVISE: `lab3_prelab` which has array manipulations and function plots. Part 1. Tensors and Neural Networks We can think of tensors as multidimensional arrays of numerical values; their job is to generalize matrices to multiple dimensions. While tensors first emerged in the 20th century, they have since been applied to numerous other disciplines, including machine learning. Tensor decomposition/factorization can solve, among other, problems in unsupervised learning settings, temporal and multirelational data. When we get to handling images for Convolutional Neural Networks, it's a good idea to have the understanding of tensors of rank 3. We will use the following naming conventions: scalar = just a number = rank 0 tensor ($a$ ∈ $F$,) vector = 1D array = rank 1 tensor ( $x = (\\;x_1,...,x_i\\;)⊤$ ∈ $F&#94;n$ ) matrix = 2D array = rank 2 tensor ( $\\textbf{X} = [a_{ij}] ∈ F&#94;{m×n}$ ) 3D array = rank 3 tensor ( $\\mathscr{X} =[t_{i,j,k}]∈F&#94;{m×n×l}$ ) $\\mathscr{N}$D array = rank $\\mathscr{N}$ tensor ( $\\mathscr{T} =[t_{i1},...,t_{i\\mathscr{N}}]∈F&#94;{n_1×...×n_\\mathscr{N}}$ ) Python library for tensors Machine learning libraries have special functions to handle tensors. Numpy has numpy.tensordot . Feel free to read about it: numpy.tensordot , but we will not be covering it in class. Tensor indexing We can create subarrays by fixing some of the given tensor's indices. We can create a vector by fixing all but one index. A 2D matrix is created when fixing all but two indices. For example, for a third order tensor the vectors are $\\mathscr{X}[:,j,k]$ = $\\mathscr{X}[j,k]$ (column), $\\mathscr{X}[i,:,k]$ = $\\mathscr{X}[i,k]$ (row), and $\\mathscr{X}[i,j,:]$ = $\\mathscr{X}[i,j]$ (tube); the matrices are $\\mathscr{X}[:,:,k]$ (frontal), $\\mathscr{X}[:,j,:]$ (lateral), $\\mathscr{X}[i,:,:]$ (horizontal). Tensor multiplication We can multiply one matrix with another as long as the sizes are compatible ((n × m) × (m × p) = n × p), and also multiply an entire matrix by a constant. Numpy numpy.dot performs a matrix multiplication which is straightforward when we have 2D or 1D arrays. But what about > 3D arrays? The function will choose according to the matching dimentions but if we want to choose we should use tensordot , but, again, we do not need that for this class. In this lab we will be doing a lot of array manipulation, including: reshaping arrays, slicing x = x[0, 10:15, 10:15] brings it into a lower rank, reordering. Create some small tensors. matrix multiplication. Reese Witherspoon as a rank 3 Tensor (photo from Labeled Faces in the Wild ) In [4]: # load and show the image img = mpimg . imread ( '../fig/reese_witherspoon.jpg' ) imgplot = plt . imshow ( img ) What type is this image? We have a suspicion that it's an array so let's find out its shape. In [42]: type ( img ), img . shape Out[42]: (numpy.ndarray, (150, 150, 3)) It's a 24-bit RGB PNG image (height, width, channels) with 8 bits for each of R, G, B. Explore and print the array. In [ ]: img [:][ 0 : 1 ][: 3 ] # selects all rows, 2nd column, and all slices In [ ]: img [ 130 ] In [45]: img [ 130 ][ 100 ] Out[45]: array([225, 199, 164], dtype=uint8) In [46]: # we are down to a single pixel img [ 130 ][ 3 ][ 0 ] Out[46]: 123 In [47]: type ( img ) Out[47]: numpy.ndarray Slicing tensors: slice along each axis In [48]: R_img = img [:,:, 0 ] G_img = img [:,:, 1 ] B_img = img [:,:, 2 ] plt . imshow ( R_img ) plt . colorbar () Out[48]: In [49]: plt . imshow ( G_img ) plt . colorbar () Out[49]: In [50]: plt . imshow ( B_img ) plt . colorbar () Out[50]: In [51]: # practice matrix by scalar img = img * 2 plt . imshow ( img ) Out[51]: Neural Networks 101: Starting with a Single Node We begin with a single node (also called a neuron). There are some inputs $x$, which get combined into an auxilliary variable $z$. The auxilliary variable is passed through the activation function $\\sigma\\left(z\\right)$ and the result is the output. Here is another image showing each step. Notice that the inputs are linearly combined according to some weights $w$ and a bias $b$. This transformation is also sometimes called an affine transformation. The perceptron transforms the weighted inputs according to the rule of the activation function. For a single perceptron, the output $y$ is just the output from the perceptron. The linear transformation and activation of the neuron occurs within a single layer of the network (shown in the dotted box). Example The task is to approximate (or learn) a function $f\\left(x\\right)$ given some input $x$. For demonstration purposes, the function we will try to learn is a Gaussian function \\begin{align} f\\left(x\\right) = e&#94;{-x&#94;{2}} \\textrm{} \\end{align} Even though we represent the input $x$ as a vector on the computer, you should think of it as a single input. For example, we're not passing $x$ and $y$ into the network. In [52]: x = np . linspace ( - 5.0 , 5.0 , 500 ) # input points x [: 5 ] Out[52]: array([-5. , -4.97995992, -4.95991984, -4.93987976, -4.91983968]) Let's plot the sigmoid and the tanh to see their difference In [53]: def sigmoid ( x ): return 1 / ( 1 + np . exp ( - x )) # The real function plt . plot ( x , sigmoid ( x ), label = 'sigmoid' ) plt . plot ( x , np . tanh ( x ), label = 'tanh' ) plt . legend () Out[53]: To transform a $tanh$ into a $sigmoid$: \\begin{align} \\dfrac{1}{2}+\\dfrac{1}{2}\\tanh(\\dfrac{x-c}{a}) = \\dfrac{1}{2}+\\dfrac{1}{2}\\dfrac{e&#94;{(x-c)/a} - e&#94;{- (x-c)/a}}{e&#94;{(x-c)/a)} + e&#94;{- (x-c)/a}}=\\dfrac{1}{1+e&#94;{-2(x-c)/a}} \\qquad\\text{(1.2)} \\textrm{} \\end{align} ($c$ is the threshold, $c$=0 in our case, and $a$ is the sharpness) Now let's create and plot the dataset for our function In [54]: x = np . linspace ( - 5.0 , 5.0 , 500 ) # input points f = np . exp ( - x * x ) # The real function plt . plot ( x , f , label = 'gaussian' ) plt . legend () Out[54]: Let's see what the single-layer, single neuron network give us. We have a couple of choices to make: We must choose some weights and some biases We must choose an activation function For now, we will manually specify the weights and biases. We choose a sigmoid activation function $$\\sigma\\left(x\\right) = \\dfrac{1}{1 + e&#94;{-z}}.$$ What are the limits $\\displaystyle\\lim_{z\\to\\infty}\\sigma\\left(z\\right)$ and $\\displaystyle\\lim_{z\\to-\\infty}\\sigma\\left(z\\right)$? Actually, the sigmoid we have here is called the logistic function. Sigmoids are really a family of functions and the logistic function is just one member in that family. There are other activation functions as well. For example: Rectified linear unit: $$\\sigma\\left(z\\right) = \\text{max}\\left(0, z\\right)$$ Hyperbolic tangent: $$\\sigma\\left(z\\right) = \\tanh\\left(z\\right)$$ Choosing the correct activation function is a really big deal. Notice that the activation functions we've mentioned so far have the feature that they \"turn on\" at some point and \"saturate\" at some point. In [55]: # Manually specify the weight and bias w = - 4.5 # weight b = 3.0 # bias # Perceptron output z = w * x + b # Affine transformation h = 1.0 / ( 1.0 + np . exp ( - z )) # Sigmoid activation And now we plot the activation function and the true function. In [56]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 11 , 7 )) # create axes object SIZE = 16 # Plot ax . plot ( x , f , ls = '-.' , lw = 4 , label = r 'True function' ) ax . plot ( x , h , lw = 4 , label = r 'Single Neuron' ) # Create labels (very important!) ax . set_xlabel ( '$x$' , fontsize = SIZE ) # Notice we make the labels big enough to read ax . set_ylabel ( '$y$' , fontsize = SIZE ) ax . tick_params ( labelsize = SIZE ) # Make the tick labels big enough to read ax . legend ( fontsize = SIZE , loc = 1 ) # Create a legend and make it big enough to read Out[56]: The single perceptron simply turns the output on and off at some point, but that's about it. We see that the neuron is on until about $x=0$ at which point it abruptly turns off. It's able to get \"close\" to the true function. Otherwise, it has nothing in common with the true function. What do you think will happen if you change $w$ and $b$? Multiple Perceptrons in a Single Layer It appears that a single neuron is somewhat limited in what it can accomplish. What if we expand the number of nodes/neurons in our network? We have two obvious choices here. One option is to add depth to the network by putting layers next to each other. The other option is to stack neurons on top of each other in the same layer. Now the network has some width, but is still only one layer deep. The following figure shows a single-layer network with two nodes in one layer. Some observations We still have a single input in this case. Note that this is not necessary in general. We're just keeping things simple with a single input for now. If we have more inputs we will have a matrix for $X$. Each node (or neuron) has a weight and bias associated with it. An affine transformation is performed for each node. Both nodes use the same activation function form $\\sigma\\left(\\cdot\\right)$ on their respective inputs. The outputs of the nodes must be combined to give the overall output of the network. There are a variety of ways of accomplishing this. In the current example, we just take a linear combination of the node outputs to produce the actual prediction. Notice that now we have weights and biases at the output too. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-7/prelab/solutions/"},{"title":"Lab 7: NumPy for Building an Artificial Neural Network and Dealing with Missing Values","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 7: Numpy for Building a Neural Network and Dealing with Missing Values Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Eleni Kaxiras Authors: David Sondak, Pavlos Protopapas, and Eleni Kaxiras In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [5]: import numpy as np import matplotlib.pyplot as plt import matplotlib.image as mpimg import numpy as np import pandas as pd % matplotlib inline Learning Goals In this lab, we'll revise matrix operations and talk about tensors. We will also talk about handling missing data. By the end of this lab, you should: Understand how a simple neural network works and code its functions from scratch. Know how to use simple pandas and scikit-learn functions to handle missing values. Be able to think of vectors and arrays as tensors. Part 1: Neural Networks 101: Starting with a Single Node The simplest way to describe a neural network is that we have some inputs $x$, which get combined into an auxilliary variable $z$. The auxilliary variable is passed through the activation function $\\sigma\\left(z\\right)$ and the result is the output. Here is another image showing each step. Notice that the inputs are linearly combined according to some weights $w$ and a bias $b$. This transformation is also sometimes called an affine transformation. The perceptron transforms the weighted inputs according to the rule of the activation function. For a single perceptron, the output $y$ is just the output from the perceptron. The linear transformation and activation of the neuron occurs within a single layer of the network (shown in the dotted box). Let's see what the single-layer, single neuron network give us. We have a couple of choices to make: We must choose some weights and some biases We must choose an activation function For now, we will manually specify the weights and biases. We choose a sigmoid activation function $$\\sigma\\left(z\\right) = \\dfrac{1}{1 + e&#94;{-z}}.$$ What are the limits $\\displaystyle\\lim_{z\\to\\infty}\\sigma\\left(z\\right)$ and $\\displaystyle\\lim_{z\\to-\\infty}\\sigma\\left(z\\right)$? Actually, the sigmoid we have here is called the logistic function. Sigmoids are really a family of functions and the logistic function is just one member in that family. In class exercise : Plot the sigmoid Plot the sigmoid In [2]: # your code here In [3]: # %load solutions/sigmoid.py def sigmoid ( z ): return 1.0 / ( 1.0 + np . exp ( - z )) Generate a list of 500 $x$ points from -5 to 5 and plot both the sigmoid and the tanh (for tanh you may use np.tanh ) What do you observe? In [ ]: # %load solutions/plot_sig.py x = np . linspace ( - 5.0 , 5.0 , 500 ) # input points print ( x [: 5 ]) plt . plot ( x , sigmoid ( x ), label = 'sigmoid' ) plt . legend () Comments We say that the activation occurs when $\\sigma = \\dfrac{1}{2}$. We can show that this corresponds to $x = -\\dfrac{b}{w}$. The \"steepness\" of the sigmoid is controlled by $w$. In class exercise: Approximate a Gaussian function using a node The task is to approximate (or learn) a function $f\\left(x\\right)$ given some input $x$. For demonstration purposes, the function we will try to learn is a Gaussian function \\begin{align} f\\left(x\\right) = e&#94;{-x&#94;{2}} \\textrm{} \\end{align} Even though we represent the input $x$ as a vector on the computer, you should think of it as a single input. Start by plotting the above function using the $x$ dataset you created earlier In [ ]: f = np . exp ( - x * x ) # The real function, x = np.linspace(-5.0, 5.0, 500) input points plt . plot ( x , f , label = 'gaussian' ) plt . legend () Now, let's code the single node as per the image above. Write a function named affine that does the linear transformation. In [ ]: # your code here def affine ( x , w , b ): \"\"\"Return affine transformation of x INPUTS ====== x: A numpy array of points in x w: A float representing the weight of the perceptron b: A float representing the bias of the perceptron RETURN ====== z: A numpy array of points after the affine transformation z = wx + b \"\"\" # Code goes here return z In [ ]: # your code here In [ ]: # %load solutions/affine.py In [ ]: # your code here In [ ]: # %load solutions/sigmoid.py In [ ]: # your code here w = - 4.5 b = 4. h = sigmoid ( affine ( x , w , b )) In [ ]: # %load solutions/perceptron.py And now we plot the activation function and the true function. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 11 , 7 )) # create axes object SIZE = 16 # Plot ax . plot ( x , f , ls = '-.' , lw = 4 , label = r 'True function' ) ax . plot ( x , h , lw = 4 , label = r 'Single Neuron' ) # Create labels (very important!) ax . set_xlabel ( '$x$' , fontsize = SIZE ) # Notice we make the labels big enough to read ax . set_ylabel ( '$y$' , fontsize = SIZE ) ax . tick_params ( labelsize = SIZE ) # Make the tick labels big enough to read ax . legend ( fontsize = SIZE , loc = 1 ) # Create a legend and make it big enough to read The single perceptron simply turns the output on and off at some point, but that's about it. We see that the neuron is on until about $x=0$ at which point it abruptly turns off. It's able to get \"close\" to the true function. Otherwise, it has nothing in common with the true function. What do you think will happen if you change $w$ and $b$? Important Observation Notice that we wrote the output as sigmoid(affine(x)) . This was not a coincidence. It looks like a composition of functions. In fact, that is what a neural network is doing. It's building up an approximation to a function by creating a composition of functions. For example, a composition of three functions would be written as $$\\varphi_{3}\\left(\\varphi_{2}\\left(\\varphi_{1}\\left(x\\right)\\right)\\right).$$ What happens if we play with the weights and biases? In [ ]: w = [ - 5.0 , 0.1 , 5.0 ] # Create a list of weights b = [ 0.0 , - 1.0 , 1.0 ] # Create a list of biases fig , ax = plt . subplots ( 1 , 1 , figsize = ( 15 , 10 )) ax . plot ( x , f , lw = 4 , ls = '-.' , label = 'True function' ) for wi , bi in zip ( w , b ): h = sigmoid ( affine ( x , wi , bi )) ax . plot ( x , h , lw = 4 , label = r '$w = {0} $, $b = {1} $' . format ( wi , bi )) ax . set_title ( 'Single neuron network' , fontsize = SIZE ) # Create labels (very important!) ax . set_xlabel ( '$x$' , fontsize = SIZE ) # Notice we make the labels big enough to read ax . set_ylabel ( '$y$' , fontsize = SIZE ) ax . tick_params ( labelsize = SIZE ) # Make the tick labels big enough to read ax . legend ( fontsize = SIZE , loc = 'best' ) # Create a legend and make it big enough to read We didn't do an exhaustive search of the weights and biases, but it sure looks like this single perceptron is never going to match the actual function. Again, we shouldn't be suprised about this. The output layer of the network is simple the logistic function, which can only have so much flexibility. Let's try to make our network more flexible by using more nodes ! Multiple Perceptrons in a Single Layer It appears that a single neuron is somewhat limited in what it can accomplish. What if we expand the number of nodes/neurons in our network? We have two obvious choices here. One option is to add depth to the network by putting layers next to each other. The other option is to stack neurons on top of each other in the same layer. Now the network has some width, but is still only one layer deep. The following figure shows a single-layer network with two nodes in one layer. Some observations We still have a single input in this case. Note that this is not necessary in general. We're just keeping things simple with a single input for now. If we have more inputs we will have a matrix for $X$. Each node (or neuron) has a weight and bias associated with it. An affine transformation is performed for each node. Both nodes use the same activation function form $\\sigma\\left(\\cdot\\right)$ on their respective inputs. The outputs of the nodes must be combined to give the overall output of the network. There are a variety of ways of accomplishing this. In the current example, we just take a linear combination of the node outputs to produce the actual prediction. Notice that now we have weights and biases at the output too. Let's see what happens in this case. First, we just compute the outputs of each neuron. In [ ]: x = np . linspace ( - 5.0 , 5.0 , 500 ) # input points f = np . exp ( - x * x ) # data w = np . array ([ 3.5 , - 3.5 ]) b = np . array ([ 3.5 , 3.5 ]) # Affine transformations z1 = w [ 0 ] * x + b [ 0 ] z2 = w [ 1 ] * x + b [ 1 ] # Node outputs h1 = 1.0 / ( 1.0 + np . exp ( - z1 )) h2 = 1.0 / ( 1.0 + np . exp ( - z2 )) Now let's plot things and see what they look like. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 14 , 10 )) ax . plot ( x , f , lw = 4 , ls = '-.' , label = 'True function' ) ax . plot ( x , h1 , lw = 4 , label = 'First neuron' ) ax . plot ( x , h2 , lw = 4 , label = 'Second neuron' ) # Set title ax . set_title ( 'Comparison of Neuron Outputs' , fontsize = SIZE ) # Create labels (very important!) ax . set_xlabel ( '$x$' , fontsize = SIZE ) # Notice we make the labels big enough to read ax . set_ylabel ( '$y$' , fontsize = SIZE ) ax . tick_params ( labelsize = SIZE ) # Make the tick labels big enough to read ax . legend ( fontsize = SIZE , loc = 'best' ) # Create a legend and make it big enough to read Just as we expected. Some sigmoids. Of course, to get the network prediction we must combine these two sigmoid curves somehow. First we'll just add $h_{1}$ and $h_{2}$ without any weights to see what happens. Note We are not doing classification here. We are trying to predict an actual function. The sigmoid activation is convenient when doing classification because you need to go from $0$ to $1$. However, when learning a function, we don't have as good of a reason to choose a sigmoid. In [ ]: # Network output wout = np . ones ( 2 ) # Set the output weights to unity to begin bout = - 1 # No bias yet yout = wout [ 0 ] * h1 + wout [ 1 ] * h2 + bout And plot. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 14 , 10 )) ax . plot ( x , f , ls = '-.' , lw = 4 , label = r 'True function' ) ax . plot ( x , yout , lw = 4 , label = r '$y_ {out} = h_ {1} + h_ {2} $' ) # Create labels (very important!) ax . set_xlabel ( '$x$' , fontsize = SIZE ) # Notice we make the labels big enough to read ax . set_ylabel ( '$y$' , fontsize = SIZE ) ax . tick_params ( labelsize = SIZE ) # Make the tick labels big enough to read ax . legend ( fontsize = SIZE , loc = 'best' ) # Create a legend and make it big enough to read Observations The network prediction is still not good. But , it is pretty sophisticated. We just have two neurons, but we get some pretty interesting behavior. We didn't do anything with the output weights. Those are probably important. Now let's see what happens when we change the weights on the output. In [ ]: # Network output wout = np . array ([ - 1.5 , - 1.5 ]) bout = np . array ( 1.5 ) yout = wout [ 0 ] * h1 + wout [ 1 ] * h2 + bout In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 14 , 10 )) ax . plot ( x , f , lw = 4 , ls = '-.' , label = 'True function' ) ax . plot ( x , yout , lw = 4 , label = r '$y_ {out} = w_ {1} &#94; {o} h_ {1} + w_ {2} &#94; {o} h_ {2} + b&#94; {o} $' ) # Create labels (very important!) ax . set_xlabel ( '$x$' , fontsize = SIZE ) # Notice we make the labels big enough to read ax . set_ylabel ( '$y$' , fontsize = SIZE ) ax . tick_params ( labelsize = SIZE ) # Make the tick labels big enough to read ax . legend ( fontsize = SIZE , loc = 1 ) # Create a legend and make it big enough to read Very cool! The two nodes interact with each other to produce a pretty complicated-looking function. It still doesn't match the true function, but now we have some hope. In fact, it's starting to look a little bit like a Gaussian! We can do better. There are three obvious options at this point: Change the number of nodes Change the activation functions Change the weights Some Mathematical Notation Before proceeding, let's learn a more succint way of doing the calculations. If you have a network with a lot of nodes, then you probably don't want to manually determine the output of each node. It will take forever. Instead, you can package the computations up using a more compact notation. We'll illustrate the ideas with the two-node network. Suppose we have a single input $x$ to a single-layer two-node network. We can store the weights from each node in a vector $\\mathbf{w} \\in \\mathbb{R}&#94;{2}$. Similarly, we can store the biases from each node in a vector $\\mathbf{b} \\in \\mathbb{R}&#94;{2}$. The affine transformation is then written as $$\\mathbf{z} = \\mathbf{w}x + \\mathbf{b}$$ where the usual laws of vector addition and multiplication by a scalar apply. Of course, we have that $\\mathbf{z} \\in \\mathbb{R}&#94;{2}$ as well. Next we evaluate the output from each node. Formally, we write $$\\mathbf{h} = \\sigma\\left(\\mathbf{z}\\right)$$ where, once again, $\\mathbf{h}\\in\\mathbb{R}&#94;{2}$. Moreover, it is understood that $\\sigma$ operates on each individual element of $\\mathbf{z}$ separately. If we denote each component of $\\mathbf{z}$ by $z_{j}, \\quad j = 1, 2$ then we can write $$h_{j} = \\sigma\\left(z_{j}\\right), \\quad j = 1, 2.$$ Lastly, we must do something about the output layer. Mathematically we write $$y_{out} = \\mathbf{w}_{out} \\cdot \\mathbf{h} + b_{out}$$ where $\\mathbf{w}_{out} \\in \\mathbb{R}&#94;{2}$ and $b_{out} \\in \\mathbb{R}$. Part 2. Handling Missing Variables Imputation in pandas Pandas has chosen to use the floating point NaN internally to denote missing data and that was largely for simplicity and performance reasons. The library will also recognize the Python None as \"missing\" or \"not available\" or \"NA\". When doing descriptive statistics, pandas excludes missing values by default. In [ ]: s = pd . Series ([ 0 , 1 ,[] , np . nan , 4 , 6 , 8 , 15 , 23 , 25 , np . nan ]) s In [ ]: # look for missing values s . isna () # or s.isnull() pandas can interpolate according to different methods. In [ ]: # how many? s . isna () . sum () In [ ]: s . isnull () . sum () In [ ]: # fill with zeros s . fillna ( 0 ) # s['one'].fillna('missing') In [ ]: # You may wish to simply exclude labels from a data set which refer to missing data. To do this, use s = pd . Series ([ 0 , 1 , np . nan , 4 , 6 , 8 , 15 , 23 , 25 , np . nan ]) s = s . dropna () s In [ ]: s = pd . Series ([ 0 , 1 , np . nan , 4 , 6 , 8 , 15 , 23 , 25 , np . nan , 27 ]) s . interpolate () Imputation in scikit-learn In [ ]: from sklearn.impute import SimpleImputer imp = SimpleImputer ( copy = True , missing_values = np . nan , strategy = 'mean' ) s1 = pd . Series ([ 0 , 1 , np . nan , 4 , 6 , 8 , 15 , 23 , 25 , np . nan ]) s2 = pd . Series ([ 0 , 1 , np . nan , 4 , 6 , 8 , 15 , 23 , 25 , np . nan ]) d = { 'col1' : s1 , 'col2' : s2 } df = pd . DataFrame ( data = d ) df In [ ]: imp . fit ( df ) df = imp . transform ( df ) df In [ ]: SimpleImputer ( copy = True , fill_value = None , missing_values = np . nan , strategy = 'mean' , verbose = 0 ) print ( imp . transform ( df )) In [ ]: imp2 = SimpleImputer ( strategy = \"most_frequent\" ) s1 = pd . Series ([ 'eleni' , 'john' , np . nan , 'john' , 'mary' , 'john' , 'george' , 'eleni' , 'john' , np . nan ]) d = { 'name' : s1 } df = pd . DataFrame ( data = d ) df In [ ]: imp2 . fit ( df ) df = imp2 . transform ( df ) df Part 3. Reese Witherspoon as a rank 3 Tensor We can think of tensors as multidimensional arrays of numerical values; their job is to generalize matrices to multiple dimensions. While tensors first emerged in the 20th century, they have since been applied to numerous other disciplines, including machine learning. Tensor decomposition/factorization can solve, among other, problems in unsupervised learning settings, temporal and multirelational data. When we get to handling images for Convolutional Neural Networks, it's a good idea to have the understanding of tensors of rank 3. We will use the following naming conventions: scalar = just a number = rank 0 tensor ($a$ ∈ $F$,) vector = 1D array = rank 1 tensor ( $x = (\\;x_1,...,x_i\\;)⊤$ ∈ $F&#94;n$ ) matrix = 2D array = rank 2 tensor ( $\\textbf{X} = [a_{ij}] ∈ F&#94;{m×n}$ ) 3D array = rank 3 tensor ( $\\mathscr{X} =[t_{i,j,k}]∈F&#94;{m×n×l}$ ) $\\mathscr{N}$D array = rank $\\mathscr{N}$ tensor ( $\\mathscr{T} =[t_{i1},...,t_{i\\mathscr{N}}]∈F&#94;{n_1×...×n_\\mathscr{N}}$ ) Tensor indexing We can create subarrays by fixing some of the given tensor's indices. We can create a vector by fixing all but one index. A 2D matrix is created when fixing all but two indices. For example, for a third order tensor the vectors are $\\mathscr{X}[:,j,k]$ = $\\mathscr{X}[j,k]$ (column), $\\mathscr{X}[i,:,k]$ = $\\mathscr{X}[i,k]$ (row), and $\\mathscr{X}[i,j,:]$ = $\\mathscr{X}[i,j]$ (tube); the matrices are $\\mathscr{X}[:,:,k]$ (frontal), $\\mathscr{X}[:,j,:]$ (lateral), $\\mathscr{X}[i,:,:]$ (horizontal). Tensor multiplication We can multiply one matrix with another as long as the sizes are compatible ((n × m) × (m × p) = n × p), and also multiply an entire matrix by a constant. Numpy numpy.dot performs a matrix multiplication which is straightforward when we have 2D or 1D arrays. But what about > 3D arrays? The function will choose according to the matching dimentions but if we want to choose we should use tensordot , but, again, we do not need tensordot for this class. (photo from Labeled Faces in the Wild ) In [8]: # load and show the image img = mpimg . imread ( '../figs/Reese_Witherspoon.jpg' ) imgplot = plt . imshow ( img ) What type is this image? We have a suspicion that it's an array so let's find out its shape. In [ ]: type ( img ), img . shape In [ ]: img It's a 24-bit RGB PNG image (height, width, channels) with 8 bits for each of R, G, B. Explore and print the array. In [ ]: img [:,:,: 3 ] . shape # selects all rows, 1st column, and all slices In [ ]: img [ 130 ] In [ ]: img [ 130 ][ 100 ] . shape if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-7/solutions/"},{"title":"Lab 8: Discriminant Analysis","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 8: Discriminant Analysis - A tale of two cities (Solutions) Harvard University Fall 2018 Instructors: Pavlos Protopapas, Kevin Rader Authors: Rahul Dave and Margo Levine In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Learning Goals Temporal patterns in urban demographics Geographic patterns in urban demographics Part 0: Learning Goals In this lab we'll work with demographics of a region of the cities of Pavlopolis and Kevinsville from the years 2000 to 2010. We'll use the data to predict household economic status from its geographical location. By the end of this lab, you will be able to: Implement different classifiers and calculate predictive accuracy of these classifiers, Compare different classifiers for general predictive accuracy. In [1]: import numpy as np import pandas as pd import scipy as sp from scipy.stats import mode from sklearn import linear_model import matplotlib import matplotlib.pyplot as plt from sklearn import discriminant_analysis as da from sklearn import preprocessing from sklearn.neighbors import KNeighborsClassifier as KNN from sklearn.model_selection import train_test_split % matplotlib inline Predicting Urban Demographic Changes Part 1: Temporal patterns in urban demographics For this first part of lab, we aim to build a model for the city of Pavlopolis that accurately predicts household economic status from its geographical location. We want the model to be robust, that is, the model should be accurate over many years (through 2010 and beyond). The data is contained in dataset_1_year_2000.txt , ..., dataset_1_year_2010.txt . The first two columns of each dataset are the adjusted latitude and longitude of some randomly sampled houses. The last column contains economic status of a household: 0: low-income, 1: middle-class, 2: high-income You are given some additional information Due to the migration of people in and out of the city, the distribution of each economic group over this region changes over the years. The city of Pavlopolis estimates that in this region there is approximately a 25% yearly increase in high-income households; and a 25% decrease in the remaining population, with the decrease being roughly the same amongst both the middle class and lower income households. Visualization We start by importing and visualizing the data. In [2]: #Load one file, check the data type, check that the data matches the description above data2000_glance = np . loadtxt ( '../data/dataset_1_year_2000.txt' ) print ( type ( data2000_glance )) data2000_glance [: 10 , :] Out[2]: array([[ 0.54432757, 0.6245105 , 2. ], [ 0.59468476, 0.72391292, 2. ], [ 0.70018033, 0.78249208, 2. ], [ 0.60126202, 0.97181171, 2. ], [ 0.63199522, 0.74850249, 2. ], [ 0.49427826, 0.60880108, 2. ], [ 0.6096247 , 0.67672357, 2. ], [ 0.76899244, 0.86092404, 2. ], [ 0.59429045, 0.82042128, 2. ], [ 0.45593116, 0.74428878, 2. ]]) In [3]: #Visualize data for every other year fig , ax = plt . subplots ( 2 , 3 , figsize = ( 12 , 5 )) #Create index for subplots ind = 0 #Iterate from year 0 to 10, with steps of 2 for i in range ( 0 , 11 , 2 ): #Load data data = np . loadtxt ( '../data/dataset_1_year_' + str ( 2000 + i ) + '.txt' ) #Split into predictor/response x = data [:, : - 1 ] y = data [:, - 1 ] #Plot each class for the current year in different colors ax [ ind // 3 , ind % 3 ] . scatter ( x [ y == 2 , 0 ], x [ y == 2 , 1 ], color = 'green' , alpha = 0.4 , label = '2-High income' ) ax [ ind // 3 , ind % 3 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'blue' , alpha = 0.4 , label = '1-Middle class' ) ax [ ind // 3 , ind % 3 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'red' , alpha = 0.4 , label = '0-Low income' ) # LABEL AXIS, TITLE ax [ ind // 3 , ind % 3 ] . set_xlabel ( 'Latitude' ) ax [ ind // 3 , ind % 3 ] . set_ylabel ( 'Longitude' ) ax [ ind // 3 , ind % 3 ] . set_title ( str ( 2000 + i )) #Update index ind = ind + 1 plt . legend ( bbox_to_anchor = ( 1 , 1 ), loc = 'upper left' , ncol = 1 ) plt . tight_layout () EXERCISE: What do you observe from the data visualizations? YOUR DISCUSSION HERE: The number of households, and there areal distribution in middle and low income brackets are decreasing over the years while the number in the high income bracket is increasing (i.e. the cluster of green gets bigger, the other clusters get smaller). The number of dwellings in the middle and low income neighborhoods are decreasing, while the number is increasing in the high income neighborhood (i.e. there are less dots of any color in the red and blue regions). This can be due to the fact that, while some housing in the middle and low income neighborhoods are becoming high-income housing, simultaneously, the number of residential housing options may be decreasing in these neighborhoods, e.g. changes in zoning. Model comparison Let's compare the the following four classification schemes (on predictive accuracy) for addressing the problem of predicting household economic status from geographic location: Training a logistic regression model on one year and use it repeatedly Training a Q/LDA model on one year and use it repeatedly Training a KNN model on one year and use it repeatedly Using Bayes Theorem to update LDA/QDA classifiers on a year-by-year basis We'll now train three single models (logistic regression, LDA, and KNN) once, and explore the accuracy of these models over time. EXERCISE: Fill in the code below to fit a logistic regression (variable logreg , with C=1000), KNN (variable knn , for the default k=5), and lda (variable lda ) models on the 2000 data. In [31]: #Load data for year 2000 data = np . loadtxt ( '../data/dataset_1_year_2000.txt' ) #Split predictors, response x = data [:, : - 1 ] y = data [:, - 1 ] #your code begins here #Fit a logistic regression model on year 2000 data logreg = linear_model . LogisticRegression ( C = 1000 ) logreg . fit ( x , y ) #Fit a lda model on year 2000 data lda = da . LinearDiscriminantAnalysis () lda . fit ( x , y ) #Fit a knn model on year 2000 data knn = KNN () knn . fit ( x , y ) #your code ends here logregtrain = logreg . score ( x , y ) ldatrain = lda . score ( x , y ) knntrain = knn . score ( x , y ) acc_log = [] acc_lda = [] acc_knn = [] #Iterate through all the years for i in range ( 1 , 11 ): #Load data for year 2000 + i data_i = np . loadtxt ( '../data/dataset_1_year_' + str ( 2000 + i ) + '.txt' ) #Split predictors, response x_i = data_i [:, : - 1 ] y_i = data_i [:, - 1 ] #Compute predictive accuracies of various models trained on 2000 data acc_log . append ( logreg . score ( x_i , y_i )) acc_lda . append ( lda . score ( x_i , y_i )) acc_knn . append ( knn . score ( x_i , y_i )) #Plot accuracy over years years = np . arange ( 1 , 11 ) + 2000 # x-axis is years 2001-2010 width = 0.25 # width of bar plt . figure ( figsize = ( 10 , 3 )) plt . bar ( years , acc_log , width , color = 'blue' , alpha = 0.5 , label = 'LogReg' ) plt . axhline ( logregtrain , 0 , 1 , color = \"blue\" , label = \"LogReg 2000\" ) plt . bar ( years + width , acc_lda , width , color = 'red' , alpha = 0.5 , label = 'LDA' ) plt . axhline ( ldatrain , 0 , 1 , color = \"red\" , label = \"LDA 2000\" ) plt . bar ( years + 2 * width , acc_knn , width , color = 'green' , alpha = 0.5 , label = 'KNN, k=5' ) plt . axhline ( knntrain , 0 , 1 , color = \"green\" , label = \"KNN 2000\" ) #Labels plt . xlabel ( 'Year' ) plt . ylabel ( 'Prediction Accuracy' ) plt . legend ( loc = 'upper left' , bbox_to_anchor = ( 1 , 1 )) # legend upper left outside plt . xticks ( years + width + 0.125 , years ); # set x-ticks spacing EXERCISE: Are these three models robust? That is, do these models perform well over the years? What about Overfitting? YOUR DISCUSSION HERE: All three models perform well in the years immediately following 2000 but their performaces decreases drastically as the years go on. Thus, training the model once and using it for many years is not a great idea. We'll now consider the remaining modeling option: Training a Q/LDA model yearly What does it mean to train a QDA or LDA model for each year? Recall that Q/LDA classifiers first model the distribution of the data within each class using a normal distribution, $\\mathcal{N}(\\mu, \\Sigma)$. Then the Q/LDA models the distribution of the data amongst the classes. For us, since we have three classes, this means that our \"model\" consists of the following 9 pieces of information (three for each class, two to define the distribution of data in the class and one to define the class proportion): Class 0: Distribution: $p(x | y = 0) = \\mathcal{N}(\\mu_0, \\Sigma_0)$ Proportion: $p(y=0)=\\pi_0 = \\frac{\\text{data in Class 0}}{\\text{total number of data}}$ Class 1: Distribution: $p(x | y = 1) = \\mathcal{N}(\\mu_1, \\Sigma_1)$ Proportion: $p(y=1)=\\pi_1 = \\frac{\\text{data in Class 1}}{\\text{total number of data}}$ Class 2: Distribution: $p(x | y = 2) = \\mathcal{N}(\\mu_2, \\Sigma_2)$ Proportion: $p(y=2)=\\pi_2 = \\frac{\\text{data in Class 2}}{\\text{total number of data}}$ Retraining a Q/LDA model means re-estimating $\\mu, \\Sigma$ and $\\pi$ for each class. EXERCISE: At the beginning of lab we were given information on the projected yearly growth rate of the classes, so we don't need the entire set of population data to re-estimate $\\pi$ for each class. Use this information to write down estimates for $\\pi_2&#94;{\\text{year i + 1}}$. Then, assuming that the total population is approximately constant over the years, estimate $\\pi_0&#94;{\\text{year i + 1}}$ and $\\pi_1&#94;{\\text{year i + 1}}$. YOUR DISCUSSION HERE: We have $$ \\pi_2&#94;{\\text{year i + 1}} = \\pi_2&#94;{\\text{year i}} + 0.25 * \\pi_2&#94;{\\text{year i}} = 1.25 * \\pi_2&#94;{\\text{year i}} $$ Since the total population stays roughly constant throughout the years, and the remaining two classes are decreasing by the same amount each year, and since $\\pi_0&#94;{2000} \\approx \\pi_1&#94;{2000}$, we estimate the proportions for Class 0 and Class 1: $$ \\pi_0&#94;{\\text{year i + 1}} = \\pi_1&#94;{\\text{year i + 1}} = \\frac{1 - 1.25 * \\pi_2&#94;{\\text{year i}}}{2} $$ How do we know that the total population is constant? We don't for certain. The number of observations for each year is approximately the same, but these are random samples from the population so they may have just been chosen to be the same. On the other hand, if the distribution of the data within each class changes (i.e. $\\mu$ and $\\Sigma$ changes within each class) then we will need re-estimate them using new data each year. Let's check, using data visualization, to see if this is indeed the case. In [8]: #Visualize data for every other year fig , ax = plt . subplots ( 3 , 6 , figsize = ( 23 , 10 )) #Iterate from year 0 to 10, with steps of 2 for i in range ( 0 , 11 , 2 ): #Load data data = np . loadtxt ( '../data/dataset_1_year_' + str ( 2000 + i ) + '.txt' ) #Split into predictor/response x = data [:, : - 1 ] y = data [:, - 1 ] #Plot each class for the current year in different colors ax [ 0 , i // 2 ] . scatter ( x [ y == 2 , 0 ], x [ y == 2 , 1 ], color = 'g' , alpha = 0.6 , label = '2-High income' ) ax [ 1 , i // 2 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'b' , alpha = 0.6 , label = '1-Middle class' ) ax [ 2 , i // 2 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'r' , alpha = 0.6 , label = '0-Low income' ) #Labels ax [ 0 , i // 2 ] . set_xlabel ( 'Latitude' ) ax [ 0 , i // 2 ] . set_ylabel ( 'Longitude' ) ax [ 0 , i // 2 ] . set_title ( str ( 2000 + i )) #Labels ax [ 1 , i // 2 ] . set_xlabel ( 'Latitude' ) ax [ 1 , i // 2 ] . set_ylabel ( 'Longitude' ) ax [ 1 , i // 2 ] . set_title ( str ( 2000 + i )) # LABEL AXIS, TITLE ax [ 2 , i // 2 ] . set_xlabel ( 'Latitude' ) ax [ 2 , i // 2 ] . set_ylabel ( 'Longitude' ) ax [ 2 , i // 2 ] . set_title ( str ( 2000 + i )) plt . legend ( bbox_to_anchor = ( 1 , 1 ), loc = 'upper left' , ncol = 1 ) plt . tight_layout () EXERCISE: Comment on how the distribution in each class appears to change over the years. Does this effect the efficiency of Q/LDA models? YOUR DISCUSSION HERE: It's reasonable to conclude from visualization of the data in each class over the years that the distribution within each class is not changing. That is, the data in each class is approximately normally distributed and the shapes of these distributions are approximately constant over time (the number of points in the class don't theoretically contribute to the shape of the distribution, shape describes the variance in each direction). From this we find it reasonable to conclude that the parameters $\\mu$ and $\\Sigma$ for each class do not need to be updated each year . Thus, updating our Q/LDA model yearly involves only re-estimating the class proportions using a formula based on projected yearly growth! So how efficient is our Q/LDA model? We train the model once on a single year's worth of data. Then, for any subsequent year, the update is just a few lines of arithmetic. For example, say we train our Q/LDA model on 2000 data, given a point from 2001, $x&#94;{2001}$, we predict the class label for $x&#94;{2001}$ by: find the probability that $x&#94;{2001}$ will be labeled Class 0 to 2 using our model from 2000: $$ \\begin{aligned} p_{2000}(y=0 | x&#94;{2001}) &= p_{2000}(x&#94;{2001} | y=0) p_{2000}(y=0) = \\mathcal{N}(x&#94;{2001}; \\mu_0, \\Sigma_0) \\pi_0&#94;{2000}\\\\ p_{2000}(y=1 | x&#94;{2001}) &= p_{2000}(x&#94;{2001} | y=1) p_{2000}(y=1) = \\mathcal{N}(x&#94;{2001}; \\mu_1, \\Sigma_1) \\pi_1&#94;{2000}\\\\ p_{2000}(y=2 | x&#94;{2001}) &= p_{2000}(x&#94;{2001} | y=2) p_{2000}(y=2) = \\mathcal{N}(x&#94;{2001}; \\mu_2, \\Sigma_2) \\pi_2&#94;{2000} \\end{aligned} $$ adjust the probabilities predicted using the 2000 model, by updating $\\pi_i$ with 2001 class proportions: $$ \\begin{aligned} p_{2001}(y=0 | x&#94;{2001}) &= p_{2000}(y=0 | x&#94;{2001}) \\frac{\\pi_0&#94;{2001}}{\\pi_0&#94;{2000}}\\\\ p_{2001}(y=1 | x&#94;{2001}) &= p_{2000}(y=1 | x&#94;{2001}) \\frac{\\pi_1&#94;{2001}}{\\pi_1&#94;{2000}}\\\\ p_{2001}(y=2 | x&#94;{2001}) &= p_{2000}(y=2 | x&#94;{2001}) \\frac{\\pi_2&#94;{2001}}{\\pi_2&#94;{2000}}\\\\ \\end{aligned} $$ take the maximum of $\\{p_{2001}(y=0 | x&#94;{2001}), p_{2001}(y=1 | x&#94;{2001}), p_{2001}(y=2 | x&#94;{2001}) \\}$ and predict the class label corresponding to the maximum probability. EXERCISE: Fill in the code below to re-estimate the class proportions (see equations from two exercises ago). In [11]: #Load data for year 2000 data = np . loadtxt ( '../data/dataset_1_year_2000.txt' ) #Split predictors, response x = data [:, : - 1 ] y = data [:, - 1 ] #your code begins here #Fit a lda model on year 2000 data lda = da . LinearDiscriminantAnalysis () lda . fit ( x , y ) #your code ends here ldatrain = lda . score ( x , y ) acc_lda_corrected = [] # Store corrected LDA accuracies #Store class proportions in 2000 p0_2000 = ( y == 0 ) . mean () p1_2000 = ( y == 1 ) . mean () p2_2000 = ( y == 2 ) . mean () #Store class proportions in current year p0_current = ( y == 0 ) . mean () p1_current = ( y == 1 ) . mean () p2_current = ( y == 2 ) . mean () for k in range ( 1 , 11 ): #Load data data_i = np . loadtxt ( 'datasets/dataset_1_year_' + str ( 2000 + k ) + '.txt' ) #Split into predictor, response x_i = data_i [:, : - 1 ] y_i = data_i [:, - 1 ] #x_train, x_test, y_train, y_test = train_test_split(x_i, y_i, test_size=0.30, random_state=0) #your code begins here #Re-estimate class proportions (25% increase in p2, adjust p0, p1 accordingly) p2_current = p2_current * 1.25 p0_current = ( 1 - p2_current ) / 2 p1_current = ( 1 - p2_current ) / 2 #your code ends here #Re-estimate class label probabilities pred_logprob = lda . predict_log_proba ( x_i ) # compute log-probabilities pred_logprob [:, 0 ] = pred_logprob [:, 0 ] + np . log ( p0_current / p0_2000 ) # correction for class 0 pred_logprob [:, 1 ] = pred_logprob [:, 1 ] + np . log ( p1_current / p1_2000 ) # correction for class 1 pred_logprob [:, 2 ] = pred_logprob [:, 2 ] + np . log ( p2_current / p2_2000 ) # correction for class 2 #Predict class label using re-estimated probabilities y_pred = pred_logprob . argmax ( axis = 1 ) #Compute accuracy acc_lda_corrected . append ( np . mean ( y_i == y_pred )) #Plot accuracy over years years = np . arange ( 1 , 11 ) + 2000 # x-axis is years 2001-2010 width = 0.25 # width of bar plt . figure ( figsize = ( 10 , 3 )) plt . bar ( years + width , acc_lda , width , color = 'red' , alpha = 0.5 , label = 'LDA' ) plt . bar ( years + 2 * width , acc_lda_corrected , width , color = 'green' , alpha = 0.5 , label = 'LDA yearly' ) #Labels plt . xlabel ( 'Year' ) plt . ylabel ( 'Prediction Accuracy' ) plt . legend ( loc = 'upper left' , bbox_to_anchor = ( 1 , 1 )) # legend upper left outside plt . title ( 'Overall predictive accuracy of LDA models' ) plt . xticks ( years + width + 0.125 , years ); # set x-ticks spacing plt . axhline ( ldatrain , 0 , 1 , color = \"red\" , label = \"LDA 2000\" ) Out[11]: Compared to training a model once and using it repeatedly, training the Q/LDA yearly performs better in terms of predictive accuracy. It isn't significantly more expensive though. Note: Why LDA and not QDA? Well since we've already observed that the distributions of data within the three classes are very simliar (in terms of shape) we can assume that the covariance matrices for all three classes will be the same - hence our model is LDA rather than QDA Conclusions: Based on the data visualization from the first 5 years, it's clear that while the class proportions are changing, the class distributions are not (the center and shape of the three classes are constant through time). Thus, updating our LDA on a yearly basis is simple, as this just requires us to adjust our estimates of the class proportions $\\pi$. Part 2: Geographic patterns in urban demographics In dataset_2.txt and dataset_3.txt you have the demographic information for a random sample of houses in two regions in Kevinsville. There are only two economic brackets for the households in these datasets: 0: low-income or middle-class, 1: high-income. The data for each region is shown in the visualizations below. In [12]: ##need to add legend fig , ax = plt . subplots ( 1 , 2 , figsize = ( 10 , 3 )) data = np . loadtxt ( '../data/dataset_2.txt' ) x = data [:, 0 : - 1 ] y = data [:, - 1 ] # Plot data ax [ 0 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'b' , alpha = 0.2 ) ax [ 0 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'r' , alpha = 0.2 ) # Label axes, set title ax [ 0 ] . set_title ( 'dataset_2' ) ax [ 0 ] . set_xlabel ( 'Latitude' ) ax [ 0 ] . set_ylabel ( 'Longitude' ) data = np . loadtxt ( 'datasets/dataset_3.txt' ) x = data [:, 0 : - 1 ] y = data [:, - 1 ] # Plot data ax [ 1 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'b' , alpha = 0.2 ) ax [ 1 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'r' , alpha = 0.2 ) # Label axes, set title ax [ 1 ] . set_title ( 'dataset_3' ) ax [ 1 ] . set_xlabel ( 'Latitude' ) ax [ 1 ] . set_ylabel ( 'Longitude' ) plt . show () EXERCISE: For each region, comment on the appropriateness of using KNN for classification. YOUR DISCUSSION HERE: Since the classes in dataset_2 overlap, we anticipate that KNN will do poorly; similarly, since the classes in dataset_3 are well-separated, we expect KNN to do well. Below is code for visualizing decision boundaries. In [27]: #-------- plot_decision_boundary # A function that visualizes the data and the decision boundaries # Input: # x (predictors) # y (labels) # poly_flag (a boolean parameter, fits quadratic model if true, otherwise linear) # title (title for plot) # ax (a set of axes to plot on) # Returns: # ax (axes with data and decision boundaries) def plot_decision_boundary ( x , y , model , poly_flag , title , ax ): # Plot data ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'red' , label = 'Normal' , cmap = plt . cm . coolwarm , alpha = 0.2 , s = 20 ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'blue' , label = 'Normal' , cmap = plt . cm . coolwarm , alpha = 0.2 , s = 20 ) # Create mesh interval = np . arange ( 0 , 1 , 0.01 ) n = np . size ( interval ) x1 , x2 = np . meshgrid ( interval , interval ) x1 = x1 . reshape ( - 1 , 1 ) x2 = x2 . reshape ( - 1 , 1 ) xx = np . concatenate (( x1 , x2 ), axis = 1 ) # Predict on mesh points if ( poly_flag ): quad_features = preprocessing . PolynomialFeatures ( degree = 2 ) xx = quad_features . fit_transform ( xx ) yy = model . predict ( xx ) yy = yy . reshape (( n , n )) # Plot decision surface x1 = x1 . reshape ( n , n ) x2 = x2 . reshape ( n , n ) ax . contourf ( x1 , x2 , yy , cmap = plt . cm . coolwarm , alpha = 0.1 ) # Label axes, set title ax . set_title ( title ) ax . set_xlabel ( 'Latitude' ) ax . set_ylabel ( 'Longitude' ) return ax In [28]: #-------- fit_and_plot_models # A function that visualizes the data and the decision boundaries # Input: # file_name (name of the file containing dataset) # Returns: # None def fit_and_plot_models ( file_name ): data = np . loadtxt ( file_name ) x = data [:, 0 : - 1 ] y = data [:, - 1 ] fig , ax = plt . subplots ( 1 , 4 , figsize = ( 15 , 3 )) # Plain Logistic Regression logreg = linear_model . LogisticRegression () logreg . fit ( x , y ) acc_logreg = logreg . score ( x , y ) str_title = 'LogReg (acc = ' + str ( acc_logreg ) + ')' ax [ 0 ] = plot_decision_boundary ( x , y , logreg , False , str_title , ax [ 0 ]) # LDA lda = da . LinearDiscriminantAnalysis () lda . fit ( x , y ) acc_lda = lda . score ( x , y ) str_title = 'LDA (acc = ' + str ( acc_lda ) + ')' ax [ 1 ] = plot_decision_boundary ( x , y , lda , False , str_title , ax [ 1 ]) # QDA qda = da . QuadraticDiscriminantAnalysis () qda . fit ( x , y ) acc_qda = qda . score ( x , y ) str_title = 'QDA (acc = ' + str ( acc_qda ) + ')' ax [ 2 ] = plot_decision_boundary ( x , y , qda , False , str_title , ax [ 2 ]) # Logistic Regression with Quadratic Terms quad_features = preprocessing . PolynomialFeatures ( degree = 2 ) x_expanded = quad_features . fit_transform ( x ) logreg_poly = linear_model . LogisticRegression ( C = 1000 ) logreg_poly . fit ( x_expanded , y ) acc_logreg_poly = logreg_poly . score ( x_expanded , y ) str_title = 'LogReg-poly (acc = ' + str ( acc_logreg_poly ) + ')' ax [ 3 ] = plot_decision_boundary ( x , y , logreg_poly , True , str_title , ax [ 3 ]) plt . tight_layout () plt . show () EXERCISE: Choose between Q/LDA and logistic regression by visualizing various types decision boundaries. In [29]: #your code here fit_and_plot_models ( '../data/dataset_2.txt' ) In [30]: #your code here fit_and_plot_models ( '../data/dataset_3.txt' ) YOUR DISCUSSION HERE: In the both datasets, the optimal decision boundary is quadratic (based on over all training accuracy and common sense). So both LDA and linear Logistic Regression yield poor prediction accuracy even on the training set. Since the first data set satisfies the model assumptions in QDA (i.e. the distribution of the data within each class is normal), we are not surprised that QDA provides a similar fit as that of (unregularized) logistic with quadratic boundaries (the latter may be overfitting). For the second data set, however, the model assumptions in QDA fail (the red class is nomally distributed, but the blue is not). On the other hand, logistic regression make no assumptions regarding the distribution of the data, it makes more sense to recommend a logistic regression model (although you should incorporate regularization to curb the over fitting). if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-8/solutions/"},{"title":"Lab 8: Discriminant Analysis","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 8: Discriminant Analysis - A tale of two cities (Student Version) Harvard University Fall 2018 Instructors: Pavlos Protopapas, Kevin Rader Authors: Rahul Dave and Margo Levine In [4]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[4]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Learning Goals Temporal patterns in urban demographics Geographic patterns in urban demographics Part 0: Learning Goals In this lab we'll work with demographics of a region of the cities of Pavlopolis and Kevinsville from the years 2000 to 2010. We'll use the data to predict household economic status from its geographical location. By the end of this lab, you will be able to: Implement different classifiers and calculate predictive accuracy of these classifiers, Compare different classifiers for general predictive accuracy. In [1]: import numpy as np import pandas as pd import scipy as sp from scipy.stats import mode from sklearn import linear_model import matplotlib import matplotlib.pyplot as plt from sklearn import discriminant_analysis as da from sklearn import preprocessing from sklearn.neighbors import KNeighborsClassifier as KNN from sklearn.model_selection import train_test_split % matplotlib inline Predicting Urban Demographic Changes Part 1: Temporal patterns in urban demographics For this first part of lab, we aim to build a model for the city of Pavlopolis that accurately predicts household economic status from its geographical location. We want the model to be robust, that is, the model should be accurate over many years (through 2010 and beyond). The data is contained in dataset_1_year_2000.txt , ..., dataset_1_year_2010.txt . The first two columns of each dataset are the adjusted latitude and longitude of some randomly sampled houses. The last column contains economic status of a household: 0: low-income, 1: middle-class, 2: high-income You are given some additional information Due to the migration of people in and out of the city, the distribution of each economic group over this region changes over the years. The city of Pavlopolis estimates that in this region there is approximately a 25% yearly increase in high-income households; and a 25% decrease in the remaining population, with the decrease being roughly the same amongst both the middle class and lower income households. Visualization We start by importing and visualizing the data. In [2]: #Load one file, check the data type, check that the data matches the description above data2000_glance = np . loadtxt ( '../data/dataset_1_year_2000.txt' ) print ( type ( data2000_glance )) data2000_glance [: 10 , :] Out[2]: array([[ 0.54432757, 0.6245105 , 2. ], [ 0.59468476, 0.72391292, 2. ], [ 0.70018033, 0.78249208, 2. ], [ 0.60126202, 0.97181171, 2. ], [ 0.63199522, 0.74850249, 2. ], [ 0.49427826, 0.60880108, 2. ], [ 0.6096247 , 0.67672357, 2. ], [ 0.76899244, 0.86092404, 2. ], [ 0.59429045, 0.82042128, 2. ], [ 0.45593116, 0.74428878, 2. ]]) In [3]: #Visualize data for every other year fig , ax = plt . subplots ( 2 , 3 , figsize = ( 12 , 5 )) #Create index for subplots ind = 0 #Iterate from year 0 to 10, with steps of 2 for i in range ( 0 , 11 , 2 ): #Load data data = np . loadtxt ( '../data/dataset_1_year_' + str ( 2000 + i ) + '.txt' ) #Split into predictor/response x = data [:, : - 1 ] y = data [:, - 1 ] #Plot each class for the current year in different colors ax [ ind // 3 , ind % 3 ] . scatter ( x [ y == 2 , 0 ], x [ y == 2 , 1 ], color = 'green' , alpha = 0.4 , label = '2-High income' ) ax [ ind // 3 , ind % 3 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'blue' , alpha = 0.4 , label = '1-Middle class' ) ax [ ind // 3 , ind % 3 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'red' , alpha = 0.4 , label = '0-Low income' ) # LABEL AXIS, TITLE ax [ ind // 3 , ind % 3 ] . set_xlabel ( 'Latitude' ) ax [ ind // 3 , ind % 3 ] . set_ylabel ( 'Longitude' ) ax [ ind // 3 , ind % 3 ] . set_title ( str ( 2000 + i )) #Update index ind = ind + 1 plt . legend ( bbox_to_anchor = ( 1 , 1 ), loc = 'upper left' , ncol = 1 ) plt . tight_layout () EXERCISE: What do you observe from the data visualizations? Model comparison Let's compare the the following four classification schemes (on predictive accuracy) for addressing the problem of predicting household economic status from geographic location: Training a logistic regression model on one year and use it repeatedly Training a Q/LDA model on one year and use it repeatedly Training a KNN model on one year and use it repeatedly Using Bayes Theorem to update LDA/QDA classifiers on a year-by-year basis We'll now train three single models (logistic regression, LDA, and KNN) once, and explore the accuracy of these models over time. EXERCISE: Fill in the code below to fit a logistic regression (variable logreg , with C=1000), KNN (variable knn , for the default k=5), and lda (variable lda ) models on the 2000 data. In [31]: #Load data for year 2000 data = np . loadtxt ( '../data/dataset_1_year_2000.txt' ) #Split predictors, response x = data [:, : - 1 ] y = data [:, - 1 ] #your code begins here #your code ends here logregtrain = logreg . score ( x , y ) ldatrain = lda . score ( x , y ) knntrain = knn . score ( x , y ) acc_log = [] acc_lda = [] acc_knn = [] #Iterate through all the years for i in range ( 1 , 11 ): #Load data for year 2000 + i data_i = np . loadtxt ( 'data/dataset_1_year_' + str ( 2000 + i ) + '.txt' ) #Split predictors, response x_i = data_i [:, : - 1 ] y_i = data_i [:, - 1 ] #Compute predictive accuracies of various models trained on 2000 data acc_log . append ( logreg . score ( x_i , y_i )) acc_lda . append ( lda . score ( x_i , y_i )) acc_knn . append ( knn . score ( x_i , y_i )) #Plot accuracy over years years = np . arange ( 1 , 11 ) + 2000 # x-axis is years 2001-2010 width = 0.25 # width of bar plt . figure ( figsize = ( 10 , 3 )) plt . bar ( years , acc_log , width , color = 'blue' , alpha = 0.5 , label = 'LogReg' ) plt . axhline ( logregtrain , 0 , 1 , color = \"blue\" , label = \"LogReg 2000\" ) plt . bar ( years + width , acc_lda , width , color = 'red' , alpha = 0.5 , label = 'LDA' ) plt . axhline ( ldatrain , 0 , 1 , color = \"red\" , label = \"LDA 2000\" ) plt . bar ( years + 2 * width , acc_knn , width , color = 'green' , alpha = 0.5 , label = 'KNN, k=5' ) plt . axhline ( knntrain , 0 , 1 , color = \"green\" , label = \"KNN 2000\" ) #Labels plt . xlabel ( 'Year' ) plt . ylabel ( 'Prediction Accuracy' ) plt . legend ( loc = 'upper left' , bbox_to_anchor = ( 1 , 1 )) # legend upper left outside plt . xticks ( years + width + 0.125 , years ); # set x-ticks spacing EXERCISE: Are these three models robust? That is, do these models perform well over the years? What about Overfitting? Bias? What do you see? We'll now consider the remaining modeling option: Training a Q/LDA model yearly What does it mean to train a QDA or LDA model for each year? Recall that Q/LDA classifiers first model the distribution of the data within each class using a normal distribution, $\\mathcal{N}(\\mu, \\Sigma)$. Then the Q/LDA models the distribution of the data amongst the classes. For us, since we have three classes, this means that our \"model\" consists of the following 9 pieces of information (three for each class, two to define the distribution of data in the class and one to define the class proportion): Class 0: Distribution: $p(x | y = 0) = \\mathcal{N}(\\mu_0, \\Sigma_0)$ Proportion: $p(y=0)=\\pi_0 = \\frac{\\text{data in Class 0}}{\\text{total number of data}}$ Class 1: Distribution: $p(x | y = 1) = \\mathcal{N}(\\mu_1, \\Sigma_1)$ Proportion: $p(y=1)=\\pi_1 = \\frac{\\text{data in Class 1}}{\\text{total number of data}}$ Class 2: Distribution: $p(x | y = 2) = \\mathcal{N}(\\mu_2, \\Sigma_2)$ Proportion: $p(y=2)=\\pi_2 = \\frac{\\text{data in Class 2}}{\\text{total number of data}}$ Retraining a Q/LDA model means re-estimating $\\mu, \\Sigma$ and $\\pi$ for each class. EXERCISE: At the beginning of lab we were given information on the projected yearly growth rate of the classes, so we don't need the entire set of population data to re-estimate $\\pi$ for each class. Use this information to write down estimates for $\\pi_2&#94;{\\text{year i + 1}}$. Then, assuming that the total population is approximately constant over the years, estimate $\\pi_0&#94;{\\text{year i + 1}}$ and $\\pi_1&#94;{\\text{year i + 1}}$. On the other hand, if the distribution of the data within each class changes (i.e. $\\mu$ and $\\Sigma$ changes within each class) then we will need re-estimate them using new data each year. Let's check, using data visualization, to see if this is indeed the case. In [8]: #Visualize data for every other year fig , ax = plt . subplots ( 3 , 6 , figsize = ( 23 , 10 )) #Iterate from year 0 to 10, with steps of 2 for i in range ( 0 , 11 , 2 ): #Load data data = np . loadtxt ( '../data/dataset_1_year_' + str ( 2000 + i ) + '.txt' ) #Split into predictor/response x = data [:, : - 1 ] y = data [:, - 1 ] #Plot each class for the current year in different colors ax [ 0 , i // 2 ] . scatter ( x [ y == 2 , 0 ], x [ y == 2 , 1 ], color = 'g' , alpha = 0.6 , label = '2-High income' ) ax [ 1 , i // 2 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'b' , alpha = 0.6 , label = '1-Middle class' ) ax [ 2 , i // 2 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'r' , alpha = 0.6 , label = '0-Low income' ) #Labels ax [ 0 , i // 2 ] . set_xlabel ( 'Latitude' ) ax [ 0 , i // 2 ] . set_ylabel ( 'Longitude' ) ax [ 0 , i // 2 ] . set_title ( str ( 2000 + i )) #Labels ax [ 1 , i // 2 ] . set_xlabel ( 'Latitude' ) ax [ 1 , i // 2 ] . set_ylabel ( 'Longitude' ) ax [ 1 , i // 2 ] . set_title ( str ( 2000 + i )) # LABEL AXIS, TITLE ax [ 2 , i // 2 ] . set_xlabel ( 'Latitude' ) ax [ 2 , i // 2 ] . set_ylabel ( 'Longitude' ) ax [ 2 , i // 2 ] . set_title ( str ( 2000 + i )) plt . legend ( bbox_to_anchor = ( 1 , 1 ), loc = 'upper left' , ncol = 1 ) plt . tight_layout () EXERCISE: Comment on how the distribution in each class appears to change over the years. Does this effect the efficiency of Q/LDA models? So how efficient is our Q/LDA model? We train the model once on a single year's worth of data. Then, for any subsequent year, the update is just a few lines of arithmetic. For example, say we train our Q/LDA model on 2000 data, given a point from 2001, $x&#94;{2001}$, we predict the class label for $x&#94;{2001}$ by: find the probability that $x&#94;{2001}$ will be labeled Class 0 to 2 using our model from 2000: $$ \\begin{aligned} p_{2000}(y=0 | x&#94;{2001}) &= p_{2000}(x&#94;{2001} | y=0) p_{2000}(y=0) = \\mathcal{N}(x&#94;{2001}; \\mu_0, \\Sigma_0) \\pi_0&#94;{2000}\\\\ p_{2000}(y=1 | x&#94;{2001}) &= p_{2000}(x&#94;{2001} | y=1) p_{2000}(y=1) = \\mathcal{N}(x&#94;{2001}; \\mu_1, \\Sigma_1) \\pi_1&#94;{2000}\\\\ p_{2000}(y=2 | x&#94;{2001}) &= p_{2000}(x&#94;{2001} | y=2) p_{2000}(y=2) = \\mathcal{N}(x&#94;{2001}; \\mu_2, \\Sigma_2) \\pi_2&#94;{2000} \\end{aligned} $$ Now note that we are assuming that $p(data | class)$ is constant from year to year, but the PRIOR $p(class)$ is changing. So let us adjust the probabilities predicted using the 2000 model, by updating $\\pi_i$ with 2001 class proportions: $$ \\begin{aligned} p_{2001}(y=0 | x&#94;{2001}) &= p_{2000}(y=0 | x&#94;{2001}) \\frac{\\pi_0&#94;{2001}}{\\pi_0&#94;{2000}}\\\\ p_{2001}(y=1 | x&#94;{2001}) &= p_{2000}(y=1 | x&#94;{2001}) \\frac{\\pi_1&#94;{2001}}{\\pi_1&#94;{2000}}\\\\ p_{2001}(y=2 | x&#94;{2001}) &= p_{2000}(y=2 | x&#94;{2001}) \\frac{\\pi_2&#94;{2001}}{\\pi_2&#94;{2000}}\\\\ \\end{aligned} $$ take the maximum of $\\{p_{2001}(y=0 | x&#94;{2001}), p_{2001}(y=1 | x&#94;{2001}), p_{2001}(y=2 | x&#94;{2001}) \\}$ and predict the class label corresponding to the maximum probability. EXERCISE: Fill in the code below to re-estimate the class proportions (see equations from two exercises ago). In [11]: #Load data for year 2000 data = np . loadtxt ( '../data/dataset_1_year_2000.txt' ) #Split predictors, response x = data [:, : - 1 ] y = data [:, - 1 ] #Fit a lda model on year 2000 data lda = da . LinearDiscriminantAnalysis () lda . fit ( x , y ) ldatrain = lda . score ( x , y ) acc_lda_corrected = [] # Store corrected LDA accuracies #Store class proportions in 2000 p0_2000 = ( y == 0 ) . mean () p1_2000 = ( y == 1 ) . mean () p2_2000 = ( y == 2 ) . mean () #Store class proportions in current year p0_current = ( y == 0 ) . mean () p1_current = ( y == 1 ) . mean () p2_current = ( y == 2 ) . mean () for k in range ( 1 , 11 ): #Load data data_i = np . loadtxt ( 'data/dataset_1_year_' + str ( 2000 + k ) + '.txt' ) #Split into predictor, response x_i = data_i [:, : - 1 ] y_i = data_i [:, - 1 ] #x_train, x_test, y_train, y_test = train_test_split(x_i, y_i, test_size=0.30, random_state=0) #your code begins here #Re-estimate class proportions (25% increase in p2, adjust p0, p1 accordingly) #your code ends here #Re-estimate class label probabilities pred_logprob = lda . predict_log_proba ( x_i ) # compute log-probabilities pred_logprob [:, 0 ] = pred_logprob [:, 0 ] + np . log ( p0_current / p0_2000 ) # correction for class 0 pred_logprob [:, 1 ] = pred_logprob [:, 1 ] + np . log ( p1_current / p1_2000 ) # correction for class 1 pred_logprob [:, 2 ] = pred_logprob [:, 2 ] + np . log ( p2_current / p2_2000 ) # correction for class 2 #Predict class label using re-estimated probabilities y_pred = pred_logprob . argmax ( axis = 1 ) #Compute accuracy acc_lda_corrected . append ( np . mean ( y_i == y_pred )) #Plot accuracy over years years = np . arange ( 1 , 11 ) + 2000 # x-axis is years 2001-2010 width = 0.25 # width of bar plt . figure ( figsize = ( 10 , 3 )) plt . bar ( years + width , acc_lda , width , color = 'red' , alpha = 0.5 , label = 'LDA' ) plt . bar ( years + 2 * width , acc_lda_corrected , width , color = 'green' , alpha = 0.5 , label = 'LDA yearly' ) #Labels plt . xlabel ( 'Year' ) plt . ylabel ( 'Prediction Accuracy' ) plt . legend ( loc = 'upper left' , bbox_to_anchor = ( 1 , 1 )) # legend upper left outside plt . title ( 'Overall predictive accuracy of LDA models' ) plt . xticks ( years + width + 0.125 , years ); # set x-ticks spacing plt . axhline ( ldatrain , 0 , 1 , color = \"red\" , label = \"LDA 2000\" ) Out[11]: Compared to training a model once and using it repeatedly, training the Q/LDA yearly performs better in terms of predictive accuracy. It isn't significantly more expensive though. Note: Why LDA and not QDA? Well since we've already observed that the distributions of data within the three classes are very simliar (in terms of shape) we can assume that the covariance matrices for all three classes will be the same - hence our model is LDA rather than QDA Conclusions: Based on the data visualization from the first 5 years, it's clear that while the class proportions are changing, the class distributions are not (the center and shape of the three classes are constant through time). Thus, updating our LDA on a yearly basis is simple, as this just requires us to adjust our estimates of the class proportions $\\pi$. Part 2: Geographic patterns in urban demographics In dataset_2.txt and dataset_3.txt you have the demographic information for a random sample of houses in two regions in Kevinsville. There are only two economic brackets for the households in these datasets: 0: low-income or middle-class, 1: high-income. The data for each region is shown in the visualizations below. In [12]: fig , ax = plt . subplots ( 1 , 2 , figsize = ( 10 , 3 )) data = np . loadtxt ( '../data/dataset_2.txt' ) x = data [:, 0 : - 1 ] y = data [:, - 1 ] # Plot data ax [ 0 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'b' , alpha = 0.2 ) ax [ 0 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'r' , alpha = 0.2 ) # Label axes, set title ax [ 0 ] . set_title ( 'dataset_2' ) ax [ 0 ] . set_xlabel ( 'Latitude' ) ax [ 0 ] . set_ylabel ( 'Longitude' ) data = np . loadtxt ( 'data/dataset_3.txt' ) x = data [:, 0 : - 1 ] y = data [:, - 1 ] # Plot data ax [ 1 ] . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], color = 'b' , alpha = 0.2 ) ax [ 1 ] . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], color = 'r' , alpha = 0.2 ) # Label axes, set title ax [ 1 ] . set_title ( 'dataset_3' ) ax [ 1 ] . set_xlabel ( 'Latitude' ) ax [ 1 ] . set_ylabel ( 'Longitude' ) plt . show () EXERCISE: For each region, comment on the appropriateness of using KNN for classification. Below is code for visualizing decision boundaries. In [27]: #-------- plot_decision_boundary # A function that visualizes the data and the decision boundaries # Input: # x (predictors) # y (labels) # poly_flag (a boolean parameter, fits quadratic model if true, otherwise linear) # title (title for plot) # ax (a set of axes to plot on) # Returns: # ax (axes with data and decision boundaries) def plot_decision_boundary ( x , y , model , poly_flag , title , ax ): # Plot data ax . scatter ( x [ y == 1 , 0 ], x [ y == 1 , 1 ], c = 'red' , label = 'Normal' , cmap = plt . cm . coolwarm , alpha = 0.2 , s = 20 ) ax . scatter ( x [ y == 0 , 0 ], x [ y == 0 , 1 ], c = 'blue' , label = 'Normal' , cmap = plt . cm . coolwarm , alpha = 0.2 , s = 20 ) # Create mesh interval = np . arange ( 0 , 1 , 0.01 ) n = np . size ( interval ) x1 , x2 = np . meshgrid ( interval , interval ) x1 = x1 . reshape ( - 1 , 1 ) x2 = x2 . reshape ( - 1 , 1 ) xx = np . concatenate (( x1 , x2 ), axis = 1 ) # Predict on mesh points if ( poly_flag ): quad_features = preprocessing . PolynomialFeatures ( degree = 2 ) xx = quad_features . fit_transform ( xx ) yy = model . predict ( xx ) yy = yy . reshape (( n , n )) # Plot decision surface x1 = x1 . reshape ( n , n ) x2 = x2 . reshape ( n , n ) ax . contourf ( x1 , x2 , yy , cmap = plt . cm . coolwarm , alpha = 0.1 ) # Label axes, set title ax . set_title ( title ) ax . set_xlabel ( 'Latitude' ) ax . set_ylabel ( 'Longitude' ) return ax In [28]: #-------- fit_and_plot_models # A function that visualizes the data and the decision boundaries # Input: # file_name (name of the file containing dataset) # Returns: # None def fit_and_plot_models ( file_name ): data = np . loadtxt ( file_name ) x = data [:, 0 : - 1 ] y = data [:, - 1 ] fig , ax = plt . subplots ( 1 , 4 , figsize = ( 15 , 3 )) # Plain Logistic Regression logreg = linear_model . LogisticRegression () logreg . fit ( x , y ) acc_logreg = logreg . score ( x , y ) str_title = 'LogReg (acc = ' + str ( acc_logreg ) + ')' ax [ 0 ] = plot_decision_boundary ( x , y , logreg , False , str_title , ax [ 0 ]) # LDA lda = da . LinearDiscriminantAnalysis () lda . fit ( x , y ) acc_lda = lda . score ( x , y ) str_title = 'LDA (acc = ' + str ( acc_lda ) + ')' ax [ 1 ] = plot_decision_boundary ( x , y , lda , False , str_title , ax [ 1 ]) # QDA qda = da . QuadraticDiscriminantAnalysis () qda . fit ( x , y ) acc_qda = qda . score ( x , y ) str_title = 'QDA (acc = ' + str ( acc_qda ) + ')' ax [ 2 ] = plot_decision_boundary ( x , y , qda , False , str_title , ax [ 2 ]) # Logistic Regression with Quadratic Terms quad_features = preprocessing . PolynomialFeatures ( degree = 2 ) x_expanded = quad_features . fit_transform ( x ) logreg_poly = linear_model . LogisticRegression ( C = 1000 ) logreg_poly . fit ( x_expanded , y ) acc_logreg_poly = logreg_poly . score ( x_expanded , y ) str_title = 'LogReg-poly (acc = ' + str ( acc_logreg_poly ) + ')' ax [ 3 ] = plot_decision_boundary ( x , y , logreg_poly , True , str_title , ax [ 3 ]) plt . tight_layout () plt . show () EXERCISE: Choose between Q/LDA and logistic regression by visualizing various types decision boundaries. Discuss. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-8/student/"},{"title":"Lecture 0: Data Science Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 0: Data Science Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [5]: import pandas as pd import sys import numpy as np import scipy as sp import matplotlib.pyplot as plt from math import radians , cos , sin , asin , sqrt import datetime from sklearn.linear_model import LinearRegression import seaborn as sns sns . set ( style = \"ticks\" ) % matplotlib inline Download the data from https://drive.google.com/open?id=0B28c493CP9GtMzN1emFoMkJNNlU First Look At The Data In [6]: hubway_data_file = '~/Downloads/hubway_data/hubway_trips.csv' hubway_data = pd . read_csv ( hubway_data_file , low_memory = False ) hubway_data . head () Out[6]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } seq_id hubway_id status duration start_date strt_statn end_date end_statn bike_nr subsc_type zip_code birth_date gender 0 1 8 Closed 9 7/28/2011 10:12:00 23.0 7/28/2011 10:12:00 23.0 B00468 Registered '97217 1976.0 Male 1 2 9 Closed 220 7/28/2011 10:21:00 23.0 7/28/2011 10:25:00 23.0 B00554 Registered '02215 1966.0 Male 2 3 10 Closed 56 7/28/2011 10:33:00 23.0 7/28/2011 10:34:00 23.0 B00456 Registered '02108 1943.0 Male 3 4 11 Closed 64 7/28/2011 10:35:00 23.0 7/28/2011 10:36:00 23.0 B00554 Registered '02116 1981.0 Female 4 5 12 Closed 12 7/28/2011 10:37:00 23.0 7/28/2011 10:37:00 23.0 B00554 Registered '97214 1983.0 Female Who? In [7]: year_to_age = lambda s : 0 if 'N' in s else 2017 - int ( s ) In [8]: fig , ax = plt . subplots ( 1 , 2 , figsize = ( 15 , 6 )) gender_counts = np . unique ( hubway_data [ 'gender' ] . replace ( np . nan , 'NaN' , regex = True ) . values , return_counts = True ) ax [ 0 ] . bar ( range ( 3 ), gender_counts [ 1 ], align = 'center' , color = [ 'black' , 'green' , 'teal' ], alpha = 0.5 ) ax [ 0 ] . set_xticks ([ 0 , 1 , 2 ]) ax [ 0 ] . set_xticklabels ([ 'none' , 'male' , 'female' , ' ' ]) ax [ 0 ] . set_title ( 'Users by Gender' ) age_col = 2017.0 - hubway_data [ 'birth_date' ] . dropna () . values age_counts = np . unique ( age_col , return_counts = True ) ax [ 1 ] . bar ( age_counts [ 0 ], age_counts [ 1 ], align = 'center' , width = 0.4 , alpha = 0.6 ) ax [ 1 ] . axvline ( x = np . mean ( age_col ), color = 'red' , label = 'average age' ) ax [ 1 ] . axvline ( x = np . percentile ( age_col , 25 ), color = 'red' , linestyle = '--' , label = 'lower quartile' ) ax [ 1 ] . axvline ( x = np . percentile ( age_col , 75 ), color = 'red' , linestyle = '--' , label = 'upper quartile' ) ax [ 1 ] . set_xlim ([ 1 , 90 ]) ax [ 1 ] . set_xlabel ( 'Age' ) ax [ 1 ] . set_ylabel ( 'Number of Checkouts' ) ax [ 1 ] . legend () ax [ 1 ] . set_title ( 'Users by Age' ) plt . tight_layout () plt . savefig ( 'Who.png' , dpi = 300 ) Where In [10]: station_data = pd . read_csv ( '../data/hubway_stations.csv' , low_memory = False )[[ 'id' , 'lat' , 'lng' ]] station_data . head () Out[10]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } id lat lng 0 3 42.340021 -71.100812 1 4 42.345392 -71.069616 2 5 42.341814 -71.090179 3 6 42.361285 -71.065140 4 7 42.353412 -71.044624 In [11]: hubway_data_with_gps = hubway_data . join ( station_data . set_index ( 'id' ), on = 'strt_statn' ) hubway_data_with_gps . head () Out[11]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } seq_id hubway_id status duration start_date strt_statn end_date end_statn bike_nr subsc_type zip_code birth_date gender lat lng 0 1 8 Closed 9 7/28/2011 10:12:00 23 7/28/2011 10:12:00 23.0 B00468 Registered '97217 1976.0 Male 42.359677 -71.059364 1 2 9 Closed 220 7/28/2011 10:21:00 23 7/28/2011 10:25:00 23.0 B00554 Registered '02215 1966.0 Male 42.359677 -71.059364 2 3 10 Closed 56 7/28/2011 10:33:00 23 7/28/2011 10:34:00 23.0 B00456 Registered '02108 1943.0 Male 42.359677 -71.059364 3 4 11 Closed 64 7/28/2011 10:35:00 23 7/28/2011 10:36:00 23.0 B00554 Registered '02116 1981.0 Female 42.359677 -71.059364 4 5 12 Closed 12 7/28/2011 10:37:00 23 7/28/2011 10:37:00 23.0 B00554 Registered '97214 1983.0 Female 42.359677 -71.059364 When In [12]: check_out_hours = hubway_data [ 'start_date' ] . apply ( lambda s : int ( s [ - 8 : - 6 ])) In [13]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 5 )) check_out_counts = np . unique ( check_out_hours , return_counts = True ) ax . bar ( check_out_counts [ 0 ], check_out_counts [ 1 ], align = 'center' , width = 0.4 , alpha = 0.6 ) ax . set_xlim ([ - 1 , 24 ]) ax . set_xticks ( range ( 24 )) ax . set_xlabel ( 'Hour of Day' ) ax . set_ylabel ( 'Number of Checkouts' ) ax . set_title ( 'Time of Day vs Checkouts' ) plt . show () How In [14]: def haversine ( pt , lat2 = 42.355589 , lon2 =- 71.060175 ): \"\"\" Calculate the great circle distance between two points on the earth (specified in decimal degrees) \"\"\" lon1 = pt [ 0 ] lat1 = pt [ 1 ] # convert decimal degrees to radians lon1 , lat1 , lon2 , lat2 = map ( radians , [ lon1 , lat1 , lon2 , lat2 ]) # haversine formula dlon = lon2 - lon1 dlat = lat2 - lat1 a = sin ( dlat / 2 ) ** 2 + cos ( lat1 ) * cos ( lat2 ) * sin ( dlon / 2 ) ** 2 c = 2 * asin ( sqrt ( a )) r = 3956 # Radius of earth in miles return c * r In [15]: station_counts = np . unique ( hubway_data_with_gps [ 'strt_statn' ] . dropna (), return_counts = True ) counts_df = pd . DataFrame ({ 'id' : station_counts [ 0 ], 'checkouts' : station_counts [ 1 ]}) counts_df = counts_df . join ( station_data . set_index ( 'id' ), on = 'id' ) counts_df . head () Out[15]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } checkouts id lat lng 0 9734 3 42.340021 -71.100812 1 18058 4 42.345392 -71.069616 2 10630 5 42.341814 -71.090179 3 23322 6 42.361285 -71.065140 4 9163 7 42.353412 -71.044624 In [16]: counts_df . loc [:, 'dist_to_center' ] = list ( map ( haversine , counts_df [[ 'lng' , 'lat' ]] . values )) counts_df . head () Out[16]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } checkouts id lat lng dist_to_center 0 9734 3 42.340021 -71.100812 2.335706 1 18058 4 42.345392 -71.069616 0.853095 2 10630 5 42.341814 -71.090179 1.802423 3 23322 6 42.361285 -71.065140 0.467803 4 9163 7 42.353412 -71.044624 0.807582 In [17]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 5 )) ax . scatter ( counts_df [ 'dist_to_center' ] . values , counts_df [ 'checkouts' ] . values ) reg_line = LinearRegression () reg_line . fit ( counts_df [ 'dist_to_center' ] . values . reshape (( len ( counts_df [ 'dist_to_center' ]), 1 )), counts_df [ 'checkouts' ] . values ) distances = np . linspace ( counts_df [ 'dist_to_center' ] . min (), counts_df [ 'dist_to_center' ] . max (), 50 ) ax . plot ( distances , reg_line . predict ( distances . reshape (( len ( distances ), 1 ))), color = 'red' , label = 'Regression Line' ) ax . set_xlabel ( 'Distance to City Center (Miles)' ) ax . set_ylabel ( 'Number of Checkouts' ) ax . set_title ( 'Distance to City Center vs Checkouts' ) ax . legend () plt . savefig ( 'How.png' , dpi = 300 ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-0/demo/"},{"title":"Lecture 2: Data Engineering Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lecture2, Notebook: Pandas, and the Grammar of Data (created with Rahul Dave for cs109) Harvard University Summer 2018 Instructors: Pavlos Protopapas and Kevin Rader In [3]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[3]: h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } We'd like a data structure that: can represent the columns in the data by their name has a structure that can easily store variables of different types that stores column names, and that we can reference by column name as well as by indexed position and it would be nice if this data structure came with built-in functions that we can use to manipulate it. Pandas is a package/library that does all of this! The library is built on top of numpy. There are two basic pandas objects, series and dataframes , which can be thought of as enhanced versions of 1D and 2D numpy arrays, respectively. Indeed Pandas attempts to keep all the efficiencies that numpy gives us. For reference, here is a useful pandas cheat sheet and the pandas documentation . The basic EDA workflow Below is a basic checklist for the early stages of exploratory data analysis in Python. While not universally applicable, the rubric covers patterns which recur in several data analysis contexts, so useful to keep it in mind when encountering a new dataset. The basic workflow (enunciated in this form by Chris Beaumont) is as follows: Build a Dataframe from the data (ideally, put all data in this object) Clean the Dataframe. It should have the following properties: Each row describes a single object Each column describes a property of that object Columns are numeric whenever appropriate Columns contain atomic properties that cannot be further decomposed Explore global properties . Use histograms, scatter plots, and aggregation functions to summarize the data. Explore group properties . Use groupby, queries, and small multiples to compare subsets of the data. This process transforms the data into a format which is easier to work with, gives you a basic overview of the data's properties, and likely generates several questions for you to follow-up on in subsequent analysis. In [4]: # The %... is an iPython thing, and is not part of the Python language. # In this case we're just telling the plotting library to draw things on # the notebook, instead of on a separate window. % matplotlib inline # See all the \"as ...\" contructs? They're just aliasing the package names. # That way we can call methods like plt.plot() instead of matplotlib.pyplot.plot(). import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd import time pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"poster\" ) Building a dataframe The easiest way to build a dataframe is simply to read in a CSV file. We WILL see an example of this here, and we shall see more examples in labs. We'll also see how we may combine multiple data sources into a larger dataframe. This example is adapted from: https://github.com/tthibo/SQL-Tutorial The first 3 lines of the file ( !head -3 data/candidates.txt on mac/unix) look like this. id|first_name|last_name|middle_name|party 33|Joseph|Biden||D 36|Samuel|Brownback||R In [8]: dfcand = pd . read_csv ( \"../data/candidates.txt\" , sep = '|' ) dfcand . head ( 10 ) Out[8]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } id first_name last_name middle_name party 0 33 Joseph Biden NaN D 1 36 Samuel Brownback NaN R 2 34 Hillary Clinton R. D 3 39 Christopher Dodd J. D 4 26 John Edwards NaN D 5 22 Rudolph Giuliani NaN R 6 24 Mike Gravel NaN D 7 16 Mike Huckabee NaN R 8 30 Duncan Hunter NaN R 9 31 Dennis Kucinich NaN D A pandas dataframe is a set of columns pasted together into a spreadsheet, as shown in the schematic below, which is taken from the cheatsheet above. The columns in pandas are called series objects. In [7]: #All the columns in this dataframe: dfcand . columns Out[7]: Index(['id', 'first_name', 'last_name', 'middle_name', 'party'], dtype='object') And the types of these columns: In [37]: dfcand . dtypes Out[37]: id int64 first_name object last_name object middle_name object party object dtype: object Access to a particular column can be obtained by treating the column name as an \"attribute\" of the dataframe: In [12]: type ( dfcand [ 'first_name' ]) Out[12]: pandas.core.series.Series But Pandas supports a dictionary like access to columns. This is very useful when column names have spaces: Python variables cannot have spaces in them. In [14]: dfcand [[ 'middle_name' , 'first_name' ]] Out[14]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } middle_name first_name 0 NaN Joseph 1 NaN Samuel 2 R. Hillary 3 J. Christopher 4 NaN John 5 NaN Rudolph 6 NaN Mike 7 NaN Mike 8 NaN Duncan 9 NaN Dennis 10 NaN John 11 NaN Barack 12 NaN Ron 13 NaN Bill 14 NaN Mitt 15 NaN Tom 16 D. Fred We can also get sub-dataframes by choosing a set of series. We pass a list of the columns we want as \"dictionary keys\" to the dataframe. In [40]: columns_i_want = [ 'first_name' , 'last_name' ] dfcand [[ 'first_name' , 'last_name' ]] #dfcand[columns_i_want] Out[40]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } first_name last_name 0 Joseph Biden 1 Samuel Brownback 2 Hillary Clinton 3 Christopher Dodd 4 John Edwards 5 Rudolph Giuliani 6 Mike Gravel 7 Mike Huckabee 8 Duncan Hunter 9 Dennis Kucinich 10 John McCain 11 Barack Obama 12 Ron Paul 13 Bill Richardson 14 Mitt Romney 15 Tom Tancredo 16 Fred Thompson Categoricals Even though party is a string, it takes on only a finite set of values, 'D', and 'R'. We can model this: In [15]: dfcand . party . unique () Out[15]: array(['D', 'R'], dtype=object) In [16]: dfcand . dtypes dfcand [ 'party' ] = dfcand [ 'party' ] . astype ( \"category\" ) In [17]: dfcand . dtypes Out[17]: id int64 first_name object last_name object middle_name object party category dtype: object In [44]: dfcand . head () Out[44]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } id first_name last_name middle_name party 0 33 Joseph Biden NaN D 1 36 Samuel Brownback NaN R 2 34 Hillary Clinton R. D 3 39 Christopher Dodd J. D 4 26 John Edwards NaN D In [20]: type ( dfcand . party [ 0 ]) Out[20]: str In [46]: dfcand . party . cat . categories Out[46]: Index(['D', 'R'], dtype='object') In [47]: dfcand . party . cat . ordered Out[47]: False Keep in mind that this is a relatively new feature of Pandas. You dont need to do this, but might find it useful to keep your types straight. Using categoricals in machine learning algorithms is more complex and usually involves a process called One Hot Encoding (more on this in the coming labs) Another piece of data This is a file of people who have contributed money to candidates: ( !head -3 data/contributors_with_candidate_id.txt ) id|last_name|first_name|middle_name|street_1|street_2|city|state|zip|amount|date|candidate_id |Agee|Steven||549 Laurel Branch Road||Floyd|VA|24091|500.00|2007-06-30|16 |Ahrens|Don||4034 Rennellwood Way||Pleasanton|CA|94566|250.00|2007-05-16|16 In [21]: dfcwci = pd . read_csv ( \"../data/contributors_with_candidate_id.txt\" , sep = \"|\" ) dfcwci . head () Out[21]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } id last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 NaN Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 1 NaN Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 2 NaN Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 3 NaN Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 4 NaN Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 Cleaning Data Most of the techniques you will learn about in Pandas are all about getting data in a form that can be used for further analysis. Cleaning usually means: dealing with missing values, transforming types appropriately, and taking care of data integrity. But we'll lump everything required to transform data to a form appropriate for analysis cleaning , even if what we are doing is for example, combining multiple data sets, or producing processed data from raw data. Lets start with some regular cleaning! In [49]: dfcwci . head () Out[49]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } id last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 NaN Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 1 NaN Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 2 NaN Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 3 NaN Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 4 NaN Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 In [22]: del dfcwci [ 'id' ] dfcwci . head () Out[22]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 1 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 3 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 We can see the size of our data In [51]: dfcwci . shape , dfcand . shape Out[51]: ((175, 11), (17, 5)) We will do some more cleaning soon but let us see the EDA process as sliced from another angle: data transformation, used both for cleaning and for seeing single column and multiple column properties in the data. Data transformation: Single Table Verbs Let us now focus on core data manipulation commands. These are universal across systems, and by identifying them, we can quickly ask how to do these when we encounter a new system. See https://gist.github.com/TomAugspurger/6e052140eaa5fdb6e8c0/ which has a comparison of dplyr and pandas. I stole and modified this table from there: dplyr has a small set of nicely defined verbs, which Hadley Wickham has used to identify core data manipulation commands. Here are listed the closest SQL and Pandas verbs, so we can see the universality of these manipulations. VERB dplyr pandas SQL QUERY/SELECTION filter() (and slice()) query() (and loc[], iloc[]) SELECT WHERE SORT arrange() sort() ORDER BY SELECT-COLUMNS/PROJECTION select() (and rename()) [](__getitem__) (and rename()) SELECT COLUMN SELECT-DISTINCT distinct() unique(),drop_duplicates() SELECT DISTINCT COLUMN ASSIGN mutate() (and transmute()) assign ALTER/UPDATE AGGREGATE summarise() describe(), mean(), max() None, AVG(),MAX() SAMPLE sample_n() and sample_frac() sample() implementation dep, use RAND() GROUP-AGG group_by/summarize groupby/agg, count, mean GROUP BY DELETE ? drop/masking DELETE/WHERE We'll tackle these one by one in Pandas, since these are data manipulations you will do all the time. QUERY In [52]: dfcwci . amount < 400 Out[52]: 0 False 1 True 2 True 3 True 4 True 5 False 6 False 7 True 8 False 9 False 10 False 11 False 12 True 13 False 14 True 15 False 16 False 17 True 18 True 19 False 20 False 21 False 22 True 23 False 24 False 25 True 26 True 27 True 28 False 29 True ... 145 True 146 True 147 True 148 True 149 True 150 False 151 True 152 True 153 True 154 True 155 False 156 False 157 True 158 True 159 False 160 True 161 True 162 True 163 False 164 False 165 True 166 True 167 True 168 False 169 False 170 True 171 False 172 True 173 False 174 False Name: amount, Length: 175, dtype: bool This gives us Trues and Falses. Such a series is called a mask . A mask is the basis of filtering. We can do: In [53]: dfcwci [ dfcwci . amount < 400 ] . head () Out[53]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 1 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 3 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 7 Aldridge Brittni NaN 808 Capitol Square Place, SW NaN Washington DC 20024 250.0 2007-06-06 16 Notice that the dataframe has been filtered down to only include those contributions with amount < 400. The rows with False in the mask have been eliminated, and those with True in the mask have been kept. In [54]: np . sum ( dfcwci . amount < 400 ), np . mean ( dfcwci . amount < 400 ) Out[54]: (132, 0.75428571428571434) Why did that work? The booleans are coerced to integers as below: In [55]: 1 * True , 1 * False Out[55]: (1, 0) Or directly, in Pandas, which works since the comparison is a pandas Series. In [56]: ( dfcwci . amount < 400 ) . mean () Out[56]: 0.75428571428571434 In [57]: dfcwci . describe () Out[57]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } zip amount candidate_id count 1.750000e+02 175.000000 175.000000 mean 3.780014e+08 3.418114 28.000000 std 3.628278e+08 1028.418999 7.823484 min 2.474000e+03 -2592.000000 16.000000 25% 9.336700e+04 -175.000000 20.000000 50% 3.233313e+08 100.000000 32.000000 75% 7.816946e+08 300.000000 35.000000 max 9.951532e+08 4600.000000 37.000000 You can combine queries. Note that we use Python's & operator instead of and . This is because we are \"Boolean AND\"ing masks to get a series of True's And Falses. In [58]: dfcwci [( dfcwci . state == 'VA' ) & ( dfcwci . amount < 400 )] Out[58]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 27 Buckheit Bruce NaN 8904 KAREN DR NaN FAIRFAX VA 220312731 100.00 2007-09-19 20 77 Ranganath Anoop NaN 2507 Willard Drive NaN Charlottesville VA 22903 -100.00 2008-04-21 32 88 Perreault Louise NaN 503 Brockridge Hunt Drive NaN Hampton VA 23666 -34.08 2008-04-21 32 145 ABDELLA THOMAS M. 4231 MONUMENT WALL WAY #340 NaN FAIRFAX VA 220308440 50.00 2007-09-30 35 Here is another way to write the query: In [29]: dfcwci [( dfcwci . amount < 0 )] Out[29]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 29 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 -2300.00 2007-08-14 20 40 Buchanan John NaN 2025 NW 29th Rd NaN Boca Raton FL 334316303 -500.00 2007-09-24 20 43 Buchanan John NaN 2025 NW 29th Rd NaN Boca Raton FL 334316303 -700.00 2007-08-28 20 50 BYNUM HERBERT NaN 332 SUNNYSIDE ROAD NaN TAMPA FL 336177249 -500.00 2008-03-10 22 51 BYINGTON MARGARET E. 2633 MIDDLEBORO LANE N.E. NaN GRAND RAPIDS MI 495061254 -2300.00 2008-03-03 22 52 BYERS BOB A. 13170 TELFAIR AVENUE NaN SYLMAR CA 913423573 -2300.00 2008-03-07 22 53 BYERS AUDREY NaN 2658 LADBROOK WAY NaN THOUSAND OAKS CA 913615073 -200.00 2008-03-07 22 54 BUSH KRYSTIE NaN P.O. BOX 61046 NaN DENVER CO 802061046 -2300.00 2008-03-06 22 55 BUSH ERIC NaN P.O. BOX 61046 NaN DENVER CO 802061046 -2300.00 2008-03-06 22 56 BURTON SUSAN NaN 9338 DEER CREEK DRIVE NaN TAMPA FL 336472286 -2300.00 2008-03-05 22 57 BURTON STEVEN G. 9938 DEER CREEK DRIVE NaN TAMPA FL 33647 -2300.00 2008-03-05 22 58 BURTON GLENN M. 4404 CHARLESTON COURT NaN TAMPA FL 336092620 -2300.00 2008-03-05 22 59 BURKHARDT CRAIG S. 910 15TH STREET N.W. NaN WASHINGTON DC 200052503 -500.00 2008-03-07 22 60 BURKHARDT CRAIG S. 910 15TH STREET N.W. NaN WASHINGTON DC 200052503 -1000.00 2008-03-07 22 61 BURKHARDT BARBARA NaN 910 15TH STREET N.W. NaN WASHINGTON DC 200052503 -500.00 2008-03-07 22 62 BURKE SUZANNE M. 3401 EVANSTON NaN SEATTLE WA 981038677 -700.00 2008-03-05 22 63 BURKE GAIL NaN 165 E. 32ND STREET APARTMENT 9E NEW YORK NY 100166014 -2000.00 2008-03-05 22 64 BURKE DONALD J. 12 LOMPOC NaN RANCHO SANTA MARGA CA 926881817 -2300.00 2008-03-11 22 65 BURGERT RONALD L. 5723 PLUMTREE DRIVE NaN DALLAS TX 752524926 -1000.00 2008-03-05 22 66 BULL BARTLE B. 439 E. 51ST STREET NaN NEW YORK NY 100226473 -800.00 2008-03-10 22 67 BULL BARTLE B. 439 E. 51ST STREET NaN NEW YORK NY 100226473 -1000.00 2008-03-10 22 68 BUKOWSKI DANIEL J. 702 S. WRIGHT STREET NaN NAPERVILLE IL 605406736 -100.00 2008-03-10 22 69 BUISSON MARGARET A. P.O. BOX 197029 NaN LOUISVILLE KY 402597029 -200.00 2008-03-11 22 70 BUCKLEY WALTER W. 1635 COUNTRY ROAD NaN BETHLEHEM PA 180155718 -100.00 2008-03-05 22 71 BUCKLEY MARJORIE B. 1635 COUNTRY ROAD NaN BETHLEHEM PA 180155718 -100.00 2008-03-05 22 72 BRUNO JOHN NaN 10136 WINDERMERE CHASE BLVD. NaN GOTHA FL 347344707 -2300.00 2008-03-06 22 73 BRUNO IRENE NaN 10136 WINDERMERE CHASE BLVD. NaN GOTHA FL 347344707 -2300.00 2008-03-06 22 74 BROWN TIMOTHY J. 26826 MARLOWE COURT NaN STEVENSON RANCH CA 913811020 -2300.00 2008-03-06 22 75 Schuff Bryan NaN 1700 W Sweden Rd NaN Brockport NY 14420 -25.00 2008-08-22 32 76 Hobbs James NaN 229 Cherry Lane NaN White House TN 37188 -25.00 2008-08-19 32 77 Ranganath Anoop NaN 2507 Willard Drive NaN Charlottesville VA 22903 -100.00 2008-04-21 32 78 Nystrom Michael A 93A Fairmont Street NaN Arlington MA 2474 -503.00 2008-04-21 32 79 Muse Nina Jo 2915 Toro Canyon Rd NaN Austin TX 78746 -50.00 2008-04-21 32 80 Waddell James L. 1823 Spel Lane SW NaN Rochester MN 55902 -28.00 2008-04-21 32 81 Brucks William C. PO Box 391 NaN Corona del Mar CA 92625 -150.00 2008-04-21 32 82 Kuehn David NaN 14502 West 93rd Street NaN Lenexa KS 66215 -330.00 2008-04-21 32 83 Verster Jeanette M. 7220 SW 61st St NaN Miami FL 331431807 -1000.00 2008-04-21 32 84 Uihlein Richard NaN 1396 N Waukegan Rd NaN Lake Forest IL 600451147 -2300.00 2008-04-21 32 85 Eskenberry Robert P 10960 Gray Cir NaN Westminster CO 80020 -223.00 2008-04-21 32 86 Froehling Alan L. 302 Broadway St NaN Mount Vernon IL 628645116 -844.80 2008-04-21 32 87 Duryea Marcia A. 123 Bayview Ave NaN Amityville NY 11701 -299.50 2008-04-21 32 88 Perreault Louise NaN 503 Brockridge Hunt Drive NaN Hampton VA 23666 -34.08 2008-04-21 32 89 Rozenfeld Timur NaN 57 Herbert Road NaN Robbinsville NJ 8691 -777.95 2008-04-21 32 90 Kazor Christopher M 707 Spindletree ave NaN Naperville IL 60565 -2592.00 2008-04-21 32 91 Lehner Thomas S. 2701 Star Lane NaN Wadsworth OH 44281 -200.00 2008-04-21 32 92 Plummer Joseph NaN 587 Blake Hill Rd NaN New Hampton NH 32564424 -24.60 2008-04-21 32 93 Raught Philip M 4714 Plum Way NaN Pittsburgh PA 15201 -1046.00 2008-04-21 32 94 Ferrara Judith D 1508 Waterford Road NaN Yardley PA 19067 -1100.00 2008-04-21 32 95 Johnson Cathleen E. 1003 Justin Ln Apt 2016 NaN Austin TX 787572648 -14.76 2008-04-21 32 96 Sanford Bradley NaN 940 Post St #43 NaN San Francisco CA 94109 -24.53 2008-04-21 32 97 Gaarder Bruce NaN PO Box 4085 NaN Mountain Home AFB ID 83648 -261.00 2008-04-21 32 98 Choe Hyeokchan NaN 207 Bridle Way NaN Fort Lee NJ 70246302 -39.50 2008-04-21 32 99 Jacobs Richard G. 14337 Tawya Rd NaN Apple Valley CA 923075545 -1000.00 2008-04-21 32 110 Reid Elizabeth NaN 73 W Patent Rd OPHIR FARM NORTH Bedford Hills NY 105072222 -350.00 2008-08-28 34 111 Reich Thomas NaN 499 Park Ave NaN New York NY 100221240 -2300.00 2008-08-28 34 125 BOURNE TRAVIS NaN LAGE KAART 77 NaN BRASSCHATT NaN 2930 -500.00 2008-11-20 35 126 SECRIST BRIAN L. 3 MULE DEER TRAIL NaN LITTLETON CO 801275722 -1000.00 2008-04-07 35 127 TOLLESTRUP TRAVIS W. 16331 WINECREEK RD. NaN SAN DIEGO CA 92127 -1000.00 2008-05-15 35 In [30]: dfcwci [( dfcwci [ 'last_name' ] == 'BYERS' )] Out[30]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 52 BYERS BOB A. 13170 TELFAIR AVENUE NaN SYLMAR CA 913423573 -2300.0 2008-03-07 22 53 BYERS AUDREY NaN 2658 LADBROOK WAY NaN THOUSAND OAKS CA 913615073 -200.0 2008-03-07 22 For cleaning, we might want to use this querying ability In [60]: dfcwci [ dfcwci . state . isnull ()] Out[60]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 125 BOURNE TRAVIS NaN LAGE KAART 77 NaN BRASSCHATT NaN 2930 -500.0 2008-11-20 35 Or the opposite, which is probably more useful in making the selection: In [61]: dfcwci [ dfcwci . state . notnull ()] . head () Out[61]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 1 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 3 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 For categoricals you can use isin . You can use Boolean not on the mask to implement not in. In [62]: dfcwci [ dfcwci . state . isin ([ 'VA' , 'WA' ])] . head ( 10 ) Out[62]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.00 2007-06-30 16 27 Buckheit Bruce NaN 8904 KAREN DR NaN FAIRFAX VA 220312731 100.00 2007-09-19 20 62 BURKE SUZANNE M. 3401 EVANSTON NaN SEATTLE WA 981038677 -700.00 2008-03-05 22 77 Ranganath Anoop NaN 2507 Willard Drive NaN Charlottesville VA 22903 -100.00 2008-04-21 32 88 Perreault Louise NaN 503 Brockridge Hunt Drive NaN Hampton VA 23666 -34.08 2008-04-21 32 100 Aaronson Rebecca NaN 2000 Village Green Dr Apt 12 NaN Mill Creek WA 980125787 100.00 2008-02-08 34 106 Aaronson Rebecca NaN 2000 Village Green Dr Apt 12 NaN Mill Creek WA 980125787 100.00 2008-02-14 34 145 ABDELLA THOMAS M. 4231 MONUMENT WALL WAY #340 NaN FAIRFAX VA 220308440 50.00 2007-09-30 35 And you can chain queries thus. In [63]: dfcwci . query ( \"10 <= amount <= 50\" ) . head ( 10 ) Out[63]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 18 Ardle William NaN 412 Dakota Avenue NaN Springfield OH 45504 50.0 2007-06-28 16 25 Buckler Steve NaN 24351 Armada Dr NaN Dana Point CA 926291306 50.0 2007-07-30 20 26 Buckler Steve NaN 24351 Armada Dr NaN Dana Point CA 926291306 25.0 2007-08-16 20 34 Buck Barbara NaN 1780 NE 138th St NaN North Miami FL 331811316 50.0 2007-09-13 20 35 Buck Barbara NaN 1780 NE 138th St NaN North Miami FL 331811316 50.0 2007-07-19 20 38 Buchanek Elizabeth NaN 7917 Kentbury Dr NaN Bethesda MD 208144615 50.0 2007-09-30 20 49 Harrison Ryan NaN 2247 3rd St NaN La Verne CA 917504918 25.0 2007-07-26 20 101 Aarons Elaine NaN 481 Buck Island Rd Apt 17A APT 17A West Yarmouth MA 26733300 25.0 2008-02-26 34 104 Aaron Shirley NaN 101 Cherry Ave NaN Havana FL 323331311 50.0 2008-02-29 34 SORT In [64]: dfcwci . sort_values ( by = \"amount\" ) . head ( 10 ) Out[64]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 90 Kazor Christopher M 707 Spindletree ave NaN Naperville IL 60565 -2592.0 2008-04-21 32 72 BRUNO JOHN NaN 10136 WINDERMERE CHASE BLVD. NaN GOTHA FL 347344707 -2300.0 2008-03-06 22 64 BURKE DONALD J. 12 LOMPOC NaN RANCHO SANTA MARGA CA 926881817 -2300.0 2008-03-11 22 73 BRUNO IRENE NaN 10136 WINDERMERE CHASE BLVD. NaN GOTHA FL 347344707 -2300.0 2008-03-06 22 74 BROWN TIMOTHY J. 26826 MARLOWE COURT NaN STEVENSON RANCH CA 913811020 -2300.0 2008-03-06 22 58 BURTON GLENN M. 4404 CHARLESTON COURT NaN TAMPA FL 336092620 -2300.0 2008-03-05 22 57 BURTON STEVEN G. 9938 DEER CREEK DRIVE NaN TAMPA FL 33647 -2300.0 2008-03-05 22 84 Uihlein Richard NaN 1396 N Waukegan Rd NaN Lake Forest IL 600451147 -2300.0 2008-04-21 32 56 BURTON SUSAN NaN 9338 DEER CREEK DRIVE NaN TAMPA FL 336472286 -2300.0 2008-03-05 22 55 BUSH ERIC NaN P.O. BOX 61046 NaN DENVER CO 802061046 -2300.0 2008-03-06 22 In [65]: dfcwci [ dfcwci . amount < 0 ] Out[65]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 29 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 -2300.00 2007-08-14 20 40 Buchanan John NaN 2025 NW 29th Rd NaN Boca Raton FL 334316303 -500.00 2007-09-24 20 43 Buchanan John NaN 2025 NW 29th Rd NaN Boca Raton FL 334316303 -700.00 2007-08-28 20 50 BYNUM HERBERT NaN 332 SUNNYSIDE ROAD NaN TAMPA FL 336177249 -500.00 2008-03-10 22 51 BYINGTON MARGARET E. 2633 MIDDLEBORO LANE N.E. NaN GRAND RAPIDS MI 495061254 -2300.00 2008-03-03 22 52 BYERS BOB A. 13170 TELFAIR AVENUE NaN SYLMAR CA 913423573 -2300.00 2008-03-07 22 53 BYERS AUDREY NaN 2658 LADBROOK WAY NaN THOUSAND OAKS CA 913615073 -200.00 2008-03-07 22 54 BUSH KRYSTIE NaN P.O. BOX 61046 NaN DENVER CO 802061046 -2300.00 2008-03-06 22 55 BUSH ERIC NaN P.O. BOX 61046 NaN DENVER CO 802061046 -2300.00 2008-03-06 22 56 BURTON SUSAN NaN 9338 DEER CREEK DRIVE NaN TAMPA FL 336472286 -2300.00 2008-03-05 22 57 BURTON STEVEN G. 9938 DEER CREEK DRIVE NaN TAMPA FL 33647 -2300.00 2008-03-05 22 58 BURTON GLENN M. 4404 CHARLESTON COURT NaN TAMPA FL 336092620 -2300.00 2008-03-05 22 59 BURKHARDT CRAIG S. 910 15TH STREET N.W. NaN WASHINGTON DC 200052503 -500.00 2008-03-07 22 60 BURKHARDT CRAIG S. 910 15TH STREET N.W. NaN WASHINGTON DC 200052503 -1000.00 2008-03-07 22 61 BURKHARDT BARBARA NaN 910 15TH STREET N.W. NaN WASHINGTON DC 200052503 -500.00 2008-03-07 22 62 BURKE SUZANNE M. 3401 EVANSTON NaN SEATTLE WA 981038677 -700.00 2008-03-05 22 63 BURKE GAIL NaN 165 E. 32ND STREET APARTMENT 9E NEW YORK NY 100166014 -2000.00 2008-03-05 22 64 BURKE DONALD J. 12 LOMPOC NaN RANCHO SANTA MARGA CA 926881817 -2300.00 2008-03-11 22 65 BURGERT RONALD L. 5723 PLUMTREE DRIVE NaN DALLAS TX 752524926 -1000.00 2008-03-05 22 66 BULL BARTLE B. 439 E. 51ST STREET NaN NEW YORK NY 100226473 -800.00 2008-03-10 22 67 BULL BARTLE B. 439 E. 51ST STREET NaN NEW YORK NY 100226473 -1000.00 2008-03-10 22 68 BUKOWSKI DANIEL J. 702 S. WRIGHT STREET NaN NAPERVILLE IL 605406736 -100.00 2008-03-10 22 69 BUISSON MARGARET A. P.O. BOX 197029 NaN LOUISVILLE KY 402597029 -200.00 2008-03-11 22 70 BUCKLEY WALTER W. 1635 COUNTRY ROAD NaN BETHLEHEM PA 180155718 -100.00 2008-03-05 22 71 BUCKLEY MARJORIE B. 1635 COUNTRY ROAD NaN BETHLEHEM PA 180155718 -100.00 2008-03-05 22 72 BRUNO JOHN NaN 10136 WINDERMERE CHASE BLVD. NaN GOTHA FL 347344707 -2300.00 2008-03-06 22 73 BRUNO IRENE NaN 10136 WINDERMERE CHASE BLVD. NaN GOTHA FL 347344707 -2300.00 2008-03-06 22 74 BROWN TIMOTHY J. 26826 MARLOWE COURT NaN STEVENSON RANCH CA 913811020 -2300.00 2008-03-06 22 75 Schuff Bryan NaN 1700 W Sweden Rd NaN Brockport NY 14420 -25.00 2008-08-22 32 76 Hobbs James NaN 229 Cherry Lane NaN White House TN 37188 -25.00 2008-08-19 32 77 Ranganath Anoop NaN 2507 Willard Drive NaN Charlottesville VA 22903 -100.00 2008-04-21 32 78 Nystrom Michael A 93A Fairmont Street NaN Arlington MA 2474 -503.00 2008-04-21 32 79 Muse Nina Jo 2915 Toro Canyon Rd NaN Austin TX 78746 -50.00 2008-04-21 32 80 Waddell James L. 1823 Spel Lane SW NaN Rochester MN 55902 -28.00 2008-04-21 32 81 Brucks William C. PO Box 391 NaN Corona del Mar CA 92625 -150.00 2008-04-21 32 82 Kuehn David NaN 14502 West 93rd Street NaN Lenexa KS 66215 -330.00 2008-04-21 32 83 Verster Jeanette M. 7220 SW 61st St NaN Miami FL 331431807 -1000.00 2008-04-21 32 84 Uihlein Richard NaN 1396 N Waukegan Rd NaN Lake Forest IL 600451147 -2300.00 2008-04-21 32 85 Eskenberry Robert P 10960 Gray Cir NaN Westminster CO 80020 -223.00 2008-04-21 32 86 Froehling Alan L. 302 Broadway St NaN Mount Vernon IL 628645116 -844.80 2008-04-21 32 87 Duryea Marcia A. 123 Bayview Ave NaN Amityville NY 11701 -299.50 2008-04-21 32 88 Perreault Louise NaN 503 Brockridge Hunt Drive NaN Hampton VA 23666 -34.08 2008-04-21 32 89 Rozenfeld Timur NaN 57 Herbert Road NaN Robbinsville NJ 8691 -777.95 2008-04-21 32 90 Kazor Christopher M 707 Spindletree ave NaN Naperville IL 60565 -2592.00 2008-04-21 32 91 Lehner Thomas S. 2701 Star Lane NaN Wadsworth OH 44281 -200.00 2008-04-21 32 92 Plummer Joseph NaN 587 Blake Hill Rd NaN New Hampton NH 32564424 -24.60 2008-04-21 32 93 Raught Philip M 4714 Plum Way NaN Pittsburgh PA 15201 -1046.00 2008-04-21 32 94 Ferrara Judith D 1508 Waterford Road NaN Yardley PA 19067 -1100.00 2008-04-21 32 95 Johnson Cathleen E. 1003 Justin Ln Apt 2016 NaN Austin TX 787572648 -14.76 2008-04-21 32 96 Sanford Bradley NaN 940 Post St #43 NaN San Francisco CA 94109 -24.53 2008-04-21 32 97 Gaarder Bruce NaN PO Box 4085 NaN Mountain Home AFB ID 83648 -261.00 2008-04-21 32 98 Choe Hyeokchan NaN 207 Bridle Way NaN Fort Lee NJ 70246302 -39.50 2008-04-21 32 99 Jacobs Richard G. 14337 Tawya Rd NaN Apple Valley CA 923075545 -1000.00 2008-04-21 32 110 Reid Elizabeth NaN 73 W Patent Rd OPHIR FARM NORTH Bedford Hills NY 105072222 -350.00 2008-08-28 34 111 Reich Thomas NaN 499 Park Ave NaN New York NY 100221240 -2300.00 2008-08-28 34 125 BOURNE TRAVIS NaN LAGE KAART 77 NaN BRASSCHATT NaN 2930 -500.00 2008-11-20 35 126 SECRIST BRIAN L. 3 MULE DEER TRAIL NaN LITTLETON CO 801275722 -1000.00 2008-04-07 35 127 TOLLESTRUP TRAVIS W. 16331 WINECREEK RD. NaN SAN DIEGO CA 92127 -1000.00 2008-05-15 35 In [66]: dfcwci . sort_values ( by = \"amount\" , ascending = False ) . head ( 10 ) Out[66]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 30 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 4600.0 2007-08-14 20 159 ABATE MARIA ELENA 1291 NIGHTINGALE AVENUE NaN MIAMI SPRINGS FL 331663832 2600.0 2008-01-25 37 15 Anthony John NaN 211 Long Island Drive NaN Hot Springs AR 71913 2300.0 2007-06-12 16 33 Buck Blaine M 45 Eaton Ave NaN Camden ME 48431752 2300.0 2007-09-30 20 28 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 2300.0 2007-08-14 20 21 Baker David NaN 2550 Adamsbrooke Drive NaN Conway AR 72034 2300.0 2007-04-11 16 13 Altes R.D. NaN 8600 Moody Road NaN Fort Smith AR 72903 2300.0 2007-06-21 16 135 ABRAMOWITZ NIRA NaN 411 HARBOR ROAD NaN SOUTHPORT CT 68901376 2300.0 2007-09-14 35 5 Akin Mike NaN 181 Baywood Lane NaN Monticello AR 71655 1500.0 2007-05-18 16 174 ABRAHAM SALEM A. P.O. BOX 7 NaN CANADIAN TX 790140007 1300.0 2008-01-30 37 SELECT-COLUMNS In [67]: dfcwci [[ 'first_name' , 'amount' ]] . head ( 10 ) Out[67]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } first_name amount 0 Steven 500.0 1 Don 250.0 2 Don 50.0 3 Don 100.0 4 Charles 100.0 5 Mike 1500.0 6 Rebecca 500.0 7 Brittni 250.0 8 John D. 1000.0 9 John D. 1300.0 SELECT-DISTINCT Selecting a distinct set is useful for cleaning. Here, we might wish to focus on contributors rather than contributions and see how many distinct contributors we have. Of-course we might be wrong, some people have identical names. In [68]: dfcwci [[ 'last_name' , 'first_name' ]] . count () Out[68]: last_name 175 first_name 175 dtype: int64 In [69]: dfcwci [[ 'last_name' , 'first_name' ]] . drop_duplicates () . count () Out[69]: last_name 126 first_name 126 dtype: int64 In [70]: dfcwci [[ 'last_name' , 'first_name' ]] . drop_duplicates () . head ( 10 ) Out[70]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name 0 Agee Steven 1 Ahrens Don 4 Akin Charles 5 Akin Mike 6 Akin Rebecca 7 Aldridge Brittni 8 Allen John D. 10 Allison John W. 11 Allison Rebecca 13 Altes R.D. ASSIGN Assignment to a new column is easy. In [71]: dfcwci [ 'name' ] = dfcwci [ 'last_name' ] + \", \" + dfcwci [ 'first_name' ] dfcwci . head ( 10 ) Out[71]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id name 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 Agee, Steven 1 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 Ahrens, Don 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 Ahrens, Don 3 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 Ahrens, Don 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 Akin, Charles 5 Akin Mike NaN 181 Baywood Lane NaN Monticello AR 71655 1500.0 2007-05-18 16 Akin, Mike 6 Akin Rebecca NaN 181 Baywood Lane NaN Monticello AR 71655 500.0 2007-05-18 16 Akin, Rebecca 7 Aldridge Brittni NaN 808 Capitol Square Place, SW NaN Washington DC 20024 250.0 2007-06-06 16 Aldridge, Brittni 8 Allen John D. NaN 1052 Cannon Mill Drive NaN North Augusta SC 29860 1000.0 2007-06-11 16 Allen, John D. 9 Allen John D. NaN 1052 Cannon Mill Drive NaN North Augusta SC 29860 1300.0 2007-06-29 16 Allen, John D. In [72]: dfcwci . assign ( ucname = dfcwci . last_name + \":\" + dfcwci . first_name ) . head ( 5 ) Out[72]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id name ucname 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 Agee, Steven Agee:Steven 1 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 Ahrens, Don Ahrens:Don 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 Ahrens, Don Ahrens:Don 3 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 Ahrens, Don Ahrens:Don 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 Akin, Charles Akin:Charles In [73]: dfcwci . head () Out[73]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id name 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 Agee, Steven 1 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 Ahrens, Don 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 Ahrens, Don 3 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 Ahrens, Don 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 Akin, Charles Will the above command actually change dfcwci ? No, it produces a fresh dataframe. What if we wanted to change an existing assignment? In [43]: dfcwci [ dfcwci . state == 'VA' ] Out[43]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id name 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.00 2007-06-30 16 Agee, Steven 27 Buckheit Bruce NaN 8904 KAREN DR NaN FAIRFAX VA 220312731 100.00 2007-09-19 20 Buckheit, Bruce 77 Ranganath Anoop NaN 2507 Willard Drive NaN Charlottesville VA 22903 -100.00 2008-04-21 32 Ranganath, Anoop 88 Perreault Louise NaN 503 Brockridge Hunt Drive NaN Hampton VA 23666 -34.08 2008-04-21 32 Perreault, Louise 145 ABDELLA THOMAS M. 4231 MONUMENT WALL WAY #340 NaN FAIRFAX VA 220308440 50.00 2007-09-30 35 ABDELLA, THOMAS In [44]: dfcwci . loc [ dfcwci . state == 'VA' , 'name' ] Out[44]: 0 Agee, Steven 27 Buckheit, Bruce 77 Ranganath, Anoop 88 Perreault, Louise 145 ABDELLA, THOMAS Name: name, dtype: object In [45]: dfcwci . loc [ dfcwci . state == 'VA' , 'name' ] = \"junk\" In [46]: dfcwci . query ( \"state=='VA'\" ) Out[46]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id name 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.00 2007-06-30 16 junk 27 Buckheit Bruce NaN 8904 KAREN DR NaN FAIRFAX VA 220312731 100.00 2007-09-19 20 junk 77 Ranganath Anoop NaN 2507 Willard Drive NaN Charlottesville VA 22903 -100.00 2008-04-21 32 junk 88 Perreault Louise NaN 503 Brockridge Hunt Drive NaN Hampton VA 23666 -34.08 2008-04-21 32 junk 145 ABDELLA THOMAS M. 4231 MONUMENT WALL WAY #340 NaN FAIRFAX VA 220308440 50.00 2007-09-30 35 junk Drop-Column Real simple: In [47]: del dfcwci [ 'name' ] AGGREGATE In [48]: dfcwci . describe () Out[48]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } zip amount candidate_id count 1.750000e+02 175.000000 175.000000 mean 3.780014e+08 3.418114 28.000000 std 3.628278e+08 1028.418999 7.823484 min 2.474000e+03 -2592.000000 16.000000 25% 9.336700e+04 -175.000000 20.000000 50% 3.233313e+08 100.000000 32.000000 75% 7.816946e+08 300.000000 35.000000 max 9.951532e+08 4600.000000 37.000000 In [49]: dfcwci . amount . max () Out[49]: 4600.0 In [50]: dfcwci [ dfcwci . amount == dfcwci . amount . max ()] Out[50]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 30 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 4600.0 2007-08-14 20 In [51]: dfcwci [ dfcwci . amount > dfcwci . amount . max () - 2300 ] Out[51]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 30 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 4600.0 2007-08-14 20 159 ABATE MARIA ELENA 1291 NIGHTINGALE AVENUE NaN MIAMI SPRINGS FL 331663832 2600.0 2008-01-25 37 Grouping using Pandas and split-apply-combine In [52]: grouped_by_state = dfcwci . groupby ( \"state\" ) In [53]: grouped_by_state . amount Out[53]: How do we get access to these? Standard pandas functions distribute over the groupby , going one by one over the sub-dataframes or sub-series. This is an example of a paradigm called split-apply-combine. GROUP-AGG The fourth part of the EDA rubric is to look at properties of the sub-dataframes you get when you make groups. (We'll talk about the graphical aspects of this later). For instance, you might group contributions by state: In [54]: dfcwci . groupby ( \"state\" ) . describe () Out[54]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } amount candidate_id zip count mean std min 25% 50% 75% max count mean std min 25% 50% 75% max count mean std min 25% 50% 75% max state AK 3.0 403.333333 100.166528 300.00 355.0000 410.000 455.0000 500.0 3.0 37.000000 0.000000 37.0 37.00 37.0 37.00 37.0 3.0 9.951532e+08 0.000000e+00 995153207.0 9.951532e+08 995153207.0 9.951532e+08 995153207.0 AR 12.0 1183.333333 775.574079 100.00 875.0000 1000.000 1700.0000 2300.0 12.0 16.000000 0.000000 16.0 16.00 16.0 16.00 16.0 12.0 7.206583e+04 4.250251e+02 71603.0 7.165500e+04 72033.5 7.222700e+04 72903.0 AZ 1.0 120.000000 NaN 120.00 120.0000 120.000 120.0000 120.0 1.0 37.000000 NaN 37.0 37.00 37.0 37.00 37.0 1.0 8.600111e+08 NaN 860011121.0 8.600111e+08 860011121.0 8.600111e+08 860011121.0 CA 23.0 -217.988261 942.102438 -2300.00 -175.0000 50.000 225.0000 1000.0 23.0 26.086957 8.151481 16.0 20.00 22.0 34.50 37.0 23.0 6.407113e+08 4.333269e+08 92127.0 9.456600e+04 913811020.0 9.260504e+08 941151435.0 CO 4.0 -1455.750000 1025.166125 -2300.00 -2300.0000 -1650.000 -805.7500 -223.0 4.0 27.750000 6.751543 22.0 22.00 27.0 32.75 35.0 4.0 6.013695e+08 4.008598e+08 80020.0 6.009768e+08 801668384.0 8.020610e+08 802061046.0 CT 1.0 2300.000000 NaN 2300.00 2300.0000 2300.000 2300.0000 2300.0 1.0 35.000000 NaN 35.0 35.00 35.0 35.00 35.0 1.0 6.890138e+07 NaN 68901376.0 6.890138e+07 68901376.0 6.890138e+07 68901376.0 DC 5.0 -309.982000 529.644175 -1000.00 -500.0000 -500.000 200.0900 250.0 5.0 20.400000 2.607681 16.0 20.00 22.0 22.00 22.0 5.0 1.600684e+08 8.946976e+07 20024.0 2.000525e+08 200052503.0 2.000525e+08 200164320.0 FL 30.0 -135.000000 1177.383862 -2300.00 -500.0000 100.000 500.0000 2600.0 30.0 26.766667 7.151963 20.0 20.00 22.0 34.00 37.0 30.0 2.990209e+08 1.015776e+08 33647.0 3.233313e+08 333063809.5 3.343163e+08 347344707.0 IA 1.0 250.000000 NaN 250.00 250.0000 250.000 250.0000 250.0 1.0 16.000000 NaN 16.0 16.00 16.0 16.00 16.0 1.0 5.026600e+04 NaN 50266.0 5.026600e+04 50266.0 5.026600e+04 50266.0 ID 1.0 -261.000000 NaN -261.00 -261.0000 -261.000 -261.0000 -261.0 1.0 32.000000 NaN 32.0 32.00 32.0 32.00 32.0 1.0 8.364800e+04 NaN 83648.0 8.364800e+04 83648.0 8.364800e+04 83648.0 IL 6.0 -931.133333 1230.657981 -2592.00 -1936.2000 -472.400 12.5000 200.0 6.0 29.166667 6.645801 20.0 24.50 32.0 32.00 37.0 6.0 5.070114e+08 2.485720e+08 60565.0 6.005716e+08 603169827.0 6.062808e+08 628645116.0 KS 1.0 -330.000000 NaN -330.00 -330.0000 -330.000 -330.0000 -330.0 1.0 32.000000 NaN 32.0 32.00 32.0 32.00 32.0 1.0 6.621500e+04 NaN 66215.0 6.621500e+04 66215.0 6.621500e+04 66215.0 KY 1.0 -200.000000 NaN -200.00 -200.0000 -200.000 -200.0000 -200.0 1.0 22.000000 NaN 22.0 22.00 22.0 22.00 22.0 1.0 4.025970e+08 NaN 402597029.0 4.025970e+08 402597029.0 4.025970e+08 402597029.0 LA 2.0 650.000000 212.132034 500.00 575.0000 650.000 725.0000 800.0 2.0 37.000000 0.000000 37.0 37.00 37.0 37.00 37.0 2.0 7.030217e+08 4.242415e+06 700021823.0 7.015217e+08 703021663.5 7.045216e+08 706021504.0 MA 6.0 -13.833333 248.197838 -503.00 25.0000 47.500 92.5000 200.0 6.0 34.666667 1.966384 32.0 34.00 34.0 36.25 37.0 6.0 2.050444e+07 1.058572e+07 2474.0 1.975712e+07 25727725.0 2.673330e+07 26733300.0 MD 2.0 150.000000 141.421356 50.00 100.0000 150.000 200.0000 250.0 2.0 27.500000 10.606602 20.0 23.75 27.5 31.25 35.0 2.0 2.081438e+08 1.140563e+03 208143002.0 2.081434e+08 208143808.5 2.081442e+08 208144615.0 ME 4.0 630.000000 1113.522938 50.00 65.0000 85.000 650.0000 2300.0 4.0 30.500000 7.000000 20.0 30.50 34.0 34.00 34.0 4.0 4.141179e+07 4.679973e+06 39071806.0 3.907181e+07 39071806.0 4.141179e+07 48431752.0 MI 5.0 -253.000000 1156.630883 -2300.00 35.0000 200.000 300.0000 500.0 5.0 32.800000 6.220932 22.0 34.00 34.0 37.00 37.0 5.0 4.853947e+08 5.515168e+06 481885097.0 4.818851e+08 483862274.0 4.842798e+08 495061254.0 MN 3.0 107.333333 139.145008 -28.00 36.0000 100.000 175.0000 250.0 3.0 33.333333 1.154701 32.0 33.00 34.0 34.00 34.0 3.0 3.674463e+08 3.181694e+08 55902.0 2.755987e+08 551141508.0 5.511415e+08 551141508.0 MO 1.0 100.000000 NaN 100.00 100.0000 100.000 100.0000 100.0 1.0 20.000000 NaN 20.0 20.00 20.0 20.00 20.0 1.0 6.411100e+04 NaN 64111.0 6.411100e+04 64111.0 6.411100e+04 64111.0 NC 1.0 500.000000 NaN 500.00 500.0000 500.000 500.0000 500.0 1.0 16.000000 NaN 16.0 16.00 16.0 16.00 16.0 1.0 2.750200e+04 NaN 27502.0 2.750200e+04 27502.0 2.750200e+04 27502.0 NH 1.0 -24.600000 NaN -24.60 -24.6000 -24.600 -24.6000 -24.6 1.0 32.000000 NaN 32.0 32.00 32.0 32.00 32.0 1.0 3.256442e+07 NaN 32564424.0 3.256442e+07 32564424.0 3.256442e+07 32564424.0 NJ 2.0 -408.725000 522.163003 -777.95 -593.3375 -408.725 -224.1125 -39.5 2.0 32.000000 0.000000 32.0 32.00 32.0 32.00 32.0 2.0 3.512750e+07 4.966549e+07 8691.0 1.756809e+07 35127496.5 5.268690e+07 70246302.0 NV 4.0 181.250000 213.478141 50.00 68.7500 87.500 200.0000 500.0 4.0 36.000000 1.154701 35.0 35.00 36.0 37.00 37.0 4.0 8.939724e+08 1.883416e+06 891175812.0 8.936894e+08 894810312.5 8.950933e+08 895093326.0 NY 8.0 -809.312500 925.274590 -2300.00 -1250.0000 -575.000 -230.8750 300.0 8.0 29.125000 5.986592 22.0 22.00 32.0 34.00 35.0 8.0 7.576625e+07 4.678602e+07 11701.0 7.512812e+07 100206344.0 1.002265e+08 105072222.0 OH 4.0 112.500000 289.755644 -200.00 -12.5000 75.000 200.0000 500.0 4.0 20.000000 8.000000 16.0 16.00 16.0 20.00 32.0 4.0 4.401775e+04 1.126738e+03 43143.0 4.314300e+04 43712.0 4.458675e+04 45504.0 OK 3.0 266.666667 208.166600 100.00 150.0000 200.000 350.0000 500.0 3.0 34.000000 0.000000 34.0 34.00 34.0 34.00 34.0 3.0 7.341663e+08 5.157607e+06 731188602.0 7.311886e+08 731188602.0 7.356552e+08 740121840.0 PA 5.0 -429.200000 600.635663 -1100.00 -1046.0000 -100.000 -100.0000 200.0 5.0 29.000000 6.708204 22.0 22.00 32.0 32.00 37.0 5.0 1.080998e+08 9.866553e+07 15201.0 1.906700e+04 180153316.0 1.801557e+08 180155718.0 RI 2.0 100.000000 0.000000 100.00 100.0000 100.000 100.0000 100.0 2.0 35.000000 0.000000 35.0 35.00 35.0 35.00 35.0 2.0 2.903295e+07 0.000000e+00 29032946.0 2.903295e+07 29032946.0 2.903295e+07 29032946.0 SC 3.0 800.000000 624.499800 100.00 550.0000 1000.000 1150.0000 1300.0 3.0 23.000000 12.124356 16.0 16.00 16.0 26.50 37.0 3.0 9.873826e+07 1.709680e+08 29860.0 2.986000e+04 29860.0 1.480925e+08 296155069.0 TN 1.0 -25.000000 NaN -25.00 -25.0000 -25.000 -25.0000 -25.0 1.0 32.000000 NaN 32.0 32.00 32.0 32.00 32.0 1.0 3.718800e+04 NaN 37188.0 3.718800e+04 37188.0 3.718800e+04 37188.0 TX 9.0 220.582222 664.483748 -1000.00 -14.7600 50.000 500.0000 1300.0 9.0 33.555556 4.746344 22.0 32.00 35.0 37.00 37.0 9.0 6.912725e+08 2.594552e+08 78746.0 7.735463e+08 775816547.0 7.875726e+08 790140007.0 UT 11.0 459.090909 1716.183000 -2300.00 25.0000 75.000 87.5000 4600.0 11.0 30.909091 7.006490 20.0 27.50 35.0 35.00 35.0 11.0 8.410139e+08 2.208553e+05 840683130.0 8.408522e+08 841176911.0 8.411769e+08 841176911.0 VA 5.0 103.184000 234.748140 -100.00 -34.0800 50.000 100.0000 500.0 5.0 27.000000 8.426150 16.0 20.00 32.0 32.00 35.0 5.0 8.813837e+07 1.206562e+08 22903.0 2.366600e+04 24091.0 2.203084e+08 220312731.0 WA 3.0 -166.666667 461.880215 -700.00 -300.0000 100.000 100.0000 100.0 3.0 30.000000 6.928203 22.0 28.00 34.0 34.00 34.0 3.0 9.804301e+08 5.270573e+05 980125787.0 9.801258e+08 980125787.0 9.805822e+08 981038677.0 In [55]: dfcwci . groupby ( \"state\" ) . sum () Out[55]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } zip amount candidate_id state AK 2985459621 1210.00 111 AR 864790 14200.00 192 AZ 860011121 120.00 37 CA 14736360720 -5013.73 600 CO 2405477834 -5823.00 111 CT 68901376 2300.00 35 DC 800341853 -1549.91 102 FL 8970626520 -4050.00 803 IA 50266 250.00 16 ID 83648 -261.00 32 IL 3042068689 -5586.80 175 KS 66215 -330.00 32 KY 402597029 -200.00 22 LA 1406043327 1300.00 74 MA 123026638 -83.00 208 MD 416287617 300.00 55 ME 165647170 2520.00 122 MI 2426973485 -1265.00 164 MN 1102338918 322.00 100 MO 64111 100.00 20 NC 27502 500.00 16 NH 32564424 -24.60 32 NJ 70254993 -817.45 64 NV 3575889763 725.00 144 NY 606129991 -6474.50 233 OH 176071 450.00 80 OK 2202499044 800.00 102 PA 540499020 -2146.00 145 RI 58065892 200.00 70 SC 296214789 2400.00 69 TN 37188 -25.00 32 TX 6221452245 1985.24 302 UT 9251153394 5050.00 340 VA 440691831 515.92 135 WA 2941290251 -500.00 90 In [56]: mydf = dfcwci . groupby ( \"state\" )[ 'amount' ] . sum () mydf . sort_values () Out[56]: state NY -6474.50 CO -5823.00 IL -5586.80 CA -5013.73 FL -4050.00 PA -2146.00 DC -1549.91 MI -1265.00 NJ -817.45 WA -500.00 KS -330.00 ID -261.00 KY -200.00 MA -83.00 TN -25.00 NH -24.60 MO 100.00 AZ 120.00 RI 200.00 IA 250.00 MD 300.00 MN 322.00 OH 450.00 NC 500.00 VA 515.92 NV 725.00 OK 800.00 AK 1210.00 LA 1300.00 TX 1985.24 CT 2300.00 SC 2400.00 ME 2520.00 UT 5050.00 AR 14200.00 Name: amount, dtype: float64 In [57]: dfcwci . groupby ( \"state\" )[ 'amount' ] . apply ( lambda x : np . std ( x )) Out[57]: state AK 81.785628 AR 742.555647 AZ 0.000000 CA 921.394361 CO 887.819907 CT 0.000000 DC 473.728151 FL 1157.594489 IA 0.000000 ID 0.000000 IL 1123.431895 KS 0.000000 KY 0.000000 LA 150.000000 MA 226.572591 MD 100.000000 ME 964.339152 MI 1034.522112 MN 113.611424 MO 0.000000 NC 0.000000 NH 0.000000 NJ 369.225000 NV 184.877493 NY 865.515126 OH 250.935749 OK 169.967317 PA 537.224869 RI 0.000000 SC 509.901951 TN 0.000000 TX 626.481285 UT 1636.316287 VA 209.965120 WA 377.123617 Name: amount, dtype: float64 The dictionary-like structure is more obvious in this method of iteration, but it does not do the combining part... In [58]: for k , v in dfcwci . groupby ( 'state' ): print ( \"State\" , k , \"mean amount\" , v . amount . mean (), \"std\" , v . amount . std ()) State AK mean amount 403.3333333333333 std 100.16652800877813 State AR mean amount 1183.3333333333333 std 775.574078676661 State AZ mean amount 120.0 std nan State CA mean amount -217.9882608695652 std 942.1024379191479 State CO mean amount -1455.75 std 1025.16612474922 State CT mean amount 2300.0 std nan State DC mean amount -309.98199999999997 std 529.6441745360747 State FL mean amount -135.0 std 1177.3838620520878 State IA mean amount 250.0 std nan State ID mean amount -261.0 std nan State IL mean amount -931.1333333333333 std 1230.6579811900083 State KS mean amount -330.0 std nan State KY mean amount -200.0 std nan State LA mean amount 650.0 std 212.13203435596427 State MA mean amount -13.833333333333334 std 248.19783775582468 State MD mean amount 150.0 std 141.4213562373095 State ME mean amount 630.0 std 1113.5229379466475 State MI mean amount -253.0 std 1156.630883212099 State MN mean amount 107.33333333333333 std 139.14500829470433 State MO mean amount 100.0 std nan State NC mean amount 500.0 std nan State NH mean amount -24.6 std nan State NJ mean amount -408.725 std 522.163002567206 State NV mean amount 181.25 std 213.47814095749163 State NY mean amount -809.3125 std 925.2745900349181 State OH mean amount 112.5 std 289.75564417856185 State OK mean amount 266.6666666666667 std 208.16659994661327 State PA mean amount -429.2 std 600.6356632768321 State RI mean amount 100.0 std 0.0 State SC mean amount 800.0 std 624.4997998398399 State TN mean amount -25.0 std nan State TX mean amount 220.5822222222222 std 664.483747614977 State UT mean amount 459.09090909090907 std 1716.1830004137353 State VA mean amount 103.18400000000001 std 234.74814009912836 State WA mean amount -166.66666666666666 std 461.88021535170066 DELETE In [59]: dfcwci . head () Out[59]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 1 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 2 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 3 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 In-place drops In [60]: df2 = dfcwci . copy () df2 . set_index ( 'last_name' , inplace = True ) df2 . head () Out[60]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } first_name middle_name street_1 street_2 city state zip amount date candidate_id last_name Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 250.0 2007-05-16 16 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 50.0 2007-06-18 16 Ahrens Don NaN 4034 Rennellwood Way NaN Pleasanton CA 94566 100.0 2007-06-21 16 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 In [61]: df2 . drop ([ 'Ahrens' ], inplace = True ) df2 . head () Out[61]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } first_name middle_name street_1 street_2 city state zip amount date candidate_id last_name Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 Akin Mike NaN 181 Baywood Lane NaN Monticello AR 71655 1500.0 2007-05-18 16 Akin Rebecca NaN 181 Baywood Lane NaN Monticello AR 71655 500.0 2007-05-18 16 Aldridge Brittni NaN 808 Capitol Square Place, SW NaN Washington DC 20024 250.0 2007-06-06 16 In [62]: df2 . reset_index ( inplace = True ) df2 . head () Out[62]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 1 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 2 Akin Mike NaN 181 Baywood Lane NaN Monticello AR 71655 1500.0 2007-05-18 16 3 Akin Rebecca NaN 181 Baywood Lane NaN Monticello AR 71655 500.0 2007-05-18 16 4 Aldridge Brittni NaN 808 Capitol Square Place, SW NaN Washington DC 20024 250.0 2007-06-06 16 The recommended way to do it is to create a new dataframe. This might be impractical if things are very large. In [63]: dfcwci = dfcwci [ dfcwci . last_name != 'Ahrens' ] dfcwci . head ( 10 ) Out[63]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 5 Akin Mike NaN 181 Baywood Lane NaN Monticello AR 71655 1500.0 2007-05-18 16 6 Akin Rebecca NaN 181 Baywood Lane NaN Monticello AR 71655 500.0 2007-05-18 16 7 Aldridge Brittni NaN 808 Capitol Square Place, SW NaN Washington DC 20024 250.0 2007-06-06 16 8 Allen John D. NaN 1052 Cannon Mill Drive NaN North Augusta SC 29860 1000.0 2007-06-11 16 9 Allen John D. NaN 1052 Cannon Mill Drive NaN North Augusta SC 29860 1300.0 2007-06-29 16 10 Allison John W. NaN P.O. Box 1089 NaN Conway AR 72033 1000.0 2007-05-18 16 11 Allison Rebecca NaN 3206 Summit Court NaN Little Rock AR 72227 1000.0 2007-04-25 16 12 Allison Rebecca NaN 3206 Summit Court NaN Little Rock AR 72227 200.0 2007-06-12 16 LIMIT In [64]: dfcwci [ 0 : 3 ] # also see loc and iloc from the lab Out[64]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 0 Agee Steven NaN 549 Laurel Branch Road NaN Floyd VA 24091 500.0 2007-06-30 16 4 Akin Charles NaN 10187 Sugar Creek Road NaN Bentonville AR 72712 100.0 2007-06-16 16 5 Akin Mike NaN 181 Baywood Lane NaN Monticello AR 71655 1500.0 2007-05-18 16 Relationships: JOINs are Cartesian Products. Finally, there are many occasions you will want to combine dataframes. We might want to see who contributed to Obama: Simple subselect In [65]: dfcand . head () Out[65]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } id first_name last_name middle_name party 0 33 Joseph Biden NaN D 1 36 Samuel Brownback NaN R 2 34 Hillary Clinton R. D 3 39 Christopher Dodd J. D 4 26 John Edwards NaN D In [66]: obamaid = dfcand . query ( \"last_name=='Obama'\" )[ 'id' ] . values [ 0 ] obamaid Out[66]: 20 In [67]: myq = dfcand [ 'id' ] . values myq Out[67]: array([33, 36, 34, 39, 26, 22, 24, 16, 30, 31, 37, 20, 32, 29, 35, 38, 41]) In [68]: obamacontrib = dfcwci . query ( \"candidate_id== %i \" % obamaid ) obamacontrib . head () Out[68]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name first_name middle_name street_1 street_2 city state zip amount date candidate_id 25 Buckler Steve NaN 24351 Armada Dr NaN Dana Point CA 926291306 50.0 2007-07-30 20 26 Buckler Steve NaN 24351 Armada Dr NaN Dana Point CA 926291306 25.0 2007-08-16 20 27 Buckheit Bruce NaN 8904 KAREN DR NaN FAIRFAX VA 220312731 100.0 2007-09-19 20 28 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 2300.0 2007-08-14 20 29 Buckel Linda NaN PO Box 683130 NaN Park City UT 840683130 -2300.0 2007-08-14 20 Explicit INNER JOIN This is the one you will want 90% of the time. It will only match keys that are present in both dataframes. (from http://pandas.pydata.org/pandas-docs/stable/merging.html ) In [69]: cols_wanted = [ 'last_name_x' , 'first_name_x' , 'candidate_id' , 'id' , 'last_name_y' ] dfcwci . merge ( dfcand , left_on = \"candidate_id\" , right_on = \"id\" )[ cols_wanted ] Out[69]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name_x first_name_x candidate_id id last_name_y 0 Agee Steven 16 16 Huckabee 1 Akin Charles 16 16 Huckabee 2 Akin Mike 16 16 Huckabee 3 Akin Rebecca 16 16 Huckabee 4 Aldridge Brittni 16 16 Huckabee 5 Allen John D. 16 16 Huckabee 6 Allen John D. 16 16 Huckabee 7 Allison John W. 16 16 Huckabee 8 Allison Rebecca 16 16 Huckabee 9 Allison Rebecca 16 16 Huckabee 10 Altes R.D. 16 16 Huckabee 11 Andres Dale 16 16 Huckabee 12 Anthony John 16 16 Huckabee 13 Arbogast Robert 16 16 Huckabee 14 Arbogast Robert 16 16 Huckabee 15 Ardle William 16 16 Huckabee 16 Atiq Omar 16 16 Huckabee 17 Atiq Omar 16 16 Huckabee 18 Baker David 16 16 Huckabee 19 Bancroft David 16 16 Huckabee 20 Banks Charles 16 16 Huckabee 21 Barbee John 16 16 Huckabee 22 Buckler Steve 20 20 Obama 23 Buckler Steve 20 20 Obama 24 Buckheit Bruce 20 20 Obama 25 Buckel Linda 20 20 Obama 26 Buckel Linda 20 20 Obama 27 Buckel Linda 20 20 Obama 28 Buck Thomas 20 20 Obama 29 Buck Jay 20 20 Obama ... ... ... ... ... ... 142 ABDELLA THOMAS 35 35 Romney 143 ABBOTT WELDON 35 35 Romney 144 ABBOTT WELDON 35 35 Romney 145 ABBOTT GERALD 35 35 Romney 146 ABBOTT GERALD 35 35 Romney 147 ABEDIN ZAINUL 37 37 McCain 148 ABBOTT SYBIL 37 37 McCain 149 ABBOTT SYBIL 37 37 McCain 150 ABBOTT RONALD 37 37 McCain 151 ABBOTT RONALD 37 37 McCain 152 ABBOTT ROBERT 37 37 McCain 153 ABBOTT MIKE 37 37 McCain 154 ABBOT DAVID 37 37 McCain 155 ABBO PAULINE 37 37 McCain 156 ABATE MARIA 37 37 McCain 157 ABAIR PETER 37 37 McCain 158 ABACHERLI SHIRLEY 37 37 McCain 159 AARONS CHARLES 37 37 McCain 160 AARONS CHARLES 37 37 McCain 161 AARONS CHARLES 37 37 McCain 162 ABEL JOHN 37 37 McCain 163 ABEL MARLING 37 37 McCain 164 ABEL RUDOLPH 37 37 McCain 165 ABELE RODNEY 37 37 McCain 166 ABERCROMBIE DENIS 37 37 McCain 167 ABESHAUS MERRILL 37 37 McCain 168 ABRAHAM GEORGE 37 37 McCain 169 ABRAHAMSON PETER 37 37 McCain 170 ABRAHAM SALEM 37 37 McCain 171 ABRAHAM SALEM 37 37 McCain 172 rows × 5 columns If the names of the columns you wanted to merge on were identical, you could simply say on=id , for example, rather than a left_on and a right_on . Outer JOIN left outer (contributors on candidates) In [70]: dfcwci . merge ( dfcand , left_on = \"candidate_id\" , right_on = \"id\" , how = \"left\" )[ cols_wanted ] Out[70]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name_x first_name_x candidate_id id last_name_y 0 Agee Steven 16 16 Huckabee 1 Akin Charles 16 16 Huckabee 2 Akin Mike 16 16 Huckabee 3 Akin Rebecca 16 16 Huckabee 4 Aldridge Brittni 16 16 Huckabee 5 Allen John D. 16 16 Huckabee 6 Allen John D. 16 16 Huckabee 7 Allison John W. 16 16 Huckabee 8 Allison Rebecca 16 16 Huckabee 9 Allison Rebecca 16 16 Huckabee 10 Altes R.D. 16 16 Huckabee 11 Andres Dale 16 16 Huckabee 12 Anthony John 16 16 Huckabee 13 Arbogast Robert 16 16 Huckabee 14 Arbogast Robert 16 16 Huckabee 15 Ardle William 16 16 Huckabee 16 Atiq Omar 16 16 Huckabee 17 Atiq Omar 16 16 Huckabee 18 Baker David 16 16 Huckabee 19 Bancroft David 16 16 Huckabee 20 Banks Charles 16 16 Huckabee 21 Barbee John 16 16 Huckabee 22 Buckler Steve 20 20 Obama 23 Buckler Steve 20 20 Obama 24 Buckheit Bruce 20 20 Obama 25 Buckel Linda 20 20 Obama 26 Buckel Linda 20 20 Obama 27 Buckel Linda 20 20 Obama 28 Buck Thomas 20 20 Obama 29 Buck Jay 20 20 Obama ... ... ... ... ... ... 142 ABDELLA THOMAS 35 35 Romney 143 ABBOTT WELDON 35 35 Romney 144 ABBOTT WELDON 35 35 Romney 145 ABBOTT GERALD 35 35 Romney 146 ABBOTT GERALD 35 35 Romney 147 ABEDIN ZAINUL 37 37 McCain 148 ABBOTT SYBIL 37 37 McCain 149 ABBOTT SYBIL 37 37 McCain 150 ABBOTT RONALD 37 37 McCain 151 ABBOTT RONALD 37 37 McCain 152 ABBOTT ROBERT 37 37 McCain 153 ABBOTT MIKE 37 37 McCain 154 ABBOT DAVID 37 37 McCain 155 ABBO PAULINE 37 37 McCain 156 ABATE MARIA 37 37 McCain 157 ABAIR PETER 37 37 McCain 158 ABACHERLI SHIRLEY 37 37 McCain 159 AARONS CHARLES 37 37 McCain 160 AARONS CHARLES 37 37 McCain 161 AARONS CHARLES 37 37 McCain 162 ABEL JOHN 37 37 McCain 163 ABEL MARLING 37 37 McCain 164 ABEL RUDOLPH 37 37 McCain 165 ABELE RODNEY 37 37 McCain 166 ABERCROMBIE DENIS 37 37 McCain 167 ABESHAUS MERRILL 37 37 McCain 168 ABRAHAM GEORGE 37 37 McCain 169 ABRAHAMSON PETER 37 37 McCain 170 ABRAHAM SALEM 37 37 McCain 171 ABRAHAM SALEM 37 37 McCain 172 rows × 5 columns right outer (contributors on candidates) = left outer (candidates on contributors) In [71]: dfcwci . merge ( dfcand , left_on = \"candidate_id\" , right_on = \"id\" , how = \"right\" )[ cols_wanted ] Out[71]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name_x first_name_x candidate_id id last_name_y 0 Agee Steven 16.0 16 Huckabee 1 Akin Charles 16.0 16 Huckabee 2 Akin Mike 16.0 16 Huckabee 3 Akin Rebecca 16.0 16 Huckabee 4 Aldridge Brittni 16.0 16 Huckabee 5 Allen John D. 16.0 16 Huckabee 6 Allen John D. 16.0 16 Huckabee 7 Allison John W. 16.0 16 Huckabee 8 Allison Rebecca 16.0 16 Huckabee 9 Allison Rebecca 16.0 16 Huckabee 10 Altes R.D. 16.0 16 Huckabee 11 Andres Dale 16.0 16 Huckabee 12 Anthony John 16.0 16 Huckabee 13 Arbogast Robert 16.0 16 Huckabee 14 Arbogast Robert 16.0 16 Huckabee 15 Ardle William 16.0 16 Huckabee 16 Atiq Omar 16.0 16 Huckabee 17 Atiq Omar 16.0 16 Huckabee 18 Baker David 16.0 16 Huckabee 19 Bancroft David 16.0 16 Huckabee 20 Banks Charles 16.0 16 Huckabee 21 Barbee John 16.0 16 Huckabee 22 Buckler Steve 20.0 20 Obama 23 Buckler Steve 20.0 20 Obama 24 Buckheit Bruce 20.0 20 Obama 25 Buckel Linda 20.0 20 Obama 26 Buckel Linda 20.0 20 Obama 27 Buckel Linda 20.0 20 Obama 28 Buck Thomas 20.0 20 Obama 29 Buck Jay 20.0 20 Obama ... ... ... ... ... ... 152 ABBOTT ROBERT 37.0 37 McCain 153 ABBOTT MIKE 37.0 37 McCain 154 ABBOT DAVID 37.0 37 McCain 155 ABBO PAULINE 37.0 37 McCain 156 ABATE MARIA 37.0 37 McCain 157 ABAIR PETER 37.0 37 McCain 158 ABACHERLI SHIRLEY 37.0 37 McCain 159 AARONS CHARLES 37.0 37 McCain 160 AARONS CHARLES 37.0 37 McCain 161 AARONS CHARLES 37.0 37 McCain 162 ABEL JOHN 37.0 37 McCain 163 ABEL MARLING 37.0 37 McCain 164 ABEL RUDOLPH 37.0 37 McCain 165 ABELE RODNEY 37.0 37 McCain 166 ABERCROMBIE DENIS 37.0 37 McCain 167 ABESHAUS MERRILL 37.0 37 McCain 168 ABRAHAM GEORGE 37.0 37 McCain 169 ABRAHAMSON PETER 37.0 37 McCain 170 ABRAHAM SALEM 37.0 37 McCain 171 ABRAHAM SALEM 37.0 37 McCain 172 NaN NaN NaN 33 Biden 173 NaN NaN NaN 36 Brownback 174 NaN NaN NaN 39 Dodd 175 NaN NaN NaN 26 Edwards 176 NaN NaN NaN 24 Gravel 177 NaN NaN NaN 30 Hunter 178 NaN NaN NaN 31 Kucinich 179 NaN NaN NaN 29 Richardson 180 NaN NaN NaN 38 Tancredo 181 NaN NaN NaN 41 Thompson 182 rows × 5 columns full outer In [72]: dfcwci . merge ( dfcand , left_on = \"candidate_id\" , right_on = \"id\" , how = \"outer\" )[ cols_wanted ] Out[72]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } last_name_x first_name_x candidate_id id last_name_y 0 Agee Steven 16.0 16 Huckabee 1 Akin Charles 16.0 16 Huckabee 2 Akin Mike 16.0 16 Huckabee 3 Akin Rebecca 16.0 16 Huckabee 4 Aldridge Brittni 16.0 16 Huckabee 5 Allen John D. 16.0 16 Huckabee 6 Allen John D. 16.0 16 Huckabee 7 Allison John W. 16.0 16 Huckabee 8 Allison Rebecca 16.0 16 Huckabee 9 Allison Rebecca 16.0 16 Huckabee 10 Altes R.D. 16.0 16 Huckabee 11 Andres Dale 16.0 16 Huckabee 12 Anthony John 16.0 16 Huckabee 13 Arbogast Robert 16.0 16 Huckabee 14 Arbogast Robert 16.0 16 Huckabee 15 Ardle William 16.0 16 Huckabee 16 Atiq Omar 16.0 16 Huckabee 17 Atiq Omar 16.0 16 Huckabee 18 Baker David 16.0 16 Huckabee 19 Bancroft David 16.0 16 Huckabee 20 Banks Charles 16.0 16 Huckabee 21 Barbee John 16.0 16 Huckabee 22 Buckler Steve 20.0 20 Obama 23 Buckler Steve 20.0 20 Obama 24 Buckheit Bruce 20.0 20 Obama 25 Buckel Linda 20.0 20 Obama 26 Buckel Linda 20.0 20 Obama 27 Buckel Linda 20.0 20 Obama 28 Buck Thomas 20.0 20 Obama 29 Buck Jay 20.0 20 Obama ... ... ... ... ... ... 152 ABBOTT ROBERT 37.0 37 McCain 153 ABBOTT MIKE 37.0 37 McCain 154 ABBOT DAVID 37.0 37 McCain 155 ABBO PAULINE 37.0 37 McCain 156 ABATE MARIA 37.0 37 McCain 157 ABAIR PETER 37.0 37 McCain 158 ABACHERLI SHIRLEY 37.0 37 McCain 159 AARONS CHARLES 37.0 37 McCain 160 AARONS CHARLES 37.0 37 McCain 161 AARONS CHARLES 37.0 37 McCain 162 ABEL JOHN 37.0 37 McCain 163 ABEL MARLING 37.0 37 McCain 164 ABEL RUDOLPH 37.0 37 McCain 165 ABELE RODNEY 37.0 37 McCain 166 ABERCROMBIE DENIS 37.0 37 McCain 167 ABESHAUS MERRILL 37.0 37 McCain 168 ABRAHAM GEORGE 37.0 37 McCain 169 ABRAHAMSON PETER 37.0 37 McCain 170 ABRAHAM SALEM 37.0 37 McCain 171 ABRAHAM SALEM 37.0 37 McCain 172 NaN NaN NaN 33 Biden 173 NaN NaN NaN 36 Brownback 174 NaN NaN NaN 39 Dodd 175 NaN NaN NaN 26 Edwards 176 NaN NaN NaN 24 Gravel 177 NaN NaN NaN 30 Hunter 178 NaN NaN NaN 31 Kucinich 179 NaN NaN NaN 29 Richardson 180 NaN NaN NaN 38 Tancredo 181 NaN NaN NaN 41 Thompson 182 rows × 5 columns When to use which? See this: http://blog.codinghorror.com/a-visual-explanation-of-sql-joins/ Useful Links http://sebastianraschka.com/Articles/sqlite3_database.html and http://sebastianraschka.com/Articles/2014_sqlite_in_python_tutorial.html#unique_indexes https://github.com/tthibo/SQL-Tutorial http://chrisalbon.com And especially for R users: https://cran.r-project.org/web/packages/dplyr/vignettes/introduction.html https://gist.github.com/TomAugspurger/6e052140eaa5fdb6e8c0/ if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"lectures","url":"lectures/lecture-2/demo/"},{"title":"Standard Section 2: Prediction using kNN and Linear Regression - Solutions","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 2: Prediction using kNN and Linear Regression Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Section Leaders: Cecilia Garraffo, Mehul Smriti Raje, Ken Arnold, Karan Motwani In [4]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"http://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[4]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } For this section, our goal is to get you familiarized with k-Nearest Neighbors and Linear. These methods find powerful applications in all walks of life and are centered around prediction. Specifically, we will: 1. Review Basic Python Data Structures 2. Import Data and Manipulates Rows and Columns 3. Load in the Bikeshare dataset which is split into a training and testing dataset 3. Do some basic exploratory analysis of the dataset and go through a scatterplot 5. Write out the algorithm for kNN WITH AND WITHOUT using the sklearn package 6. Learn to use the sklearn package for Linear Regression. 7. What is and how to extract information about Confidence Intervals. For this section we will be using the following packages: In [ ]: #Check Python Version import sys assert ( sys . version_info . major == 3 ), print ( sys . version ) #Matrices, Dataframe and Plotting Operations import numpy as np import pandas as pd import seaborn as sns import matplotlib import matplotlib.pyplot as plt % matplotlib inline #Model Packages for k-NN and Linear Regression from sklearn.neighbors import KNeighborsRegressor from sklearn.preprocessing import PolynomialFeatures from sklearn.linear_model import LinearRegression from statsmodels.api import OLS import statsmodels.api as sm #Metrics, Performance Evaluation and Helpful fucntions from sklearn import metrics , datasets from collections import Counter import statsmodels.api as sm from sklearn.model_selection import train_test_split #Aesthetic settings from IPython.display import display pd . set_option ( 'display.max_rows' , 999 ) pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.notebook_repr_html' , True ) Review – Python : List, Dictionary Comprehensions and Zip **Exercise** In [ ]: #Makes a list of all the even numbers from 0 to 20 with a For Loop ##Your Code Here Solution In [ ]: # %load sol1 **Exercise** In [ ]: #Create a dictionary with the list A elements as keys and list B elements #as values using Zip and Dictionary Comprehension list_a = [ 'a' , 'b' , 'c' , 'd' , 'e' ] list_b = [ 1 , 2 , 3 , 4 , 5 ] ##Your Code Here In [ ]: # %load sol2 Working with Dataframes Importing Data In [ ]: #Import Data data_path = 'data/states.csv' states = pd . read_csv ( data_path , index_col = 0 ) states . head () Data describing the population per state from 1900 to 2010 Select Specific Columns **Exercise** In [ ]: #Select by Name : Select only '1930','1940','1950','1960' columns. #Select by Index : Select only the first 3 columns #Select by List : Select the following list of columns columns_list = [ '1920' , '1840' ] Solution In [ ]: # %load sol3.py Learn to \"display\", always! In the above statements, we use the display function which can be imported using from IPython.display import display . It provides a very aesthetically pleasing representation of the data with great demarcation for row and column information. Let's see a comparison below : In [ ]: print ( states [ columns_list ] . head ()) In [ ]: display ( states [ columns_list ] . head ()) Select Specific Rows **Exercise** In [ ]: #Filter out by First N Rows n = 25 #Select by Index, rows 5 to 10. #Select by List of Indices below row_list = np . arange ( 1 , 25 , 2 ) print ( row_list ) Solution In [ ]: # %load sol4.py Load in the Bikeshare dataset and perform EDA: The specific task is to build a regression model for a bike share system that can predict the total number of bike rentals in a given day, based on attributes about the day. Such a demand forecasting model would be useful in planning the number of bikes that need to be available in the system on any given day, and also in monitoring traffic in the city. The data for this problem was collected from the Capital Bikeshare program in Washington D.C. over two years. The data set is provided in the file 'bikeshare.csv'. Each row in these files contains 10 attributes describing a day and its weather: season (1 = spring, 2 = summer, 3 = fall, 4 = winter) month (1 through 12, with 1 denoting Jan) holiday (1 = the day is a holiday, 0 = otherwise) day_of_week (0 through 6, with 0 denoting Sunday) workingday (1 = the day is neither a holiday or weekend, 0 = otherwise) weather 1: Clear, Few clouds, Partly cloudy, Partly cloudy 2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist 3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds 4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog temp (temperature in Celsius) atemp (apparent temperature, or relative outdoor temperature, in Celsius) humidity (relative humidity) windspeed (wind speed) and the last column 'count' contains the response variable, i.e. total number of bike rentals on the day. In [ ]: #Load the BikeShare dataset bikeshare = pd . read_csv ( 'data/bikeshare.csv' ) del bikeshare [ 'Unnamed: 0' ] print ( \"Length of Dataset:\" , len ( bikeshare )) display ( bikeshare . head ()) In [ ]: display ( bikeshare . describe ()) We can also use the groupby function to look at mean stats aggregated by month: In [ ]: bikeshare . groupby ( 'month' ) . mean () Let's plot the variation of count with month? Is there a seasonal change? In [ ]: plt . plot ( bikeshare . groupby ( 'month' ) . mean ()[ 'count' ]) plt . xlabel ( 'Month' ) plt . ylabel ( 'Count' ) plt . title ( 'Bikeshare Rental Count as a function of Month' ) plt . show () What is temp, a_temp, is there a difference? In [ ]: plt . plot ( bikeshare [ 'temp' ], bikeshare [ 'atemp' ]) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A-Temp' ) plt . title ( 'A-Temp vs Temp' ) plt . show () What did we do wrong here? Why does the plot look like this? Sorting! Whenever your plot makes zig-zag changes across the scale, it is because matplotlib is trying to connect the points sequentially from the top (using a line plot) and skipping across the scale when $x_{i+1}$ is lower than $x_{i}$. So let's sort. In [ ]: new = bikeshare . sort_values ([ 'temp' ]) plt . plot ( new [ 'temp' ], new [ 'atemp' ]) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A-Temp' ) plt . title ( 'A-Temp vs Temp' ) plt . show () It still looks weird, why? Let's have a closer look at the dataframe: In [ ]: display ( new . head ()) There are multiple atemp values for each temp value, which if not sorted will bounce around at the same x-value. Thus, we need to sort both axes simultaneously. In [ ]: new = bikeshare . sort_values ([ 'temp' , 'atemp' ]) plt . plot ( new [ 'temp' ], new [ 'atemp' ]) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A-Temp' ) plt . title ( 'A-Temp vs Temp' ) plt . show () By plotting efficiently, we found an anomaly we would have otherwise overlooked. It looks like there is a problem with the data around temp greater than 30 and atemp less than 10 . **Exercise** Solution In [ ]: # %load sol5.py Anomaly! atemp and temp are usually lineary related except at this one datapoint. Now, we get to make a judgement call as to whether we should keep the datapoint? We'll come back to this question after the lecture on Missing Data and Imputation. Worth a thought though. In [ ]: bikeshare = bikeshare . drop ([ 188 ]) In [ ]: display ( bikeshare [( bikeshare [ 'temp' ] > 30 ) & ( bikeshare [ 'atemp' ] < 10 )]) Normalize In general, it is good practice to normalize data before proceeding. As such, we can create the following functions: In [ ]: #Function to takes in a dataset and normalizes it def normalize ( x ): #print(x.shape) #print(np.min(x).shape) num = x - np . min ( x ) denom = np . max ( x ) - np . min ( x ) return ( num / denom ) #bikeshare_norm = normalize(bikeshare.iloc[:, 0:10]) bikeshare_norm = normalize ( bikeshare ) display ( bikeshare_norm . head ()) bikeshare_norm . describe () **Exercise** Solution In [ ]: # %load sol6.py In [ ]: #Adapt the normalization function above to take column names as input #Function to takes in a dataset and normalizes it def normalize_cols ( x , columns ): for i in columns : x [ i ] = normalize ( x [ i ]) return x bikeshare_norm2 = normalize_cols ( bikeshare , bikeshare . columns ) In [ ]: display ( bikeshare_norm2 . head ()) bikeshare . describe () Let's see what the describe function AFTER normalization: Broadcasting In [ ]: from IPython.display import Image Image ( 'http://www.scipy-lectures.org/_images/numpy_broadcasting.png' ) image from Scipy Lecture Notes Choose one predictor In [ ]: bikeshare . columns bikeshare . iloc [:, 0 : 10 ] . head () In [ ]: #sns.pairplot(bikeshare, x_vars=bikeshare.iloc[:,:10] , y_vars =bikeshare['count']) In [ ]: bikeshare = bikeshare [[ 'temp' , 'count' ]] In [ ]: # %load sol8.py In [ ]: bikeshare . head () Split up the data into a training set and a test set: Now that we have an idea of what the data looks like, we would like to predict count. Therefore, we will be breaking up the data into a training and a testing set. The training set will be used to train the model, while the testing set will be used to gauge how well our model does in general. The testing set is a way for us to ensure our model doesn't overfit our training data. Let us first create a function that will randomly split the data up into a 70-30 split, with 70% of the data going into the testing set: **Exercise** In [ ]: #Function to Split data into Train and Test Set, Enter Code Here def split_data ( data ): #Calculate Length of Dataset #Define Split #Set a random Seed For Shuffling #Generate a Mask with a X:Y Split #Separate train and test data using mask #Return Train and Test Data Separately return data_train , data_test Solution In [ ]: # %load sol6.py In [ ]: #Split data using defined function train_data , test_data = split_data ( bikeshare ) print ( \"Length of Training set:\" , len ( train_data )) print ( \"Length of Testing set:\" , len ( test_data )) **Exercise** In [ ]: ## Check that the ratio between test and train sets is right #Your Code Here Solution In [ ]: # %load sol7.py Old vs new indices In [ ]: train_data . head () In [ ]: train_data . iloc [: 5 ] In [ ]: train_data . loc [ 3 : 9 ] In [ ]: train_data . iloc [ 3 : 9 ] Alternative approach using Standard 'train_test_split' function from sklearn In [ ]: train_data , test_data = train_test_split ( bikeshare , test_size = 0.30 , random_state = 13 ) print ( \"Length of Training set:\" , len ( train_data )) print ( \"Length of Testing set:\" , len ( test_data )) Implementing the kNN Algorithm by hand: To really understand how the kNN algorithm works, it helps to go through the algorithm line by line in code. In [ ]: #kNN Algorithm def knn_algorithm ( train , test , k ): #Create any empty list to store our predictions in predictions = [] #Separate the response and predictor variables from training and test set: train_x = train [ 'temp' ] train_y = train [ 'count' ] test_x = test [ 'temp' ] test_y = test [ 'count' ] for i , ele in enumerate ( test_x ): #For each test point, store the distance between all training points and test point distances = pd . DataFrame (( train_x . values - ele ) ** 2 , index = train . index ) distances . columns = [ 'dist' ] #display(distances) #Then, we sum across the columns per row to obtain the Euclidean distance squared ##distances = vec_distances.sum(axis = 1) #Sort the distances to training points (in ascending order) and take first k points nearest_k = distances . sort_values ( by = 'dist' ) . iloc [: k ] #For simplicity, we omitted the square rooting of the Euclidean distance because the #square root function preserves order. #Take the mean of the y-values of training set corresponding to the nearest k points k_mean = train_y [ nearest_k . index ] . mean () #Add on the mean to our predicted y-value list predictions . append ( k_mean ) #Create a dataframe with the x-values from test and predicted y-values predict = test . copy () predict [ 'predicted_count' ] = pd . Series ( predictions , index = test . index ) return predict Now to run the algorithm on our dataset with $k = 5$: In [ ]: #Run the kNN function k = 5 predicted_knn = knn_algorithm ( train_data , test_data , k ) predicted_knn . head () We want to have a way to evaluate our predictions from the kNN algorithm with $k=5$. One way is to compute the $R&#94;2$ coefficient. Let's create a function for that: In [ ]: #Test predictions in comparison to true value of test set def evaluate ( predicted , true ): #Find the squared error: squared_error = ( predicted [ 'predicted_count' ] - true [ 'count' ]) ** 2 #Finding the mean squared error: error_var = squared_error . sum () sample_var = (( true [ 'count' ] - true [ 'count' ] . mean ()) ** 2 ) . sum () r = ( 1 - ( error_var / sample_var )) return r Then let's apply this function to our predictions: In [ ]: print ( \"Length of Test Data:\" , len ( test_data )) print ( \"R&#94;2 Score of kNN - test:\" , evaluate ( predicted_knn , test_data )) In [ ]: predicted_knn_train = knn_algorithm ( train_data , train_data , k ) print ( \"R&#94;2 Score of kNN - train:\" , evaluate ( predicted_knn_train , train_data )) We see that the coefficient for the Nearest Neighbors implementation with $k=5$ is $R&#94;2 = 0.134$, which should more or less match what we get with the sklearn package. Now using sklearn to implement kNN: We will now use the sklearn package to implement kNN. Then, we can fit the model and use various metrics to assess our accuracy. What is sklearn? Scikit-learn provides a range of supervised and unsupervised learning algorithms via a consistent interface in Python. It is licensed under a permissive simplified BSD license and is distributed under many Linux distributions, encouraging academic and commercial use. The library is built upon the SciPy (Scientific Python) that must be installed before you can use scikit-learn. This stack that includes: NumPy: Base n-dimensional array package SciPy: Fundamental library for scientific computing Matplotlib: Comprehensive 2D/3D plotting IPython: Enhanced interactive console Sympy: Symbolic mathematics Pandas: Data structures and analysis Extensions or modules for SciPy care conventionally named SciKits. As such, the module provides learning algorithms and is named scikit-learn. The vision for the library is a level of robustness and support required for use in production systems. This means a deep focus on concerns such as easy of use, code quality, collaboration, documentation and performance. General sklearn model fitting code-structure : #Split Data into Train and Test Set x_train, y_train = training_data.drop('Response_Variable', axis=1), training_data['Response_Variable'] x_test, y_test = test_data.drop('Response_Variable', axis=1), test_data['Response_Variable'] #Define Model model = sklearn_model_name(hyper_parameter1 = value1, hyper_parameter2 = value2) #Fit Model model.fit(x_train, y_train) #Get Prediction y_pred_train = model.predict(x_train) y_pred_test = model.predict(x_test) #Evaluate Model r2_train = model.score(y_train, y_pred_train) r2_test = model.score(y_test, y_pred_test) #Print Results print(\"Score for Model (Training):\", r2_train) print(\"Score for Model (Testing) :\", r2_test) Every model has a list of hyperparameters that can be set using sklearn for the specific problem. In practice it is advisable to cross-validate a list of values to find best model fit. model.fit calculates the parameters of your model corresponding to the training data and hyperparameters you provided. model.predict(X) is the standard method called to make the model predict values for a specific X. Depending on if you feed x_train or x_test, you will get a y_prediction_train or y_prediction_test respectively. Evaluation of model can vary according to the task at hand i.e. Regression or Classification. For Regression, $R&#94;2$ Score is standard while for Classification, Accuracy (%) is standard. In [ ]: # Set kNN parameter: k = 100 # Now we can fit the model, predict our variable of interest, and then evaluate our fit: # First, we create the classifier object: neighbors = KNeighborsRegressor ( n_neighbors = k ) # Then, we fit the model using x_train as training data and y_train as target values: neighbors . fit ( train_data [[ 'temp' ]], train_data [ 'count' ]) # Retreieve our predictions: prediction_knn = neighbors . predict ( test_data [[ 'temp' ]]) # This returns the mean accuracy on the given test data and labels, or in other words, # the R squared value -- A constant model that always predicts the expected value of y, # disregarding the input features, would get a R&#94;2 score of 1. r2_train = neighbors . score ( train_data [[ 'temp' ]], train_data [ 'count' ]) r2_test = neighbors . score ( test_data [[ 'temp' ]], test_data [ 'count' ]) print ( \"Length of Test Data:\" , len ( test_data [ 'count' ])) print ( \"R&#94;2 Score of kNN on test set:\" , r_test ) print ( \"R&#94;2 Score of kNN on training set:\" , r_train ) In [ ]: # SubPlots fig , axes = plt . subplots ( nrows = 1 , ncols = 2 , figsize = ( 20 , 6 )) #axes[0].set_xlim([0.5, 0.7]) axes [ 0 ] . plot ( train_data [ 'temp' ], train_data [ 'count' ], 'o' , label = 'Data' ) #, '*', label='Predicted') axes [ 0 ] . plot ( train_data [ 'temp' ], neighbors . predict ( train_data [[ 'temp' ]]), '*' , label = 'Prediction' ) axes [ 0 ] . set_xlabel ( 'Normalized Temperature' ) axes [ 0 ] . set_ylabel ( '# of Rides' ) axes [ 0 ] . set_title ( \"Training Set\" ) axes [ 0 ] . legend () axes [ 1 ] . plot ( test_data [ 'temp' ], test_data [ 'count' ], 'o' , label = 'Data' ) #, '*') axes [ 1 ] . plot ( test_data [ 'temp' ], prediction_knn , '*' , label = 'Prediction' ) axes [ 1 ] . set_xlabel ( 'Normalized Temperature' ) axes [ 1 ] . set_ylabel ( '# of Rides' ) axes [ 1 ] . set_title ( \"Test Set\" ) axes [ 1 ] . legend () fig . suptitle ( \"Bike Rides\" ); **Exercise** In [ ]: # Can you predict what will happen for k=1 and for k = number-of-observations-in-training-set? Try it! Linear Regression We just went over the kNN prediction method. Now, we will fit the same data, but Linear Regression. We will use a the same training/testing dataset as before and create our linear regression objects. In [ ]: #Split Data into X,Y x_train , y_train = train_data . drop ([ 'count' ], axis = 1 ), train_data [ 'count' ] x_test , y_test = test_data . drop ([ 'count' ], axis = 1 ), test_data [ 'count' ] #Add constant x_train_ca = sm . add_constant ( x_train ) x_test_ca = sm . add_constant ( x_test ) StatsModels use a Y followed by X structure while feeding data in contrast to sklearn that uses X followed by Y. In [ ]: #We must first create the linear regression object from stats model model = sm . OLS ( y_train , x_train_ca ) results = model . fit () print ( results . params ) Now, we will compute metrics that can be used to assess fit. Note: sklearn.metrics is class of functions that consists of all the metrics we care about to evaluate our models. While it is not hard to implement them yourself, it is helpful to go through http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics . In [ ]: #To compute the mean squared error (notice that we are now using the TEST set): print ( \"R&#94;2 Score for Linear Regression (Training):\" , metrics . r2_score ( y_train , results . predict ( x_train_ca ))) print ( \"R&#94;2 Score for Linear Regression (Testing) :\" , metrics . r2_score ( y_test , results . predict ( x_test_ca ))) In [ ]: #Find the squared error: y_pred_train = results . predict ( x_train_ca ) squared_error_train = ( y_pred_train - y_train ) ** 2 #Finding the mean squared error: error_var_train = squared_error_train . mean () sample_var_train = (( y_train - y_train . mean ()) ** 2 ) . mean () y_pred_test = results . predict ( x_test_ca ) squared_error_test = ( y_pred_test - y_test ) ** 2 #Finding the mean squared error: error_var_test = squared_error_test . mean () sample_var_test = (( y_test - y_test . mean ()) ** 2 ) . mean () print ( error_var_train , sample_var_train , 1 - error_var_train / sample_var_train ) print ( error_var_test , sample_var_test , 1 - error_var_test / sample_var_test ) In [ ]: results . summary () In [ ]: plt . plot ( x_train , y_train , 'b+' ) plt . plot ( x_test , y_test , 'r+' ) x_forpredict = np . linspace ( 0 , 1 , 100 ) line_y = results . predict ( sm . add_constant ( x_forpredict )) plt . plot ( x_forpredict , line_y ) Confidence Intervals In Data Science, a confidence interval (CI) is a type of interval estimate, computed from the statistics of the observed data, that might contain the true value of an unknown population parameter. Simply speaking, a Confidence Interval is a range of values we are fairly sure our true value lies in. It is important to remind ourselves here that Confidence Intervals belong to a parameter and not a statistic. Thus, they represent the window in which the true value exists for the entire population when all we have is a sample. Example : We measure the heights of 40 randomly chosen men, and get a mean height of 175cm, we also know the standard deviation of men's heights is 20cm. The 95% Confidence Interval is thus: 175cm ± 6.2cm. This says the true mean of ALL men (if we could measure all their heights) is likely to be between 168.8cm and 181.2cm. But it might not be! The \"95%\" says that 95% of experiments like we just did will include the true mean, but 5% won't. So there is a 1-in-20 chance (5%) that our Confidence Interval does NOT include the true mean. To get Confidence Intervals using StatsModels: In [ ]: #Confidence Interval using Stats Model Summary thresh = 0.05 intervals = results . conf_int ( alpha = thresh ) intervals = intervals . rename ( index = str , columns = { 0 : str ( thresh / 2 * 100 ) + \"%\" , 1 : str (( 1 - thresh / 2 ) * 100 ) + \"%\" }) display ( intervals ) In the above block of code, results.conf_int(alpha=thresh) returns a dataframe with columns 0 and 1. We explained Confidence Intervals above where because we assume normal symetric distribution of data, the 95% Confidence Interval means there's 2.5% chance of the true value lying below the values in Column 0 and 2.5% chance of the true value lying above Column 1. Therefore, for a better understanding, given a constant threshold, you can rename the columns to suit the Confidence Interval values. The syntax is dataframe.rename(index=str, columns={old_col_name1:new_col_name1, old_col_name2:new_col_name2}) In [ ]: train_x . shape if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-2/solutions/"},{"title":"Standard Section 2: Prediction using kNN and Linear Regression - Student Version","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 2: Prediction using kNN and Linear Regression Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Section Leaders: Cecilia Garraffo, Mehul Smriti Raje, Ken Arnold, Karan Motwani In [4]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"http://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[4]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } For this section, our goal is to get you familiarized with k-Nearest Neighbors and Linear. These methods find powerful applications in all walks of life and are centered around prediction. Specifically, we will: 1. Review Basic Python Data Structures 2. Import Data and Manipulates Rows and Columns 3. Load in the Bikeshare dataset which is split into a training and testing dataset 3. Do some basic exploratory analysis of the dataset and go through a scatterplot 5. Write out the algorithm for kNN WITH AND WITHOUT using the sklearn package 6. Learn to use the sklearn package for Linear Regression. 7. What is and how to extract information about Confidence Intervals. For this section we will be using the following packages: In [ ]: #Check Python Version import sys assert ( sys . version_info . major == 3 ), print ( sys . version ) #Matrices, Dataframe and Plotting Operations import numpy as np import pandas as pd import seaborn as sns import matplotlib import matplotlib.pyplot as plt % matplotlib inline #Model Packages for k-NN and Linear Regression from sklearn.neighbors import KNeighborsRegressor from sklearn.preprocessing import PolynomialFeatures from sklearn.linear_model import LinearRegression from statsmodels.api import OLS import statsmodels.api as sm #Metrics, Performance Evaluation and Helpful fucntions from sklearn import metrics , datasets from collections import Counter import statsmodels.api as sm from sklearn.model_selection import train_test_split #Aesthetic settings from IPython.display import display pd . set_option ( 'display.max_rows' , 999 ) pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.notebook_repr_html' , True ) Review – Python : List, Dictionary Comprehensions and Zip **Exercise** In [ ]: #Makes a list of all the even numbers from 0 to 20 with a For Loop ##Your Code Here Solution In [ ]: # %load sol1 **Exercise** In [ ]: #Create a dictionary with the list A elements as keys and list B elements #as values using Zip and Dictionary Comprehension list_a = [ 'a' , 'b' , 'c' , 'd' , 'e' ] list_b = [ 1 , 2 , 3 , 4 , 5 ] ##Your Code Here In [ ]: # %load sol2 Working with Dataframes Importing Data In [ ]: #Import Data data_path = 'data/states.csv' states = pd . read_csv ( data_path , index_col = 0 ) states . head () Data describing the population per state from 1900 to 2010 Select Specific Columns **Exercise** In [ ]: #Select by Name : Select only '1930','1940','1950','1960' columns. #Select by Index : Select only the first 3 columns #Select by List : Select the following list of columns columns_list = [ '1920' , '1840' ] Solution In [ ]: # %load sol3.py Learn to \"display\", always! In the above statements, we use the display function which can be imported using from IPython.display import display . It provides a very aesthetically pleasing representation of the data with great demarcation for row and column information. Let's see a comparison below : In [ ]: print ( states [ columns_list ] . head ()) In [ ]: display ( states [ columns_list ] . head ()) Select Specific Rows **Exercise** In [ ]: #Filter out by First N Rows n = 25 #Select by Index, rows 5 to 10. #Select by List of Indices below row_list = np . arange ( 1 , 25 , 2 ) print ( row_list ) Solution In [ ]: # %load sol4.py Load in the Bikeshare dataset and perform EDA: The specific task is to build a regression model for a bike share system that can predict the total number of bike rentals in a given day, based on attributes about the day. Such a demand forecasting model would be useful in planning the number of bikes that need to be available in the system on any given day, and also in monitoring traffic in the city. The data for this problem was collected from the Capital Bikeshare program in Washington D.C. over two years. The data set is provided in the file 'bikeshare.csv'. Each row in these files contains 10 attributes describing a day and its weather: season (1 = spring, 2 = summer, 3 = fall, 4 = winter) month (1 through 12, with 1 denoting Jan) holiday (1 = the day is a holiday, 0 = otherwise) day_of_week (0 through 6, with 0 denoting Sunday) workingday (1 = the day is neither a holiday or weekend, 0 = otherwise) weather 1: Clear, Few clouds, Partly cloudy, Partly cloudy 2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist 3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds 4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog temp (temperature in Celsius) atemp (apparent temperature, or relative outdoor temperature, in Celsius) humidity (relative humidity) windspeed (wind speed) and the last column 'count' contains the response variable, i.e. total number of bike rentals on the day. In [ ]: #Load the BikeShare dataset bikeshare = pd . read_csv ( 'data/bikeshare.csv' ) del bikeshare [ 'Unnamed: 0' ] print ( \"Length of Dataset:\" , len ( bikeshare )) display ( bikeshare . head ()) In [ ]: display ( bikeshare . describe ()) We can also use the groupby function to look at mean stats aggregated by month: In [ ]: bikeshare . groupby ( 'month' ) . mean () Let's plot the variation of count with month? Is there a seasonal change? In [ ]: plt . plot ( bikeshare . groupby ( 'month' ) . mean ()[ 'count' ]) plt . xlabel ( 'Month' ) plt . ylabel ( 'Count' ) plt . title ( 'Bikeshare Rental Count as a function of Month' ) plt . show () What is temp, a_temp, is there a difference? In [ ]: plt . plot ( bikeshare [ 'temp' ], bikeshare [ 'atemp' ]) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A-Temp' ) plt . title ( 'A-Temp vs Temp' ) plt . show () What did we do wrong here? Why does the plot look like this? Sorting! Whenever your plot makes zig-zag changes across the scale, it is because matplotlib is trying to connect the points sequentially from the top (using a line plot) and skipping across the scale when $x_{i+1}$ is lower than $x_{i}$. So let's sort. In [ ]: new = bikeshare . sort_values ([ 'temp' ]) plt . plot ( new [ 'temp' ], new [ 'atemp' ]) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A-Temp' ) plt . title ( 'A-Temp vs Temp' ) plt . show () It still looks weird, why? Let's have a closer look at the dataframe: In [ ]: display ( new . head ()) There are multiple atemp values for each temp value, which if not sorted will bounce around at the same x-value. Thus, we need to sort both axes simultaneously. In [ ]: new = bikeshare . sort_values ([ 'temp' , 'atemp' ]) plt . plot ( new [ 'temp' ], new [ 'atemp' ]) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A-Temp' ) plt . title ( 'A-Temp vs Temp' ) plt . show () By plotting efficiently, we found an anomaly we would have otherwise overlooked. It looks like there is a problem with the data around temp greater than 30 and atemp less than 10 . **Exercise** Solution In [ ]: # %load sol5.py Anomaly! atemp and temp are usually lineary related except at this one datapoint. Now, we get to make a judgement call as to whether we should keep the datapoint? We'll come back to this question after the lecture on Missing Data and Imputation. Worth a thought though. In [ ]: bikeshare = bikeshare . drop ([ 188 ]) In [ ]: display ( bikeshare [( bikeshare [ 'temp' ] > 30 ) & ( bikeshare [ 'atemp' ] < 10 )]) Normalize In general, it is good practice to normalize data before proceeding. As such, we can create the following functions: In [ ]: #Function to takes in a dataset and normalizes it def normalize ( x ): #print(x.shape) #print(np.min(x).shape) num = x - np . min ( x ) denom = np . max ( x ) - np . min ( x ) return ( num / denom ) #bikeshare_norm = normalize(bikeshare.iloc[:, 0:10]) bikeshare_norm = normalize ( bikeshare ) display ( bikeshare_norm . head ()) bikeshare_norm . describe () **Exercise** Solution In [ ]: # %load sol6.py In [ ]: #Adapt the normalization function above to take column names as input #Function to takes in a dataset and normalizes it def normalize_cols ( x , columns ): for i in columns : x [ i ] = normalize ( x [ i ]) return x bikeshare_norm2 = normalize_cols ( bikeshare , bikeshare . columns ) In [ ]: display ( bikeshare_norm2 . head ()) bikeshare . describe () Let's see what the describe function AFTER normalization: Broadcasting In [ ]: from IPython.display import Image Image ( 'http://www.scipy-lectures.org/_images/numpy_broadcasting.png' ) image from Scipy Lecture Notes Choose one predictor In [ ]: bikeshare . columns bikeshare . iloc [:, 0 : 10 ] . head () In [ ]: #sns.pairplot(bikeshare, x_vars=bikeshare.iloc[:,:10] , y_vars =bikeshare['count']) In [ ]: bikeshare = bikeshare [[ 'temp' , 'count' ]] In [ ]: # %load sol8.py In [ ]: bikeshare . head () Split up the data into a training set and a test set: Now that we have an idea of what the data looks like, we would like to predict count. Therefore, we will be breaking up the data into a training and a testing set. The training set will be used to train the model, while the testing set will be used to gauge how well our model does in general. The testing set is a way for us to ensure our model doesn't overfit our training data. Let us first create a function that will randomly split the data up into a 70-30 split, with 70% of the data going into the testing set: **Exercise** In [ ]: #Function to Split data into Train and Test Set, Enter Code Here def split_data ( data ): #Calculate Length of Dataset #Define Split #Set a random Seed For Shuffling #Generate a Mask with a X:Y Split #Separate train and test data using mask #Return Train and Test Data Separately return data_train , data_test Solution In [ ]: # %load sol6.py In [ ]: #Split data using defined function train_data , test_data = split_data ( bikeshare ) print ( \"Length of Training set:\" , len ( train_data )) print ( \"Length of Testing set:\" , len ( test_data )) **Exercise** In [ ]: ## Check that the ratio between test and train sets is right #Your Code Here Solution In [ ]: # %load sol7.py Old vs new indices In [ ]: train_data . head () In [ ]: train_data . iloc [: 5 ] In [ ]: train_data . loc [ 3 : 9 ] In [ ]: train_data . iloc [ 3 : 9 ] Alternative approach using Standard 'train_test_split' function from sklearn In [ ]: train_data , test_data = train_test_split ( bikeshare , test_size = 0.30 , random_state = 13 ) print ( \"Length of Training set:\" , len ( train_data )) print ( \"Length of Testing set:\" , len ( test_data )) Implementing the kNN Algorithm by hand: To really understand how the kNN algorithm works, it helps to go through the algorithm line by line in code. In [ ]: #kNN Algorithm def knn_algorithm ( train , test , k ): #Create any empty list to store our predictions in predictions = [] #Separate the response and predictor variables from training and test set: train_x = train [ 'temp' ] train_y = train [ 'count' ] test_x = test [ 'temp' ] test_y = test [ 'count' ] for i , ele in enumerate ( test_x ): #For each test point, store the distance between all training points and test point distances = pd . DataFrame (( train_x . values - ele ) ** 2 , index = train . index ) distances . columns = [ 'dist' ] #display(distances) #Then, we sum across the columns per row to obtain the Euclidean distance squared ##distances = vec_distances.sum(axis = 1) #Sort the distances to training points (in ascending order) and take first k points nearest_k = distances . sort_values ( by = 'dist' ) . iloc [: k ] #For simplicity, we omitted the square rooting of the Euclidean distance because the #square root function preserves order. #Take the mean of the y-values of training set corresponding to the nearest k points k_mean = train_y [ nearest_k . index ] . mean () #Add on the mean to our predicted y-value list predictions . append ( k_mean ) #Create a dataframe with the x-values from test and predicted y-values predict = test . copy () predict [ 'predicted_count' ] = pd . Series ( predictions , index = test . index ) return predict Now to run the algorithm on our dataset with $k = 5$: In [ ]: #Run the kNN function k = 5 predicted_knn = knn_algorithm ( train_data , test_data , k ) predicted_knn . head () We want to have a way to evaluate our predictions from the kNN algorithm with $k=5$. One way is to compute the $R&#94;2$ coefficient. Let's create a function for that: In [ ]: #Test predictions in comparison to true value of test set def evaluate ( predicted , true ): #Find the squared error: squared_error = ( predicted [ 'predicted_count' ] - true [ 'count' ]) ** 2 #Finding the mean squared error: error_var = squared_error . sum () sample_var = (( true [ 'count' ] - true [ 'count' ] . mean ()) ** 2 ) . sum () r = ( 1 - ( error_var / sample_var )) return r Then let's apply this function to our predictions: In [ ]: print ( \"Length of Test Data:\" , len ( test_data )) print ( \"R&#94;2 Score of kNN - test:\" , evaluate ( predicted_knn , test_data )) In [ ]: predicted_knn_train = knn_algorithm ( train_data , train_data , k ) print ( \"R&#94;2 Score of kNN - train:\" , evaluate ( predicted_knn_train , train_data )) We see that the coefficient for the Nearest Neighbors implementation with $k=5$ is $R&#94;2 = 0.134$, which should more or less match what we get with the sklearn package. Now using sklearn to implement kNN: We will now use the sklearn package to implement kNN. Then, we can fit the model and use various metrics to assess our accuracy. What is sklearn? Scikit-learn provides a range of supervised and unsupervised learning algorithms via a consistent interface in Python. It is licensed under a permissive simplified BSD license and is distributed under many Linux distributions, encouraging academic and commercial use. The library is built upon the SciPy (Scientific Python) that must be installed before you can use scikit-learn. This stack that includes: NumPy: Base n-dimensional array package SciPy: Fundamental library for scientific computing Matplotlib: Comprehensive 2D/3D plotting IPython: Enhanced interactive console Sympy: Symbolic mathematics Pandas: Data structures and analysis Extensions or modules for SciPy care conventionally named SciKits. As such, the module provides learning algorithms and is named scikit-learn. The vision for the library is a level of robustness and support required for use in production systems. This means a deep focus on concerns such as easy of use, code quality, collaboration, documentation and performance. General sklearn model fitting code-structure : #Split Data into Train and Test Set x_train, y_train = training_data.drop('Response_Variable', axis=1), training_data['Response_Variable'] x_test, y_test = test_data.drop('Response_Variable', axis=1), test_data['Response_Variable'] #Define Model model = sklearn_model_name(hyper_parameter1 = value1, hyper_parameter2 = value2) #Fit Model model.fit(x_train, y_train) #Get Prediction y_pred_train = model.predict(x_train) y_pred_test = model.predict(x_test) #Evaluate Model r2_train = model.score(y_train, y_pred_train) r2_test = model.score(y_test, y_pred_test) #Print Results print(\"Score for Model (Training):\", r2_train) print(\"Score for Model (Testing) :\", r2_test) Every model has a list of hyperparameters that can be set using sklearn for the specific problem. In practice it is advisable to cross-validate a list of values to find best model fit. model.fit calculates the parameters of your model corresponding to the training data and hyperparameters you provided. model.predict(X) is the standard method called to make the model predict values for a specific X. Depending on if you feed x_train or x_test, you will get a y_prediction_train or y_prediction_test respectively. Evaluation of model can vary according to the task at hand i.e. Regression or Classification. For Regression, $R&#94;2$ Score is standard while for Classification, Accuracy (%) is standard. In [ ]: # Set kNN parameter: k = 100 # Now we can fit the model, predict our variable of interest, and then evaluate our fit: # First, we create the classifier object: neighbors = KNeighborsRegressor ( n_neighbors = k ) # Then, we fit the model using x_train as training data and y_train as target values: neighbors . fit ( train_data [[ 'temp' ]], train_data [ 'count' ]) # Retreieve our predictions: prediction_knn = neighbors . predict ( test_data [[ 'temp' ]]) # This returns the mean accuracy on the given test data and labels, or in other words, # the R squared value -- A constant model that always predicts the expected value of y, # disregarding the input features, would get a R&#94;2 score of 1. r2_train = neighbors . score ( train_data [[ 'temp' ]], train_data [ 'count' ]) r2_test = neighbors . score ( test_data [[ 'temp' ]], test_data [ 'count' ]) print ( \"Length of Test Data:\" , len ( test_data [ 'count' ])) print ( \"R&#94;2 Score of kNN on test set:\" , r_test ) print ( \"R&#94;2 Score of kNN on training set:\" , r_train ) In [ ]: # SubPlots fig , axes = plt . subplots ( nrows = 1 , ncols = 2 , figsize = ( 20 , 6 )) #axes[0].set_xlim([0.5, 0.7]) axes [ 0 ] . plot ( train_data [ 'temp' ], train_data [ 'count' ], 'o' , label = 'Data' ) #, '*', label='Predicted') axes [ 0 ] . plot ( train_data [ 'temp' ], neighbors . predict ( train_data [[ 'temp' ]]), '*' , label = 'Prediction' ) axes [ 0 ] . set_xlabel ( 'Normalized Temperature' ) axes [ 0 ] . set_ylabel ( '# of Rides' ) axes [ 0 ] . set_title ( \"Training Set\" ) axes [ 0 ] . legend () axes [ 1 ] . plot ( test_data [ 'temp' ], test_data [ 'count' ], 'o' , label = 'Data' ) #, '*') axes [ 1 ] . plot ( test_data [ 'temp' ], prediction_knn , '*' , label = 'Prediction' ) axes [ 1 ] . set_xlabel ( 'Normalized Temperature' ) axes [ 1 ] . set_ylabel ( '# of Rides' ) axes [ 1 ] . set_title ( \"Test Set\" ) axes [ 1 ] . legend () fig . suptitle ( \"Bike Rides\" ); **Exercise** In [ ]: # Can you predict what will happen for k=1 and for k = number-of-observations-in-training-set? Try it! Linear Regression We just went over the kNN prediction method. Now, we will fit the same data, but Linear Regression. We will use a the same training/testing dataset as before and create our linear regression objects. In [ ]: #Split Data into X,Y x_train , y_train = train_data . drop ([ 'count' ], axis = 1 ), train_data [ 'count' ] x_test , y_test = test_data . drop ([ 'count' ], axis = 1 ), test_data [ 'count' ] #Add constant x_train_ca = sm . add_constant ( x_train ) x_test_ca = sm . add_constant ( x_test ) StatsModels use a Y followed by X structure while feeding data in contrast to sklearn that uses X followed by Y. In [ ]: #We must first create the linear regression object from stats model model = sm . OLS ( y_train , x_train_ca ) results = model . fit () print ( results . params ) Now, we will compute metrics that can be used to assess fit. Note: sklearn.metrics is class of functions that consists of all the metrics we care about to evaluate our models. While it is not hard to implement them yourself, it is helpful to go through http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics . In [ ]: #To compute the mean squared error (notice that we are now using the TEST set): print ( \"R&#94;2 Score for Linear Regression (Training):\" , metrics . r2_score ( y_train , results . predict ( x_train_ca ))) print ( \"R&#94;2 Score for Linear Regression (Testing) :\" , metrics . r2_score ( y_test , results . predict ( x_test_ca ))) In [ ]: #Find the squared error: y_pred_train = results . predict ( x_train_ca ) squared_error_train = ( y_pred_train - y_train ) ** 2 #Finding the mean squared error: error_var_train = squared_error_train . mean () sample_var_train = (( y_train - y_train . mean ()) ** 2 ) . mean () y_pred_test = results . predict ( x_test_ca ) squared_error_test = ( y_pred_test - y_test ) ** 2 #Finding the mean squared error: error_var_test = squared_error_test . mean () sample_var_test = (( y_test - y_test . mean ()) ** 2 ) . mean () print ( error_var_train , sample_var_train , 1 - error_var_train / sample_var_train ) print ( error_var_test , sample_var_test , 1 - error_var_test / sample_var_test ) In [ ]: results . summary () In [ ]: plt . plot ( x_train , y_train , 'b+' ) plt . plot ( x_test , y_test , 'r+' ) x_forpredict = np . linspace ( 0 , 1 , 100 ) line_y = results . predict ( sm . add_constant ( x_forpredict )) plt . plot ( x_forpredict , line_y ) Confidence Intervals In Data Science, a confidence interval (CI) is a type of interval estimate, computed from the statistics of the observed data, that might contain the true value of an unknown population parameter. Simply speaking, a Confidence Interval is a range of values we are fairly sure our true value lies in. It is important to remind ourselves here that Confidence Intervals belong to a parameter and not a statistic. Thus, they represent the window in which the true value exists for the entire population when all we have is a sample. Example : We measure the heights of 40 randomly chosen men, and get a mean height of 175cm, we also know the standard deviation of men's heights is 20cm. The 95% Confidence Interval is thus: 175cm ± 6.2cm. This says the true mean of ALL men (if we could measure all their heights) is likely to be between 168.8cm and 181.2cm. But it might not be! The \"95%\" says that 95% of experiments like we just did will include the true mean, but 5% won't. So there is a 1-in-20 chance (5%) that our Confidence Interval does NOT include the true mean. To get Confidence Intervals using StatsModels: In [ ]: #Confidence Interval using Stats Model Summary thresh = 0.05 intervals = results . conf_int ( alpha = thresh ) intervals = intervals . rename ( index = str , columns = { 0 : str ( thresh / 2 * 100 ) + \"%\" , 1 : str (( 1 - thresh / 2 ) * 100 ) + \"%\" }) display ( intervals ) In the above block of code, results.conf_int(alpha=thresh) returns a dataframe with columns 0 and 1. We explained Confidence Intervals above where because we assume normal symetric distribution of data, the 95% Confidence Interval means there's 2.5% chance of the true value lying below the values in Column 0 and 2.5% chance of the true value lying above Column 1. Therefore, for a better understanding, given a constant threshold, you can rename the columns to suit the Confidence Interval values. The syntax is dataframe.rename(index=str, columns={old_col_name1:new_col_name1, old_col_name2:new_col_name2}) In [ ]: train_x . shape if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-2/student/"},{"title":"Standard Section 3: Predictor Types and Feature - Solutions","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 3: Predictor types and Feature Selection Harvard University Fall 2018 Instructors: Pavlos Protopapas, Kevin Rader Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan Motwani, Cecilia Garraffo In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"http://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } For this section, our goal is to discuss the complexities around different types of data features and thinking carefully about how different datatypes and collinearity issues can affect our models, whether our true goal is inference or prediction. Specifically, we will: 1. Discuss different variable types, and techniques of \"one-hot-encoding\" our factor variables 2. Build a variable selection function that performs an exhaustive feature search overall all possible combinations of predictors For this section we will be using the following packages: In [2]: #Check Python Version import sys assert ( sys . version_info . major == 3 ), print ( sys . version ) # Data and Stats packages import numpy as np import pandas as pd from sklearn import metrics , datasets from sklearn.model_selection import train_test_split import statsmodels.api as sm # RUNNING FOR ME (MSR) # Visualization packages % matplotlib inline import matplotlib import matplotlib.pyplot as plt import matplotlib.patches as mpatches import seaborn as sns matplotlib . rcParams [ 'figure.figsize' ] = ( 13.0 , 6.0 ) # Other Helpful fucntions import itertools import warnings warnings . filterwarnings ( \"ignore\" ) #Aesthetic settings from IPython.display import display pd . set_option ( 'display.max_rows' , 999 ) pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.notebook_repr_html' , True ) /Users/kcarnold/anaconda3/envs/py36/lib/python3.6/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead. from pandas.core import datetools 1. Extending Linear Regression by Transforming Predictors Linear regression works great when our features are all continuous and all linearly affect the output. But often real data have more interesting characteristics. Here, we'll look at how we can extend linear regression to handle: Categorical predictors, like gender, which have one of a few discrete values Interactions between predictors, which let us model how one variable changes the effect of another. For our dataset, we'll be using the passenger list from the Titanic, which famously sank in 1912. Let's have a look at the data. Some descriptions of the data are at https://www.kaggle.com/c/titanic/data , and here's how seaborn preprocessed it . In [3]: # Load the dataset from seaborn titanic = sns . load_dataset ( \"titanic\" ) titanic . head () Out[3]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } survived pclass sex age sibsp parch fare embarked class who adult_male deck embark_town alive alone 0 0 3 male 22.0 1 0 7.2500 S Third man True NaN Southampton no False 1 1 1 female 38.0 1 0 71.2833 C First woman False C Cherbourg yes False 2 1 3 female 26.0 0 0 7.9250 S Third woman False NaN Southampton yes True 3 1 1 female 35.0 1 0 53.1000 S First woman False C Southampton yes False 4 0 3 male 35.0 0 0 8.0500 S Third man True NaN Southampton no True In [4]: # Keep only a subset of the predictors; some are redundant, others (like deck) have too many missing values. titanic = titanic [[ 'age' , 'sex' , 'class' , 'embark_town' , 'alone' , 'fare' ]] In [5]: titanic . info () RangeIndex: 891 entries, 0 to 890 Data columns (total 6 columns): age 714 non-null float64 sex 891 non-null object class 891 non-null category embark_town 889 non-null object alone 891 non-null bool fare 891 non-null float64 dtypes: bool(1), category(1), float64(2), object(2) memory usage: 29.8+ KB In [6]: # Drop missing data (is this a good idea?) titanic = titanic . dropna () titanic . info () Int64Index: 712 entries, 0 to 890 Data columns (total 6 columns): age 712 non-null float64 sex 712 non-null object class 712 non-null category embark_town 712 non-null object alone 712 non-null bool fare 712 non-null float64 dtypes: bool(1), category(1), float64(2), object(2) memory usage: 29.3+ KB Let's explore this data. Most people look at differences in survival, which is important but requires knowing how to deal with categorical responses, which we'll learn how to do next week. For this week, let's see if there are systematic differences in what fare people paid. First let's look at the distribution of fares. **Exercise 1**: Show the distribution of fares in at least two ways. You may use functions from matplotlib, Pandas, or Seaborn. In [7]: # Your code here titanic . fare . describe () Out[7]: count 712.000000 mean 34.567251 std 52.938648 min 0.000000 25% 8.050000 50% 15.645850 75% 33.000000 max 512.329200 Name: fare, dtype: float64 In [8]: # Your code here fig , axes = plt . subplots ( nrows = 2 , ncols = 2 , figsize = ( 16 , 8 )) sns . distplot ( titanic . fare , ax = axes [ 0 , 0 ]) sns . violinplot ( x = 'fare' , data = titanic , ax = axes [ 0 , 1 ]) sns . boxplot ( x = 'fare' , data = titanic , ax = axes [ 1 , 0 ]) sns . barplot ( x = 'fare' , data = titanic , ax = axes [ 1 , 1 ]) # Of course you should label your axes, etc. Out[8]: What do we learn from each visualization? Which is most helpful? What can we say about the fares that passengers paid? Your answer here A good visualization of the distribution of a variable will enable us to answer three kinds of questions: What values are central or typical? (e.g., mean, median, modes) What is the typical spread of values around those central values? (e.g., variance/stdev, skewness) What are unusual or exceptional values (e.g., outliers) The barplot clearly shows the mean and stdev, but that's about it. The other visualizations give complementary info, e.g., the boxplot shows outliers clearly, but the histogram most clearly suggests that there might be secondary modes in addition to the primary mode. Overall, we can see that most passengers paid below $50, but there are many outliers. If we were carefully analyzing this data, we might consider removing some outliers entirely and transforming the remaining data to make its distribution more Normal. But for now we'll just use the data as-is. Exploring predictors Cabin class is probably going to matter for fare, but we might wonder if age and gender also matter. Let's explore them. In [9]: sns . distplot ( titanic . age , rug = True , rug_kws = { 'alpha' : . 1 , 'color' : 'k' }) Out[9]: In [10]: sns . lmplot ( x = \"age\" , y = \"fare\" , hue = \"sex\" , data = titanic , size = 8 ) Out[10]: Hmm... the slopes seem to be different for males and females. Remember this for later. How about sex and class? In [11]: titanic . sex . value_counts () Out[11]: male 453 female 259 Name: sex, dtype: int64 In [12]: titanic [ 'class' ] . value_counts () # Why couldn't we write `titanic.class.value_counts()` here? Out[12]: Third 355 First 184 Second 173 Name: class, dtype: int64 In [13]: sns . barplot ( x = \"class\" , hue = \"sex\" , y = \"fare\" , data = titanic ) Out[13]: In [14]: sns . violinplot ( x = \"class\" , hue = \"sex\" , y = \"fare\" , data = titanic ) Out[14]: Aside: can we replicate that violin plot without Seaborn? In [15]: # plt.violinplot takes an array of data arrays, and plots each one as a separate violin. # The data arrays don't have to be the same length. # It returns Matplotlib objects corresponding to each of the pieces of the visualization. plt . violinplot ([ [ 0 , 1 , 2 ], [ 10 , 14 , 9 , 10 , 10 , 10 ], [ 6 ] ]) Out[15]: {'bodies': [ , , ], 'cmaxes': , 'cmins': , 'cbars': } In [16]: # We can use Pandas queries to make datasets for each class. # We need to use `.values` to get plain Numpy arrays. classes = 'First Second Third' . split () plt . violinplot ([ titanic [ 'fare' ][ titanic [ 'class' ] == cls ] . values for cls in classes ]) plt . xticks ([ 1 , 2 , 3 ], classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [17]: # It gets a little more tricky when we want to plot the two sexes side-by-side. # Fortunately we can tell violinplot to place the violins at different positions. position_array = [ 0 , 4 , 5 ] # just to show the effect of the position array. plt . violinplot ([ titanic [ 'fare' ][ titanic [ 'class' ] == cls ] . values for cls in classes ], positions = position_array ) #plt.xticks(position_array, classes) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [18]: # We can use the position array to shift the male and female violins. sexes = 'male female' . split () positions_array = np . arange ( len ( classes )) # this will be [0, 1, 2] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [19]: # But what about a legend? Unfortunately plt.violinplot doesn't support legends, so we # have to do it by hand. positions_array = np . arange ( len ( classes )) fake_handles = [] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) fake_handles . append ( mpatches . Patch ()) plt . legend ( fake_handles , sexes ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [20]: # Dang, the colors are wrong. We'll have to use some hacky code to pull the color out of the violin... positions_array = np . arange ( len ( classes )) fake_handles = [] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) cur_violin_color = violin [ 'cbars' ] . get_color ()[ 0 ] fake_handles . append ( mpatches . Patch ( color = cur_violin_color )) plt . legend ( fake_handles , sexes ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [21]: # Or explicitly control the colors. colors = sns . color_palette ( \"Set1\" , n_colors = len ( sexes ), desat =. 5 ) sns . palplot ( colors ) In [22]: positions_array = np . arange ( len ( classes )) fake_handles = [] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) # Set the color color = colors [ i ] for part_name , part in violin . items (): if part_name == 'bodies' : for body in violin [ 'bodies' ]: body . set_color ( color ) else : part . set_color ( color ) fake_handles . append ( mpatches . Patch ( color = color )) plt . legend ( fake_handles , sexes ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); No more digression, back to regressions. So it looks like fare varies with class, age, and maybe gender, and the way that fare depends on class and age may be different for male vs female. Let's first do a simple linear regression on age. In [23]: model1 = sm . OLS ( titanic . fare , sm . add_constant ( titanic [ 'age' ]) ) . fit () model1 . summary () Out[23]: OLS Regression Results Dep. Variable: fare R-squared: 0.009 Model: OLS Adj. R-squared: 0.007 Method: Least Squares F-statistic: 6.214 Date: Mon, 01 Oct 2018 Prob (F-statistic): 0.0129 Time: 11:09:51 Log-Likelihood: -3832.7 No. Observations: 712 AIC: 7669. Df Residuals: 710 BIC: 7679. Df Model: 1 Covariance Type: nonrobust coef std err t P>|t| [0.025 0.975] const 24.4823 4.503 5.437 0.000 15.642 33.323 age 0.3402 0.136 2.493 0.013 0.072 0.608 Omnibus: 715.959 Durbin-Watson: 1.927 Prob(Omnibus): 0.000 Jarque-Bera (JB): 30912.718 Skew: 4.664 Prob(JB): 0.00 Kurtosis: 33.903 Cond. No. 75.2 How do we interpret this? How good is this model? Does age affect fare? How can we tell? And if so, how? Handling categorical variables Statistical packages generally distinguish between three types of variables: continuous variables, like age and fare. nominal variables, like gender and whether the person survived ordinal variables like cabin class (first > second > third) (Ordinal variables can often be treated like nominal variables; that's what we'll do for now.) How do we deal with gender, or class? They're categorical variables. We'll need to use dummy variables to encode them. In [24]: titanic_orig = titanic . copy () **Exercise 2**: Create a column `sex_male` that is 1 if the passenger is male, 0 otherwise. In [25]: # Your code here titanic [ 'sex_male' ] = ( titanic . sex == 'male' ) . astype ( int ) **Exercise 3**: Do we need a `sex_female` column, or any others? Why or why not? your answer here No, because it's redundant: the only values for sex in this dataset are male and female , so if a passenger is not male, we know they're female. **Exercise 4**: Create columns for `class_` In [26]: # Your code here titanic [ 'class_Second' ] = ( titanic [ 'class' ] == 'Second' ) . astype ( int ) titanic [ 'class_Third' ] = 1 * ( titanic [ 'class' ] == 'Third' ) # just another way to do it In [27]: titanic . info () Int64Index: 712 entries, 0 to 890 Data columns (total 9 columns): age 712 non-null float64 sex 712 non-null object class 712 non-null category embark_town 712 non-null object alone 712 non-null bool fare 712 non-null float64 sex_male 712 non-null int64 class_Second 712 non-null int64 class_Third 712 non-null int64 dtypes: bool(1), category(1), float64(2), int64(3), object(2) memory usage: 66.0+ KB In [28]: # Your code here # This function automates the above: titanic = pd . get_dummies ( titanic_orig , columns = [ 'sex' , 'class' ], drop_first = True ) titanic . head () Out[28]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } age embark_town alone fare sex_male class_Second class_Third 0 22.0 Southampton False 7.2500 1 0 1 1 38.0 Cherbourg False 71.2833 0 0 0 2 26.0 Southampton True 7.9250 0 0 1 3 35.0 Southampton False 53.1000 0 0 0 4 35.0 Southampton True 8.0500 1 0 1 **Exercise 5**: Fit a linear regression including the new sex and class variables. In [29]: # Your code here model2 = sm . OLS ( titanic . fare , sm . add_constant ( titanic [[ 'age' , 'sex_male' , 'class_Second' , 'class_Third' ]]) ) . fit () model2 . summary () Out[29]: OLS Regression Results Dep. Variable: fare R-squared: 0.386 Model: OLS Adj. R-squared: 0.382 Method: Least Squares F-statistic: 110.9 Date: Mon, 01 Oct 2018 Prob (F-statistic): 2.25e-73 Time: 11:09:51 Log-Likelihood: -3662.4 No. Observations: 712 AIC: 7335. Df Residuals: 707 BIC: 7358. Df Model: 4 Covariance Type: nonrobust coef std err t P>|t| [0.025 0.975] const 110.9658 5.485 20.229 0.000 100.196 121.736 age -0.4513 0.117 -3.841 0.000 -0.682 -0.221 sex_male -10.4196 3.329 -3.130 0.002 -16.956 -3.883 class_Second -70.0469 4.515 -15.514 0.000 -78.911 -61.182 class_Third -78.9638 4.145 -19.051 0.000 -87.102 -70.826 Omnibus: 804.007 Durbin-Watson: 1.974 Prob(Omnibus): 0.000 Jarque-Bera (JB): 70017.197 Skew: 5.349 Prob(JB): 0.00 Kurtosis: 50.388 Cond. No. 150. **Exercise 6** How do we interpret these results? All else being equal, what does being male do to the fare? What can we say about being male and first-class ? Your answer here Interactions In [30]: # It seemed like gender interacted with age and class. Can we put that in our model? titanic [ 'sex_male_X_age' ] = titanic [ 'age' ] * titanic [ 'sex_male' ] model3 = sm . OLS ( titanic . fare , sm . add_constant ( titanic [[ 'age' , 'sex_male' , 'class_Second' , 'class_Third' , 'sex_male_X_age' ]]) ) . fit () model3 . summary () Out[30]: OLS Regression Results Dep. Variable: fare R-squared: 0.390 Model: OLS Adj. R-squared: 0.386 Method: Least Squares F-statistic: 90.21 Date: Mon, 01 Oct 2018 Prob (F-statistic): 2.26e-73 Time: 11:09:51 Log-Likelihood: -3659.9 No. Observations: 712 AIC: 7332. Df Residuals: 706 BIC: 7359. Df Model: 5 Covariance Type: nonrobust coef std err t P>|t| [0.025 0.975] const 101.7891 6.868 14.821 0.000 88.305 115.273 age -0.1195 0.190 -0.628 0.530 -0.493 0.254 sex_male 4.0310 7.334 0.550 0.583 -10.367 18.429 class_Second -70.2038 4.503 -15.590 0.000 -79.045 -61.362 class_Third -78.9242 4.134 -19.093 0.000 -87.040 -70.809 sex_male_X_age -0.5030 0.228 -2.210 0.027 -0.950 -0.056 Omnibus: 808.727 Durbin-Watson: 1.986 Prob(Omnibus): 0.000 Jarque-Bera (JB): 71826.587 Skew: 5.397 Prob(JB): 0.00 Kurtosis: 51.006 Cond. No. 241. What happened to the age and male terms? In [31]: # It seemed like gender interacted with age and class. Can we put that in our model? titanic [ 'sex_male_X_class_Second' ] = titanic [ 'age' ] * titanic [ 'class_Second' ] titanic [ 'sex_male_X_class_Third' ] = titanic [ 'age' ] * titanic [ 'class_Third' ] model4 = sm . OLS ( titanic . fare , sm . add_constant ( titanic [[ 'age' , 'sex_male' , 'class_Second' , 'class_Third' , 'sex_male_X_age' , 'sex_male_X_class_Second' , 'sex_male_X_class_Third' ]]) ) . fit () model4 . summary () Out[31]: OLS Regression Results Dep. Variable: fare R-squared: 0.403 Model: OLS Adj. R-squared: 0.397 Method: Least Squares F-statistic: 67.80 Date: Mon, 01 Oct 2018 Prob (F-statistic): 1.23e-74 Time: 11:09:51 Log-Likelihood: -3652.4 No. Observations: 712 AIC: 7321. Df Residuals: 704 BIC: 7357. Df Model: 7 Covariance Type: nonrobust coef std err t P>|t| [0.025 0.975] const 127.2774 9.446 13.474 0.000 108.732 145.823 age -0.7991 0.257 -3.107 0.002 -1.304 -0.294 sex_male 4.0819 7.266 0.562 0.574 -10.185 18.348 class_Second -104.1076 11.219 -9.280 0.000 -126.134 -82.081 class_Third -112.1375 9.787 -11.458 0.000 -131.352 -92.923 sex_male_X_age -0.4864 0.226 -2.156 0.031 -0.929 -0.043 sex_male_X_class_Second 0.9504 0.305 3.120 0.002 0.352 1.549 sex_male_X_class_Third 0.9728 0.270 3.602 0.000 0.443 1.503 Omnibus: 812.510 Durbin-Watson: 1.993 Prob(Omnibus): 0.000 Jarque-Bera (JB): 75162.969 Skew: 5.424 Prob(JB): 0.00 Kurtosis: 52.152 Cond. No. 445. What has happened to the $R&#94;2$ as we added more features? Does this mean that the model is better? (What if we kept adding more predictors and interaction terms? We'll explore this in the next homework.) In [32]: models = [ model1 , model2 , model3 , model4 ] plt . plot ([ model . df_model for model in models ], [ model . rsquared for model in models ], 'x-' ) plt . xlabel ( \"Model df\" ) plt . ylabel ( \"$R&#94;2$\" ); 2. Model Selection via exhaustive search selection The dataset for this problem contains 10 simulated predictors and a response variable. In [33]: # Import the dataset data = pd . read_csv ( 'data/dataset3.txt' ) data . head () Out[33]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 y 0 0.488866 0.488866 0.488866 0.078913 0.098292 0.144871 0.065302 0.250225 -0.392509 -0.501255 0.625915 1 0.146479 0.146479 0.146479 0.022562 0.088052 0.104879 0.082436 0.332836 -0.178366 -0.061798 0.058947 2 0.525450 0.525450 0.525450 -0.157520 -0.328685 -0.246146 -0.233882 0.054153 -0.010547 0.393186 -0.176577 3 0.351241 0.351241 0.351241 -0.062256 -0.096287 -0.033425 -0.088843 -0.475510 -0.066429 -0.249999 0.154168 4 -0.168068 -0.168068 -0.168068 -0.080250 -0.155529 -0.099511 -0.106430 -0.203144 0.194485 -0.037681 -0.288597 By visually inspecting the data set, do we find that some of the predictors are correlated amongst themselves? In [34]: sns . pairplot ( data ) Out[34]: Predictors x1, x2, x3 seem to be perfectly correlated while predictors x4, x5, x6, x7 show very high degrees of correlation. In [35]: data . corr () Out[35]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 y x1 1.000000 1.000000 1.000000 -0.189945 -0.232439 -0.215623 -0.228322 -0.047643 -0.061022 0.050977 0.195962 x2 1.000000 1.000000 1.000000 -0.189945 -0.232439 -0.215623 -0.228322 -0.047643 -0.061022 0.050977 0.195962 x3 1.000000 1.000000 1.000000 -0.189945 -0.232439 -0.215623 -0.228322 -0.047643 -0.061022 0.050977 0.195962 x4 -0.189945 -0.189945 -0.189945 1.000000 0.974279 0.964344 0.969540 0.058516 0.108294 -0.010416 -0.225856 x5 -0.232439 -0.232439 -0.232439 0.974279 1.000000 0.982785 0.982227 0.080342 0.126004 -0.012399 -0.257433 x6 -0.215623 -0.215623 -0.215623 0.964344 0.982785 1.000000 0.976308 0.079547 0.123368 -0.021029 -0.261228 x7 -0.228322 -0.228322 -0.228322 0.969540 0.982227 0.976308 1.000000 0.074004 0.112241 -0.022023 -0.235921 x8 -0.047643 -0.047643 -0.047643 0.058516 0.080342 0.079547 0.074004 1.000000 -0.133182 0.052151 0.238538 x9 -0.061022 -0.061022 -0.061022 0.108294 0.126004 0.123368 0.112241 -0.133182 1.000000 0.006923 -0.607845 x10 0.050977 0.050977 0.050977 -0.010416 -0.012399 -0.021029 -0.022023 0.052151 0.006923 1.000000 -0.406231 y 0.195962 0.195962 0.195962 -0.225856 -0.257433 -0.261228 -0.235921 0.238538 -0.607845 -0.406231 1.000000 Let us compute the cofficient of correlation between each pair of predictors, and visualize the matrix of correlation coefficients using a heat map. In [36]: # generating heat map sns . heatmap ( data . corr ()) Out[36]: Do the predictors fall naturally into groups based on the correlation values? We can see that higly correlated predictors fall into dark red groups based on correlation values close to 1. Other correlation values also form differently coloured groups. **If you were asked to select a minimal subset of predictors based on the correlation information in order to build a good regression model, how many predictors will you pick, and which ones will you choose? ** Your answer here We may choose one predictor from the x1,x2,x3 list - let's pick x1. Similarly, let's pick x6 out of x4,x5,x6,x7. The other predictors are not strongly correlated, so we pick them all, i.e. x8,x9,x10. Thus, we have picked 5 predictors x1, x6, x8, x9, x10 for our regression model. Model Selection Criteria: Bayesian Information Criterion (BIC) Generally BIC = -2 x Log-likehood + 2 x log(K) For least-squares regression specifically, $$BIC = n \\log \\Big(\\frac{RSS}{n}\\Big) + \\log(n)*K$$ where, RSS = Residual Sum of Squares n = the number of obervations K = the number of features in our model Selecting minimal subset of predictors Let us apply the exhaustive search variable selection methods discussed in class to choose a minimal subset of predictors that yield high prediction accuracy. We will use the Bayesian Information Criterion (BIC) to choose the subset size. In [37]: x = data . iloc [:,: - 1 ] y = data . iloc [:, - 1 ] x . shape , y . shape Out[37]: ((100, 10), (100,)) In [38]: def find_best_subset_of_size ( x , y , num_predictors ): predictors = x . columns best_r_squared = - np . inf best_model_data = None # Enumerate subsets of the given size subsets_of_size_k = itertools . combinations ( predictors , num_predictors ) # Inner loop: iterate through subsets_k for subset in subsets_of_size_k : # Fit regression model using ‘subset' and calculate R&#94;2 # Keep track of subset with highest R&#94;2 features = list ( subset ) x_subset = sm . add_constant ( x [ features ]) model = sm . OLS ( y , x_subset ) . fit () r_squared = model . rsquared # Check if we get a higher R&#94;2 value than than current max R&#94;2. # If so, update our best subset if r_squared > best_r_squared : best_r_squared = r_squared best_model_data = { 'r_squared' : r_squared , 'subset' : features , 'model' : model } return best_model_data In [39]: find_best_subset_of_size ( x , y , 8 ) Out[39]: {'r_squared': 0.6445570800123952, 'subset': ['x1', 'x4', 'x5', 'x6', 'x7', 'x8', 'x9', 'x10'], 'model': } In [40]: def exhaustive_search_selection ( x , y ): \"\"\"Exhaustively search predictor combinations Parameters: ----------- x : DataFrame of predictors/features y : response varible Returns: ----------- Dataframe of model comparisons and OLS Model with lowest BIC for subset with highest R&#94;2 \"\"\" predictors = x . columns stats = [] models = dict () # Outer loop: iterate over sizes 1, 2 .... d for k in range ( 1 , len ( predictors )): best_size_k_model = find_best_subset_of_size ( x , y , num_predictors = k ) best_subset = best_size_k_model [ 'subset' ] best_model = best_size_k_model [ 'model' ] stats . append ({ 'k' : k , 'formula' : \"y ~ {} \" . format ( ' + ' . join ( best_subset )), 'bic' : best_model . bic , 'r_squared' : best_model . rsquared }) models [ k ] = best_model return pd . DataFrame ( stats ), models In [41]: stats , models = exhaustive_search_selection ( x , y ) stats Out[41]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } bic formula k r_squared 0 -36.720144 y ~ x9 1 0.369475 1 -61.732380 y ~ x9 + x10 2 0.531105 2 -65.728760 y ~ x6 + x9 + x10 3 0.569751 3 -71.007523 y ~ x6 + x8 + x9 + x10 4 0.610243 4 -72.366019 y ~ x1 + x6 + x8 + x9 + x10 5 0.632807 5 -70.354782 y ~ x1 + x4 + x6 + x8 + x9 + x10 6 0.642209 6 -66.158687 y ~ x1 + x4 + x6 + x7 + x8 + x9 + x10 7 0.643670 7 -61.802744 y ~ x1 + x4 + x5 + x6 + x7 + x8 + x9 + x10 8 0.644557 8 -61.802744 y ~ x1 + x2 + x4 + x5 + x6 + x7 + x8 + x9 + x10 9 0.644557 In [42]: stats . plot ( x = 'k' , y = 'bic' , marker = '*' ) Out[42]: In [43]: stats . info () RangeIndex: 9 entries, 0 to 8 Data columns (total 4 columns): bic 9 non-null float64 formula 9 non-null object k 9 non-null int64 r_squared 9 non-null float64 dtypes: float64(2), int64(1), object(1) memory usage: 368.0+ bytes In [44]: best_stat = stats . iloc [ stats . bic . idxmin ()] best_stat Out[44]: bic -72.366 formula y ~ x1 + x6 + x8 + x9 + x10 k 5 r_squared 0.632807 Name: 4, dtype: object In [45]: best_k = best_stat [ 'k' ] best_bic = best_stat [ 'bic' ] best_formula = best_stat [ 'formula' ] best_r2 = best_stat [ 'r_squared' ] In [46]: print ( \"The best overall model is ` {formula} ` with bic= {bic:.2f} and R&#94;2= {r_squared:.3f} \" . format ( formula = best_formula , bic = best_bic , r_squared = best_r2 )) The best overall model is `y ~ x1 + x6 + x8 + x9 + x10` with bic=-72.37 and R&#94;2=0.633 In [47]: models [ best_k ] . summary () Out[47]: OLS Regression Results Dep. Variable: y R-squared: 0.633 Model: OLS Adj. R-squared: 0.613 Method: Least Squares F-statistic: 32.40 Date: Mon, 01 Oct 2018 Prob (F-statistic): 4.59e-19 Time: 11:10:08 Log-Likelihood: 49.999 No. Observations: 100 AIC: -88.00 Df Residuals: 94 BIC: -72.37 Df Model: 5 Covariance Type: nonrobust coef std err t P>|t| [0.025 0.975] const 4.337e-18 0.015 2.86e-16 1.000 -0.030 0.030 x1 0.1343 0.056 2.403 0.018 0.023 0.245 x6 -0.2147 0.074 -2.883 0.005 -0.363 -0.067 x8 0.1810 0.055 3.312 0.001 0.073 0.290 x9 -0.5081 0.059 -8.545 0.000 -0.626 -0.390 x10 -0.3584 0.053 -6.782 0.000 -0.463 -0.254 Omnibus: 28.643 Durbin-Watson: 1.849 Prob(Omnibus): 0.000 Jarque-Bera (JB): 5.697 Skew: 0.051 Prob(JB): 0.0579 Kurtosis: 1.835 Cond. No. 5.11 Do the chosen subsets match the ones you picked using the correlation matrix you had visualized? Yes! The predictor subset matches with the ones we picked before. In [ ]: Plotting multiple axes in a single figure source: http://matplotlib.org/faq/usage_faq.html See also this matplotlib tutorial. In [ ]: if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-3/solutions/"},{"title":"Standard Section 3: Predictor Types and Feature - Student Version","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 3: Predictor types and Feature Selection Harvard University Fall 2018 Instructors: Pavlos Protopapas, Kevin Rader Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan Motwani, Cecilia Garraffo In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"http://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } For this section, our goal is to discuss the complexities around different types of data features and thinking carefully about how different datatypes and collinearity issues can affect our models, whether our true goal is inference or prediction. Specifically, we will: 1. Discuss different variable types, and techniques of \"one-hot-encoding\" our factor variables 2. Build a variable selection function that performs an exhaustive feature search overall all possible combinations of predictors For this section we will be using the following packages: In [2]: #Check Python Version import sys assert ( sys . version_info . major == 3 ), print ( sys . version ) # Data and Stats packages import numpy as np import pandas as pd from sklearn import metrics , datasets from sklearn.model_selection import train_test_split import statsmodels.api as sm # RUNNING FOR ME (MSR) # Visualization packages % matplotlib inline import matplotlib import matplotlib.pyplot as plt import matplotlib.patches as mpatches import seaborn as sns matplotlib . rcParams [ 'figure.figsize' ] = ( 13.0 , 6.0 ) # Other Helpful fucntions import itertools import warnings warnings . filterwarnings ( \"ignore\" ) #Aesthetic settings from IPython.display import display pd . set_option ( 'display.max_rows' , 999 ) pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.notebook_repr_html' , True ) 1. Extending Linear Regression by Transforming Predictors Linear regression works great when our features are all continuous and all linearly affect the output. But often real data have more interesting characteristics. Here, we'll look at how we can extend linear regression to handle: Categorical predictors, like gender, which have one of a few discrete values Interactions between predictors, which let us model how one variable changes the effect of another. For our dataset, we'll be using the passenger list from the Titanic, which famously sank in 1912. Let's have a look at the data. Some descriptions of the data are at https://www.kaggle.com/c/titanic/data , and here's how seaborn preprocessed it . In [3]: # Load the dataset from seaborn titanic = sns . load_dataset ( \"titanic\" ) titanic . head () In [4]: # Keep only a subset of the predictors; some are redundant, others (like deck) have too many missing values. titanic = titanic [[ 'age' , 'sex' , 'class' , 'embark_town' , 'alone' , 'fare' ]] In [5]: titanic . info () In [6]: # Drop missing data (is this a good idea?) titanic = titanic . dropna () titanic . info () Let's explore this data. Most people look at differences in survival, which is important but requires knowing how to deal with categorical responses, which we'll learn how to do next week. For this week, let's see if there are systematic differences in what fare people paid. First let's look at the distribution of fares. **Exercise 1**: Show the distribution of fares in at least two ways. You may use functions from matplotlib, Pandas, or Seaborn. In [7]: # Your code here In [8]: # Your code here What do we learn from each visualization? Which is most helpful? What can we say about the fares that passengers paid? Your answer here Exploring predictors Cabin class is probably going to matter for fare, but we might wonder if age and gender also matter. Let's explore them. In [9]: sns . distplot ( titanic . age , rug = True , rug_kws = { 'alpha' : . 1 , 'color' : 'k' }) In [10]: sns . lmplot ( x = \"age\" , y = \"fare\" , hue = \"sex\" , data = titanic , size = 8 ) Hmm... the slopes seem to be different for males and females. Remember this for later. How about sex and class? In [11]: titanic . sex . value_counts () In [12]: titanic [ 'class' ] . value_counts () # Why couldn't we write `titanic.class.value_counts()` here? In [13]: sns . barplot ( x = \"class\" , hue = \"sex\" , y = \"fare\" , data = titanic ) In [14]: sns . violinplot ( x = \"class\" , hue = \"sex\" , y = \"fare\" , data = titanic ) Aside: can we replicate that violin plot without Seaborn? In [15]: # plt.violinplot takes an array of data arrays, and plots each one as a separate violin. # The data arrays don't have to be the same length. # It returns Matplotlib objects corresponding to each of the pieces of the visualization. plt . violinplot ([ [ 0 , 1 , 2 ], [ 10 , 14 , 9 , 10 , 10 , 10 ], [ 6 ] ]) In [16]: # We can use Pandas queries to make datasets for each class. # We need to use `.values` to get plain Numpy arrays. classes = 'First Second Third' . split () plt . violinplot ([ titanic [ 'fare' ][ titanic [ 'class' ] == cls ] . values for cls in classes ]) plt . xticks ([ 1 , 2 , 3 ], classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [17]: # It gets a little more tricky when we want to plot the two sexes side-by-side. # Fortunately we can tell violinplot to place the violins at different positions. position_array = [ 0 , 4 , 5 ] # just to show the effect of the position array. plt . violinplot ([ titanic [ 'fare' ][ titanic [ 'class' ] == cls ] . values for cls in classes ], positions = position_array ) #plt.xticks(position_array, classes) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [18]: # We can use the position array to shift the male and female violins. sexes = 'male female' . split () positions_array = np . arange ( len ( classes )) # this will be [0, 1, 2] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [19]: # But what about a legend? Unfortunately plt.violinplot doesn't support legends, so we # have to do it by hand. positions_array = np . arange ( len ( classes )) fake_handles = [] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) fake_handles . append ( mpatches . Patch ()) plt . legend ( fake_handles , sexes ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [20]: # Dang, the colors are wrong. We'll have to use some hacky code to pull the color out of the violin... positions_array = np . arange ( len ( classes )) fake_handles = [] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) cur_violin_color = violin [ 'cbars' ] . get_color ()[ 0 ] fake_handles . append ( mpatches . Patch ( color = cur_violin_color )) plt . legend ( fake_handles , sexes ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); In [21]: # Or explicitly control the colors. colors = sns . color_palette ( \"Set1\" , n_colors = len ( sexes ), desat =. 5 ) sns . palplot ( colors ) In [22]: positions_array = np . arange ( len ( classes )) fake_handles = [] for i , sex in enumerate ( sexes ): offset = . 15 * ( - 1 if i == 0 else 1 ) violin = plt . violinplot ([ titanic [ 'fare' ][( titanic [ 'sex' ] == sex ) & ( titanic [ 'class' ] == cls )] . values for cls in classes ], positions = positions_array + offset , widths =. 25 , showmedians = True , showextrema = True ) # Set the color color = colors [ i ] for part_name , part in violin . items (): if part_name == 'bodies' : for body in violin [ 'bodies' ]: body . set_color ( color ) else : part . set_color ( color ) fake_handles . append ( mpatches . Patch ( color = color )) plt . legend ( fake_handles , sexes ) plt . xticks ( positions_array , classes ) plt . xlabel ( \"Ticket Class\" ) plt . ylabel ( \"Fare\" ); No more digression, back to regressions. So it looks like fare varies with class, age, and maybe gender, and the way that fare depends on class and age may be different for male vs female. Let's first do a simple linear regression on age. In [23]: model1 = sm . OLS ( titanic . fare , sm . add_constant ( titanic [ 'age' ]) ) . fit () model1 . summary () How do we interpret this? How good is this model? Does age affect fare? How can we tell? And if so, how? Handling categorical variables Statistical packages generally distinguish between three types of variables: continuous variables, like age and fare. nominal variables, like gender and whether the person survived ordinal variables like cabin class (first > second > third) (Ordinal variables can often be treated like nominal variables; that's what we'll do for now.) How do we deal with gender, or class? They're categorical variables. We'll need to use dummy variables to encode them. In [24]: titanic_orig = titanic . copy () **Exercise 2**: Create a column `sex_male` that is 1 if the passenger is male, 0 otherwise. In [25]: # Your code here **Exercise 3**: Do we need a `sex_female` column, or any others? Why or why not? your answer here **Exercise 4**: Create columns for `class_` In [26]: # Your code here In [27]: titanic . info () In [28]: # Your code here **Exercise 5**: Fit a linear regression including the new sex and class variables. In [29]: # Your code here **Exercise 6** How do we interpret these results? All else being equal, what does being male do to the fare? What can we say about being male and first-class ? Your answer here Interactions In [30]: # It seemed like gender interacted with age and class. Can we put that in our model? titanic [ 'sex_male_X_age' ] = titanic [ 'age' ] * titanic [ 'sex_male' ] model3 = sm . OLS ( titanic . fare , sm . add_constant ( titanic [[ 'age' , 'sex_male' , 'class_Second' , 'class_Third' , 'sex_male_X_age' ]]) ) . fit () model3 . summary () What happened to the age and male terms? In [31]: # It seemed like gender interacted with age and class. Can we put that in our model? titanic [ 'sex_male_X_class_Second' ] = titanic [ 'age' ] * titanic [ 'class_Second' ] titanic [ 'sex_male_X_class_Third' ] = titanic [ 'age' ] * titanic [ 'class_Third' ] model4 = sm . OLS ( titanic . fare , sm . add_constant ( titanic [[ 'age' , 'sex_male' , 'class_Second' , 'class_Third' , 'sex_male_X_age' , 'sex_male_X_class_Second' , 'sex_male_X_class_Third' ]]) ) . fit () model4 . summary () What has happened to the $R&#94;2$ as we added more features? Does this mean that the model is better? (What if we kept adding more predictors and interaction terms? We'll explore this in the next homework.) In [32]: models = [ model1 , model2 , model3 , model4 ] plt . plot ([ model . df_model for model in models ], [ model . rsquared for model in models ], 'x-' ) plt . xlabel ( \"Model df\" ) plt . ylabel ( \"$R&#94;2$\" ); 2. Model Selection via exhaustive search selection The dataset for this problem contains 10 simulated predictors and a response variable. In [33]: # Import the dataset data = pd . read_csv ( 'data/dataset3.txt' ) data . head () By visually inspecting the data set, do we find that some of the predictors are correlated amongst themselves? In [34]: sns . pairplot ( data ) Predictors x1, x2, x3 seem to be perfectly correlated while predictors x4, x5, x6, x7 show very high degrees of correlation. In [35]: data . corr () Let us compute the cofficient of correlation between each pair of predictors, and visualize the matrix of correlation coefficients using a heat map. In [36]: # generating heat map sns . heatmap ( data . corr ()) Do the predictors fall naturally into groups based on the correlation values? We can see that higly correlated predictors fall into dark red groups based on correlation values close to 1. Other correlation values also form differently coloured groups. **If you were asked to select a minimal subset of predictors based on the correlation information in order to build a good regression model, how many predictors will you pick, and which ones will you choose? ** Your answer here We may choose one predictor from the x1,x2,x3 list - let's pick x1. Similarly, let's pick x6 out of x4,x5,x6,x7. The other predictors are not strongly correlated, so we pick them all, i.e. x8,x9,x10. Thus, we have picked 5 predictors x1, x6, x8, x9, x10 for our regression model. Model Selection Criteria: Bayesian Information Criterion (BIC) Generally BIC = -2 x Log-likehood + 2 x log(K) For least-squares regression specifically, $$BIC = n \\log \\Big(\\frac{RSS}{n}\\Big) + \\log(n)*K$$ where, RSS = Residual Sum of Squares n = the number of obervations K = the number of features in our model Selecting minimal subset of predictors Let us apply the exhaustive search variable selection methods discussed in class to choose a minimal subset of predictors that yield high prediction accuracy. We will use the Bayesian Information Criterion (BIC) to choose the subset size. In [37]: x = data . iloc [:,: - 1 ] y = data . iloc [:, - 1 ] x . shape , y . shape In [38]: def find_best_subset_of_size ( x , y , num_predictors ): predictors = x . columns best_r_squared = - np . inf best_model_data = None # Enumerate subsets of the given size subsets_of_size_k = itertools . combinations ( predictors , num_predictors ) # Inner loop: iterate through subsets_k for subset in subsets_of_size_k : # Fit regression model using ‘subset' and calculate R&#94;2 # Keep track of subset with highest R&#94;2 features = list ( subset ) x_subset = sm . add_constant ( x [ features ]) model = sm . OLS ( y , x_subset ) . fit () r_squared = model . rsquared # Check if we get a higher R&#94;2 value than than current max R&#94;2. # If so, update our best subset if r_squared > best_r_squared : best_r_squared = r_squared best_model_data = { 'r_squared' : r_squared , 'subset' : features , 'model' : model } return best_model_data In [39]: find_best_subset_of_size ( x , y , 8 ) In [40]: def exhaustive_search_selection ( x , y ): \"\"\"Exhaustively search predictor combinations Parameters: ----------- x : DataFrame of predictors/features y : response varible Returns: ----------- Dataframe of model comparisons and OLS Model with lowest BIC for subset with highest R&#94;2 \"\"\" predictors = x . columns stats = [] models = dict () # Outer loop: iterate over sizes 1, 2 .... d for k in range ( 1 , len ( predictors )): best_size_k_model = find_best_subset_of_size ( x , y , num_predictors = k ) best_subset = best_size_k_model [ 'subset' ] best_model = best_size_k_model [ 'model' ] stats . append ({ 'k' : k , 'formula' : \"y ~ {} \" . format ( ' + ' . join ( best_subset )), 'bic' : best_model . bic , 'r_squared' : best_model . rsquared }) models [ k ] = best_model return pd . DataFrame ( stats ), models In [41]: stats , models = exhaustive_search_selection ( x , y ) stats In [42]: stats . plot ( x = 'k' , y = 'bic' , marker = '*' ) In [43]: stats . info () In [44]: best_stat = stats . iloc [ stats . bic . idxmin ()] best_stat In [45]: best_k = best_stat [ 'k' ] best_bic = best_stat [ 'bic' ] best_formula = best_stat [ 'formula' ] best_r2 = best_stat [ 'r_squared' ] In [46]: print ( \"The best overall model is ` {formula} ` with bic= {bic:.2f} and R&#94;2= {r_squared:.3f} \" . format ( formula = best_formula , bic = best_bic , r_squared = best_r2 )) In [47]: models [ best_k ] . summary () Do the chosen subsets match the ones you picked using the correlation matrix you had visualized? Yes! The predictor subset matches with the ones we picked before. In [ ]: Plotting multiple axes in a single figure source: http://matplotlib.org/faq/usage_faq.html See also this matplotlib tutorial. In [ ]: if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-3/student/"},{"title":"Standard Section 4: Model Selection","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 4: Model Selection Harvard University Fall 2018 Instructors: Pavlos Protopapas, Kevin Rader Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan Motwani, Cecilia Garraffo In [2]: #RUN THIS CELL from IPython.core.display import HTML HTML ( ' h1{padding-top:25px;padding-bottom:25px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black}h2{padding-top:10px;padding-bottom:10px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}div.exercise{background-color:#ffcccc;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em}div.theme{background-color:#DDDDDD;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em;font-size:18pt}p.q1{padding-top:5px;padding-bottom:5px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}header{padding-top:35px;padding-bottom:35px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black} ' ) Out[2]: h1{padding-top:25px;padding-bottom:25px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black}h2{padding-top:10px;padding-bottom:10px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}div.exercise{background-color:#ffcccc;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em}div.theme{background-color:#DDDDDD;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em;font-size:18pt}p.q1{padding-top:5px;padding-bottom:5px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}header{padding-top:35px;padding-bottom:35px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black} In [2]: # Data and Stats packages import numpy as np import pandas as pd from sklearn import metrics , datasets from sklearn.model_selection import train_test_split from sklearn.neighbors import KNeighborsRegressor from sklearn.linear_model import LinearRegression , Lasso , LassoCV , Ridge , RidgeCV import statsmodels.api as sm # Visualization packages % matplotlib inline import matplotlib import matplotlib.pyplot as plt import seaborn as sns matplotlib . rcParams [ 'figure.figsize' ] = ( 13.0 , 6.0 ) # Other import itertools import tqdm # Aesthetic settings from IPython.display import display pd . set_option ( 'display.max_columns' , 999 ) pd . set_option ( 'display.width' , 500 ) sns . set_style ( 'whitegrid' ) sns . set_context ( 'talk' ) /Users/kcarnold/anaconda3/envs/py36/lib/python3.6/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead. from pandas.core import datetools NYC Car Hire Dataset The dataset can be downloaded from https://drive.google.com/open?id=0B28c493CP9GtRHFVM0U0SVI2Yms Our goal, as in lecture, will be to predict taxi fares based on various other features of the ride. For descriptions of what the columns mean, see http://www.nyc.gov/html/tlc/html/about/trip_record_data.shtml and data dictionaries there. In [3]: # Instead of converting to datetime after loading, you can tell Pandas the datatypes you want while loading. nyc_cab_df = pd . read_csv ( 'nyc_car_hire_data.csv' , dtype = { 'Store_and_fwd_flag' : str , 'Base' : str }, parse_dates = [ 'lpep_pickup_datetime' , 'Lpep_dropoff_datetime' ]) nyc_cab_df [ 'pickup_hour' ] = nyc_cab_df . lpep_pickup_datetime . dt . hour nyc_cab_df [ 'dropoff_hour' ] = nyc_cab_df . Lpep_dropoff_datetime . dt . hour nyc_cab_df . head () Out[3]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } AWND Base Day Dropoff_latitude Dropoff_longitude Ehail_fee Extra Fare_amount Lpep_dropoff_datetime MTA_tax PRCP Passenger_count Payment_type Pickup_latitude Pickup_longitude RateCodeID SNOW SNWD Store_and_fwd_flag TMAX TMIN Tip_amount Tolls_amount Total_amount Trip_distance Trip_type Type VendorID lpep_pickup_datetime Trip Length (min) pickup_hour dropoff_hour 0 4.7 B02512 1 NaN NaN NaN NaN 33.863498 2014-04-01 00:24:00 NaN 0.0 NaN NaN 40.7690 -73.9549 NaN 0.0 0.0 NaN 60 39 NaN NaN NaN 4.083561 NaN 1 NaN 2014-04-01 00:11:00 13.0 0 0 1 4.7 B02512 1 NaN NaN NaN NaN 19.022892 2014-04-01 00:29:00 NaN 0.0 NaN NaN 40.7267 -74.0345 NaN 0.0 0.0 NaN 60 39 NaN NaN NaN 3.605694 NaN 1 NaN 2014-04-01 00:17:00 12.0 0 0 2 4.7 B02512 1 NaN NaN NaN NaN 25.498981 2014-04-01 00:34:00 NaN 0.0 NaN NaN 40.7316 -73.9873 NaN 0.0 0.0 NaN 60 39 NaN NaN NaN 4.221763 NaN 1 NaN 2014-04-01 00:21:00 13.0 0 0 3 4.7 B02512 1 NaN NaN NaN NaN 28.024628 2014-04-01 00:39:00 NaN 0.0 NaN NaN 40.7588 -73.9776 NaN 0.0 0.0 NaN 60 39 NaN NaN NaN 2.955510 NaN 1 NaN 2014-04-01 00:28:00 11.0 0 0 4 4.7 B02512 1 NaN NaN NaN NaN 12.083589 2014-04-01 00:40:00 NaN 0.0 NaN NaN 40.7594 -73.9722 NaN 0.0 0.0 NaN 60 39 NaN NaN NaN 1.922292 NaN 1 NaN 2014-04-01 00:33:00 7.0 0 0 Let's have a quick look at the data before we get started. (We really should do more than this, but skipping that for time.) In [4]: plt . boxplot ( nyc_cab_df . Fare_amount ); In [5]: # We notice there's some big outliers; let's remove them for now. q1 , q3 = nyc_cab_df . Fare_amount . quantile ([ . 25 , . 75 ]) iqr = q3 - q1 outlier = ( nyc_cab_df . Fare_amount == 0 ) | ( nyc_cab_df . Fare_amount > q3 + 2.5 * iqr ) # A generous criterion. nyc_cab_df_clean = nyc_cab_df [ ~ outlier ] print ( f \"Removed {outlier.sum()} outliers ({outlier.mean():.1%})\" ) Removed 10019 outliers (0.5%) In [6]: # Just plotting distributions to see if there's any more blatant things to notice. Skipping for presentation. sns . distplot ( nyc_cab_df_clean . Fare_amount ) /Users/kcarnold/anaconda3/envs/py36/lib/python3.6/site-packages/scipy/stats/stats.py:1706: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result. return np.add.reduce(sorted[indexer] * weights, axis=axis) / sumval Out[6]: Let's work with a subset of this data for now. In [7]: # TODO: some useful predictors may be missing, but maybe because they have missing data. # nyc_cab_df.columns.difference(all_predictors) all_predictors = [ 'Trip Length (min)' , 'Type' , 'Trip_distance' , 'TMAX' , 'TMIN' , 'pickup_hour' , 'dropoff_hour' , 'Pickup_longitude' , 'Pickup_latitude' , 'SNOW' , 'SNWD' , 'PRCP' ] sample_frac = . 01 shuffled = nyc_cab_df_clean . sample ( frac = sample_frac , random_state = 0 )[ all_predictors + [ 'Fare_amount' ]] shuffled . shape n_total = len ( shuffled ) n_test = int ( n_total * . 2 ) n_valid = int ( n_total * . 2 ) n_train = n_total - n_valid - n_test train = shuffled . iloc [: n_train ] . copy () valid = shuffled . iloc [ n_train : n_train + n_valid ] . copy () test = shuffled . iloc [ n_train + n_valid :] . copy () assert len ( train ) == n_train assert len ( valid ) == n_valid assert len ( test ) == n_test print ( f \" {n_train} train, {n_valid} validation, {n_test} test.\" ) 11183 train, 3727 validation, 3727 test. In [8]: train . info () Int64Index: 11183 entries, 959269 to 686097 Data columns (total 13 columns): Trip Length (min) 11183 non-null float64 Type 11183 non-null int64 Trip_distance 11183 non-null float64 TMAX 11183 non-null int64 TMIN 11183 non-null int64 pickup_hour 11183 non-null int64 dropoff_hour 11183 non-null int64 Pickup_longitude 11183 non-null float64 Pickup_latitude 11183 non-null float64 SNOW 11183 non-null float64 SNWD 11183 non-null float64 PRCP 11183 non-null float64 Fare_amount 11183 non-null float64 dtypes: float64(8), int64(5) memory usage: 1.2 MB Scaling / Normalization Warm-up exercise: for which of the following do the units of the predictors matter (e.g., trip length in minutes vs seconds; temperature in F or C)? k-NN (Nearest Neighbors regression) Linear regression Lasso regression Ridge regression kNN: yes . Scaling affects distance metric, which determines what \"neighbor\" means Linear regression: no . Multiply predictor by $c$ -> divide coef by $c$. Lasso: yes : If we divided coef by $c$, then corresponding penalty term is also divided by $c$. Ridge: yes : Same as Lasso, except penalty divided by $c&#94;2$. Remember that the mean and variance used to scale data are parameters that need to be learned from our training data. In [9]: from sklearn.preprocessing import StandardScaler scaler = StandardScaler () . fit ( train [ all_predictors ]) pd . DataFrame ({ 'mean' : scaler . mean_ , 'variance' : scaler . var_ }, index = all_predictors ) . T Out[9]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Trip Length (min) Type Trip_distance TMAX TMIN pickup_hour dropoff_hour Pickup_longitude Pickup_latitude SNOW SNWD PRCP mean 11.330680 0.300009 2.875462 60.886167 43.269874 13.980148 13.978897 -73.879007 40.718952 0.0 0.0 0.336174 variance 61.431918 0.210004 5.458100 70.157211 36.335824 42.114960 43.055980 4.887413 1.486695 0.0 0.0 1.105074 In [10]: # Scaling in place... not my favorite approach for df in [ train , valid , test ]: df [ all_predictors ] = scaler . transform ( df [ all_predictors ]) In [11]: train [ all_predictors ] . describe () Out[11]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Trip Length (min) Type Trip_distance TMAX TMIN pickup_hour dropoff_hour Pickup_longitude Pickup_latitude SNOW SNWD PRCP count 1.118300e+04 1.118300e+04 1.118300e+04 1.118300e+04 1.118300e+04 1.118300e+04 1.118300e+04 1.118300e+04 1.118300e+04 11183.0 11183.0 1.118300e+04 mean -8.895286e-17 -8.895286e-18 1.105557e-16 -2.265121e-16 -5.534139e-16 -5.511900e-17 1.906133e-17 -4.778039e-16 3.429768e-15 0.0 0.0 -9.530664e-18 std 1.000045e+00 1.000045e+00 1.000045e+00 1.000045e+00 1.000045e+00 1.000045e+00 1.000045e+00 1.000045e+00 1.000045e+00 0.0 0.0 1.000045e+00 min -1.445636e+00 -6.546676e-01 -1.230798e+00 -1.657854e+00 -2.035507e+00 -2.154238e+00 -2.130375e+00 -2.332211e-01 -3.339532e+01 0.0 0.0 -3.197923e-01 25% -6.801201e-01 -6.546676e-01 -6.615118e-01 -8.221316e-01 -5.424547e-01 -7.674041e-01 -7.587809e-01 -4.550192e-02 -3.110732e-04 0.0 0.0 -3.197923e-01 50% -1.697762e-01 -6.546676e-01 -2.420375e-01 1.359045e-02 -4.477065e-02 1.571516e-01 3.080150e-01 -3.345387e-02 2.595593e-02 0.0 0.0 -3.197923e-01 75% 3.405678e-01 1.527493e+00 3.186884e-01 7.299237e-01 4.529134e-01 7.735220e-01 7.652132e-01 -1.930459e-02 6.536592e-02 0.0 0.0 -2.532033e-01 max 5.954351e+00 1.527493e+00 8.113206e+00 1.923812e+00 2.609544e+00 1.389892e+00 1.374811e+00 3.341808e+01 3.855061e-01 0.0 0.0 4.408025e+00 In [12]: train . Fare_amount . describe () Out[12]: count 11183.000000 mean 14.650476 std 8.598972 min 0.010000 25% 7.500000 50% 13.000000 75% 20.014209 max 52.500000 Name: Fare_amount, dtype: float64 Nearest-Neighbors Regression: How many neighbors should we use? In [13]: k_vals = [ 1 , 5 , 10 , 15 , 20 , 25 , 30 , 35 , 40 , 50 , 60 ] knns = { k : KNeighborsRegressor ( n_neighbors = k ) . fit ( train [ all_predictors ], train . Fare_amount ) for k in k_vals } train_r2s = [ metrics . r2_score ( train . Fare_amount , model . predict ( train [ all_predictors ])) for k , model in knns . items ()] In [14]: plt . plot ( k_vals , train_r2s , '-+' , label = \"Train\" ) plt . xlabel ( 'n_neighbors' ) plt . ylabel ( \"$R&#94;2$\" ) plt . legend (); Which n_neighbors should we choose? What's our goal? Do best on unseen data. Validation set is currently unseen. So let's see how well our models do on it. In [15]: val_r2s = [ metrics . r2_score ( valid . Fare_amount , model . predict ( valid [ all_predictors ])) for k , model in knns . items ()] In [16]: plt . plot ( k_vals , train_r2s , '-+' , label = \"Train\" ) plt . plot ( k_vals , val_r2s , '-*' , label = \"Validation\" ) plt . xlabel ( 'n_neighbors' ) plt . ylabel ( \"$R&#94;2$\" ) plt . legend (); Now, which n_neighbors should we choose? In [17]: best_r2_idx = np . argmax ( val_r2s ) best_r2 = val_r2s [ best_r2_idx ] best_n_neighbors = k_vals [ best_r2_idx ] print ( f \"Best n_neighbors is {best_n_neighbors} , which gives a validation R&#94;2 of {best_r2:.3f} \" ) Best n_neighbors is 10, which gives a validation R&#94;2 of 0.855 How confident are we about that choice? What if there was something unusual about our particular validation set? How could we gain more confidence? Cross-Validation If we repeat an experiment and the results say the same thing, we get more confident in that result. How could we repeat this experiment? Let's choose different subsets of our data as our training and validation sets. In [18]: from sklearn.model_selection import KFold n_splits = 10 folds = np . zeros (( n_splits , len ( train ))) fake_dataset = np . arange ( len ( train )) for fold_idx , ( train_indices , valid_indices ) in enumerate ( KFold ( n_splits = n_splits ) . split ( fake_dataset )): folds [ fold_idx , train_indices ] = 2 folds [ fold_idx , valid_indices ] = 1 fig , ax = plt . subplots ( figsize = ( 10 , 5 )) sns . heatmap ( folds [:: - 1 ], ax = ax ) # TODO: label this better! ax . set ( xlabel = \"Datum idx\" , ylabel = \"Fold idx\" ); Cross-Validation core In [19]: X = train [ all_predictors ] y = train . Fare_amount In [20]: n_neighbors = 10 # for example cv = KFold ( n_splits = 10 ) cv_r2 = [] for fold_idx , ( train_indices , valid_indices ) in enumerate ( cv . split ( X )): # Train on training set. model = KNeighborsRegressor ( n_neighbors = n_neighbors ) model . fit ( X . iloc [ train_indices ], y . iloc [ train_indices ]) # Evaluate on validation set. val_predictions = model . predict ( X . iloc [ valid_indices ]) val_r2 = metrics . r2_score ( y . iloc [ valid_indices ], val_predictions ) cv_r2 . append ( val_r2 ) In [21]: sns . boxplot ( cv_r2 ); plt . xlabel ( \"Validation $R&#94;2$\" ); Now do this for each candidate n_neighbors! In [22]: def cross_validate_knn ( X , y , n_splits , k_vals ): cv_results = [] cv = KFold ( n_splits = n_splits ) # Outer loop: pick n_neighbors for n_neighbors in k_vals : # Inner loop: pick train and validation sets. for fold_idx , ( train_indices , valid_indices ) in enumerate ( cv . split ( X )): # Train on training set. model = KNeighborsRegressor ( n_neighbors = n_neighbors ) model . fit ( X . iloc [ train_indices ], y . iloc [ train_indices ]) # Evaluate on validation set. I include MSE here just to show how. val_predictions = model . predict ( X . iloc [ valid_indices ]) val_r2 = metrics . r2_score ( y . iloc [ valid_indices ], val_predictions ) val_mse = metrics . mean_squared_error ( y . iloc [ valid_indices ], val_predictions ) cv_results . append ( dict ( fold_idx = fold_idx , n_neighbors = n_neighbors , val_r2 = val_r2 , val_mse = val_mse )) return pd . DataFrame ( cv_results ) cv_results = cross_validate_knn ( X , y , n_splits = 10 , k_vals = k_vals ) cv_results . head ( 11 ) Out[22]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } fold_idx n_neighbors val_mse val_r2 0 0 1 19.582487 0.751775 1 1 1 17.710063 0.743087 2 2 1 17.890290 0.739744 3 3 1 15.108882 0.790357 4 4 1 21.316752 0.713888 5 5 1 15.927632 0.773481 6 6 1 16.262528 0.774167 7 7 1 16.395153 0.789799 8 8 1 19.922931 0.728344 9 9 1 16.710313 0.795838 10 0 5 12.751734 0.838361 In [23]: # Make a table of the validation R&#94;2 data, where each row is a different fold. val_r2_table = cv_results . pivot ( index = 'fold_idx' , columns = 'n_neighbors' , values = 'val_r2' ) # alternative: cv_results.set_index(['fold_idx', 'n_neighbors']).val_r2.unstack(level=1) val_r2_table Out[23]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } n_neighbors 1 5 10 15 20 25 30 35 40 50 60 fold_idx 0 0.751775 0.838361 0.846247 0.848543 0.846561 0.845755 0.843973 0.844033 0.840830 0.837155 0.834562 1 0.743087 0.829843 0.853299 0.858193 0.857334 0.856293 0.854176 0.853082 0.851862 0.849573 0.847336 2 0.739744 0.851182 0.859116 0.861349 0.863230 0.860448 0.860142 0.857826 0.855546 0.852625 0.849647 3 0.790357 0.855258 0.860757 0.863444 0.862979 0.862656 0.860542 0.858673 0.859154 0.855150 0.851734 4 0.713888 0.785308 0.791115 0.797459 0.797057 0.794462 0.792262 0.789779 0.788168 0.783295 0.780932 5 0.773481 0.842808 0.852990 0.859311 0.862505 0.858309 0.855681 0.854264 0.853136 0.849946 0.846897 6 0.774167 0.832477 0.844946 0.843760 0.844797 0.843010 0.841472 0.839870 0.838088 0.835430 0.832205 7 0.789799 0.855152 0.860794 0.860559 0.861657 0.859818 0.856437 0.854543 0.852385 0.850082 0.846750 8 0.728344 0.788996 0.800917 0.801670 0.800536 0.799309 0.798490 0.796204 0.794484 0.790631 0.789120 9 0.795838 0.871517 0.875833 0.874913 0.875388 0.874800 0.874535 0.873019 0.871999 0.869174 0.865932 Let's visualize that data, 3 different ways. In [24]: fig , ax = plt . subplots ( figsize = ( 10 , 5 )) for fold_idx , row in val_r2_table . iterrows (): ax . plot ( row . index , row . values , '-x' , c = 'black' , alpha =. 3 , label = \"single fold\" if fold_idx is 0 else None ) # plt.plot(row.index, val_r2_table.mean(axis=0), c='white', linewidth=5) ax . plot ( row . index , val_r2_table . mean ( axis = 0 ), label = 'Mean' ) ax . legend () ax . set ( xlabel = \"n_neighbors\" , ylabel = \"$R&#94;2$ on validation fold\" , title = \"Performance vs hyperparameter over different CV folds\" ); In [25]: fig , ax = plt . subplots ( figsize = ( 10 , 5 )) ax . boxplot ( val_r2_table . values , positions = k_vals , widths = 4 ); ax . set ( xlabel = \"n_neighbors\" , ylabel = \"$R&#94;2$ on validation fold\" ); In [26]: cv_r2_mean = cv_results . groupby ( 'n_neighbors' ) . val_r2 . mean () cv_r2_std = cv_results . groupby ( 'n_neighbors' ) . val_r2 . std () plt . errorbar ( k_vals , cv_r2_mean , yerr = cv_r2_std , capsize = 5 ) plt . gca () . set ( xlabel = \"n_neighbors\" , ylabel = \"Validation $R&#94;2$ $\\pm$ stdev\" ); Now, which n_neighbors should you choose? Make a final model with our optimal hyperparameter value For now, let's use the model with the best mean CV performance. In [27]: best_n_neighbors = cv_r2_mean . idxmax () estimated_r2_best = cv_r2_mean [ best_n_neighbors ] print ( \"The best n_neighbors is {} , with estimated R&#94;2 = {:.2f} +- {:.2f} \" . format ( best_n_neighbors , estimated_r2_best , cv_r2_std [ best_n_neighbors ])) The best n_neighbors is 20, with estimated R&#94;2 = 0.85 +- 0.03 In [28]: all_my_data = pd . concat ([ train , valid ]) my_best_model = ( KNeighborsRegressor ( n_neighbors = best_n_neighbors ) . fit ( all_my_data [ all_predictors ], all_my_data . Fare_amount )) assert len ( train ) + len ( valid ) == len ( all_my_data ) print ( f \"Trained a new model on {len(train)} + {len(valid)} = {len(all_my_data)} samples.\" ) Trained a new model on 11183 + 3727 = 14910 samples. How well does this model perform on unseen data? We've already looked at train and validation . Only test remains completely unseen. The point of no return... In [29]: print ( f \"We expect our best model to get an R&#94;2 of {estimated_r2_best:.3f} , or even better because we have more data now.\" ) print ( \"Drumroll please...\" ) We expect our best model to get an R&#94;2 of 0.847, or even better because we have more data now. Drumroll please... In [30]: test_predictions = my_best_model . predict ( test [ all_predictors ]) test_r2 = metrics . r2_score ( test . Fare_amount , test_predictions ) print ( f \"Our best model got an R&#94;2 of {test_r2:.3f} .\" ) Our best model got an R&#94;2 of 0.817. btw, when I first ran this, the test R&#94;2 was much worse, ~0.5. But I figured out why. Can you? It turns out that the test set happened to have some enormous outliers. Same approach works for penalized regression! In [36]: def cross_validate_general ( train_model , X , y , n_splits , params ): cv_results = [] cv = KFold ( n_splits = n_splits ) # Outer loop: pick hyperparameter setting. for param_setting in params : # Inner loop: pick train and validation sets. for fold_idx , ( train_indices , valid_indices ) in enumerate ( cv . split ( X , y )): # Train on training set. model = train_model ( X [ train_indices ], y [ train_indices ], param_setting ) # Evaluate on validation set. val_predictions = model . predict ( X [ valid_indices ]) val_r2 = metrics . r2_score ( y [ valid_indices ], val_predictions ) val_mse = metrics . mean_squared_error ( y [ valid_indices ], val_predictions ) cv_results . append ( dict ( param_setting , fold_idx = fold_idx , val_r2 = val_r2 , val_mse = val_mse )) return pd . DataFrame ( cv_results ) def train_lasso ( X , y , params ): return Lasso ( alpha = params [ 'alpha' ]) . fit ( X , y ) def train_KNN ( X , y , params ): return KNeighborsRegressor ( n_neighbors = params [ 'n_neighbors' ]) . fit ( X , y ) X = train [ all_predictors ] . values y = train . Fare_amount . values params = [{ 'alpha' : alpha } for alpha in [ . 001 , . 01 , . 1 , 1. , 10. ]] cv_results = cross_validate_general ( train_model = train_lasso , # train_model=train_KNN, X = X , y = y , n_splits = 10 , params = params ) agg_cv_results = cv_results . groupby ( 'alpha' ) . val_r2 . agg ([ 'mean' , 'std' ]) agg_cv_results /Users/kcarnold/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/linear_model/coordinate_descent.py:491: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations. Fitting data with very small alpha may cause precision problems. ConvergenceWarning) Out[36]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } mean std alpha 0.001 0.844636 0.031926 0.010 0.844776 0.031824 0.100 0.844775 0.031353 1.000 0.813970 0.026487 10.000 -0.001185 0.001649 In [37]: best_alpha = agg_cv_results [ 'mean' ] . idxmax () estimated_r2 = agg_cv_results [ 'mean' ][ best_alpha ] best_model = Lasso ( alpha = best_alpha ) . fit ( X , y ) test_predictions = best_model . predict ( test [ all_predictors ] . values ) test_r2 = metrics . r2_score ( test . Fare_amount , test_predictions ) print ( f \"Best alpha was {best_alpha} , with estimated R&#94;2 of {estimated_r2:.3f} .\" ) print ( f \"Training this on all data gives a test R&#94;2 of {test_r2:.3f} \" ) Best alpha was 0.01, with estimated R&#94;2 of 0.845. Training this on all data gives a test R&#94;2 of 0.803 In [33]: # We could also use a meta-estimator from sklearn. # But make sure you understand all of what's going on in the above first! from sklearn.model_selection import GridSearchCV gridsearch_model = GridSearchCV ( estimator = Lasso (), param_grid = [{ 'alpha' : [ . 1 , 1. , 10. ]}], cv = KFold ( n_splits = 10 ), scoring = 'r2' , return_train_score = False ) gridsearch_model . fit ( X , y ) pd . DataFrame ( gridsearch_model . cv_results_ ) . set_index ( 'param_alpha' ) Out[33]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } mean_fit_time std_fit_time mean_score_time std_score_time params split0_test_score split1_test_score split2_test_score split3_test_score split4_test_score split5_test_score split6_test_score split7_test_score split8_test_score split9_test_score mean_test_score std_test_score rank_test_score param_alpha 0.1 0.002758 0.000181 0.000329 0.000071 {'alpha': 0.1} 0.848971 0.852551 0.857965 0.864766 0.780191 0.863877 0.843819 0.856511 0.797919 0.881180 0.844777 0.029740 1 1.0 0.002498 0.000339 0.000279 0.000051 {'alpha': 1.0} 0.815950 0.819903 0.823129 0.838299 0.761552 0.825254 0.812359 0.825485 0.773266 0.844504 0.813972 0.025125 2 10.0 0.001751 0.000142 0.000266 0.000034 {'alpha': 10.0} -0.000373 -0.000410 -0.001153 -0.000108 -0.000075 -0.005123 -0.000034 -0.002568 -0.000001 -0.002008 -0.001185 0.001564 3 In [34]: # It also refits the model on the full dataset, so we get the same test R&#94;2. gridsearch_model . score ( test [ all_predictors ], test . Fare_amount ) Out[34]: 0.803262478581998 Homework Critique Good visuals \"don't make me think\". Good written analysis interprets (doesn't just describe) and connects the data with the real world . Good code is easy to change without making mistakes, which lets you iterate faster. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-4/demo/"},{"title":"Standard Section 5: Logistic Regression and Principal Component Analysis (PCA)","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 5: Logistic Regression and PCA Harvard University Fall 2018 Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan Motwani, Cecilia Garraffo Instructors: Pavlos Protopapas, Kevin Rader In [1]: #RUN THIS CELL from IPython.core.display import HTML HTML ( ' h1{padding-top:25px;padding-bottom:25px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black}h2{padding-top:10px;padding-bottom:10px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}div.exercise{background-color:#ffcccc;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em}div.theme{background-color:#DDDDDD;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em;font-size:18pt}p.q1{padding-top:5px;padding-bottom:5px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}header{padding-top:35px;padding-bottom:35px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black} ' ) Out[1]: h1{padding-top:25px;padding-bottom:25px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black}h2{padding-top:10px;padding-bottom:10px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}div.exercise{background-color:#ffcccc;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em}div.theme{background-color:#DDDDDD;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em;font-size:18pt}p.q1{padding-top:5px;padding-bottom:5px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}header{padding-top:35px;padding-bottom:35px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black} In this section we will be covering Logistic Regression and PCA using the Wine dataset. The goal is to get you familiarized with the implementation of Logistic Regresison and PCA through the use of a dataset we haven't seen. The exercises below will help you be able to answer parts of Homework 5. Specifically, we will: 1. Import data, explore with analyse relationship with response. 2. Fit a linear regression model for classification, understand drawbacks and interpret results. 3. Fit a logistic regression model for classification, compare performance and interpret results. 3. Use PCA to reduce dimensionality, fit model to PCA components and compare performance. For this section we will be using the following packages: In [1]: # Data and Stats packages import numpy as np import pandas as pd import statsmodels.api as sm from statsmodels.api import OLS from sklearn import metrics , datasets from sklearn.model_selection import train_test_split from sklearn.decomposition import PCA from sklearn.linear_model import LogisticRegression from sklearn.linear_model import LogisticRegressionCV from sklearn.discriminant_analysis import LinearDiscriminantAnalysis from sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis from sklearn.preprocessing import PolynomialFeatures from sklearn.neighbors import KNeighborsClassifier from sklearn.model_selection import cross_val_score from sklearn.metrics import accuracy_score from sklearn.model_selection import KFold from sklearn.preprocessing import MinMaxScaler # Visualization packages % matplotlib inline import matplotlib import matplotlib.pyplot as plt import seaborn as sns matplotlib . rcParams [ 'figure.figsize' ] = ( 13.0 , 6.0 ) # Other import itertools import tqdm # Aesthetic settings from IPython.display import display pd . set_option ( 'display.max_columns' , 999 ) pd . set_option ( 'display.width' , 500 ) sns . set_style ( 'whitegrid' ) sns . set_context ( 'talk' ) /anaconda3/lib/python3.6/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead. from pandas.core import datetools Part One Import Dataset In [2]: #Import dataframe flowers_df = pd . read_csv ( 'flowers.csv' ) del flowers_df [ 'Unnamed: 0' ] display ( flowers_df . head ()) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } sepal_length sepal_width petal_length petal_width species 0 7.0 3.2 4.7 1.4 versicolor 1 6.4 3.2 4.5 1.5 versicolor 2 6.9 3.1 4.9 1.5 versicolor 3 5.5 2.3 4.0 1.3 versicolor 4 6.5 2.8 4.6 1.5 versicolor As we can see, species here is the response variable which defines flower type and the 4 predictor variables are flower characteristics. In [3]: #Describe dataset flowers_df [ 'species' ] = flowers_df [ 'species' ] == 'versicolor' display ( flowers_df . describe ()) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } sepal_length sepal_width petal_length petal_width count 100.000000 100.000000 100.000000 100.000000 mean 6.262000 2.872000 4.906000 1.676000 std 0.662834 0.332751 0.825578 0.424769 min 4.900000 2.000000 3.000000 1.000000 25% 5.800000 2.700000 4.375000 1.300000 50% 6.300000 2.900000 4.900000 1.600000 75% 6.700000 3.025000 5.525000 2.000000 max 7.900000 3.800000 6.900000 2.500000 Explore Data Check which variables have high correlations and distinctive patterns with the response. Any patterns worth mentioning? In [4]: sns . pairplot ( flowers_df , hue = \"species\" ) plt . show () This plot is great because it not only shows correlations but also relationship with the response. The left diagonal shows the histogram for each predictor with the response subset. You can re-create the left diagonal with the code below. In [5]: #Explore dataset for relationships with Quality subset_species_0 , subset_species_1 = flowers_df [ flowers_df [ 'species' ] == 0 ], flowers_df [ flowers_df [ 'species' ] == 1 ] #Get set of predictors columns = list ( flowers_df . columns ) columns . remove ( 'species' ) #Plot relationship fig , ax = plt . subplots ( 2 , 2 , figsize = ( 15 , 15 )) alpha = 0.4 count = 0 for i in range ( 2 ): for j in range ( 2 ): ax [ i , j ] . hist ( subset_species_0 [ columns [ count ]], alpha = alpha , label = 'Species = 0' , normed = True ) ax [ i , j ] . hist ( subset_species_1 [ columns [ count ]], alpha = alpha , label = 'Species = 1' , normed = True ) ax [ i , j ] . set_title ( columns [ count ] + ' vs Quality' ) ax [ i , j ] . set_xlabel ( columns [ count ]) ax [ i , j ] . set_ylabel ( 'Frequency' ) ax [ i , j ] . legend () count += 1 plt . show () We can observe that petal_length , petal_width are useful distinguishing predictors for flower species. Split and Normalize Data In [6]: #Split data into train and test np . random . seed ( 1001 ) msk = np . random . rand ( len ( flowers_df )) < 0.7 data_train = flowers_df [ msk ] data_test = flowers_df [ ~ msk ] #Split predictor and response columns x_train , y_train = data_train . drop ([ 'species' ], axis = 1 ), data_train [ 'species' ] x_test , y_test = data_test . drop ([ 'species' ], axis = 1 ), data_test [ 'species' ] print ( \"Length of Training Set :\" , len ( data_train )) print ( \"Length of Testing Set :\" , len ( data_test )) Length of Training Set : 64 Length of Testing Set : 36 What is the right way to normalize? In [7]: #Function to normalize data def normalize ( df , train_dict , flag = True ): for i in df . columns : if flag : train_dict [ i ] = ( df [ i ] . min (), df [ i ] . max ()) df [ i ] = ( df [ i ] - train_dict [ i ][ 0 ]) / ( train_dict [ i ][ 1 ] - train_dict [ i ][ 0 ]) return df , train_dict #Normalize train and get characteristics of training columns x_train , train_dict = normalize ( x_train , {}, True ) x_test , train_dict = normalize ( x_test , train_dict , False ) Peeking at any information from the test set is cheating, we use the entire dataset for atmost data exploration. No information, including min, max, mean std, should be used from the test set or under the influence of the test set. Thus, the right way to normalize is to store the characteristics of the training set and apply it to both datasets independently. In [8]: print ( \"Training Dataframe :\" ) display ( x_train . describe ()) print ( \" \\n\\n Testing Dataframe :\" ) display ( x_test . describe ()) Training Dataframe : .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } sepal_length sepal_width petal_length petal_width count 64.000000 64.000000 64.000000 64.000000 mean 0.442187 0.416992 0.466747 0.414583 std 0.223429 0.195451 0.213806 0.285936 min 0.000000 0.000000 0.000000 0.000000 25% 0.266667 0.312500 0.307692 0.200000 50% 0.466667 0.437500 0.435897 0.333333 75% 0.575000 0.500000 0.602564 0.666667 max 1.000000 1.000000 1.000000 1.000000 Testing Dataframe : .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } sepal_length sepal_width petal_length petal_width count 36.000000 36.000000 36.000000 36.000000 mean 0.475000 0.425347 0.527778 0.514815 std 0.217981 0.231368 0.204979 0.270267 min 0.000000 -0.125000 0.128205 0.000000 25% 0.358333 0.296875 0.384615 0.316667 50% 0.450000 0.437500 0.525641 0.533333 75% 0.600000 0.562500 0.666667 0.733333 max 0.933333 1.000000 0.948718 1.000000 Some maximum values in Testing Dataframe are not 1, some minimum values are > 0. Is this wrong? What could be an explanation for this? Could we see negative values in test or values greater than 1? Part Two Perform Classification using Multiple Linear Regression In [9]: #Add constant to x_train and x_test x_train_cst = sm . add_constant ( x_train ) x_test_cst = sm . add_constant ( x_test ) #Training model = OLS ( y_train , x_train_cst ) . fit () #Predict y_pred_train = model . predict ( x_train_cst ) > 0.5 y_pred_test = model . predict ( x_test_cst ) > 0.5 #Perfromance Evaluation train_score = accuracy_score ( y_train , y_pred_train ) * 100 test_score = accuracy_score ( y_test , y_pred_test ) * 100 print ( \"Training Set Accuracy:\" , str ( train_score ) + '%' ) print ( \"Testing Set Accuracy:\" , str ( test_score ) + '%' ) Training Set Accuracy: 98.4375% Testing Set Accuracy: 94.44444444444444% In [10]: #Get significant predictors and Confidence Intervals using Stats Model Summary print ( \"Significant Predictors : \\n \" ,) print ( model . pvalues [ model . pvalues < 0.01 ], \" \\n \" ) thresh = 0.01 intervals = model . conf_int ( alpha = thresh ) intervals = intervals . rename ( index = str , columns = { 0 : str ( thresh / 2 * 100 ) + \"%\" , 1 : str (( 1 - thresh / 2 ) * 100 ) + \"%\" }) print ( \"Confidence Intervals:\" ,) display ( intervals ) Significant Predictors : const 1.302238e-21 petal_width 1.368759e-06 dtype: float64 Confidence Intervals: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 0.5% 99.5% const 1.021095 1.466538 sepal_length -0.493553 1.000970 sepal_width -0.115400 0.921418 petal_length -2.049886 0.164881 petal_width -1.768611 -0.597113 Here, we have used a higher probability threshold (p<0.01) since we have very few datapoints. Does this make sense? petal_width seems like the only significant predictor, is this intuitive given the histogram above? In [11]: #Get Performance by Class (Lookup Confusion Matrix) pd . crosstab ( y_test , y_pred_test , margins = True , rownames = [ 'Actual' ], colnames = [ 'Predicted' ]) Out[11]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Predicted False True All Actual False 22 2 24 True 0 12 12 All 22 14 36 Can you calculate True Positive Rate? False Positive Rate? If this was a medical test for cancer, what do we want ideally, Low False Positive rate or Low False Negative rate? What are the implications? Part Three Perform Classification using Multiple Logistic Regression [ https://towardsdatascience.com/logistic-regression-detailed-overview-46c4da4303bc ] In [12]: #Add constant to x_train and x_test x_train_cst = sm . add_constant ( x_train ) x_test_cst = sm . add_constant ( x_test ) #Training model = LogisticRegression ( C = 100000 ) . fit ( x_train_cst , y_train ) #Predict y_pred_train = model . predict ( x_train_cst ) y_pred_test = model . predict ( x_test_cst ) #Perfromance Evaluation train_score = accuracy_score ( y_train , y_pred_train ) * 100 test_score = accuracy_score ( y_test , y_pred_test ) * 100 print ( \"Training Set Accuracy:\" , str ( train_score ) + '%' ) print ( \"Testing Set Accuracy:\" , str ( test_score ) + '%' ) Training Set Accuracy: 100.0% Testing Set Accuracy: 86.11111111111111% In [13]: #Get Performance by Class pd . crosstab ( y_test , y_pred_test , margins = True , rownames = [ 'Actual' ], colnames = [ 'Predicted' ]) Out[13]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Predicted False True All Actual False 20 4 24 True 1 11 12 All 21 15 36 In [14]: #Helper function for visualization def visualize_prob ( model , x , y , ax ): \"\"\" Function Name : visualize_prob Description : A function to visualize the probabilities predicted by a Logistic Regression model Input: model (Logistic regression model) x (n x d array of predictors in training data) y (n x 1 array of response variable vals in training data: 0 or 1) ax (an axis object to generate the plot) \"\"\" #Use the model to predict probabilities for x y_pred = model . predict_proba ( x ) #Separate the predictions on the label 1 and label 0 points ypos = y_pred [ y == 1 ] yneg = y_pred [ y == 0 ] #Count the number of label 1 and label 0 points npos = ypos . shape [ 0 ] nneg = yneg . shape [ 0 ] #Plot the probabilities on a vertical line at x = 0, #with the positive points in blue and negative points in red pos_handle = ax . plot ( np . zeros (( npos , 1 )), ypos [:, 1 ], 'bo' , label = 'Species 1' , alpha = 0.2 ) neg_handle = ax . plot ( np . zeros (( nneg , 1 )), yneg [:, 1 ], 'ro' , label = 'Species 0' , alpha = 0.2 ) #Line to mark prob 0.5 ax . axhline ( y = 0.5 , color = 'k' , linestyle = '--' ) #Add y-label and legend, do not display x-axis, set y-axis limit ax . set_ylabel ( 'Probability of Species Class' ) ax . legend ( loc = 'best' ) ax . get_xaxis () . set_visible ( False ) In [15]: #Create Plot fig = plt . figure ( figsize = ( 12 , 6 )) ax1 = fig . add_subplot ( 121 ) ax2 = fig . add_subplot ( 122 ) #Plot Training visualize_prob ( model , x_train_cst , y_train , ax1 ) ax1 . set_title ( 'Training Dataset' ) #Plot Testing visualize_prob ( model , x_test_cst , y_test , ax2 ) ax2 . set_title ( 'Testing Dataset' ) plt . show () Does Logistic Regression perform better or worse? Has it overfitted to the training set? What would points near 0.5 line mean? Analyzing Significance of Coefficients How many of the coefficients estimated by the multiple logistic regression model are significantly different from zero at a significance level of 95% ? [ https://www.sagepub.com/sites/default/files/upm-binaries/21122_Chapter_21.pdf ] In [16]: #Creating model model = LogisticRegression ( C = 100000 ) #Initializing variables bootstrap_iterations = 1000 coeffs = np . zeros (( bootstrap_iterations , data_train . shape [ 1 ] - 1 )) #Conduct bootstraping iterations for i in range ( bootstrap_iterations ): temp = data_train . sample ( frac = 1 , replace = True ) response_variable = temp [ 'species' ] temp = temp . drop ([ 'species' ], axis = 1 ) model . fit ( temp , response_variable ) coeffs [ i ,:] = model . coef_ #Find Significant Columns, Count coeffs_count , significant_cols = 0 , [] for i in range ( coeffs . shape [ 1 ]): coeff_samples = coeffs [:, i ] lower_bound = np . percentile ( coeff_samples , 2.5 ) upper_bound = np . percentile ( coeff_samples , 97.5 ) if lower_bound > 0 or upper_bound < 0 : coeffs_count += 1 significant_cols . append ( data_train . columns [ i ]) print ( 'Columns :' , significant_cols ) print ( 'Count of 95 % s tatistically significant coefficients :' , coeffs_count ) Columns : ['petal_width'] Count of 95% statistically significant coefficients : 1 Part Four - Use PCA to Reduce Dimensionality - Perform Classification on PCA Components Although PCA is used for dimensionality reduction, let's apply it to this problem. Find the number of principal components needed to explain 85% of the data variance and compare the performance of the model fitted to this data. In [21]: #Create and fit PCA object pca = PCA () pca . fit ( x_train ) #Transforming x_train and x_test x_train_pca = pca . transform ( x_train ) x_test_pca = pca . transform ( x_test ) #Find number of components that explain predefined variance threshold sum_variance , component_count = 0 , 0 while sum_variance < 0.85 : sum_variance += pca . explained_variance_ratio_ [ component_count ] component_count += 1 print ( 'Number of Principal Components that explain >=85 % o f Variance: ' , component_count ) print ( 'Total Variance Explained by ' + str ( component_count ) + ' components:' , str ( sum_variance * 100 ) + '%' ) Number of Principal Components that explain >=85% of Variance: 2 Total Variance Explained by 2 components: 88.42744186872083% In [18]: #Create and fit PCA object pca = PCA ( n_components = component_count ) pca . fit ( x_train ) #Transforming x_train and x_test x_train_pca = pca . transform ( x_train ) x_test_pca = pca . transform ( x_test ) #Add constant to x_train and x_test x_train_pca_cst = sm . add_constant ( x_train_pca ) x_test_pca_cst = sm . add_constant ( x_test_pca ) #Training model = LogisticRegression ( C = 100000 ) . fit ( x_train_pca_cst , y_train ) #Predict y_pred_train = model . predict ( x_train_pca_cst ) y_pred_test = model . predict ( x_test_pca_cst ) #Perfromance Evaluation train_score = accuracy_score ( y_train , y_pred_train ) * 100 test_score = accuracy_score ( y_test , y_pred_test ) * 100 print ( \"Training Set Accuracy:\" , str ( train_score ) + '%' ) print ( \"Testing Set Accuracy:\" , str ( test_score ) + '%' ) Training Set Accuracy: 100.0% Testing Set Accuracy: 86.11111111111111% We observe that 2 PC's were enough to replicate the accuracy performance of Logistic Regression with all predictors. Imagine the impact to complexity we can cause when we have multiple thousand predictors but few PCA components are able to able to match their performance. Drawback? Interpretability. In [19]: #Create Plot fig = plt . figure ( figsize = ( 12 , 6 )) ax1 = fig . add_subplot ( 121 ) ax2 = fig . add_subplot ( 122 ) #Plot Training visualize_prob ( model , x_train_pca_cst , y_train , ax1 ) ax1 . set_title ( 'Training Dataset' ) #Plot Testing visualize_prob ( model , x_test_pca_cst , y_test , ax2 ) ax2 . set_title ( 'Testing Dataset' ) plt . show () In [20]: #Get Performance by Class pd . crosstab ( y_test , y_pred_test , margins = True , rownames = [ 'Actual' ], colnames = [ 'Predicted' ]) Out[20]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Predicted False True All Actual False 20 4 24 True 1 11 12 All 21 15 36 Where does PCA perform better/worse? Does trying to explain variance sacrifice the power of the predictors? Is the variance we ignore, the last 15%, better for generalizability of the model i.e. can it prevent overfitting to the training set? [ https://giphy.com/gifs/pca-Lyejb62QjQepG ] if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-5/solutions/"},{"title":"Standard Section 6: Feed Forward Artificial Neural Networks Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 6: Feed Forward Neural Networks Harvard University Fall 2018 Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan Motwani, Cecilia Garraffo Instructors: Pavlos Protopapas, Kevin Rader Author: Mehul Smriti Raje In [1]: #RUN THIS CELL from IPython.core.display import HTML HTML ( ' h1{padding-top:25px;padding-bottom:25px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black}h2{padding-top:10px;padding-bottom:10px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}div.exercise{background-color:#ffcccc;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em}div.theme{background-color:#DDDDDD;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em;font-size:18pt}p.q1{padding-top:5px;padding-bottom:5px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}header{padding-top:35px;padding-bottom:35px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black} ' ) Out[1]: h1{padding-top:25px;padding-bottom:25px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black}h2{padding-top:10px;padding-bottom:10px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}div.exercise{background-color:#ffcccc;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em}div.theme{background-color:#DDDDDD;border-color:#E9967A;border-left:5px solid #800080;padding:0.5em;font-size:18pt}p.q1{padding-top:5px;padding-bottom:5px;text-align:left;padding-left:5px;background-color:#EEEEEE;color:black}header{padding-top:35px;padding-bottom:35px;text-align:left;padding-left:10px;background-color:#DDDDDD;color:black} In this section we will discover how to create feed-forward neural networks using a fun dataset. The goal is to familiarize you with manual implementations of Neural Networks. The exercises below will help you be able to answer parts of Homework 6. Specifically, we will: 1. Import data, explore with analyse relationship with response. 2. Fit some previously used regression models, understand drawbacks and interpret results. 3. Construct a feed-forward NN for regression, compare performance and interpret results. For this section we will be using the following packages: In [1]: # Data and Stats packages import numpy as np import pandas as pd import statsmodels.api as sm from statsmodels.api import OLS from sklearn import metrics , datasets from sklearn.model_selection import train_test_split from sklearn.linear_model import LogisticRegression , LinearRegression from sklearn.linear_model import LogisticRegressionCV from sklearn.preprocessing import PolynomialFeatures from sklearn.metrics import accuracy_score , r2_score # Visualization packages % matplotlib inline import matplotlib import matplotlib.pyplot as plt import seaborn as sns matplotlib . rcParams [ 'figure.figsize' ] = ( 13.0 , 6.0 ) # Aesthetic settings from IPython.display import display pd . set_option ( 'display.max_columns' , 999 ) pd . set_option ( 'display.width' , 500 ) sns . set_style ( 'whitegrid' ) sns . set_context ( 'talk' ) /Users/mehulsmritiraje/anaconda/lib/python3.6/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead. from pandas.core import datetools Fun Dataset Let us import a fun dataset specially created to show you how to play with neural networks. In [2]: #Import dataframe fun_df = pd . read_csv ( 'data/fun_dataset.csv' ) fun_df = fun_df [[ 'x' , 'y' ]] display ( fun_df . head ()) print ( fun_df . shape ) .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } x y 0 2.617188 -2.265495 1 0.000000 0.000000 2 9.375000 -9.363387 3 8.320312 -3.740912 4 0.195312 0.191599 (100, 2) Let us peek and see how the data is distributed. In [3]: fun_df = fun_df . sort_values ( by = 'x' ) plt . plot ( fun_df . x , fun_df . y , '--' ) Out[3]: [ ] We see that there are two distinct humps in the data. We will try to qualitatively check if our models generalise well on these. Can we model this data using Logistic Regression/Polynomial Regression In [4]: # Defining X and Y X = fun_df . x Y = fun_df . y In [5]: fun_df . describe () Out[5]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } x y count 100.000000 100.000000 mean 4.828125 -0.707590 std 3.016739 4.377725 min 0.000000 -9.449327 25% 2.333984 -2.751728 50% 4.941406 0.019516 75% 7.470703 1.532279 max 10.000000 6.336071 Doing the same old pre-processing In [6]: # Splitting into train and test x_train , x_test , y_train , y_test = train_test_split ( X , Y , test_size = 0.25 , random_state = 9001 ) # Re-shaping data x_train , y_train = x_train . values . reshape ( - 1 , 1 ), y_train . values x_test , y_test = x_test . values . reshape ( - 1 , 1 ), y_test . values print ( x_train . shape , x_test . shape , y_train . shape , y_test . shape ) (75, 1) (25, 1) (75,) (25,) Question 1: Should we normalise/standardise the data here? Why or why not? In [7]: # standardising values means = { 'x' : x_train . mean (), 'y' : y_train . mean ()} stds = { 'x' : x_train . std (), 'y' : y_train . std ()} x_train = ( x_train - means [ 'x' ]) / stds [ 'x' ] y_train = ( y_train - means [ 'y' ]) / stds [ 'y' ] x_test = ( x_test - means [ 'x' ]) / stds [ 'x' ] y_test = ( y_test - means [ 'y' ]) / stds [ 'y' ] Answer: Standardising the data helps in faster convergence of optimisation algorithms, especially when building neural networks. Thus, we standardise our data. Question 2: Would you use Logistic Regression for this data? Why/why not? Answer: The response variable for this dataset is not binary. hence, I would refrain from using Logistic Regression Fitting Polynomial Regression Question 3: Would you use polynomial regression for this data? Why/why not? If yes, what degree of polynomial would you pick? Why? Answer: Looking at the data, it seems that there is a at least a quadratic relation between the predictor and response variables. Thus, I would want to experiment with polynomial regression. I can see about 4 trends in the data distribution. So, I'd like to start experimenting with polynomials around degree 4. Let us try fitting with different degrees of polynomials between 2-15. In [8]: # Fitting model with degree deg result_df = pd . DataFrame ({ 'x_train' : x_train [:, 0 ], 'y_train' : y_train , }) models_df = {} degrees = [ 3 , 5 , 10 , 15 ] for deg in degrees : # Preparing data poly = PolynomialFeatures ( degree = deg , ) x_train_poly = poly . fit_transform ( x_train ) x_test_poly = poly . fit_transform ( x_test ) # Training linreg = LinearRegression () linreg . fit ( x_train_poly , y_train ) # Predict and convert to binary responses y_pred_train = linreg . predict ( x_train_poly ) y_pred_test = linreg . predict ( x_test_poly ) # Performance Evaluation train_score = r2_score ( y_train , y_pred_train ) * 100 test_score = r2_score ( y_test , y_pred_test ) * 100 # store in df result_df [ 'y_train_pred_ {} ' . format ( deg )] = y_pred_train models_df [ deg ] = [ linreg , x_train_poly . shape , train_score , test_score ] /Users/mehulsmritiraje/anaconda/lib/python3.6/site-packages/scipy/linalg/basic.py:1018: RuntimeWarning: internal gelsd driver lwork query error, required iwork dimension not returned. This is likely the result of LAPACK bug 0038, fixed in LAPACK 3.2.2 (released July 21, 2010). Falling back to 'gelss' driver. warnings.warn(mesg, RuntimeWarning) In [9]: # Plotting results result_df = result_df . sort_values ( by = 'x_train' ) plt . scatter ( result_df . x_train , result_df . y_train , color = 'k' , marker = '*' , label = 'Actual Values' ) for deg in degrees : plt . plot ( result_df . x_train , result_df [ 'y_train_pred_ {} ' . format ( deg )], '--' , label = 'Predicted Values for deg {} ' . format ( deg )) plt . title ( 'Polyomial Regression for multiple degree' ) plt . legend () Out[9]: We see that both poynomials of degree 15 does a great job of capturing the data well. We choose the model with degree 15. In [10]: degree_chosen = 15 print ( \"Number of features:\" , models_df [ degree_chosen ][ 1 ]) print ( \"Training Set Accuracy:\" , str ( models_df [ degree_chosen ][ 2 ]) + '%' ) print ( \"Testing Set Accuracy:\" , str ( models_df [ degree_chosen ][ 3 ]) + '%' ) Number of features: (75, 16) Training Set Accuracy: 100.0% Testing Set Accuracy: 100.0% We observe that we require 16 features and a polynomial of degree 15 to model the data with nearly perfect accuracy. Let's now try to model this data using a Feed-Forward Neural Network Question 4: What is the shape of input and output arrays to the neural network? In [11]: print ( x_train . shape , y_train . shape ) (75, 1) (75,) Let us construct a network with a single hidden layer. We will now define the parameters of our network. Let us choose the number of hidden layers to be 3. In [12]: input_dim = 1 output_dim = 1 num_hidden_layers = 1 num_hidden_nodes = 3 Question 5: What are the shapes of the weight matrices for the network? In [13]: print ( \"WL0: ( {0} , {1} )\" . format ( num_hidden_nodes , input_dim + 1 )) print ( \"WL1: ( {0} , {1} )\" . format ( output_dim , num_hidden_nodes + 1 )) WL0: (3,2) WL1: (1,4) Choosing an activation function Question 6: How do we pick an activation function for our neural network? Answer 6: Activation functions are chosen based on the nature of the problem. We will cover more about this in lectures. We will work with the sigmoid activation function here. In [14]: sigmoid = lambda x : ( 1 / ( 1 + np . exp ( - x ))) Let's now create a feed-forward network with this activation function. Let us assign all 1s to initialise both WL0 and WL1 In [15]: # ASSIGNING WEIGHTS # all 1s WL0 = np . ones (( num_hidden_nodes , input_dim + 1 )) WL1 = np . ones (( output_dim , num_hidden_nodes + 1 )) # FORWARD PROPAGATION # input layer ones = np . ones (( len ( x_train ), 1 )) L0 = x_train L0 = np . append ( L0 , ones , axis = 1 ) # hidden layer a0 = np . dot ( WL0 , L0 . T ) z0 = { 'sigmoid' : sigmoid ( a0 )} # output layer ones = np . ones (( len ( y_train ), 1 )) z0 [ 'sigmoid' ] = np . append ( z0 [ 'sigmoid' ] . T , ones , axis = 1 ) . T # affine a1 = { 'sigmoid' : np . dot ( WL1 , z0 [ 'sigmoid' ])} z1 = a1 In [16]: # PLOTTING THE MODEL def plot_nn_models ( result_df , title , sig ): result_df = result_df . sort_values ( by = 'x_train' ) plt . scatter ( result_df . x_train , result_df . y_train , color = 'k' , marker = '*' , label = 'Actual Values' ) if sig : plt . plot ( result_df . x_train , result_df . y_pred_train_sigmoid , '--' , label = 'Predicted Values using Sigmoid' ) plt . title ( title ) plt . legend () return result_df = pd . DataFrame ({ 'x_train' : x_train [:, 0 ], 'y_train' : y_train , 'y_pred_train_sigmoid' : z1 [ 'sigmoid' ][ 0 ] }) plot_nn_models ( result_df , 'NN with arbitrary weights' , True ) Question 7: Does the current NN capture the trends in data? If no, how should we modify our network? Answer: The network is not doing a good job at approximating the function well right now. We need to experiment and find out whether we need to change the weights, number of hidden nodes or number of hidden layers. Let us first adjust weights to try and find a model that matches our data well In [17]: # ASSIGNING WEIGHTS # Obtained using trial and error WL0 = { 'sigmoid' : np . array ([[ 10 , 0.01 ], [ 13 , - 10 ], [ 0.1 , 20 ]])} WL1 = { 'sigmoid' : np . array ([[ 1.75 , - 1.75 , 1 , - 1 ]])} # FORWARD PROPAGATION # input layer ones = np . ones (( len ( x_train ), 1 )) L0 = x_train L0 = np . append ( L0 , ones , axis = 1 ) # hidden layer a0 = { 'sigmoid' : np . dot ( WL0 [ 'sigmoid' ], L0 . T )} z0 = { 'sigmoid' : sigmoid ( a0 [ 'sigmoid' ])} # output layer ones = np . ones (( len ( y_train ), 1 )) z0 [ 'sigmoid' ] = np . append ( z0 [ 'sigmoid' ] . T , ones , axis = 1 ) . T # affine a1 = { 'sigmoid' : np . dot ( WL1 [ 'sigmoid' ], z0 [ 'sigmoid' ])} z1 = a1 # PLOTTING THE MODEL result_df = pd . DataFrame ({ 'x_train' : x_train [:, 0 ], 'y_train' : y_train , 'y_pred_train_sigmoid' : z1 [ 'sigmoid' ][ 0 ] }) plot_nn_models ( result_df , 'NN with arbitrary weights' , True ) With some adjusted weights (obtained by trial and error and logically observing which weight changes which part of approximation), we see that the sigmoid activation functions is doing a really good job at capturing the hump between x=-0.2 to x=1 . The weights obtained by our most suitable model having 3 hidden nodes are given below: In [18]: print ( \"WL0: \\n \" , WL0 [ 'sigmoid' ], \" \\n \" ) print ( \"WL1: \\n \" , WL1 [ 'sigmoid' ]) WL0: [[ 1.00000000e+01 1.00000000e-02] [ 1.30000000e+01 -1.00000000e+01] [ 1.00000000e-01 2.00000000e+01]] WL1: [[ 1.75 -1.75 1. -1. ]] Let us now increase the number of hidden nodes to 4 and use Sigmoid as our activation function to see if we can find a model that matches our data better In [19]: # Re-defining the number of hidden nodes num_hidden_nodes = 4 # Printing shape of weight vectors print ( \"WL0: ( {0} , {1} )\" . format ( num_hidden_nodes , input_dim + 1 )) print ( \"WL1: ( {0} , {1} )\" . format ( output_dim , num_hidden_nodes + 1 )) WL0: (4,2) WL1: (1,5) In [20]: # ASSIGNING WEIGHTS # Obtained using trial and error WL0 = { 'sigmoid' : np . array ([[ 10 , 1 ], [ - 5 , - 5 ], [ 14 , - 12 ], [ - 5 , 5 ]])} WL1 = { 'sigmoid' : np . array ([[ 2 , 1 , - 2.5 , 0.5 , - 1 ]])} # FORWARD PROPAGATION # input layer ones = np . ones (( len ( x_train ), 1 )) L0 = x_train L0 = np . append ( L0 , ones , axis = 1 ) # hidden layer a0 = { 'sigmoid' : np . dot ( WL0 [ 'sigmoid' ], L0 . T )} z0 = { 'sigmoid' : sigmoid ( a0 [ 'sigmoid' ])} # output layer ones = np . ones (( len ( y_train ), 1 )) z0 [ 'sigmoid' ] = np . append ( z0 [ 'sigmoid' ] . T , ones , axis = 1 ) . T # affine a1 = { 'sigmoid' : np . dot ( WL1 [ 'sigmoid' ], z0 [ 'sigmoid' ])} z1 = a1 # PLOTTING THE MODEL result_df = pd . DataFrame ({ 'x_train' : x_train [:, 0 ], 'y_train' : y_train , 'y_pred_train_sigmoid' : z1 [ 'sigmoid' ][ 0 ] }) plot_nn_models ( result_df , 'NN with arbitrary weights' , True ) After several trial and errors, we have found that adding an additional node helps the model generalise well on the second hump between x=-1.5 and x=0 also, adding to it's generalisation on the other hump as seen before. The weights obtained by our most suitable model having 4 hidden nodes are given below: In [21]: WL0_best , WL1_best = WL0 [ 'sigmoid' ], WL1 [ 'sigmoid' ] print ( \"WL0: \\n \" , WL0_best , \" \\n \" ) print ( \"WL1: \\n \" , WL1_best ) WL0: [[ 10 1] [ -5 -5] [ 14 -12] [ -5 5]] WL1: [[ 2. 1. -2.5 0.5 -1. ]] Similarly, can we improve our function fit by increasing the number of hidden nodes? Performance of NN Question 8: So far, we are qualitatively determining if our feed-forward neural network models our data well. Can we quantitaively determine this? How? Answer: Yes! We can quantitatively determine the performance of our model by choose the metric we want to use. Let's use the MSE values to determine the loss from our model (as we have done in cases of regression before). The loss, as we know, indicated how well our model fits the data. Look up other loss functions used by neual networks here: https://ml-cheatsheet.readthedocs.io/en/latest/loss_functions.html What metric would you use if the data had categorical target variables? Let us calculate the loss from our network. In [22]: loss = sum (( result_df . y_pred_train_sigmoid - result_df . y_train ) ** 2 ) print ( loss ) 3.10369819692 Question 9: Lets transport back in time to our favourite calculus lessons. How do we minimise the loss of any function approximation? Answer One way to do this is by adjusting the function approximation parameters using a technique called gradient descent. We have also covred gradient descent in the previous lecture. Look at the slides for Lecture 12 for reference. Let us explore gradient descent below. Gradient Descent Theory At any point in one dimension, a function's derivative tells us whether increasing the input will increase the function (positive derivative) or decrease the function (negative derivative). The derivative also tells us how much we think the function will increase/decrease for a small change in the input. We're being told which direction we want to move in, and how strongly we want to make that move. With multiple inputs, we can take a derivative with respect to any of the inputs, but the result still holds. Let's say the derivative with respect to input1 is +k1 and the derivative with respect to input2 is -k2 ? We still want to increase input1 and decrease input2 ... but by how much? It turns out that a ratio of k1:k2 (exactly what the derivatives told us) is optimal, at least near our current point. So we say new_point = old_point + .01 * (k1,-k2) . Thus, we increase the first input by .01 * k1 and decrease the second input by .01 * k2 , and then ask about the derivatives at the new point to make further update. Example showing use of gradient descent to find function minima using approximation Let us define a function f(x) = sin(x) + cos(x) and guess that it has a minimum value of f(x) = -1 at parameter value x_min = 1 . Let us now use gradient descent to optimize the approximation of x_min . In [23]: # inline function for f(x) f = lambda x : np . sin ( x ) + np . cos ( x ) We calculate the gradient of f(x) wrt x to be f'(x) = cos(x) - sin(x) . In [24]: # inline function for df/dx der_f_x = lambda x : np . cos ( x ) - np . sin ( x ) We calculate the gradient at x_min and update its approximation for 1000 iterations to see how the values change. In [25]: x_n_minus_1 = 1 f_x_min = - 1 x_vals = [ x_n_minus_1 ] errors = [] l = 0.01 # learning rate for i in range ( 1000 ): gradient_eval = der_f_x ( x_n_minus_1 ) # evaluating gradient at x_(n-1), i.e. previous parameter approximation x_n = x_n_minus_1 + l * gradient_eval # updating approximation of x_min f_eval = f ( x_n ) # evaluating function at new point error = f_eval - f_x_min # finding error in approximation errors . append ( error ) # storing values of error x_vals . append ( x_n ) # storing values of x_min x_n_minus_1 = x_n # x_n is the previous step now figure , ax = plt . subplots ( 1 , 2 , figsize = ( 18 , 6 )) ax [ 0 ] . plot ( range ( 1001 ), x_vals ) ax [ 0 ] . set_xlabel ( 'step' ) ax [ 0 ] . set_ylabel ( 'x_min' ) ax [ 1 ] . set_title ( 'Gradient Descent' ) ax [ 1 ] . plot ( range ( 1000 ), errors ) ax [ 1 ] . set_xlabel ( 'step' ) ax [ 1 ] . set_ylabel ( 'error' ) ax [ 1 ] . set_title ( 'Gradient Descent' ) Out[25]: We can observe that the error and x_min approximation values stop changing after around 300 approximations, i.e. the approximated value of x_min has become nearly static. Let us see what these approximated values are. In [26]: print ( 'x_min = ' , x_vals [ - 1 ]) print ( 'error = ' , error ) x_min = 0.785398303888 error = 2.41421356237 Question 10: How do we determine the number of steps taken to reach our optimal weight values? Answer: Another way to perform gradient descent is to define a threshold and stop iterating when the values change becomes smaller than this threshold value. Let us do this to find the number of steps taken to reach the optimal value. In [27]: x_n_minus_1 = 1 f_x_min = - 1 x_vals = [ x_n_minus_1 ] errors = [] l = 0.01 # learning rate error = 1 step = 0 threshold = 0.0001 while True : gradient_eval = der_f_x ( x_n_minus_1 ) # evaluating gradient at x_(n-1), i.e. previous parameter approximation x_n = x_n_minus_1 + l * gradient_eval # updating approximation of x_min f_eval = f ( x_n ) # evaluating function at new point error = f_eval - f_x_min # finding error in approximation errors . append ( error ) # storing values of error x_vals . append ( x_n ) # storing values of x_min x_n_minus_1 = x_n # x_n is the previous step now step += 1 if abs ( f_eval - f ( x_vals [ step - 1 ])) < threshold : break print ( 'Number of steps = ' , step ) Number of steps = 79 Thus, we see that with a learning rate of 0.01, it took us 79 steps to reach optimal values of our parameter. Question 11: How was this learning rate chosen? Answer Here, the choice of the 'learning rate' (lr) as .01 was arbitrary: bigger values of learning rates let us move more quickly towards the optimal value, but will be less accurate. Small learning rates are safe, but slow, while rates that are too big will fail to converge. Finding the right value is tricky and often times in complex problems, people experiment with many values of lr. Gradient descent can performed on weights of neural networks to determine their optimal values that can yield the highest network accuracies. Testing on Unseen Data Let us now check the performance of our NN on unseen test data, using our observations and optimal weight values from above. In [28]: # WL0_best and WL1_best are the best weight values we have obtained # We have trained the network using x_train above # We now apply the same transformatons on x_test # input layer ones = np . ones (( len ( x_test ), 1 )) L0 = x_test L0 = np . append ( L0 , ones , axis = 1 ) # hidden layer a0 = np . dot ( WL0_best , L0 . T ) z0 = sigmoid ( a0 ) # output layer ones = np . ones (( len ( y_test ), 1 )) z0 = np . append ( z0 . T , ones , axis = 1 ) . T # affine with sigmoid a1 = np . dot ( WL1_best , z0 ) z1 = a1 y_pred_test = z1 # THIS IS THE OUTPUT FOR TEST DATA In [29]: # Performance Evaluation train_score = r2_score ( y_train , result_df . y_pred_train_sigmoid ) * 100 # THIS WAS FOUND ABOVE ALREADY test_score = r2_score ( y_test , y_pred_test [ 0 ]) * 100 print ( \"Training Set Accuracy:\" , str ( train_score ) + '%' ) print ( \"Testing Set Accuracy:\" , str ( test_score ) + '%' ) Training Set Accuracy: 95.8617357374% Testing Set Accuracy: 96.3285378691% We can observe that our manually constructed feed-forward neural network gave us comparable results to the polynomial model constructed before. Here, we adjusted 13 parameters with a single input feature, compared to 16 parameters and 15 features in the polynomial model. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section-6/demo/"},{"title":"Section 7","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 7: Multiclass Classification Harvard University Fall 2018 Section Leaders: Mehul Smriti Raje, Ken Arnold, Karan Motwani, Cecilia Garraffo Instructors: Pavlos Protopapas, Kevin Rader In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [2]: % matplotlib inline import numpy as np import pandas as pd import matplotlib from matplotlib.patches import Ellipse import matplotlib.pyplot as plt from sklearn import preprocessing from sklearn.preprocessing import PolynomialFeatures from sklearn.metrics import r2_score from sklearn.model_selection import train_test_split from sklearn.decomposition import PCA from sklearn.linear_model import LogisticRegression from sklearn.linear_model import LogisticRegressionCV from sklearn.discriminant_analysis import LinearDiscriminantAnalysis from sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis from sklearn.neighbors import KNeighborsClassifier from sklearn.model_selection import cross_val_score from sklearn.metrics import accuracy_score from sklearn.model_selection import KFold from sklearn.tree import DecisionTreeClassifier from sklearn.tree import export_graphviz from sklearn.metrics import confusion_matrix from scipy import linalg from scipy.stats import multivariate_normal import itertools import time from itertools import combinations from IPython.display import Image from pandas.plotting import scatter_matrix import seaborn as sns sns . set ( style = 'white' ) This data is from the Sloan Digital Sky Server The Sloan Digital Sky Survey is a project to make a map of a large part of the universe using a 2.5 meters telescope located at Apache Point Observatory in New Mexico. In [3]: Image ( '../fig/sdss.jpg' ) Out[3]: *Image from SDSS A few physics concepts for this section: 1) Blackbody Radiation: All objects with a temperature above absolute zero (0 K, -273.15 degrees C) emit energy in the form of electromagnetic radiation. A blackbody is a theoretical or model body which absorbs all radiation falling on it, reflecting or transmitting none. It is a hypothetical object which is a \"perfect\" absorber and a \"perfect\" emitter of radiation over all wavelengths. The spectral distribution of the thermal energy radiated by a blackbody (i.e. the pattern of the intensity of the radiation over a range of wavelengths or frequencies) depends only on its temperature. Based on this concept, astronomers use the distribution of measured colors in an object as a proxy for its temperature. In [4]: Image ( '../fig/blackbody_radn_curves.png' ) Out[4]: *Image & text from Swinburne University of Technology ( http://astronomy.swin.edu.au/cosmos/B/Blackbody+Radiation ) 2) Redshift: Doppler effect can be described by the change in wavelength of light emitted by moving source. A receding object emits light systematically moved towards larger wavelengths (to the red colors). In [5]: Image ( '../fig/redshift.png' ) Out[5]: *Image from Wikipedia. Because the universe is expanding, objects further from us will recede faster (think of a balloon being inflated and how the relative velocity of two points further away on its surface will be larger than that of two nearby points). In [6]: Image ( '../fig/expansion.jpeg' ) Out[6]: *Image from Quora ( https://www.quora.com/If-the-age-of-universe-is-14-billion-years-how-are-we-able-to-receive-signals-from-galaxies-300-billion-light-years-away ) Combining these two concepts it is possible to estimate the distance of a body based on the energy distribution of its emission. 3) Quasar: Quasars are the most luminous objects in our Universe, some of them thousands of times brighter than our galaxy. They are located at the center of some galaxies and, while they are black holes, they emit light because they are accreating very hot plasma. In [7]: Image ( '../fig/quasar.jpeg' ) Out[7]: *Image from Wikipedia. Data Preparation Load and investigate In [8]: sky = pd . read_csv ( 'data/skyserver2.csv' ) display ( sky . head ()) display ( sky . describe ()) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } objid ra dec u g r i z run rerun camcol field specobjid class redshift plate mjd fiberid 0 1.237650e+18 146.603617 -0.191463 18.91808 17.66467 16.97991 16.55797 16.32081 756 301 3 206 2.995200e+17 GALAXY 0.121521 266 51630 111 1 1.237650e+18 147.830879 -0.175939 18.98907 17.97828 17.44428 17.25260 17.09242 756 301 3 214 3.006650e+17 GALAXY 0.037041 267 51608 181 2 1.237650e+18 147.842227 -0.000417 19.49610 18.58028 18.25762 18.13326 18.10417 756 301 3 214 4.310080e+18 STAR 0.000146 3828 55539 479 3 1.237650e+18 147.863064 -0.168406 18.90579 17.75234 17.12903 16.70868 16.45255 756 301 3 214 3.006660e+17 GALAXY 0.125802 267 51608 186 4 1.237650e+18 150.441214 -0.154485 19.30410 17.58480 16.83829 16.47711 16.16986 756 301 3 231 3.029540e+17 GALAXY 0.033204 269 51910 315 .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } objid ra dec u g r i z run rerun camcol field specobjid redshift plate mjd fiberid count 2.000000e+05 200000.000000 200000.000000 200000.000000 200000.000000 200000.000000 200000.000000 200000.000000 200000.000000 200000.0 200000.000000 200000.000000 2.000000e+05 200000.000000 200000.000000 200000.000000 200000.000000 mean 1.237655e+18 178.686321 24.816779 18.638851 17.403152 16.874588 16.564581 16.303857 2080.103000 301.0 3.466770 203.906360 1.923518e+18 0.169906 1708.345145 53149.708080 336.360185 std 4.979335e+12 77.097746 25.620110 0.831529 0.978530 1.122199 22.427669 38.810382 767.613046 0.0 1.577047 152.119652 2.018399e+18 0.434031 1792.687266 1428.512516 204.980630 min 1.237650e+18 0.002795 -11.252825 10.227170 7.466997 8.449127 -9999.000000 -9999.000000 94.000000 301.0 1.000000 11.000000 2.994900e+17 -0.004136 266.000000 51578.000000 1.000000 25% 1.237650e+18 137.232575 0.908004 18.212257 16.844877 16.186505 15.857110 15.617598 1458.000000 301.0 2.000000 86.000000 6.452250e+17 0.000049 573.000000 52145.000000 165.000000 50% 1.237650e+18 174.759439 15.012978 18.874230 17.517360 16.891115 16.590470 16.413170 2137.000000 301.0 3.000000 165.000000 1.020120e+18 0.050072 906.000000 52427.000000 328.000000 75% 1.237660e+18 222.176390 50.697999 19.275013 18.050670 17.564960 17.310303 17.193173 2728.000000 301.0 5.000000 279.000000 2.684260e+18 0.098129 2384.000000 54271.000000 494.000000 max 1.237660e+18 359.996095 68.925750 19.599990 19.982480 33.209920 32.349170 28.668700 3699.000000 301.0 6.000000 812.000000 1.008270e+19 6.992002 8955.000000 57519.000000 1000.000000 In [9]: sky . info () RangeIndex: 200000 entries, 0 to 199999 Data columns (total 18 columns): objid 200000 non-null float64 ra 200000 non-null float64 dec 200000 non-null float64 u 200000 non-null float64 g 200000 non-null float64 r 200000 non-null float64 i 200000 non-null float64 z 200000 non-null float64 run 200000 non-null int64 rerun 200000 non-null int64 camcol 200000 non-null int64 field 200000 non-null int64 specobjid 200000 non-null float64 class 200000 non-null object redshift 200000 non-null float64 plate 200000 non-null int64 mjd 200000 non-null int64 fiberid 200000 non-null int64 dtypes: float64(10), int64(7), object(1) memory usage: 27.5+ MB Transform predictors Intensities to colors The single-letter columns are the spectral energy in certain bands of wavelengths, so the differences between them tell us about color. Astronomers typically look at the following differences: In [10]: sky [ 'u-g' ] = sky [ 'u' ] - sky [ 'g' ] sky [ 'g-r' ] = sky [ 'g' ] - sky [ 'r' ] sky [ 'r-i' ] = sky [ 'r' ] - sky [ 'i' ] sky . head () Out[10]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } objid ra dec u g r i z run rerun ... field specobjid class redshift plate mjd fiberid u-g g-r r-i 0 1.237650e+18 146.603617 -0.191463 18.91808 17.66467 16.97991 16.55797 16.32081 756 301 ... 206 2.995200e+17 GALAXY 0.121521 266 51630 111 1.25341 0.68476 0.42194 1 1.237650e+18 147.830879 -0.175939 18.98907 17.97828 17.44428 17.25260 17.09242 756 301 ... 214 3.006650e+17 GALAXY 0.037041 267 51608 181 1.01079 0.53400 0.19168 2 1.237650e+18 147.842227 -0.000417 19.49610 18.58028 18.25762 18.13326 18.10417 756 301 ... 214 4.310080e+18 STAR 0.000146 3828 55539 479 0.91582 0.32266 0.12436 3 1.237650e+18 147.863064 -0.168406 18.90579 17.75234 17.12903 16.70868 16.45255 756 301 ... 214 3.006660e+17 GALAXY 0.125802 267 51608 186 1.15345 0.62331 0.42035 4 1.237650e+18 150.441214 -0.154485 19.30410 17.58480 16.83829 16.47711 16.16986 756 301 ... 231 3.029540e+17 GALAXY 0.033204 269 51910 315 1.71930 0.74651 0.36118 5 rows × 21 columns In [11]: #Double check max ( abs ( ( sky [ 'u' ] - sky [ 'r' ]) - ( sky [ 'u-g' ] + sky [ 'g-r' ]))) Out[11]: 0.0 Log-transform Redshift Redshift makes much more sense in log-scale In [12]: plt . boxplot ( sky . redshift , vert = False ); In [13]: # Negative redshift is physically impossible, so the np.maximum clips everything below 0 to 0. # log of 0 is -inf, so shift up by a small constant sky [ 'log_redshift' ] = np . log ( np . maximum ( sky . redshift , 0 ) + 1e-6 ) In [14]: plt . boxplot ( sky . log_redshift , vert = False ); Make target numeric In [15]: sky [ 'class' ] . value_counts () Out[15]: GALAXY 106877 STAR 72303 QSO 20820 Name: class, dtype: int64 In [16]: sky [ 'class' ] . value_counts ( normalize = True ) Out[16]: GALAXY 0.534385 STAR 0.361515 QSO 0.104100 Name: class, dtype: float64 QSO is Quasars, representing about 10% of our data. We'll want to represent our target classes numerically. Exercise : Could we use a dummy variable encoding for our 3 targets? First we make a mapping from names to ids and back: In [17]: tgt_id2name = [ 'GALAXY' , 'STAR' , 'QSO' ] tgt_name2id = { name : idx for idx , name in enumerate ( tgt_id2name )} print ( \"Class 1 is\" , tgt_id2name [ 1 ]) print ( \"Galaxy is class\" , tgt_name2id [ 'GALAXY' ]) Class 1 is STAR Galaxy is class 0 Now we use that mapping to make a new numeric column. In [18]: sky [ 'response' ] = [ tgt_name2id [ cls ] for cls in sky [ 'class' ]] Separate data in train and test sets In [19]: data_train_raw , data_test_raw = train_test_split ( sky , test_size =. 3 , random_state = 2001 ) len ( data_train_raw ), len ( data_test_raw ) Out[19]: (140000, 60000) In [20]: # This is the somewhat magic way: data_train_raw . groupby ( 'class' ) . log_redshift . apply ( lambda group : sns . kdeplot ( group )); In [21]: # Less magic, but less functional. data_train_raw . groupby ( 'class' ) . log_redshift . hist () Out[21]: class GALAXY AxesSubplot(0.125,0.125;0.775x0.755) QSO AxesSubplot(0.125,0.125;0.775x0.755) STAR AxesSubplot(0.125,0.125;0.775x0.755) Name: log_redshift, dtype: object Scale data In [22]: def scale_df ( df , means , stds ): cols_to_scale = means . index df = df . copy () df [ cols_to_scale ] = ( df [ cols_to_scale ] - means ) / stds return df cols_to_scale = [ 'u-g' , 'g-r' , 'r-i' ] train_means = data_train_raw [ cols_to_scale ] . mean ( axis = 0 ) train_stds = data_train_raw [ cols_to_scale ] . std ( axis = 0 ) data_train = scale_df ( data_train_raw , train_means , train_stds ) data_test = scale_df ( data_test_raw , train_means , train_stds ) In [23]: # Check results. data_train [ cols_to_scale ] . describe () Out[23]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } u-g g-r r-i count 1.400000e+05 1.400000e+05 1.400000e+05 mean 1.179118e-14 -8.189271e-15 -1.978227e-16 std 1.000000e+00 1.000000e+00 1.000000e+00 min -7.522239e+00 -4.355468e+01 -5.057106e-01 25% -4.669444e-01 -5.770969e-01 -6.782710e-03 50% 2.125324e-02 3.755652e-02 -1.708342e-03 75% 6.553996e-01 6.943079e-01 2.576763e-03 max 9.175197e+00 1.125847e+01 3.741469e+02 Visualize! In [63]: def scatter_stars ( ax , df , columns , class_labels , class_colors , s = 5 , xlim = [ - 4 , 4 ], ylim = [ - 4 , 4 ], ** kw ): for idx , ( color , name ) in enumerate ( zip ( class_colors , class_labels )): subset = df [ df [ 'class' ] == name ] ax . scatter ( subset [ columns [ 0 ]], subset [ columns [ 1 ]], label = name , c = color , s = s , ** kw ) ax . set ( xlabel = columns [ 0 ], ylabel = columns [ 1 ], xlim = xlim , ylim = ylim ) ax . legend () In [64]: data_sample = data_train . sample ( frac =. 05 ) In [65]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 16 , 10 )) scatter_stars ( ax , data_sample , columns = [ 'u-g' , 'g-r' ], # For overplotting demo, switch which of this line and the following is commented. # class_labels=['GALAXY', 'STAR', 'QSO'], class_labels = [ 'STAR' , 'GALAXY' , 'QSO' ], class_colors = [ 'r' , 'g' , 'b' ], s = 10 , alpha =. 5 ) Caution: the overplotting between Star and Galaxy is deceptive. Make classification task In [25]: predictors = [ 'u-g' , 'g-r' ] X_train = data_train . loc [:, predictors ] y_train = data_train . loc [:, 'response' ] X_test = data_test . loc [:, predictors ] y_test = data_test . loc [:, 'response' ] Multi-class Classification Approaches When we look at multiclass classifiers, the overall accuracy (mean of y_true == y_pred) is interesting, but doesn't show us if we're making more mistakes on one class or another. It especially down-weights mistakes on minority classes (here, quasars). Mistakes on minority classes may be far more important than their frequency suggests (especially if we're dealing with people), so let's also look at confusion matrices . In [26]: # Code credit: sklearn example def plot_confusion_matrix ( ax , cm , classes , normalize = False , title = 'Confusion matrix' , cmap = plt . cm . Blues ): \"\"\" This function prints and plots the confusion matrix. Normalization can be applied by setting `normalize=True`. \"\"\" if normalize : cm = cm . astype ( 'float' ) / cm . sum ( axis = 1 )[:, np . newaxis ] # print(\"Normalized confusion matrix\") # else: # print('Confusion matrix, without normalization') img = ax . imshow ( cm , interpolation = 'nearest' , cmap = cmap ) plt . colorbar ( img , ax = ax ) tick_marks = np . arange ( len ( classes )) ax . set ( xticks = tick_marks , yticks = tick_marks ) ax . set_xticklabels ( classes , rotation = 45 ) ax . set_yticklabels ( classes ) fmt = '.2f' if normalize else 'd' thresh = cm . max () / 2. for i , j in itertools . product ( range ( cm . shape [ 0 ]), range ( cm . shape [ 1 ])): ax . text ( j , i , format ( cm [ i , j ], fmt ), horizontalalignment = \"center\" , color = \"white\" if cm [ i , j ] > thresh else \"black\" ) ax . set ( title = title , ylabel = 'True label' , xlabel = 'Predicted label' ) For example, if we always predict \"star\", we'd get a confusion matrix like: In [27]: fig , ax = plt . subplots () constant_predictions = np . full ( len ( y_test ), 1 ) cnf_matrix = confusion_matrix ( y_test , constant_predictions ) plot_confusion_matrix ( ax , cnf_matrix , classes = tgt_id2name , normalize = True ) print ( \"Accuracy:\" , np . mean ( constant_predictions == y_test )) Accuracy: 0.3645333333333333 Here's our routine from hw7 for plotting decision boundaries: In [28]: def overlay_decision_boundary ( ax , model , colors = None , nx = 200 , ny = 200 , desaturate =. 5 ): \"\"\" A function that visualizes the decision boundaries of a classifier. ax: Matplotlib Axes to plot on model: Classifier (has a `.predict` method) X: feature vectors y: ground-truth classes colors: list of colors to use. Use color colors[i] for class i. nx, ny: number of mesh points to evaluated the classifier on desaturate: how much to desaturate each of the colors (for better contrast with the sample points) \"\"\" # Create mesh xmin , xmax = ax . get_xlim () ymin , ymax = ax . get_ylim () xx , yy = np . meshgrid ( np . linspace ( xmin , xmax , nx ), np . linspace ( ymin , ymax , ny )) X = np . c_ [ xx . flatten (), yy . flatten ()] # Predict on mesh of points model = getattr ( model , 'predict' , model ) y = model ( X ) y = y . reshape (( nx , ny )) # Generate colormap. if colors is None : colors = sns . utils . get_color_cycle () y -= y . min () # If first class is not 0, shift. assert np . max ( y ) <= len ( colors ) colors = [ sns . utils . desaturate ( color , desaturate ) for color in colors ] cmap = matplotlib . colors . ListedColormap ( colors ) # Plot decision surface ax . pcolormesh ( xx , yy , y , zorder =- 2 , cmap = cmap , norm = matplotlib . colors . NoNorm (), vmin = 0 , vmax = y . max () + 1 ) xx = xx . reshape ( nx , ny ) yy = yy . reshape ( nx , ny ) # ax.contourf(xx, yy, y, cmap=cmap, vmin=0, vmax=3) ax . contour ( xx , yy , y , colors = \"black\" , linewidths = 1 , zorder =- 1 ) Logistic Regression Estimation time (it surprises me how fast this is... really?) In [59]: % time ovr = LogisticRegression(multi_class='ovr', solver='lbfgs').fit(X_train, y_train) CPU times: user 810 ms, sys: 188 ms, total: 998 ms Wall time: 267 ms In [60]: % timeit ovr = LogisticRegression(multi_class='ovr', solver='lbfgs').fit(X_train, y_train) 242 ms ± 9.69 ms per loop (mean ± std. dev. of 7 runs, 1 loop each) Inference time: In [62]: ovr = LogisticRegression ( multi_class = 'ovr' , solver = 'lbfgs' ) . fit ( X_train , y_train ) % timeit predictions = ovr.predict(X_test) 1.88 ms ± 79.5 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each) What's one-vs-rest doing? One-vs-Rest fits 3 different classifiers: galaxy-vs-rest, star-vs-rest, and quasar-vs-rest. For example, the galaxy-vs-rest model is: In [32]: is_galaxy = ( y_train == 0 ) . astype ( int ) galaxy_vs_rest = LogisticRegression ( solver = 'saga' ) . fit ( X_train , is_galaxy ) Notice how the coefficients are exactly the same for this model... In [33]: galaxy_vs_rest . coef_ , galaxy_vs_rest . intercept_ Out[33]: (array([[-0.31954908, 2.0910309 ]]), array([0.13686235])) ...and class 0 of the one-vs-rest model: In [34]: ovr . coef_ [ 0 ], ovr . intercept_ [ 0 ] Out[34]: (array([-0.31955343, 2.09104437]), 0.1368552182578172) In [68]: fig , ax = plt . subplots () scatter_stars ( ax , data_sample , columns = [ 'u-g' , 'g-r' ], class_labels = tgt_id2name , class_colors = class_colors , edgecolor = 'black' , lw =. 25 , s = 10 ) overlay_decision_boundary ( ax , galaxy_vs_rest , colors = class_colors , desaturate =. 3 ) CV for hyperparameter selection The coefficients of Logistic Regression can be regularized by an L2 (magnitude) penalty. Let's use cross-validation to select a good penalty parameter. In [35]: % time lrm_ovr = LogisticRegressionCV(multi_class = 'ovr', cv=5).fit(X_train, y_train) # We could also fit a Multinomial model, but that's beyond our scope here. print ( 'OvR Logistic Regression: accuracy on train= {:.2%} , test= {:.2%} ' . format ( lrm_ovr . score ( X_train , y_train ), lrm_ovr . score ( X_test , y_test ))) CPU times: user 19.2 s, sys: 4.37 s, total: 23.6 s Wall time: 6.21 s OvR Logistic Regression: accuracy on train=76.54%, test=76.27% Why might CPU times be greater than wall time? Hint: your CPU probably has multiple cores... In [66]: fig , ax = plt . subplots () scatter_stars ( ax , data_sample , columns = [ 'u-g' , 'g-r' ], class_labels = tgt_id2name , class_colors = class_colors , edgecolor = 'black' , lw =. 25 , s = 10 ) overlay_decision_boundary ( ax , lrm_ovr , colors = class_colors , desaturate =. 3 ) k-NN kNN estimation time: In [36]: % time knn = KNeighborsClassifier(n_neighbors=10).fit(X_train, y_train) CPU times: user 251 ms, sys: 64.1 ms, total: 315 ms Wall time: 108 ms Inference time: In [37]: % time knn_predictions = knn.predict(X_test) CPU times: user 270 ms, sys: 13.8 ms, total: 284 ms Wall time: 284 ms Let's use a sklearn meta-estimator to find the best value of k. (On homework you should use cross_val_score ; we're doing it a different way here so you can't just copy-paste code for one of the answers): In [38]: from sklearn.model_selection import GridSearchCV In [69]: kvals = [ 10 , 50 , 100 ] t = time . time () knn = GridSearchCV ( KNeighborsClassifier (), { 'n_neighbors' : kvals }, cv = 5 ) . fit ( X_train , y_train ) runtime_knn = time . time () - t In [40]: % timeit predictions = knn.predict(X_test) 1.26 s ± 12 ms per loop (mean ± std. dev. of 7 runs, 1 loop each) In [70]: print ( \"Best k:\" , knn . best_params_ [ 'n_neighbors' ]) print ( 'kNN Test Score:' , knn . score ( X_test , y_test ), ', runtime= ' , runtime_knn ) Best k: 100 kNN Test Score: 0.8329 , runtime= 28.959781885147095 In [71]: plt . plot ( kvals , knn . cv_results_ [ 'mean_test_score' ], '-*' ) plt . fill_between ( kvals , knn . cv_results_ [ 'mean_test_score' ] - 2 * knn . cv_results_ [ 'std_test_score' ], knn . cv_results_ [ 'mean_test_score' ] + 2 * knn . cv_results_ [ 'std_test_score' ], alpha =. 3 ) plt . xlabel ( 'k' ) plt . ylabel ( 'validation accuracy +- 2 std' ); In [72]: fig , ax = plt . subplots () scatter_stars ( ax , data_sample , columns = [ 'u-g' , 'g-r' ], class_labels = tgt_id2name , class_colors = class_colors , edgecolor = 'black' , lw =. 25 , s = 10 ) overlay_decision_boundary ( ax , knn , colors = class_colors , desaturate =. 3 ) LDA and QDA LDA and QDA model each class as a Normal distribution. (Does that make sense for our data?) To classify a sample, we use Bayes' rule: $$P(y=k | X) = \\frac{P(X | y=k) P(y=k)}{P(X)} = \\frac{P(X | y=k) P(y = k)}{ \\sum_{l} P(X | y=l) \\cdot P(y=l)}$$ So the most likely class is: $$\\hat{y} = \\arg\\max_k P(y=k | X) = \\arg\\max_k P(X | y=k) P(y=k)$$ (see http://scikit-learn.org/stable/modules/lda_qda.html#mathematical-formulation-of-the-lda-and-qda-classifiers ) In [48]: lda = LinearDiscriminantAnalysis ( store_covariance = True ) #, priors=[1,1,1]) qda = QuadraticDiscriminantAnalysis ( store_covariance = True ) #, priors=[1,1,1]) t = time . time () lda . fit ( X_train , y_train ) fittime_lda = time . time () - t t = time . time () qda . fit ( X_train , y_train ) fittime_qda = time . time () - t t = time . time () lda . predict ( X_test ) infertime_lda = time . time () - t t = time . time () qda . predict ( X_test ) infertime_qda = time . time () - t print ( 'LDA accuracy train= {:.2%} , test: {:.2%} , fit time {:.2f} s, predict time {:.2f} s' . format ( lda . score ( X_train , y_train ), lda . score ( X_test , y_test ), fittime_lda , infertime_lda )) print ( 'QDA accuracy train= {:.2%} , test: {:.2%} , fit time {:.2f} s, predict time {:.2f} s' . format ( qda . score ( X_train , y_train ), qda . score ( X_test , y_test ), fittime_qda , infertime_qda )) LDA accuracy train=73.38%, test: 72.97%, fit time 0.07s, predict time 0.00s QDA accuracy train=69.95%, test: 69.60%, fit time 0.02s, predict time 0.01s Let's look at the model that LDA and QDA fit to the data. Do they make sense? In [49]: # Code credit: http://scikit-learn.org/stable/auto_examples/classification/plot_lda_qda.html def plot_ellipse ( ax , mean , cov , color ): v , w = np . linalg . eigh ( cov ) u = w [ 0 ] / np . linalg . norm ( w [ 0 ]) angle = np . arctan ( u [ 1 ] / u [ 0 ]) angle = 180 * angle / np . pi # convert to degrees # filled Gaussian at 2 standard deviation ell = matplotlib . patches . Ellipse ( mean , 2 * v [ 0 ] ** 0.5 , 2 * v [ 1 ] ** 0.5 , 180 + angle , facecolor = color , edgecolor = 'yellow' , linewidth = 2 , zorder = 2 ) ell . set_clip_box ( ax . bbox ) ell . set_alpha ( 0.5 ) ax . add_artist ( ell ) In [50]: fitted_models = [ lda , qda ] titles = [ 'LDA' , 'QDA' ] class_colors = [ 'r' , 'g' , 'b' ] f , axes = plt . subplots ( 1 , 2 , figsize = ( 16 , 7 )) for i , ( model , ax , title ) in enumerate ( zip ( fitted_models , axes , titles )): scatter_stars ( ax , data_sample , columns = [ 'u-g' , 'g-r' ], class_labels = tgt_id2name , class_colors = class_colors , edgecolor = 'black' , lw =. 5 , s = 10 ) for target , color in enumerate ( class_colors ): if isinstance ( model , QuadraticDiscriminantAnalysis ): # For QDA covariance = model . covariance_ [ target ] else : # LDA covariance = model . covariance_ plot_ellipse ( ax , model . means_ [ target ], covariance , color ) ax . set_title ( title ) What about those priors? Generally we estimate them from the data: In [51]: lda . priors_ Out[51]: array([0.5351 , 0.36022143, 0.10467857]) In [54]: data_train . response . value_counts ( normalize = True ) Out[54]: 0 0.535100 1 0.360221 2 0.104679 Name: response, dtype: float64 ... but we could use domain knowledge to set them. In [56]: fig , axs = plt . subplots ( ncols = 2 , figsize = ( 16 , 8 )) for ax , title , model in zip ( axs , 'LDA QDA' . split (), [ lda , qda ]): cnf_matrix = confusion_matrix ( y_test , model . predict ( X_test )) # cnf_matrix = confusion_matrix(np.full_like(y_test, 2), y_test) plot_confusion_matrix ( ax , cnf_matrix , classes = tgt_id2name , normalize = True ) ax . set_title ( title ) In [73]: # from sklearn 0.20 def balanced_accuracy_score ( y_true , y_pred ): C = confusion_matrix ( y_true , y_pred ) with np . errstate ( divide = 'ignore' , invalid = 'ignore' ): per_class = np . diag ( C ) / C . sum ( axis = 1 ) if np . any ( np . isnan ( per_class )): warnings . warn ( 'y_pred contains classes not in y_true' ) per_class = per_class [ ~ np . isnan ( per_class )] score = np . mean ( per_class ) return score In [58]: fitted_models = [ lda , qda ] titles = [ 'LDA' , 'QDA' ] class_colors = [ 'r' , 'g' , 'b' ] f , axes = plt . subplots ( 1 , 2 , figsize = ( 16 , 7 )) data_sample = data_train . sample ( frac =. 05 ) for i , ( model , ax , title ) in enumerate ( zip ( fitted_models , axes , titles )): scatter_stars ( ax , data_sample , columns = [ 'u-g' , 'g-r' ], class_labels = tgt_id2name , class_colors = class_colors , edgecolor = 'black' , lw =. 25 , s = 10 ) overlay_decision_boundary ( ax , model , colors = class_colors , desaturate =. 3 ) ax . set_title ( title ) # print(\"{}: accuracy on train={:.2%}, test={:.2%}\".format( # title, balanced_accuracy_score(y_train, model.predict(X_train)), # balanced_accuracy_score(y_test, model.predict(X_test)))) We are not doing great at separating stars from galaxies. What other information could help us distinguish these two? Here is where the domain knowledge becomes important. Stars can be observed only when they are close enough, while galaxies that we observe and look like stars (point source like) are much further away. Redshift is a measure of distance and is one of the columns in our dataset. Lets see what happens if we include it. In [74]: plot_columns = [ 'u-g' , 'g-r' , 'log_redshift' ] col_pairs = list ( combinations ( plot_columns , 2 )) n = len ( col_pairs ) fig , axes = plt . subplots ( nrows = n , figsize = ( 12 , 7 * n )) data_sample = data_train . sample ( frac =. 1 ) for ax , columns in zip ( axes , col_pairs ): scatter_stars ( ax , data_sample , columns , tgt_id2name , class_colors , alpha =. 3 ) fig . tight_layout () Exercise Go back and change a color to 'redshift' in the predictors In [75]: predictors = [ 'u-g' , 'log_redshift' ] X_train = data_train . loc [:, predictors ] y_train = data_train . loc [:, 'response' ] X_test = data_test . loc [:, predictors ] y_test = data_test . loc [:, 'response' ] In [77]: lda . fit ( X_train , y_train ) qda . fit ( X_train , y_train ) fitted_models = [ lda , qda ] titles = [ 'LDA' , 'QDA' ] class_colors = [ 'r' , 'g' , 'b' ] f , axes = plt . subplots ( 1 , 2 , figsize = ( 16 , 7 )) data_sample = data_train . sample ( frac =. 05 ) for i , ( model , ax , title ) in enumerate ( zip ( fitted_models , axes , titles )): scatter_stars ( ax , data_sample , columns = predictors , class_labels = tgt_id2name , class_colors = class_colors , edgecolor = 'black' , lw =. 25 , s = 10 ) overlay_decision_boundary ( ax , model , colors = class_colors , desaturate =. 3 ) ax . set_title ( title ) print ( \" {} : accuracy on train= {:.2%} , test= {:.2%} \" . format ( title , model . score ( X_train , y_train ), model . score ( X_test , y_test ))) LDA: accuracy on train=97.66%, test=97.74% QDA: accuracy on train=98.71%, test=98.71% QDA now does better than LDA, why do you think that is? if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/section7/solutions/"},{"title":"Lab 5: Regularization and Cross-Validation","text":"Jupyter Notebooks Lab 5: Regularization and Cross-Validation - Student Version Lab 5: Regularization and Cross-Validation - Solutions","tags":"labs","url":"labs/lab-5/"},{"title":"Advanced Section 3: Methods of Regularization and Justifications","text":"Slides PPTX | Advanced Section 3: Methods of Regularization and Justifications Section Notes PDF | Advanced Section 3: Methods of Regularization and Justifications Jupyter Notebooks Advanced Section 3: Methods of Regularization and Justifications","tags":"a-sections","url":"a-sections/a-section-3/"},{"title":"Lecture 8: High Dimensionality and Principal Component Analysis (PCA)","text":"Slides PDF | Lecture 8: High Dimensionality and Principal Component Analysis (PCA) Associated Materials Notebook | Lecture 8: Principal Component Analysis Demo Notebook | Standard Section 5: Logistic Regression and Principal Component Analysis (PCA) - Solutions Notebook | Lab 6: Classification and Dimensionality Reduction","tags":"lectures","url":"lectures/lecture-8/"},{"title":"Lecture 7: Regularization","text":"Slides PDF | Lecture 7: Regularization PPTX | Lecture 7: Regularization Jupyter Notebooks Lab 5: Regularization and Cross-Validation - Student Version Lab 5: Regularization and Cross-Validation - Solutions","tags":"lectures","url":"lectures/lecture-7/"},{"title":"Standard Section 3: Predictor Types and Feature","text":"Slides PDF | Standard Section 3: Predictor Types and Feature Notebooks Standard Section 3: Predictor Types and Feature - Student Version Standard Section 3: Predictor Types and Feature - Solutions","tags":"sections","url":"sections/section-3/"},{"title":"Lab 4: Multiple and Polynomial Linear Regression","text":"Jupyter Notebooks Lab 4: Multiple Linear Regression and Polynomial Regression - Student Version Lab 4: Multiple Linear Regression and Polynomial Regression - Solutions","tags":"labs","url":"labs/lab-4/"},{"title":"Advanced Section 2: Model Selection and Information Criteria","text":"Slides PDF | Advanced Section 2: Model Selection and Information Criteria PPTX | Advanced Section 2: Model Selection and Information Criteria Section Notes PDF | Advanced Section 2: Model Selection and Information Criteria","tags":"a-sections","url":"a-sections/a-section-2/"},{"title":"Lecture 6: Multiple Linear Regression, Polynomial Regression and Model Selection","text":"Slides PDF | Lecture 6: Multiple Linear Regression, Polynomial Regression and Model Selection PPTX | Lecture 6: Multiple Linear Regression, Polynomial Regression and Model Selection PDF | Standard Section 4: Model selection Jupyter Notebooks Standard Section 4: Model Selection Demo Lab 4: Multiple Linear Regression and Polynomial Regression - Student Version Lab 4: Multiple Linear Regression and Polynomial Regression - Solutions","tags":"lectures","url":"lectures/lecture-6/"},{"title":"Lecture 5: Linear Regression, Confidence Intervals and Standard Errors","text":"Slides PDF | Lecture 5: Linear Regression, Confidence Intervals and Standard Errors PPTX | Lecture 5: Linear Regression, Confidence Intervals and Standard Errors Jupyter Notebooks Standard Section 3: Predictor Types and Feature - Student Version Standard Section 3: Predictor Types and Feature - Solutions Lab 3: Scikit-learn for Regression - Student Version Lab 3: Scikit-learn for Regression - Solutions","tags":"lectures","url":"lectures/lecture-5/"},{"title":"Standard Section 2: Prediction using kNN and Linear Regression","text":"Jupyter Notebooks Standard Section 2: Prediction using kNN and Linear Regression - Student Version Standard Section 2: Prediction using kNN and Linear Regression - Solutions","tags":"sections","url":"sections/section-2/"},{"title":"Lab 3: Scikit-learn for Regression","text":"Jupyter Notebooks Lab 3: Scikit-learn for Regression - Student Version Lab 3: Scikit-learn for Regression - Solutions","tags":"labs","url":"labs/lab-3/"},{"title":"Advanced Section 1: Linear Algebra and Hypothesis Testing","text":"Slides PDF | Advanced Section 1: Linear Algebra and Hypothesis Testing PPTX | Advanced Section 1: Linear Algebra and Hypothesis Testing","tags":"a-sections","url":"a-sections/a-section-1/"},{"title":"Lecture 4: Linear Regression, kNN Regression and Inference","text":"Slides PDF | Lecture 4: Linear Regression, kNN Regression and Inference PPTX | Lecture 4: Linear Regression, kNN Regression and Inference Jupyter Notebooks Lecture 4: Regression Demo Standard Section 2: Prediction using kNN and Linear Regression - Student Version Standard Section 2: Prediction using kNN and Linear Regression - Solutions Lab 3: Scikit-learn for Regression - Student Version Lab 3: Scikit-learn for Regression - Solutions","tags":"lectures","url":"lectures/lecture-4/"},{"title":"Lecture 3: Effective Exploratory Data Analysis and Visualization","text":"Slides PDF | Lecture 3: Effective Exploratory Data Analysis and Visualization Associated Materials Notebook | Lecture 3: EDA and Visualization Demo","tags":"lectures","url":"lectures/lecture-3/"},{"title":"Standard Section 1: Introduction to Web Scraping","text":"Jupyter Notebooks Standard Section 1: Introduction to Web Scraping - Student Version Standard Section 1: Introduction to Web Scraping - Solutions","tags":"sections","url":"sections/section-1/"},{"title":"Lab 2: Python for Data Collection and Cleaning","text":"Notebooks Lab 2: BeautifulSoup for Scraping - Student Version Lab 2: BeautifulSoup for Scraping - Solutions Lab 2: Pandas for Data Cleaning - Student Version Lab 2: Pandas for Data Cleaning - Solutions","tags":"labs","url":"labs/lab-2/"},{"title":"Lecture 2: Data Engineering - The Grammar of Data","text":"Slides PDF | Lecture 2: Data Engineering - The Grammar of Data PPTX | Lecture 2: Data Engineering - The Grammar of Data Jupyter Notebooks Lecture 2: Data Engineering Demo Standard Section 1: Introduction to Web Scraping - Student Version Standard Section 1: Introduction to Web Scraping - Solutions Lab 1: Introduction to Python and its Numerical Stack - Student Version Lab 1: Introduction to Python and its Numerical Stack - Solutions Lab 2: BeautifulSoup for Scraping - Student Version Lab 2: BeautifulSoup for Scraping - Solutions","tags":"lectures","url":"lectures/lecture-2/"},{"title":"Lecture 1: Data, Summaries and Visuals","text":"Slides PDF | Lecture 1: Data, Summaries and Visuals Jupyter Notebooks Standard Section 1: Introduction to Web Scraping - Student Version Standard Section 1: Introduction to Web Scraping - Solutions Lab 1: Introduction to Python and its Numerical Stack - Student Version Lab 1: Introduction to Python and its Numerical Stack - Solutions","tags":"lectures","url":"lectures/lecture-1/"},{"title":"Lab 6: Classification and Dimensionality Reduction - Student Version","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 6: Classification and Dimensionality Reduction Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructors: Pavlos Protopapas. Contributors: Will Claybaugh and David Sondak Zoom I will be using zoom during this lab. You can connect to the room using the link https://harvard-dce.zoom.us/j/7607382317 and when you are ready to share your screen let me know and can share your screen. In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Learning Goals In this lab, we'll explore different models used to predict which of several labels applies to a new datapoint based on labels observed in the training data. We'll similarly explore PCA as a technique for reducing the number of features in a dataset with as little loss of structure as possible. By the end of this lab, you should: Be familiar with the sklearn implementations of Logistic Regression Be able to make an informed choice of model based on the data at hand Be familiar with the SKlearn implementation of Principle Components Analysis (PCA) Be able to select an appropriate number of PCA components (Bonus) Structure your sklearn code into Pipelines to make building, fitting, and tracking your models easier (Bonus) Apply weights to each class in the model to achieve your desired tradeoffs between discovery and false alarm in various classes In [76]: % matplotlib inline import numpy as np import scipy as sp import matplotlib.pyplot as plt import pandas as pd pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) from sklearn.model_selection import train_test_split Part 1: The Wine Dataset The dataset contains 11 chemical features of various wines, along with experts' rating of that wine's quality. The quality scale technically runs from 1-10, but only 3-9 are actually used in the data. Our goal will be to distinguish good wines from bad wines based on their chemical properties. Read-in and checking We do the usual read-in and verification of the data: In [75]: wines_df = pd . read_csv ( \"data/wines.csv\" , index_col = 0 ) wines_df . head () Out[75]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } fixed acidity volatile acidity citric acid residual sugar chlorides free sulfur dioxide total sulfur dioxide density pH sulphates alcohol quality red good 0 8.9 0.590 0.50 2.0 0.337 27.0 81.0 0.99640 3.04 1.61 9.5 6 1 0 1 7.7 0.690 0.22 1.9 0.084 18.0 94.0 0.99610 3.31 0.48 9.5 5 1 0 2 8.8 0.685 0.26 1.6 0.088 16.0 23.0 0.99694 3.32 0.47 9.4 5 1 0 3 11.4 0.460 0.50 2.7 0.122 4.0 17.0 1.00060 3.13 0.70 10.2 5 1 0 4 8.8 0.240 0.54 2.5 0.083 25.0 57.0 0.99830 3.39 0.54 9.2 5 1 0 In [77]: wines_df . describe () Out[77]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } fixed acidity volatile acidity citric acid residual sugar chlorides free sulfur dioxide total sulfur dioxide density pH sulphates alcohol quality red good count 1000.000000 1000.000000 1000.00000 1000.000000 1000.000000 1000.00000 1000.00000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.00000 1000.000000 mean 7.558400 0.397455 0.30676 4.489250 0.067218 25.29650 91.03100 0.995351 3.251980 0.572990 10.489433 5.796000 0.50000 0.189000 std 1.559455 0.189923 0.16783 4.112419 0.046931 17.06237 59.57269 0.002850 0.164416 0.169583 1.151195 0.844451 0.50025 0.391705 min 3.800000 0.080000 0.00000 0.800000 0.009000 1.00000 6.00000 0.987400 2.740000 0.280000 8.500000 3.000000 0.00000 0.000000 25% 6.500000 0.260000 0.22000 1.800000 0.042000 12.00000 37.75000 0.993480 3.140000 0.460000 9.500000 5.000000 0.00000 0.000000 50% 7.200000 0.340000 0.30000 2.400000 0.060000 22.00000 86.00000 0.995690 3.240000 0.550000 10.300000 6.000000 0.50000 0.000000 75% 8.200000 0.520000 0.40000 6.100000 0.080000 35.00000 135.00000 0.997400 3.360000 0.650000 11.300000 6.000000 1.00000 0.000000 max 15.500000 1.580000 1.00000 26.050000 0.611000 131.00000 313.00000 1.003690 3.900000 2.000000 14.000000 8.000000 1.00000 1.000000 Building the training/test data As usual, we split the data before we begin our analysis. Today, we take the 'quality' variable as our target. There's a debate to be had about the best way to handle this variable. It has 10 categories (1-10), though only 3-9 are used. While the variable is definitely ordinal- we can put the categories in an order everyone agrees on- the variable probably isn't a simple numeric feature; it's not clear whether the gap between a 5 and a 6 wine is the same as the gap between an 8 and a 9. Ordinal regression is one possibility for our analysis (beyond the scope of this course), but we'll view the quality variable as categorical. Further, we'll simplify it down to 'good' and 'bad' wines (quality at or above 7, and quality at or below 6, respectively). This binary column already exists in the data, under the name 'good'. In [78]: wines_train , wines_test = train_test_split ( wines_df , test_size = 0.2 , random_state = 8 , stratify = wines_df [ 'good' ]) x_train = wines_train . drop ([ 'quality' , 'good' ], axis = 1 ) y_train = wines_train [ 'good' ] x_test = wines_test . drop ([ 'quality' , 'good' ], axis = 1 ) y_test = wines_test [ 'good' ] x_train . head () Out[78]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } fixed acidity volatile acidity citric acid residual sugar chlorides free sulfur dioxide total sulfur dioxide density pH sulphates alcohol red 744 7.6 0.30 0.37 1.6 0.087 27.0 177.0 0.99438 3.09 0.50 9.8 0 51 7.6 0.29 0.49 2.7 0.092 25.0 60.0 0.99710 3.31 0.61 10.1 1 213 13.2 0.46 0.52 2.2 0.071 12.0 35.0 1.00060 3.10 0.56 9.0 1 883 8.6 0.33 0.34 11.8 0.059 42.0 240.0 0.99882 3.17 0.52 10.0 0 98 7.7 0.41 0.76 1.8 0.611 8.0 45.0 0.99680 3.06 1.26 9.4 1 Now that we've split, let's explore some patterns in the data In [80]: from pandas.plotting import scatter_matrix scatter_matrix ( wines_train , figsize = ( 30 , 20 )); It looks like there aren't any particularly strong correlations among the predictors (maybe sulfur dioxide and free sulfur dioxide) so we're safe to keep them all. It also looks like the different quality categories have roughly the same distribution of most variables, with volatile/fixed acidity and alcohol seeming like the most useful predictors. Part 2 (Introduction): Binary Logistic Regression Linear regression is usually a good baseline model, but since the outcome we're trying to predict only takes values 0 and 1 we'll want to use logistic regression instead of basic linear regression. We'll begin with statsmodels , because cs109 likes confidence intervals and checking that coefficients make sense. In [81]: import statsmodels.api as sm sm_fitted_logit = sm . Logit ( y_train , sm . add_constant ( x_train )) . fit () #sm_fitted_logit.summary() ### ORIGINAL VERSION. GAVE AttributeError: module 'scipy.stats' has no attribute 'chisqprob' sm_fitted_logit . summary2 () ### WORKS Optimization terminated successfully. Current function value: 0.372167 Iterations 10 Out[81]: Model: Logit Pseudo R-squared: 0.232 Dependent Variable: good AIC: 621.4673 Date: 2018-10-18 00:50 BIC: 682.3672 No. Observations: 800 Log-Likelihood: -297.73 Df Model: 12 LL-Null: -387.52 Df Residuals: 787 LLR p-value: 5.1997e-32 Converged: 1.0000 Scale: 1.0000 No. Iterations: 10.0000 Coef. Std.Err. z P>|z| [0.025 0.975] const 296.7882 178.7587 1.6603 0.0969 -53.5724 647.1488 fixed acidity 0.4228 0.1962 2.1546 0.0312 0.0382 0.8073 volatile acidity -3.6301 1.1006 -3.2983 0.0010 -5.7872 -1.4729 citric acid -0.8217 1.0638 -0.7724 0.4399 -2.9066 1.2633 residual sugar 0.1628 0.0759 2.1454 0.0319 0.0141 0.3115 chlorides -18.8903 8.1523 -2.3172 0.0205 -34.8684 -2.9121 free sulfur dioxide 0.0026 0.0089 0.2864 0.7746 -0.0150 0.0201 total sulfur dioxide -0.0036 0.0038 -0.9597 0.3372 -0.0110 0.0038 density -312.9457 182.0829 -1.7187 0.0857 -669.8215 43.9302 pH 1.5112 1.1276 1.3402 0.1802 -0.6989 3.7212 sulphates 2.5571 0.8610 2.9700 0.0030 0.8696 4.2446 alcohol 0.4945 0.2190 2.2580 0.0239 0.0653 0.9236 red 0.6751 0.6490 1.0403 0.2982 -0.5968 1.9470 Let's talk about the output: First, \"optimization terminated successfully\". Recall that linear regression and its simple formula for the optimal betas is a rarity in machine learning and statistics: most models are fit to the data algorithmically, not via a formula. This message is letting us know that the algorithm seems to have worked. Second, the pseudo $R&#94;2$ is rather low (.23). As with regular $R&#94;2$, we might take this as a sign that the model is struggling. Finally, let's look at the coefficients. Several of the coefficients are statistically significant, including Fixed acidity - good Volatile Acidity - bad Residual Sugar - good (judge have a sweet tooth?) Chlorides - bad Sulphates - good Alcohol - good (judges like getting drunk?) The rest only reach a coefficient size we would often observe by chance alone, without any actual effect from the predictor More formal interpretations are of coefficients are long-winded. \"A one unit increase in alcohol (holding all else constant) results in a predicted 0.494 increase in the log odds of a wine being classified as good\". We can't be more precise because the effect of one unit of alcohol depends on how much alcohol there already is. The one unit increase/decrease matters more if the wine is otherwise on the border between good and bad. If the wine is undrinkable (in the far left tail of the sigmoidal curve) one unit of alcohol barely moves the probability, while if the wine is in the middle of the curve that unit of acidity has much more practical impact. Discussion Are there any bones you'd like to pick with the model I've laid out? Can you think of a better logistic regression model? Prediction One of the really cool features of logistic regression is that it hands back probabilities of a given case being 1 or 0, rather than just 1s and 0s. That lets us do neat things like set different cutoffs for what counts as a 1 and do ROC analysis and so on. Here, we'll just set the cutoff at 0.5: if a 1 is reported as more likely, predict a 1. (You can play with the cutoff yourself and see if you can make the model do better by trading false positives and false negatives). Because this is statsmodels, we'll need to import a tool or do the test set score calculation ourselves. Here, it's easy enough to implement: do the predictions compare with .5 find out what percentage of our binary predictions matched the truth In [82]: sm_binary_prediction = sm_fitted_logit . predict ( sm . add_constant ( x_test )) >= . 5 np . sum ( y_test == sm_binary_prediction ) / len ( y_test ) Out[82]: 0.80500000000000005 Wow! 80% is a pretty good performance! We can pretty much tell the bad wines from the good. Here's a sanity check: In [83]: np . sum ( y_test == 0 ) / len ( y_test ) Out[83]: 0.81000000000000005 Oh... no... wait. A model that says \"all wines are bad\" also scores 80% on the test set. Our fancy model isn't really doing that well. Moral of the story : Before you congratulate a model, think of a truly trivial model to compare it to. Exercise 1 Re-create the results above but this time work with sklearn . Use the LogisticRegression class. Follow the usual .fit , .score procedure. To match statsmodel 's coefficient values (roughly), you will need to adjust the input parameters: C solver One other parameter See the sklearn documentation Hint: statsmodels uses a Newton-Raphson method to optimize the beta values. In [84]: from sklearn.linear_model import LogisticRegression print ( \"target: \\n {} \" . format ( sm_fitted_logit . params )) #fitted_lr = LogisticRegression(C=___, solver=___, ___) target: const 296.788181 fixed acidity 0.422755 volatile acidity -3.630081 citric acid -0.821665 residual sugar 0.162801 chlorides -18.890258 free sulfur dioxide 0.002563 total sulfur dioxide -0.003620 density -312.945669 pH 1.511186 sulphates 2.557134 alcohol 0.494461 red 0.675074 dtype: float64 Answer : In [11]: # your code here In [12]: # %load solutions/sklearn_logistic.py Speaker note: When presenting solution, model reading the documentation from the webpage. How does one know where to look? Speaker note: Mention the wide variety of solvers and how (some) use different levels of derivatives to converge in fewer steps The Decision Boundary One powerful way to think about classification models is to consider where and how they draw the line between predicting \"class A\" and \"class B\". The code below lets you play with a 2d logistic regression. Points towards yellow will be predicted as 1s, points towards violet will be predicted as 0s. In [13]: from scipy.special import expit def plot_logistic_contour ( beta0 , betaX , betaY , betaXY = 0 , betaX2 = 0 , betaY2 = 0 ): delta =. 1 x_values = np . arange ( - 3.0 , 3.0 , delta ) y_values = np . arange ( - 3.0 , 3.0 , delta ) x_grid , y_grid = np . meshgrid ( x_values , y_values ) logistic_output = expit ( beta0 + betaX * x_grid + betaY * y_grid + betaXY * x_grid * y_grid + betaX2 * x_grid ** 2 + betaY2 * y_grid ** 2 ) contour_figure = plt . contour ( x_grid , y_grid , logistic_output ) plt . clabel ( contour_figure , inline = 1 , fontsize = 10 ); plt . xlim ( - 3 , 3 ) plt . ylim ( - 3 , 3 ) plt . show () #plot_logistic_contour(beta0=1, betaX=2, betaY=3, betaXY=0, betaY2=.1) In [14]: # Use this cell to experiment plot_logistic_contour ( beta0 = 1 , betaX = 2 , betaY = 3 ) Exercise 2 What happens to the decision boundary as the coefficient on X increases? What happens if you increase the Y coefficient to match? What does the constant term control? What impact do higher-order and interaction terms have on the boundary? What parameter settings should I show the class? Answers : your answer here In [15]: # %load solutions/boundaries.txt Part 3 (The Real Challenge): Multiclass Classification Before we move on, let's consider a more common use case of logistic regression: predicting not just a binary variable, but what level a categorical variable will take. Instead of breaking the quality variable into 'good' and 'other', let's discretize into 'good, 'medium', and 'bad'. In [36]: # copy the original data so that we're free to make changes wines_df_recode = wines_df . copy () # use the 'cut' function to reduce a variable down to particular bins. Here the lowest bin is 0-4, next is 5-7, # and the last is 7-10 wines_df_recode [ 'quality' ] = pd . cut ( wines_df_recode [ 'quality' ],[ 0 , 4 , 7 , 10 ], labels = [ 0 , 1 , 2 ]) # drop the un-needed columns x_data = wines_df_recode . drop ([ 'quality' , 'good' ], axis = 1 ) y_data = wines_df_recode [ 'quality' ] x_train , x_test , y_train , y_test = train_test_split ( x_data , y_data , test_size =. 2 , random_state = 8 , stratify = y_data ) print ( wines_df [ 'quality' ] . head ()) print ( wines_df_recode [ 'quality' ] . head ()) The cut function obviously stores a lot of extra information for us. It's a very useful tool for discretizing an existing variable. Exercise 3 Adapt your earlier logistic regression code to fit to the new training data. What is stored in .coef_ and .intercept_ ? How well does this model predict the test data? Put the model's performance in context. Think of a trivial model to compare to, and provide its accuracy score on the test set. Answers : 1. In [17]: # your code here In [18]: # %load solutions/multi_logistic.py your answer here In [19]: # %load solutions/multi_logistic.txt 2. In [20]: # your code here In [21]: # %load solutions/score1.py your answer here 3. In [22]: # make a dumb prediction that always guesses 1, the most common class # your code here In [23]: # %load solutions/trivial_model.py your solution here But, a trivial model that guesses the most likely class also does really well on the test set, too. In [24]: # %load solutions/3.3.txt Summary Logistic regression extends OLS to work naturally with a dependent variable that's only ever 0 and 1. In fact, Logistic regression is even more general and is used for predicting the probability of an example belonging to each of $N$ classes. The code for the two cases is identical and just like LinearRegression : .fit , .score , and all the rest Significant predictors does not imply that the model actually works well. Signifigance can be driven by data size alone. The data aren't enough to do what we want Warning : Logistic regression tries to hand back valid probabilities. As with all models, you can't trust the results until you validate them- if you're going to use raw probabilities instead of just predicted class, take the time to verify that if you pool all cases where the model says \"I'm 30% confident it's class A\" 30% of them actually are class A. Part 4: Dimensionality Reduction Our models are clearly struggling, but it's hard to tell why. Let's PCA to shrink the problem down to 2d (with as little loss as possible) and see if that gives us a clue about what makes this problem tough. In [25]: from sklearn.decomposition import PCA from sklearn.preprocessing import StandardScaler # scale the datasets scale_transformer = StandardScaler ( copy = True ) . fit ( x_train ) x_train_scaled = scale_transformer . transform ( x_train ) x_test_scaled = scale_transformer . transform ( x_test ) # reduce dimensions pca_transformer = PCA ( 2 ) . fit ( x_train_scaled ) x_train_2d = pca_transformer . transform ( x_train_scaled ) x_test_2d = pca_transformer . transform ( x_test_scaled ) print ( x_train_2d . shape ) x_train_2d [ 0 : 5 ,:] Some comments: Both scaling and reducing dimension follow the same pattern: we fit the object to the training data, then use .transform to convert the training and test data. This ensures that, for instance, we scale the test data using the training mean and variance, not its own mean and variance We need to equalize the variance of each feature before applying PCA, otherwise certain dimensions will dominate the scaling: our PCA dimensions would just be the features with the largest spread. In [26]: ## plot each group # notice that we set up lists to track each group's plotting color and label colors = [ 'r' , 'c' , 'b' ] label_text = [ \"Bad Wines\" , \"Medium Wines\" , \"Good Wines\" ] # and we loop over the different groups for cur_quality in [ 0 , 1 , 2 ]: cur_df = x_train_2d [ y_train == cur_quality ] plt . scatter ( cur_df [:, 0 ], cur_df [:, 1 ], c = colors [ cur_quality ], label = label_text [ cur_quality ]) # all plots need labels plt . xlabel ( \"PCA Dimension 1\" ) plt . ylabel ( \"PCA Dimention 2\" ) plt . legend (); Well, that gives us some idea of why the problem is difficult: the good wines and bad wines are hiding right among the average wines. It does look like the wines separate into two groups, though, possibly one for reds and one for whites. Exercise 4 What critique can you make against the plot above? Why does this plot not prove that the different wines are hopelessly similar? The wine data we've used so far consist entirely of continuous predictors. Would PCA work with categorical data? Answer : your answer here In [27]: # %load solutions/4.txt Exercise 5 Edit the code above to plot the locations of red wines and white wines Answer : In [28]: # your code here Evaluating PCA - Variance Explained One of the criticisms we made of the PCA plot was that it's lost something from the original data. Let's actually investigate how much of the original data's structure the 2d PCA captures. We'll look at the explained_variance_ratio_ portion of the PCA fit. This lists, in order, the percentage of the x data's total variance that is captured by the nth PCA dimension. In [29]: var_explained = pca_transformer . explained_variance_ratio_ print ( \"Variance explained by each PCA component:\" , var_explained ) print ( \"Total Variance Explained:\" , np . sum ( var_explained )) The first PCA dimension captures 33% of the variance in the data, and the second PCA dimension adds another 20%. Together, we've got about half of the total variation in the training data covered with just these two dimensions. Exercise 6 Fit a PCA that finds the first 10 PCA components of our training data Use np.cumsum to print out the variance we'd be able to explain by using n PCA dimensions for n=1 through 10 Does the 10-dimension PCA agree with the 2d PCA on how much variance the first components explain? Do the 10d and 2d PCAs find the same first two dimensions? Why or why not? Make a plot of number of PCA dimensions against total variance explained. What PCA dimension looks good to you? Hint: np.cumsum stands for 'cumulative sum', so np.cumsum([1,3,2,-1,2]) is [1,4,6,5,7] Answer : In [30]: #your code here 3. your answer here In [31]: # %load solutions/6.3.txt 4. In [32]: #your code here In [33]: # %load solutions/6.4.py A PCA dimension of 3, 4, or 5 looks good to me. These values are roughly where we hit diminishing returns on variance explained. Plots like the one above are called 'Scree' or 'Elbow' plots. They are often used to heuristically select a good number of PCA dimensions. Summary PCA maps a high-dimensional space into a lower dimensional space. The PCA dimensions are ordered by how much of the original data's variance they capture There are other cool and useful properties of the PCA dimensions (orthogonal, etc.). See a textbook . PCA on a given dataset always gives the same dimensions in the same order. You can select the number of dimensions by fitting a big PCA and examining a plot of the cumulative variance explained. Part 5: Did we fail? None of the models worked, and we can't tell good wines from bad. Was it all a waste of time and money? Not really. All analyses are a roll of the dice. Some analyses fail, like this one did, becuase the data at hand just don't support the task we've set out. What can we do about it? Be honest about the methods and the null result. Lots of analyses fail. Collect a dataset you think has a better chance of success. Maybe we collected the wrong chemical signals... Keep trying new approaches. Just beware of overfitting the data you're validating on. Always have a test set locked away for when the final model is built. Change the question. Maybe something you noticed during analysis seems interesting or useful (classifying red versus white). But again, you the more you try, the more you might overfit, so have test data locked away. Just move on. If the odds of success start to seem small, maybe you need a new project. The Moral of the Lab Sometimes, the data just aren't enough to adequately predict outcomes. In this lab we saw that no amount of modeling finesse would let us use a wine's chemical properties to tell good wines and bad wines from mediocre ones. The chemical properties were very good at telling red wines from whites, however. PCA helped us visualize the data and confirm that the highly rated wines just aren't chemically distinct from the other wines. NOT ALL ANALYSES YIELD USEFUL RESULTS Sometimes (arguably most of the time), the data aren't suitable for a task or just don't have anything interesting to say. Part 6 (Sidebar): Weighting the training points Some models can accept weights on the training points to given them greater priority in the model's fitting process. This can be useful if, for instance, certain classes are rare but we want to be sure the model classifies them correctly (e.g. we're trying to classify cancers and one form is rare but very aggressive). In general, weighting training points is like moving along the ROC curve; we change some model parameters to alter the mistakes the model makes to be more in line with our tastes. Let's see this in action with a logistic regression: In [39]: # copy the original data so that we're free to make changes wines_df_recode = wines_df . copy () # use the 'cut' function to reduce a variable down to particular bins. Here the lowest bin is 0-4, next is 5-7, # and the last is 7-10 wines_df_recode [ 'quality' ] = pd . cut ( wines_df_recode [ 'quality' ],[ 0 , 4 , 7 , 10 ], labels = [ 0 , 1 , 2 ]) # drop the un-needed columns x_data = wines_df_recode . drop ([ 'quality' , 'good' ], axis = 1 ) y_data = wines_df_recode [ 'quality' ] x_train , x_test , y_train , y_test = train_test_split ( x_data , y_data , test_size =. 2 , random_state = 8 , stratify = y_data ) print ( wines_df [ 'quality' ] . head ()) print ( wines_df_recode [ 'quality' ] . head ()) In [49]: unweighted_lr = LogisticRegression ( C = 1000000 ) . fit ( x_train , y_train ) weight_dict = { 0 : 1000 , 1 : 1 , 2 : 100 } weighted_lr = LogisticRegression ( C = 1000000 , class_weight = weight_dict ) . fit ( x_train , y_train ) In [50]: from sklearn.metrics import confusion_matrix print ( \"Rows: True Lables (Bad, Medium, Good), \\n Colummns: Predicted Lables (Bad, Medium, Good)\" ) print () print ( \"unweighted:\" ) print ( confusion_matrix ( y_test , unweighted_lr . predict ( x_test ))) print ( \"weighted:\" ) print ( confusion_matrix ( y_test , weighted_lr . predict ( x_test ))) Without weighting, the model plays it safe and predicts that all of the test set wines are medium. With weighting, the model is told to care more about getting the bad and good wines right. The model does as we've asked and correctly IDs 3 good/bad test wines, at the price of 17 falsely bad wines and 16 falsely good wines. However, if identifying bad and good wines is, as implied, 100 times more important than identifying medium wines, we've made a really good trade. Exercise 7 What happens if you give a weight of 0 to the medium wines? What weighting gives results that accord with your personal sense of what the model should be doing? How many actually-medium bottles is a single good bottle worth? Answers : The model learns a classification rule that never predicts 'medium'. It's as it we dropped the medium wines from training. 100, 1, 100 looks the best to me. We get a 1-in-8 sucess rate on the wines flagged as good. However, I found these values by looking at the test set confusion matrix; it's not clear they'd maintain the 1-in-8 ratio on new data. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-6/student/"},{"title":"Advanced Sections 3: Methods of Regularization and Justifications","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Advanced Section 3: Regularization Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Section Leader: Camilo Fosco Contributors: Will Claybaugh, Pavlos Protopapas This notebooks shows, in code, the effects of the regularization methods. We also show the instability that can arise in OLS. In [2]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[2]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [50]: # Imports import numpy as np import matplotlib.pyplot as plt from mpl_toolkits.mplot3d import Axes3D as a3d # from plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot from plotly.plotly import plot , iplot import plotly.graph_objs as go init_notebook_mode ( connected = True ) from copy import deepcopy % matplotlib inline % matplotlib notebook requirejs.config({paths: { 'plotly': ['https://cdn.plot.ly/plotly-latest.min']},});if(!window.Plotly) {{require(['plotly'],function(plotly) {window.Plotly=plotly;});}} Create regression problem To exemplify the estimators and their behavior on different types of data, we create a basic 2D regression, as well as a 2d regression with highly colinear predictors. Let's start with a normal regression with random predictor values: In [51]: ## Global variables for plots # True betas: b_true = np . array ([ 3 , 7 ]) . reshape (( 2 , 1 )) # Samples and Y noise N = 300 sigma = 5 # linspaces lsp = np . linspace ( - 1.5 , 1.5 , 20 ) lsp_x , lsp_y = np . meshgrid ( lsp , lsp ) lsp_mat = np . column_stack (( lsp_x . flatten (), lsp_y . flatten ())) In [52]: # Generate random data from the true betas X = np . random . rand ( N , 2 ) * 10 - 5 X = ( X - X . mean ( axis = 0 )) / X . std ( axis = 0 ) eps = np . random . normal ( scale = sigma , size = ( N , 1 )) y = np . dot ( X , b_true ) + eps Plot regression problem In [53]: # 3D plot with Axes3D. 3D plotting with this is suboptimal, as it does no actual 3d rendering. def plot_scatter_axes3d ( X , y , b_true ): # y surface from true betas y_noiseless = np . dot ( lsp_mat , b_true ) . reshape (( 20 , 20 )) fig = plt . figure ( figsize = [ 9 , 7 ]) ax = fig . gca ( projection = '3d' ) ax . scatter ( X [:, 0 ], X [:, 1 ], y , color = 'red' , alpha = 1 , zorder = y ) ax . plot_surface ( lsp_x , lsp_y , np . dot ( lsp_mat , b_true ) . reshape (( 20 , 20 )), color = 'black' , alpha = 0.5 , zorder = y_noiseless ) plt . show () plot_scatter_axes3d ( X , y , b_true ); var element = $('#e9bfceae-c3da-46ab-8c18-d78d6e00b1ab'); /* Put everything inside the global mpl namespace */ window.mpl = {}; mpl.get_websocket_type = function() { if (typeof(WebSocket) !== 'undefined') { return WebSocket; } else if (typeof(MozWebSocket) !== 'undefined') { return MozWebSocket; } else { alert('Your browser does not have WebSocket support.' + 'Please try Chrome, Safari or Firefox ≥ 6. ' + 'Firefox 4 and 5 are also supported but you ' + 'have to enable WebSockets in about:config.'); }; } mpl.figure = function(figure_id, websocket, ondownload, parent_element) { this.id = figure_id; this.ws = websocket; this.supports_binary = (this.ws.binaryType != undefined); if (!this.supports_binary) { var warnings = document.getElementById(\"mpl-warnings\"); if (warnings) { warnings.style.display = 'block'; warnings.textContent = ( \"This browser does not support binary websocket messages. \" + \"Performance may be slow.\"); } } this.imageObj = new Image(); this.context = undefined; this.message = undefined; this.canvas = undefined; this.rubberband_canvas = undefined; this.rubberband_context = undefined; this.format_dropdown = undefined; this.image_mode = 'full'; this.root = $('<div/>'); this._root_extra_style(this.root) this.root.attr('style', 'display: inline-block'); $(parent_element).append(this.root); this._init_header(this); this._init_canvas(this); this._init_toolbar(this); var fig = this; this.waiting = false; this.ws.onopen = function () { fig.send_message(\"supports_binary\", {value: fig.supports_binary}); fig.send_message(\"send_image_mode\", {}); if (mpl.ratio != 1) { fig.send_message(\"set_dpi_ratio\", {'dpi_ratio': mpl.ratio}); } fig.send_message(\"refresh\", {}); } this.imageObj.onload = function() { if (fig.image_mode == 'full') { // Full images could contain transparency (where diff images // almost always do), so we need to clear the canvas so that // there is no ghosting. fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height); } fig.context.drawImage(fig.imageObj, 0, 0); }; this.imageObj.onunload = function() { fig.ws.close(); } this.ws.onmessage = this._make_on_message_function(this); this.ondownload = ondownload; } mpl.figure.prototype._init_header = function() { var titlebar = $( '<div class=\"ui-dialog-titlebar ui-widget-header ui-corner-all ' + 'ui-helper-clearfix\"/>'); var titletext = $( '<div class=\"ui-dialog-title\" style=\"width: 100%; ' + 'text-align: center; padding: 3px;\"/>'); titlebar.append(titletext) this.root.append(titlebar); this.header = titletext[0]; } mpl.figure.prototype._canvas_extra_style = function(canvas_div) { } mpl.figure.prototype._root_extra_style = function(canvas_div) { } mpl.figure.prototype._init_canvas = function() { var fig = this; var canvas_div = $('<div/>'); canvas_div.attr('style', 'position: relative; clear: both; outline: 0'); function canvas_keyboard_event(event) { return fig.key_event(event, event['data']); } canvas_div.keydown('key_press', canvas_keyboard_event); canvas_div.keyup('key_release', canvas_keyboard_event); this.canvas_div = canvas_div this._canvas_extra_style(canvas_div) this.root.append(canvas_div); var canvas = $('<canvas/>'); canvas.addClass('mpl-canvas'); canvas.attr('style', \"left: 0; top: 0; z-index: 0; outline: 0\") this.canvas = canvas[0]; this.context = canvas[0].getContext(\"2d\"); var backingStore = this.context.backingStorePixelRatio || this.context.webkitBackingStorePixelRatio || this.context.mozBackingStorePixelRatio || this.context.msBackingStorePixelRatio || this.context.oBackingStorePixelRatio || this.context.backingStorePixelRatio || 1; mpl.ratio = (window.devicePixelRatio || 1) / backingStore; var rubberband = $('<canvas/>'); rubberband.attr('style', \"position: absolute; left: 0; top: 0; z-index: 1;\") var pass_mouse_events = true; canvas_div.resizable({ start: function(event, ui) { pass_mouse_events = false; }, resize: function(event, ui) { fig.request_resize(ui.size.width, ui.size.height); }, stop: function(event, ui) { pass_mouse_events = true; fig.request_resize(ui.size.width, ui.size.height); }, }); function mouse_event_fn(event) { if (pass_mouse_events) return fig.mouse_event(event, event['data']); } rubberband.mousedown('button_press', mouse_event_fn); rubberband.mouseup('button_release', mouse_event_fn); // Throttle sequential mouse events to 1 every 20ms. rubberband.mousemove('motion_notify', mouse_event_fn); rubberband.mouseenter('figure_enter', mouse_event_fn); rubberband.mouseleave('figure_leave', mouse_event_fn); canvas_div.on(\"wheel\", function (event) { event = event.originalEvent; event['data'] = 'scroll' if (event.deltaY < 0) { event.step = 1; } else { event.step = -1; } mouse_event_fn(event); }); canvas_div.append(canvas); canvas_div.append(rubberband); this.rubberband = rubberband; this.rubberband_canvas = rubberband[0]; this.rubberband_context = rubberband[0].getContext(\"2d\"); this.rubberband_context.strokeStyle = \"#000000\"; this._resize_canvas = function(width, height) { // Keep the size of the canvas, canvas container, and rubber band // canvas in synch. canvas_div.css('width', width) canvas_div.css('height', height) canvas.attr('width', width * mpl.ratio); canvas.attr('height', height * mpl.ratio); canvas.attr('style', 'width: ' + width + 'px; height: ' + height + 'px;'); rubberband.attr('width', width); rubberband.attr('height', height); } // Set the figure to an initial 600x600px, this will subsequently be updated // upon first draw. this._resize_canvas(600, 600); // Disable right mouse context menu. $(this.rubberband_canvas).bind(\"contextmenu\",function(e){ return false; }); function set_focus () { canvas.focus(); canvas_div.focus(); } window.setTimeout(set_focus, 100); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items) { var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { // put a spacer in here. continue; } var button = $('<button/>'); button.addClass('ui-button ui-widget ui-state-default ui-corner-all ' + 'ui-button-icon-only'); button.attr('role', 'button'); button.attr('aria-disabled', 'false'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); var icon_img = $('<span/>'); icon_img.addClass('ui-button-icon-primary ui-icon'); icon_img.addClass(image); icon_img.addClass('ui-corner-all'); var tooltip_span = $('<span/>'); tooltip_span.addClass('ui-button-text'); tooltip_span.html(tooltip); button.append(icon_img); button.append(tooltip_span); nav_element.append(button); } var fmt_picker_span = $('<span/>'); var fmt_picker = $('<select/>'); fmt_picker.addClass('mpl-toolbar-option ui-widget ui-widget-content'); fmt_picker_span.append(fmt_picker); nav_element.append(fmt_picker_span); this.format_dropdown = fmt_picker[0]; for (var ind in mpl.extensions) { var fmt = mpl.extensions[ind]; var option = $( '<option/>', {selected: fmt === mpl.default_extension}).html(fmt); fmt_picker.append(option) } // Add hover states to the ui-buttons $( \".ui-button\" ).hover( function() { $(this).addClass(\"ui-state-hover\");}, function() { $(this).removeClass(\"ui-state-hover\");} ); var status_bar = $('<span class=\"mpl-message\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; } mpl.figure.prototype.request_resize = function(x_pixels, y_pixels) { // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client, // which will in turn request a refresh of the image. this.send_message('resize', {'width': x_pixels, 'height': y_pixels}); } mpl.figure.prototype.send_message = function(type, properties) { properties['type'] = type; properties['figure_id'] = this.id; this.ws.send(JSON.stringify(properties)); } mpl.figure.prototype.send_draw_message = function() { if (!this.waiting) { this.waiting = true; this.ws.send(JSON.stringify({type: \"draw\", figure_id: this.id})); } } mpl.figure.prototype.handle_save = function(fig, msg) { var format_dropdown = fig.format_dropdown; var format = format_dropdown.options[format_dropdown.selectedIndex].value; fig.ondownload(fig, format); } mpl.figure.prototype.handle_resize = function(fig, msg) { var size = msg['size']; if (size[0] != fig.canvas.width || size[1] != fig.canvas.height) { fig._resize_canvas(size[0], size[1]); fig.send_message(\"refresh\", {}); }; } mpl.figure.prototype.handle_rubberband = function(fig, msg) { var x0 = msg['x0'] / mpl.ratio; var y0 = (fig.canvas.height - msg['y0']) / mpl.ratio; var x1 = msg['x1'] / mpl.ratio; var y1 = (fig.canvas.height - msg['y1']) / mpl.ratio; x0 = Math.floor(x0) + 0.5; y0 = Math.floor(y0) + 0.5; x1 = Math.floor(x1) + 0.5; y1 = Math.floor(y1) + 0.5; var min_x = Math.min(x0, x1); var min_y = Math.min(y0, y1); var width = Math.abs(x1 - x0); var height = Math.abs(y1 - y0); fig.rubberband_context.clearRect( 0, 0, fig.canvas.width, fig.canvas.height); fig.rubberband_context.strokeRect(min_x, min_y, width, height); } mpl.figure.prototype.handle_figure_label = function(fig, msg) { // Updates the figure title. fig.header.textContent = msg['label']; } mpl.figure.prototype.handle_cursor = function(fig, msg) { var cursor = msg['cursor']; switch(cursor) { case 0: cursor = 'pointer'; break; case 1: cursor = 'default'; break; case 2: cursor = 'crosshair'; break; case 3: cursor = 'move'; break; } fig.rubberband_canvas.style.cursor = cursor; } mpl.figure.prototype.handle_message = function(fig, msg) { fig.message.textContent = msg['message']; } mpl.figure.prototype.handle_draw = function(fig, msg) { // Request the server to send over a new figure. fig.send_draw_message(); } mpl.figure.prototype.handle_image_mode = function(fig, msg) { fig.image_mode = msg['mode']; } mpl.figure.prototype.updated_canvas_event = function() { // Called whenever the canvas gets updated. this.send_message(\"ack\", {}); } // A function to construct a web socket function for onmessage handling. // Called in the figure constructor. mpl.figure.prototype._make_on_message_function = function(fig) { return function socket_on_message(evt) { if (evt.data instanceof Blob) { /* FIXME: We get \"Resource interpreted as Image but * transferred with MIME type text/plain:\" errors on * Chrome. But how to set the MIME type? It doesn't seem * to be part of the websocket stream */ evt.data.type = \"image/png\"; /* Free the memory for the previous frames */ if (fig.imageObj.src) { (window.URL || window.webkitURL).revokeObjectURL( fig.imageObj.src); } fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL( evt.data); fig.updated_canvas_event(); fig.waiting = false; return; } else if (typeof evt.data === 'string' && evt.data.slice(0, 21) == \"data:image/png;base64\") { fig.imageObj.src = evt.data; fig.updated_canvas_event(); fig.waiting = false; return; } var msg = JSON.parse(evt.data); var msg_type = msg['type']; // Call the \"handle_{type}\" callback, which takes // the figure and JSON message as its only arguments. try { var callback = fig[\"handle_\" + msg_type]; } catch (e) { console.log(\"No handler for the '\" + msg_type + \"' message type: \", msg); return; } if (callback) { try { // console.log(\"Handling '\" + msg_type + \"' message: \", msg); callback(fig, msg); } catch (e) { console.log(\"Exception inside the 'handler_\" + msg_type + \"' callback:\", e, e.stack, msg); } } }; } // from http://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas mpl.findpos = function(e) { //this section is from http://www.quirksmode.org/js/events_properties.html var targ; if (!e) e = window.event; if (e.target) targ = e.target; else if (e.srcElement) targ = e.srcElement; if (targ.nodeType == 3) // defeat Safari bug targ = targ.parentNode; // jQuery normalizes the pageX and pageY // pageX,Y are the mouse positions relative to the document // offset() returns the position of the element relative to the document var x = e.pageX - $(targ).offset().left; var y = e.pageY - $(targ).offset().top; return {\"x\": x, \"y\": y}; }; /* * return a copy of an object with only non-object keys * we need this to avoid circular references * http://stackoverflow.com/a/24161582/3208463 */ function simpleKeys (original) { return Object.keys(original).reduce(function (obj, key) { if (typeof original[key] !== 'object') obj[key] = original[key] return obj; }, {}); } mpl.figure.prototype.mouse_event = function(event, name) { var canvas_pos = mpl.findpos(event) if (name === 'button_press') { this.canvas.focus(); this.canvas_div.focus(); } var x = canvas_pos.x * mpl.ratio; var y = canvas_pos.y * mpl.ratio; this.send_message(name, {x: x, y: y, button: event.button, step: event.step, guiEvent: simpleKeys(event)}); /* This prevents the web browser from automatically changing to * the text insertion cursor when the button is pressed. We want * to control all of the cursor setting manually through the * 'cursor' event from matplotlib */ event.preventDefault(); return false; } mpl.figure.prototype._key_event_extra = function(event, name) { // Handle any extra behaviour associated with a key event } mpl.figure.prototype.key_event = function(event, name) { // Prevent repeat events if (name == 'key_press') { if (event.which === this._key) return; else this._key = event.which; } if (name == 'key_release') this._key = null; var value = ''; if (event.ctrlKey && event.which != 17) value += \"ctrl+\"; if (event.altKey && event.which != 18) value += \"alt+\"; if (event.shiftKey && event.which != 16) value += \"shift+\"; value += 'k'; value += event.which.toString(); this._key_event_extra(event, name); this.send_message(name, {key: value, guiEvent: simpleKeys(event)}); return false; } mpl.figure.prototype.toolbar_button_onclick = function(name) { if (name == 'download') { this.handle_save(this, null); } else { this.send_message(\"toolbar_button\", {name: name}); } }; mpl.figure.prototype.toolbar_button_onmouseover = function(tooltip) { this.message.textContent = tooltip; }; mpl.toolbar_items = [[\"Home\", \"Reset original view\", \"fa fa-home icon-home\", \"home\"], [\"Back\", \"Back to previous view\", \"fa fa-arrow-left icon-arrow-left\", \"back\"], [\"Forward\", \"Forward to next view\", \"fa fa-arrow-right icon-arrow-right\", \"forward\"], [\"\", \"\", \"\", \"\"], [\"Pan\", \"Pan axes with left mouse, zoom with right\", \"fa fa-arrows icon-move\", \"pan\"], [\"Zoom\", \"Zoom to rectangle\", \"fa fa-square-o icon-check-empty\", \"zoom\"], [\"\", \"\", \"\", \"\"], [\"Download\", \"Download plot\", \"fa fa-floppy-o icon-save\", \"download\"]]; mpl.extensions = [\"eps\", \"jpeg\", \"pdf\", \"png\", \"ps\", \"raw\", \"svg\", \"tif\"]; mpl.default_extension = \"png\";var comm_websocket_adapter = function(comm) { // Create a \"websocket\"-like object which calls the given IPython comm // object with the appropriate methods. Currently this is a non binary // socket, so there is still some room for performance tuning. var ws = {}; ws.close = function() { comm.close() }; ws.send = function(m) { //console.log('sending', m); comm.send(m); }; // Register the callback with on_msg. comm.on_msg(function(msg) { //console.log('receiving', msg['content']['data'], msg); // Pass the mpl event to the overriden (by mpl) onmessage function. ws.onmessage(msg['content']['data']) }); return ws; } mpl.mpl_figure_comm = function(comm, msg) { // This is the function which gets called when the mpl process // starts-up an IPython Comm through the \"matplotlib\" channel. var id = msg.content.data.id; // Get hold of the div created by the display call when the Comm // socket was opened in Python. var element = $(\"#\" + id); var ws_proxy = comm_websocket_adapter(comm) function ondownload(figure, format) { window.open(figure.imageObj.src); } var fig = new mpl.figure(id, ws_proxy, ondownload, element.get(0)); // Call onopen now - mpl needs it, as it is assuming we've passed it a real // web socket which is closed, not our websocket->open comm proxy. ws_proxy.onopen(); fig.parent_element = element.get(0); fig.cell_info = mpl.find_output_cell(\"<div id='\" + id + \"'></div>\"); if (!fig.cell_info) { console.error(\"Failed to find cell for figure\", id, fig); return; } var output_index = fig.cell_info[2] var cell = fig.cell_info[0]; }; mpl.figure.prototype.handle_close = function(fig, msg) { var width = fig.canvas.width/mpl.ratio fig.root.unbind('remove') // Update the output cell to use the data from the current canvas. fig.push_to_output(); var dataURL = fig.canvas.toDataURL(); // Re-enable the keyboard manager in IPython - without this line, in FF, // the notebook keyboard shortcuts fail. IPython.keyboard_manager.enable() $(fig.parent_element).html('<img src=\"' + dataURL + '\" width=\"' + width + '\">'); fig.close_ws(fig, msg); } mpl.figure.prototype.close_ws = function(fig, msg){ fig.send_message('closing', msg); // fig.ws.close() } mpl.figure.prototype.push_to_output = function(remove_interactive) { // Turn the data on the canvas into data in the output cell. var width = this.canvas.width/mpl.ratio var dataURL = this.canvas.toDataURL(); this.cell_info[1]['text/html'] = '<img src=\"' + dataURL + '\" width=\"' + width + '\">'; } mpl.figure.prototype.updated_canvas_event = function() { // Tell IPython that the notebook contents must change. IPython.notebook.set_dirty(true); this.send_message(\"ack\", {}); var fig = this; // Wait a second, then push the new image to the DOM so // that it is saved nicely (might be nice to debounce this). setTimeout(function () { fig.push_to_output() }, 1000); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items){ var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { continue; }; var button = $('<button class=\"btn btn-default\" href=\"#\" title=\"' + name + '\"><i class=\"fa ' + image + ' fa-lg\"></i></button>'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); nav_element.append(button); } // Add the status bar. var status_bar = $('<span class=\"mpl-message\" style=\"text-align:right; float: right;\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; // Add the close button to the window. var buttongrp = $('<div class=\"btn-group inline pull-right\"></div>'); var button = $('<button class=\"btn btn-mini btn-primary\" href=\"#\" title=\"Stop Interaction\"><i class=\"fa fa-power-off icon-remove icon-large\"></i></button>'); button.click(function (evt) { fig.handle_close(fig, {}); } ); button.mouseover('Stop Interaction', toolbar_mouse_event); buttongrp.append(button); var titlebar = this.root.find($('.ui-dialog-titlebar')); titlebar.prepend(buttongrp); } mpl.figure.prototype._root_extra_style = function(el){ var fig = this el.on(\"remove\", function(){ fig.close_ws(fig, {}); }); } mpl.figure.prototype._canvas_extra_style = function(el){ // this is important to make the div 'focusable el.attr('tabindex', 0) // reach out to IPython and tell the keyboard manager to turn it's self // off when our div gets focus // location in version 3 if (IPython.notebook.keyboard_manager) { IPython.notebook.keyboard_manager.register_events(el); } else { // location in version 2 IPython.keyboard_manager.register_events(el); } } mpl.figure.prototype._key_event_extra = function(event, name) { var manager = IPython.notebook.keyboard_manager; if (!manager) manager = IPython.keyboard_manager; // Check for shift+enter if (event.shiftKey && event.which == 13) { this.canvas_div.blur(); event.shiftKey = false; // Send a \"J\" for go to next cell event.which = 74; event.keyCode = 74; manager.command_mode(); manager.handle_keydown(event); } } mpl.figure.prototype.handle_save = function(fig, msg) { fig.ondownload(fig, null); } mpl.find_output_cell = function(html_output) { // Return the cell and output element which can be found *uniquely* in the notebook. // Note - this is a bit hacky, but it is done because the \"notebook_saving.Notebook\" // IPython event is triggered only after the cells have been serialised, which for // our purposes (turning an active figure into a static one), is too late. var cells = IPython.notebook.get_cells(); var ncells = cells.length; for (var i=0; i<ncells; i++) { var cell = cells[i]; if (cell.cell_type === 'code'){ for (var j=0; j<cell.output_area.outputs.length; j++) { var data = cell.output_area.outputs[j]; if (data.data) { // IPython >= 3 moved mimebundle to data attribute of output data = data.data; } if (data['text/html'] == html_output) { return [cell, data, j]; } } } } } // Register the function which deals with the matplotlib target/channel. // The kernel may be null if the page has been refreshed. if (IPython.notebook.kernel != null) { IPython.notebook.kernel.comm_manager.register_target('matplotlib', mpl.mpl_figure_comm); } In [58]: # 3D plot with plotly. Plotly is a much better approach for 3d plots, but it requires the user to have an online account. # plotly.tools.set_credentials_file(username='camilofosco', api_key='AY1QtDdBCza2qZePnygz') def plot_scatter_plotly ( X , y , b_true ): # y surface from true betas y_noiseless = np . dot ( lsp_mat , b_true ) . reshape (( 20 , 20 )) data = [ go . Scatter3d ( x = X [:, 0 ], y = X [:, 1 ], z = y , mode = 'markers' , marker = dict ( size = 5 , color = 'green' , line = dict ( color = 'rgba(217, 217, 217, 0.14)' , width = 0.5 ), opacity = 1 ) ), go . Surface ( x = lsp_x , y = lsp_y , z = y_noiseless , colorscale = 'Greens' , opacity = 0.8 , showscale = False ), ] layout = go . Layout ( title = '2D Regression' , autosize = False , width = 700 , height = 700 , ) fig = go . Figure ( data = data , layout = layout ) return fig , data print ( X . shape , y . shape ) fig , data = plot_scatter_plotly ( X , y , b_true ) print ( len ( data )) iplot ( fig , filename = '2D Regression - normal data' ) (300, 2) (300, 1) 2 Out[58]: In [59]: # Regression types to use: regr = [ 'OLS' ] colors = [ 'Blues' , 'Reds' ] Calculate regression coefficients for OLS (normal data) In [93]: from sklearn.linear_model import LinearRegression , Ridge , Lasso , ElasticNet , RidgeCV , LassoCV , ElasticNetCV def fit_regression ( X , y , regr = [ 'OLS' ], verbose = True ): betas = [] if regr == 'all' : regr = [ 'OLS' , 'Ridge' , 'LASSO' , 'EN' ] for r in regr : if r == 'OLS' : # OLS fit regr_ols = LinearRegression ( fit_intercept = False ) regr_ols . fit ( X , y ) beta_ols = regr_ols . coef_ if verbose : print ( f 'OLS coefficients: {beta_ols} ' ) betas . append ( beta_ols ) elif r == 'Ridge' : # Ridge fit regr_ridge = RidgeCV ( fit_intercept = False ) regr_ridge . fit ( X , y ) beta_ridge = regr_ridge . coef_ if verbose : print ( f 'Ridge coefficients: {beta_ridge} , regularization coef: {regr_ridge.alpha_} ' ) betas . append ( beta_ridge ) elif r == 'LASSO' : # LASSO fit regr_lasso = LassoCV ( fit_intercept = False ) regr_lasso . fit ( X , y ) beta_lasso = regr_lasso . coef_ if verbose : print ( f 'LASSO coefficients: {beta_lasso} , regularization coef: {regr_lasso.alpha_} ' ) betas . append ( beta_lasso ) elif r == 'EN' : # Elastic Net fit regr_EN = ElasticNetCV ( fit_intercept = False ) regr_EN . fit ( X , y ) beta_EN = regr_EN . coef_ if verbose : print ( f 'ElasticNet coefficients: {beta_EN} , regularization coef: {regr_EN.alpha_} ' ) betas . append ( beta_EN ) return betas print ( 'True coefficents:' , b_true . ravel ()) betas = fit_regression ( X , y . ravel (), regr = regr ); True coefficents: [3 7] OLS coefficients: [2.89216421 6.95112742] Plot fitted planes (normal data) In [116]: def plot_fitted_planes ( betas , colors , names , data = [], return_traces = False ): for i , b in enumerate ( betas ): y = np . dot ( lsp_mat , b . reshape (( 2 , 1 ))) . reshape (( 20 , 20 )) data . append ( go . Surface ( x = lsp_x , y = lsp_y , z = y , colorscale = colors [ i ], text = names [ i ], showscale = False )) layout = go . Layout ( title = '2D Regression' , autosize = False , width = 700 , height = 700 , ) if return_traces : return data fig = go . Figure ( data = data , layout = layout ) return fig fig = plot_fitted_planes ( betas , colors = colors , names = regr , data = deepcopy ( data )) iplot ( fig , filename = '2D Regression with different estimators - normal data' ) Out[116]: Create regression problem with colinearity In [117]: # Generate random data with high colinearity between predictors x1 = np . random . rand ( N , 1 ) * 10 - 5 x2 = x1 + np . random . normal ( scale = 0.1 , size = ( N , 1 )) X_colin = np . column_stack (( x1 , x2 )) X_colin = ( X_colin - X_colin . mean ( axis = 0 )) / X_colin . std ( axis = 0 ) eps = np . random . normal ( scale = sigma , size = ( N , 1 )) y_colin = np . dot ( X_colin , b_true ) + eps Plot regression problem with colinearity In [118]: fig , data_colin = plot_scatter_plotly ( X_colin , y_colin , b_true ) iplot ( fig , filename = '2D Regression - normal data' ) Out[118]: Calculate regression coefficients (colinear data) In [64]: print ( 'True coefficents:' , b_true . ravel ()) betas_colin = fit_regression ( X_colin , y_colin . ravel (), regr = regr ); True coefficents: [3 7] OLS coefficients: [9.28778571 0.30263443] Plot fitting planes (colinear data) In [65]: fig = plot_fitted_planes ( betas_colin , colors = colors , names = regr , data = deepcopy ( data_colin )) iplot ( fig , filename = '2D Regression with different estimators - colinear data' ) Out[65]: Add a small perturbation to the colinear data and fit again In [71]: # Perturbation is just a bit of small uniform noise: perturbation = np . random . rand ( X_colin . shape [ 0 ], X_colin . shape [ 1 ]) * 0.05 X_colin_pert = X_colin + perturbation y_colin_pert = np . dot ( X_colin_pert , b_true ) + eps print ( 'True coefficents:' , b_true . ravel ()) betas = fit_regression ( X_colin_pert , y_colin_pert . ravel (), regr = regr ); fig , data_colin_pert = plot_scatter_plotly ( X_colin_pert , y_colin_pert , b_true ) fig = plot_fitted_planes ( betas , colors = colors , names = regr , data = deepcopy ( data_colin_pert )) iplot ( fig , filename = '2D Regression with different estimators - colinear data' ) True coefficents: [3 7] OLS coefficients: [0.3480226 9.24496111] Out[71]: This clearly shows how unstable our estimates are in OLS. As expected, in this case, the inverse Gram Matrix $(X&#94;TX)&#94;{-1}$ (proportional to covariance) will present very large diagonal values: In [68]: print ( 'Inverse of Gram Matrix for colinear data (propto covariance matrix of betas):' ) print ( np . linalg . inv ( np . dot ( X_colin . T , X_colin ))) print ( 'Condition number of Gram Matrix:' ) print ( np . linalg . cond ( np . dot ( X_colin . T , X_colin ))) print ( ' \\n Compare to non-colinear data:' ) print ( np . linalg . inv ( np . dot ( X . T , X ))) print ( 'Condition number of Gram Matrix with non-colinear data:' ) print ( np . linalg . cond ( np . dot ( X . T , X ))) Inverse of Gram Matrix for colinear data (propto covariance matrix of betas): [[ 2.87349732 -2.87183017] [-2.87183017 2.87349732]] Condition number of Gram Matrix: 3446.196493910531 Compare to non-colinear data: [[3.33386079e-03 4.19339416e-05] [4.19339416e-05 3.33386079e-03]] Condition number of Gram Matrix with non-colinear data: 1.0254768368917215 Analyze loss surfaces In [81]: def OLS_loss ( X , y , beta , lbda = 0 ): y_hat = np . dot ( X , beta ) return np . sum (( y_hat - y ) ** 2 , axis = 0 ) def Ridge_loss ( X , y , beta , lbda ): y_hat = np . dot ( X , beta ) return np . sum (( y_hat - y ) ** 2 , axis = 0 ) + lbda * np . sum ( beta ** 2 , axis = 0 ) def LASSO_loss ( X , y , beta , lbda ): y_hat = np . dot ( X , beta ) return ( 1 / ( 2 * len ( X ))) * np . sum (( y_hat - y ) ** 2 , axis = 0 ) + lbda * np . sum ( np . abs ( beta ), axis = 0 ) def EN_loss ( X , y , beta , lbda ): ratio = 0.1 y_hat = np . dot ( X , beta ) return ( 1 / ( 2 * len ( X ))) * np . sum (( y_hat - y ) ** 2 , axis = 0 ) + lbda * ( ratio * np . sum ( beta ** 2 , axis = 0 ) + ( 1 - ratio ) * np . sum ( np . abs ( beta ), axis = 0 )) In [91]: # linspace for loss surface L = 40 lsp_b = np . linspace ( - 20 , 20 , L ) lsp_b_x , lsp_b_y = np . meshgrid ( lsp_b , lsp_b ) lsp_b_mat = np . column_stack (( lsp_b_x . flatten (), lsp_b_y . flatten ())) def build_surface_fig ( loss_values ): data = [ go . Surface ( x = lsp_b_x , y = lsp_b_y , z = loss_values , colorscale = 'Viridis' , opacity = 0.7 , contours = dict ( z = dict ( show = True , width = 3 , highlight = True , highlightcolor = 'orange' , project = dict ( z = True ), usecolormap = True )) ) ] layout = go . Layout ( title = 'Loss surface' , autosize = False , width = 700 , height = 700 , scene = dict ( xaxis = dict ( title = 'Beta 1' ), yaxis = dict ( title = 'Beta 2' ), zaxis = dict ( title = 'Loss' ) ) ) fig = go . Figure ( data = data , layout = layout ) display ( iplot ( fig , filename = '2D Regression with different estimators - colinear data' )) build_surface_fig ( OLS_loss ( X_colin , y_colin . reshape ( - 1 , 1 ), lsp_b_mat . T , 100 ) . reshape (( L , L ))); In [75]: # # OLS # loss_values = OLS_loss(X, y, lsp_b_mat.T).reshape((L,L)) # fig, data = build_surface_fig(loss_values) # iplot(fig, filename='Loss Surface') # # Ridge # loss_values = Ridge_loss(X, y, lsp_b_mat.T, 100.0).reshape((L,L)) # fig, data = build_surface_fig(loss_values) # iplot(fig, filename='Loss Surface') # # LASSO # loss_values = LASSO_loss(X, y, lsp_b_mat.T, 100.0).reshape((L,L)) # fig, data = build_surface_fig(loss_values) # iplot(fig, filename='Loss Surface') # # Elastic Net # loss_values = EN_loss(X, y, lsp_b_mat.T, 100.0).reshape((L,L)) # fig, data = build_surface_fig(loss_values) # fig['layout'].update() # iplot(fig, filename='Loss Surface') In [112]: from ipywidgets import interactive , HBox , VBox def loss_3d_interactive ( X , y , loss = 'Ridge' ): '''Uses plotly to draw an interactive 3D representation of the loss function, with a slider to control the regularization factor. Inputs: X: predictor matrix for the regression problem. Has to be of dim n x 2 y: response vector loss: string with the loss to plot. Options are 'Ridge', 'LASSO', 'EN'. ''' if loss == 'Ridge' : loss_function = Ridge_loss lbda_slider_min = 0 lbda_slider_max = 1000 lbda_step = 1 clf = Ridge () elif loss == 'LASSO' : loss_function = LASSO_loss lbda_slider_min = 1 lbda_slider_max = 150 lbda_step = 1 clf = Lasso () elif loss == 'EN' : loss_function = EN_loss lbda_slider_min = 1 lbda_slider_max = 150 lbda_step = 1 clf = ElasticNet () else : raise ValueError ( \"Loss string not recognized. Available options are: 'Ridge', 'LASSO', 'EN'.\" ) # linspace for loss surface L = 20 lsp_b = np . linspace ( - 10 , 10 , L ) lsp_b_x , lsp_b_y = np . meshgrid ( lsp_b , lsp_b ) lsp_b_mat = np . column_stack (( lsp_b_x . flatten (), lsp_b_y . flatten ())) # Get all optimal betas for current lambda range precomp_coefs = [] for l in range ( lbda_slider_min , lbda_slider_max + 1 , lbda_step ): clf . set_params ( alpha = l ) clf . fit ( X , y ) precomp_coefs . append ( clf . coef_ ) f = go . FigureWidget ( data = [ go . Surface ( x = lsp_b_x , y = lsp_b_y , z = loss_function ( X , y . reshape ( - 1 , 1 ), lsp_b_mat . T , 0 ) . reshape (( L , L )), colorscale = 'Viridis' , opacity = 0.7 , contours = dict ( z = dict ( show = True , width = 3 , highlight = True , highlightcolor = 'orange' , project = dict ( z = True ), usecolormap = True )) ), go . Scatter3d ( x = [ p [ 0 ] for p in precomp_coefs ], y = [ p [ 1 ] for p in precomp_coefs ], z = np . zeros ( len ( precomp_coefs )), marker = dict ( size = 1 , color = 'darkorange' , line = dict ( color = 'darkorange' , width = 1 ), opacity = 1 ) ), go . Scatter3d ( x = [ 0 ], y = [ 0 ], z = [ 0 ], marker = dict ( size = 10 , color = 'orange' , opacity = 1 ), ) ], layout = go . Layout ( scene = go . layout . Scene ( xaxis = dict ( title = 'Beta 1' ), yaxis = dict ( title = 'Beta 2' ), zaxis = dict ( title = 'Loss' ), camera = go . layout . scene . Camera ( up = dict ( x = 0 , y = 0 , z = 1 ), center = dict ( x = 0 , y = 0 , z = 0 ), eye = dict ( x = 1.25 , y = 1.25 , z = 1.25 )) ), width = 1000 , height = 700 ,) ) def update_z ( lbda ): f . data [ 0 ] . z = loss_function ( X , y . reshape ( - 1 , 1 ), lsp_b_mat . T , lbda ) . reshape (( L , L )) beta_opt = precomp_coefs [( lbda - lbda_slider_min ) // ( lbda_step )] f . data [ - 1 ] . x = [ beta_opt [ 0 ]] f . data [ - 1 ] . y = [ beta_opt [ 1 ]] f . data [ - 1 ] . z = [ 0 ] lambda_slider = interactive ( update_z , lbda = ( lbda_slider_min , lbda_slider_max , lbda_step )) vb = VBox (( f , lambda_slider )) vb . layout . align_items = 'center' display ( vb ) In [124]: print ( X_colin . shape , y_colin . shape ) loss_3d_interactive ( X_colin , y_colin . ravel (), loss = 'Ridge' ) (300, 2) (300, 1) var element = $('#895fc9c9-f5c6-48bc-b4af-000a27f1ff82'); {\"model_id\": \"a46b5881b7c540e09a9caab90ae17367\", \"version_major\": 2, \"version_minor\": 0} In [ ]: if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"a-sections","url":"a-sections/a-section-3/demo/"},{"title":"Advanced Section 9: Support Vector Machines Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Advanced Section 9: Support Vector Machine Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [9]: import numpy as np import matplotlib.pyplot as plt from sklearn.svm import SVC In [5]: % matplotlib notebook import ipywidgets as widgets from ipywidgets import interact W,b slider In [6]: fig , ax = plt . subplots ( 1 , 1 ) delta =. 1 x_grid , y_grid = np . meshgrid ( np . arange ( - 4 , 4 , delta ), np . arange ( - 4 , 4 , delta )) def contour_plot ( w1 = 1 , w2 = 1 , b = 0 , alpha = 1 ): plt . cla () model_grid = w1 * x_grid + w2 * y_grid + b # contour cs = ax . contour ( x_grid , y_grid , model_grid , [ - 10 , - 5 , - 1 , 0 , 1 , 5 , 10 ]) plt . clabel ( cs ); plt . show () contour_plot () def update ( w1 , w2 , b , alpha ): plt . cla () model_grid = alpha * w1 * x_grid + alpha * w2 * y_grid + b # contour cs = ax . contour ( x_grid , y_grid , model_grid , [ - 2 , - 1 , 0 , 1 , 2 ]) plt . clabel ( cs ); fig . show () interact ( update , w1 = widgets . FloatSlider ( min =- 10.0 , max = 10.0 , value = 1.0 ), w2 = widgets . FloatSlider ( min =- 10.0 , max = 10.0 , value = 1.0 ), b = widgets . FloatSlider ( min =- 10.0 , max = 10.0 , value = 0 ), alpha = widgets . FloatSlider ( min = 0 , max = 10.0 , value = 1.0 )); var element = $('#49493840-2160-47a9-9f72-e324aab95c83'); /* Put everything inside the global mpl namespace */ window.mpl = {}; mpl.get_websocket_type = function() { if (typeof(WebSocket) !== 'undefined') { return WebSocket; } else if (typeof(MozWebSocket) !== 'undefined') { return MozWebSocket; } else { alert('Your browser does not have WebSocket support.' + 'Please try Chrome, Safari or Firefox ≥ 6. ' + 'Firefox 4 and 5 are also supported but you ' + 'have to enable WebSockets in about:config.'); }; } mpl.figure = function(figure_id, websocket, ondownload, parent_element) { this.id = figure_id; this.ws = websocket; this.supports_binary = (this.ws.binaryType != undefined); if (!this.supports_binary) { var warnings = document.getElementById(\"mpl-warnings\"); if (warnings) { warnings.style.display = 'block'; warnings.textContent = ( \"This browser does not support binary websocket messages. \" + \"Performance may be slow.\"); } } this.imageObj = new Image(); this.context = undefined; this.message = undefined; this.canvas = undefined; this.rubberband_canvas = undefined; this.rubberband_context = undefined; this.format_dropdown = undefined; this.image_mode = 'full'; this.root = $('<div/>'); this._root_extra_style(this.root) this.root.attr('style', 'display: inline-block'); $(parent_element).append(this.root); this._init_header(this); this._init_canvas(this); this._init_toolbar(this); var fig = this; this.waiting = false; this.ws.onopen = function () { fig.send_message(\"supports_binary\", {value: fig.supports_binary}); fig.send_message(\"send_image_mode\", {}); if (mpl.ratio != 1) { fig.send_message(\"set_dpi_ratio\", {'dpi_ratio': mpl.ratio}); } fig.send_message(\"refresh\", {}); } this.imageObj.onload = function() { if (fig.image_mode == 'full') { // Full images could contain transparency (where diff images // almost always do), so we need to clear the canvas so that // there is no ghosting. fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height); } fig.context.drawImage(fig.imageObj, 0, 0); }; this.imageObj.onunload = function() { fig.ws.close(); } this.ws.onmessage = this._make_on_message_function(this); this.ondownload = ondownload; } mpl.figure.prototype._init_header = function() { var titlebar = $( '<div class=\"ui-dialog-titlebar ui-widget-header ui-corner-all ' + 'ui-helper-clearfix\"/>'); var titletext = $( '<div class=\"ui-dialog-title\" style=\"width: 100%; ' + 'text-align: center; padding: 3px;\"/>'); titlebar.append(titletext) this.root.append(titlebar); this.header = titletext[0]; } mpl.figure.prototype._canvas_extra_style = function(canvas_div) { } mpl.figure.prototype._root_extra_style = function(canvas_div) { } mpl.figure.prototype._init_canvas = function() { var fig = this; var canvas_div = $('<div/>'); canvas_div.attr('style', 'position: relative; clear: both; outline: 0'); function canvas_keyboard_event(event) { return fig.key_event(event, event['data']); } canvas_div.keydown('key_press', canvas_keyboard_event); canvas_div.keyup('key_release', canvas_keyboard_event); this.canvas_div = canvas_div this._canvas_extra_style(canvas_div) this.root.append(canvas_div); var canvas = $('<canvas/>'); canvas.addClass('mpl-canvas'); canvas.attr('style', \"left: 0; top: 0; z-index: 0; outline: 0\") this.canvas = canvas[0]; this.context = canvas[0].getContext(\"2d\"); var backingStore = this.context.backingStorePixelRatio || this.context.webkitBackingStorePixelRatio || this.context.mozBackingStorePixelRatio || this.context.msBackingStorePixelRatio || this.context.oBackingStorePixelRatio || this.context.backingStorePixelRatio || 1; mpl.ratio = (window.devicePixelRatio || 1) / backingStore; var rubberband = $('<canvas/>'); rubberband.attr('style', \"position: absolute; left: 0; top: 0; z-index: 1;\") var pass_mouse_events = true; canvas_div.resizable({ start: function(event, ui) { pass_mouse_events = false; }, resize: function(event, ui) { fig.request_resize(ui.size.width, ui.size.height); }, stop: function(event, ui) { pass_mouse_events = true; fig.request_resize(ui.size.width, ui.size.height); }, }); function mouse_event_fn(event) { if (pass_mouse_events) return fig.mouse_event(event, event['data']); } rubberband.mousedown('button_press', mouse_event_fn); rubberband.mouseup('button_release', mouse_event_fn); // Throttle sequential mouse events to 1 every 20ms. rubberband.mousemove('motion_notify', mouse_event_fn); rubberband.mouseenter('figure_enter', mouse_event_fn); rubberband.mouseleave('figure_leave', mouse_event_fn); canvas_div.on(\"wheel\", function (event) { event = event.originalEvent; event['data'] = 'scroll' if (event.deltaY < 0) { event.step = 1; } else { event.step = -1; } mouse_event_fn(event); }); canvas_div.append(canvas); canvas_div.append(rubberband); this.rubberband = rubberband; this.rubberband_canvas = rubberband[0]; this.rubberband_context = rubberband[0].getContext(\"2d\"); this.rubberband_context.strokeStyle = \"#000000\"; this._resize_canvas = function(width, height) { // Keep the size of the canvas, canvas container, and rubber band // canvas in synch. canvas_div.css('width', width) canvas_div.css('height', height) canvas.attr('width', width * mpl.ratio); canvas.attr('height', height * mpl.ratio); canvas.attr('style', 'width: ' + width + 'px; height: ' + height + 'px;'); rubberband.attr('width', width); rubberband.attr('height', height); } // Set the figure to an initial 600x600px, this will subsequently be updated // upon first draw. this._resize_canvas(600, 600); // Disable right mouse context menu. $(this.rubberband_canvas).bind(\"contextmenu\",function(e){ return false; }); function set_focus () { canvas.focus(); canvas_div.focus(); } window.setTimeout(set_focus, 100); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items) { var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { // put a spacer in here. continue; } var button = $('<button/>'); button.addClass('ui-button ui-widget ui-state-default ui-corner-all ' + 'ui-button-icon-only'); button.attr('role', 'button'); button.attr('aria-disabled', 'false'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); var icon_img = $('<span/>'); icon_img.addClass('ui-button-icon-primary ui-icon'); icon_img.addClass(image); icon_img.addClass('ui-corner-all'); var tooltip_span = $('<span/>'); tooltip_span.addClass('ui-button-text'); tooltip_span.html(tooltip); button.append(icon_img); button.append(tooltip_span); nav_element.append(button); } var fmt_picker_span = $('<span/>'); var fmt_picker = $('<select/>'); fmt_picker.addClass('mpl-toolbar-option ui-widget ui-widget-content'); fmt_picker_span.append(fmt_picker); nav_element.append(fmt_picker_span); this.format_dropdown = fmt_picker[0]; for (var ind in mpl.extensions) { var fmt = mpl.extensions[ind]; var option = $( '<option/>', {selected: fmt === mpl.default_extension}).html(fmt); fmt_picker.append(option) } // Add hover states to the ui-buttons $( \".ui-button\" ).hover( function() { $(this).addClass(\"ui-state-hover\");}, function() { $(this).removeClass(\"ui-state-hover\");} ); var status_bar = $('<span class=\"mpl-message\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; } mpl.figure.prototype.request_resize = function(x_pixels, y_pixels) { // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client, // which will in turn request a refresh of the image. this.send_message('resize', {'width': x_pixels, 'height': y_pixels}); } mpl.figure.prototype.send_message = function(type, properties) { properties['type'] = type; properties['figure_id'] = this.id; this.ws.send(JSON.stringify(properties)); } mpl.figure.prototype.send_draw_message = function() { if (!this.waiting) { this.waiting = true; this.ws.send(JSON.stringify({type: \"draw\", figure_id: this.id})); } } mpl.figure.prototype.handle_save = function(fig, msg) { var format_dropdown = fig.format_dropdown; var format = format_dropdown.options[format_dropdown.selectedIndex].value; fig.ondownload(fig, format); } mpl.figure.prototype.handle_resize = function(fig, msg) { var size = msg['size']; if (size[0] != fig.canvas.width || size[1] != fig.canvas.height) { fig._resize_canvas(size[0], size[1]); fig.send_message(\"refresh\", {}); }; } mpl.figure.prototype.handle_rubberband = function(fig, msg) { var x0 = msg['x0'] / mpl.ratio; var y0 = (fig.canvas.height - msg['y0']) / mpl.ratio; var x1 = msg['x1'] / mpl.ratio; var y1 = (fig.canvas.height - msg['y1']) / mpl.ratio; x0 = Math.floor(x0) + 0.5; y0 = Math.floor(y0) + 0.5; x1 = Math.floor(x1) + 0.5; y1 = Math.floor(y1) + 0.5; var min_x = Math.min(x0, x1); var min_y = Math.min(y0, y1); var width = Math.abs(x1 - x0); var height = Math.abs(y1 - y0); fig.rubberband_context.clearRect( 0, 0, fig.canvas.width, fig.canvas.height); fig.rubberband_context.strokeRect(min_x, min_y, width, height); } mpl.figure.prototype.handle_figure_label = function(fig, msg) { // Updates the figure title. fig.header.textContent = msg['label']; } mpl.figure.prototype.handle_cursor = function(fig, msg) { var cursor = msg['cursor']; switch(cursor) { case 0: cursor = 'pointer'; break; case 1: cursor = 'default'; break; case 2: cursor = 'crosshair'; break; case 3: cursor = 'move'; break; } fig.rubberband_canvas.style.cursor = cursor; } mpl.figure.prototype.handle_message = function(fig, msg) { fig.message.textContent = msg['message']; } mpl.figure.prototype.handle_draw = function(fig, msg) { // Request the server to send over a new figure. fig.send_draw_message(); } mpl.figure.prototype.handle_image_mode = function(fig, msg) { fig.image_mode = msg['mode']; } mpl.figure.prototype.updated_canvas_event = function() { // Called whenever the canvas gets updated. this.send_message(\"ack\", {}); } // A function to construct a web socket function for onmessage handling. // Called in the figure constructor. mpl.figure.prototype._make_on_message_function = function(fig) { return function socket_on_message(evt) { if (evt.data instanceof Blob) { /* FIXME: We get \"Resource interpreted as Image but * transferred with MIME type text/plain:\" errors on * Chrome. But how to set the MIME type? It doesn't seem * to be part of the websocket stream */ evt.data.type = \"image/png\"; /* Free the memory for the previous frames */ if (fig.imageObj.src) { (window.URL || window.webkitURL).revokeObjectURL( fig.imageObj.src); } fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL( evt.data); fig.updated_canvas_event(); fig.waiting = false; return; } else if (typeof evt.data === 'string' && evt.data.slice(0, 21) == \"data:image/png;base64\") { fig.imageObj.src = evt.data; fig.updated_canvas_event(); fig.waiting = false; return; } var msg = JSON.parse(evt.data); var msg_type = msg['type']; // Call the \"handle_{type}\" callback, which takes // the figure and JSON message as its only arguments. try { var callback = fig[\"handle_\" + msg_type]; } catch (e) { console.log(\"No handler for the '\" + msg_type + \"' message type: \", msg); return; } if (callback) { try { // console.log(\"Handling '\" + msg_type + \"' message: \", msg); callback(fig, msg); } catch (e) { console.log(\"Exception inside the 'handler_\" + msg_type + \"' callback:\", e, e.stack, msg); } } }; } // from http://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas mpl.findpos = function(e) { //this section is from http://www.quirksmode.org/js/events_properties.html var targ; if (!e) e = window.event; if (e.target) targ = e.target; else if (e.srcElement) targ = e.srcElement; if (targ.nodeType == 3) // defeat Safari bug targ = targ.parentNode; // jQuery normalizes the pageX and pageY // pageX,Y are the mouse positions relative to the document // offset() returns the position of the element relative to the document var x = e.pageX - $(targ).offset().left; var y = e.pageY - $(targ).offset().top; return {\"x\": x, \"y\": y}; }; /* * return a copy of an object with only non-object keys * we need this to avoid circular references * http://stackoverflow.com/a/24161582/3208463 */ function simpleKeys (original) { return Object.keys(original).reduce(function (obj, key) { if (typeof original[key] !== 'object') obj[key] = original[key] return obj; }, {}); } mpl.figure.prototype.mouse_event = function(event, name) { var canvas_pos = mpl.findpos(event) if (name === 'button_press') { this.canvas.focus(); this.canvas_div.focus(); } var x = canvas_pos.x * mpl.ratio; var y = canvas_pos.y * mpl.ratio; this.send_message(name, {x: x, y: y, button: event.button, step: event.step, guiEvent: simpleKeys(event)}); /* This prevents the web browser from automatically changing to * the text insertion cursor when the button is pressed. We want * to control all of the cursor setting manually through the * 'cursor' event from matplotlib */ event.preventDefault(); return false; } mpl.figure.prototype._key_event_extra = function(event, name) { // Handle any extra behaviour associated with a key event } mpl.figure.prototype.key_event = function(event, name) { // Prevent repeat events if (name == 'key_press') { if (event.which === this._key) return; else this._key = event.which; } if (name == 'key_release') this._key = null; var value = ''; if (event.ctrlKey && event.which != 17) value += \"ctrl+\"; if (event.altKey && event.which != 18) value += \"alt+\"; if (event.shiftKey && event.which != 16) value += \"shift+\"; value += 'k'; value += event.which.toString(); this._key_event_extra(event, name); this.send_message(name, {key: value, guiEvent: simpleKeys(event)}); return false; } mpl.figure.prototype.toolbar_button_onclick = function(name) { if (name == 'download') { this.handle_save(this, null); } else { this.send_message(\"toolbar_button\", {name: name}); } }; mpl.figure.prototype.toolbar_button_onmouseover = function(tooltip) { this.message.textContent = tooltip; }; mpl.toolbar_items = [[\"Home\", \"Reset original view\", \"fa fa-home icon-home\", \"home\"], [\"Back\", \"Back to previous view\", \"fa fa-arrow-left icon-arrow-left\", \"back\"], [\"Forward\", \"Forward to next view\", \"fa fa-arrow-right icon-arrow-right\", \"forward\"], [\"\", \"\", \"\", \"\"], [\"Pan\", \"Pan axes with left mouse, zoom with right\", \"fa fa-arrows icon-move\", \"pan\"], [\"Zoom\", \"Zoom to rectangle\", \"fa fa-square-o icon-check-empty\", \"zoom\"], [\"\", \"\", \"\", \"\"], [\"Download\", \"Download plot\", \"fa fa-floppy-o icon-save\", \"download\"]]; mpl.extensions = [\"eps\", \"jpeg\", \"pdf\", \"png\", \"ps\", \"raw\", \"svg\", \"tif\"]; mpl.default_extension = \"png\";var comm_websocket_adapter = function(comm) { // Create a \"websocket\"-like object which calls the given IPython comm // object with the appropriate methods. Currently this is a non binary // socket, so there is still some room for performance tuning. var ws = {}; ws.close = function() { comm.close() }; ws.send = function(m) { //console.log('sending', m); comm.send(m); }; // Register the callback with on_msg. comm.on_msg(function(msg) { //console.log('receiving', msg['content']['data'], msg); // Pass the mpl event to the overriden (by mpl) onmessage function. ws.onmessage(msg['content']['data']) }); return ws; } mpl.mpl_figure_comm = function(comm, msg) { // This is the function which gets called when the mpl process // starts-up an IPython Comm through the \"matplotlib\" channel. var id = msg.content.data.id; // Get hold of the div created by the display call when the Comm // socket was opened in Python. var element = $(\"#\" + id); var ws_proxy = comm_websocket_adapter(comm) function ondownload(figure, format) { window.open(figure.imageObj.src); } var fig = new mpl.figure(id, ws_proxy, ondownload, element.get(0)); // Call onopen now - mpl needs it, as it is assuming we've passed it a real // web socket which is closed, not our websocket->open comm proxy. ws_proxy.onopen(); fig.parent_element = element.get(0); fig.cell_info = mpl.find_output_cell(\"<div id='\" + id + \"'></div>\"); if (!fig.cell_info) { console.error(\"Failed to find cell for figure\", id, fig); return; } var output_index = fig.cell_info[2] var cell = fig.cell_info[0]; }; mpl.figure.prototype.handle_close = function(fig, msg) { var width = fig.canvas.width/mpl.ratio fig.root.unbind('remove') // Update the output cell to use the data from the current canvas. fig.push_to_output(); var dataURL = fig.canvas.toDataURL(); // Re-enable the keyboard manager in IPython - without this line, in FF, // the notebook keyboard shortcuts fail. IPython.keyboard_manager.enable() $(fig.parent_element).html('<img src=\"' + dataURL + '\" width=\"' + width + '\">'); fig.close_ws(fig, msg); } mpl.figure.prototype.close_ws = function(fig, msg){ fig.send_message('closing', msg); // fig.ws.close() } mpl.figure.prototype.push_to_output = function(remove_interactive) { // Turn the data on the canvas into data in the output cell. var width = this.canvas.width/mpl.ratio var dataURL = this.canvas.toDataURL(); this.cell_info[1]['text/html'] = '<img src=\"' + dataURL + '\" width=\"' + width + '\">'; } mpl.figure.prototype.updated_canvas_event = function() { // Tell IPython that the notebook contents must change. IPython.notebook.set_dirty(true); this.send_message(\"ack\", {}); var fig = this; // Wait a second, then push the new image to the DOM so // that it is saved nicely (might be nice to debounce this). setTimeout(function () { fig.push_to_output() }, 1000); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items){ var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { continue; }; var button = $('<button class=\"btn btn-default\" href=\"#\" title=\"' + name + '\"><i class=\"fa ' + image + ' fa-lg\"></i></button>'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); nav_element.append(button); } // Add the status bar. var status_bar = $('<span class=\"mpl-message\" style=\"text-align:right; float: right;\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; // Add the close button to the window. var buttongrp = $('<div class=\"btn-group inline pull-right\"></div>'); var button = $('<button class=\"btn btn-mini btn-primary\" href=\"#\" title=\"Stop Interaction\"><i class=\"fa fa-power-off icon-remove icon-large\"></i></button>'); button.click(function (evt) { fig.handle_close(fig, {}); } ); button.mouseover('Stop Interaction', toolbar_mouse_event); buttongrp.append(button); var titlebar = this.root.find($('.ui-dialog-titlebar')); titlebar.prepend(buttongrp); } mpl.figure.prototype._root_extra_style = function(el){ var fig = this el.on(\"remove\", function(){ fig.close_ws(fig, {}); }); } mpl.figure.prototype._canvas_extra_style = function(el){ // this is important to make the div 'focusable el.attr('tabindex', 0) // reach out to IPython and tell the keyboard manager to turn it's self // off when our div gets focus // location in version 3 if (IPython.notebook.keyboard_manager) { IPython.notebook.keyboard_manager.register_events(el); } else { // location in version 2 IPython.keyboard_manager.register_events(el); } } mpl.figure.prototype._key_event_extra = function(event, name) { var manager = IPython.notebook.keyboard_manager; if (!manager) manager = IPython.keyboard_manager; // Check for shift+enter if (event.shiftKey && event.which == 13) { this.canvas_div.blur(); event.shiftKey = false; // Send a \"J\" for go to next cell event.which = 74; event.keyCode = 74; manager.command_mode(); manager.handle_keydown(event); } } mpl.figure.prototype.handle_save = function(fig, msg) { fig.ondownload(fig, null); } mpl.find_output_cell = function(html_output) { // Return the cell and output element which can be found *uniquely* in the notebook. // Note - this is a bit hacky, but it is done because the \"notebook_saving.Notebook\" // IPython event is triggered only after the cells have been serialised, which for // our purposes (turning an active figure into a static one), is too late. var cells = IPython.notebook.get_cells(); var ncells = cells.length; for (var i=0; i<ncells; i++) { var cell = cells[i]; if (cell.cell_type === 'code'){ for (var j=0; j<cell.output_area.outputs.length; j++) { var data = cell.output_area.outputs[j]; if (data.data) { // IPython >= 3 moved mimebundle to data attribute of output data = data.data; } if (data['text/html'] == html_output) { return [cell, data, j]; } } } } } // Register the function which deals with the matplotlib target/channel. // The kernel may be null if the page has been refreshed. if (IPython.notebook.kernel != null) { IPython.notebook.kernel.comm_manager.register_target('matplotlib', mpl.mpl_figure_comm); } var element = $('#6f59a655-c775-4e69-99f0-fb02433ff4c6'); {\"model_id\": \"b3c9a85ebad7464299612216def26967\", \"version_major\": 2, \"version_minor\": 0} C slider In [11]: % matplotlib notebook x_train = np . array ([ [ 1 , 1 ], [ 2 , 1 ], [ 3 , 3 ], [ 4 , 1 ], [ 2 , 2 ], # [2.5,2], #really good non-seperable example [ 2.5 , 1.5 ], #really good seperable example ]) y_train = np . array ([ 0 , 0 , 1 , 1 , 1 , 0 ]) fig , ax = plt . subplots ( 1 , 1 ) # grid delta =. 1 x_grid , y_grid = np . meshgrid ( np . arange ( 0 , 4 , delta ), np . arange ( 0 , 4 , delta )) grid_dataset = np . hstack ([ x_grid . reshape ( - 1 , 1 ), y_grid . reshape ( - 1 , 1 )]) def contour ( cur_c ): plt . cla () fitted_model = SVC ( kernel = 'linear' , C = cur_c ) . fit ( x_train , y_train ) out = fitted_model . decision_function ( grid_dataset ) # points ax . scatter ( x_train [:, 0 ], x_train [:, 1 ], c = y_train ); # contour model_grid = out . reshape ( x_grid . shape ) cs = ax . contour ( x_grid , y_grid , model_grid , [ - 1 , 0 , 1 ]) plt . clabel ( cs ); fig . show () contour ( 1 ) def update ( cur_c , kernel_toggle = False ): if kernel_toggle : cur_kernel = 'rbf' else : cur_kernel = 'linear' plt . cla () fitted_model = SVC ( kernel = cur_kernel , C = cur_c ) . fit ( x_train , y_train ) out = fitted_model . decision_function ( grid_dataset ) # points ax . scatter ( x_train [:, 0 ], x_train [:, 1 ], c = y_train ); # contour model_grid = out . reshape ( x_grid . shape ) cs = ax . contour ( x_grid , y_grid , model_grid , [ - 1 , 0 , 1 ]) plt . clabel ( cs ); fig . show () interact ( update , cur_c = widgets . FloatSlider ( min =. 001 , max = 50 , value = 1 , step =. 1 ), kernel_toggle = widgets . ToggleButton ( value = False , description = \"RBF\" )); var element = $('#09c39ac5-d3ed-4bd4-88fb-79dc1d386535'); /* Put everything inside the global mpl namespace */ window.mpl = {}; mpl.get_websocket_type = function() { if (typeof(WebSocket) !== 'undefined') { return WebSocket; } else if (typeof(MozWebSocket) !== 'undefined') { return MozWebSocket; } else { alert('Your browser does not have WebSocket support.' + 'Please try Chrome, Safari or Firefox ≥ 6. ' + 'Firefox 4 and 5 are also supported but you ' + 'have to enable WebSockets in about:config.'); }; } mpl.figure = function(figure_id, websocket, ondownload, parent_element) { this.id = figure_id; this.ws = websocket; this.supports_binary = (this.ws.binaryType != undefined); if (!this.supports_binary) { var warnings = document.getElementById(\"mpl-warnings\"); if (warnings) { warnings.style.display = 'block'; warnings.textContent = ( \"This browser does not support binary websocket messages. \" + \"Performance may be slow.\"); } } this.imageObj = new Image(); this.context = undefined; this.message = undefined; this.canvas = undefined; this.rubberband_canvas = undefined; this.rubberband_context = undefined; this.format_dropdown = undefined; this.image_mode = 'full'; this.root = $('<div/>'); this._root_extra_style(this.root) this.root.attr('style', 'display: inline-block'); $(parent_element).append(this.root); this._init_header(this); this._init_canvas(this); this._init_toolbar(this); var fig = this; this.waiting = false; this.ws.onopen = function () { fig.send_message(\"supports_binary\", {value: fig.supports_binary}); fig.send_message(\"send_image_mode\", {}); if (mpl.ratio != 1) { fig.send_message(\"set_dpi_ratio\", {'dpi_ratio': mpl.ratio}); } fig.send_message(\"refresh\", {}); } this.imageObj.onload = function() { if (fig.image_mode == 'full') { // Full images could contain transparency (where diff images // almost always do), so we need to clear the canvas so that // there is no ghosting. fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height); } fig.context.drawImage(fig.imageObj, 0, 0); }; this.imageObj.onunload = function() { fig.ws.close(); } this.ws.onmessage = this._make_on_message_function(this); this.ondownload = ondownload; } mpl.figure.prototype._init_header = function() { var titlebar = $( '<div class=\"ui-dialog-titlebar ui-widget-header ui-corner-all ' + 'ui-helper-clearfix\"/>'); var titletext = $( '<div class=\"ui-dialog-title\" style=\"width: 100%; ' + 'text-align: center; padding: 3px;\"/>'); titlebar.append(titletext) this.root.append(titlebar); this.header = titletext[0]; } mpl.figure.prototype._canvas_extra_style = function(canvas_div) { } mpl.figure.prototype._root_extra_style = function(canvas_div) { } mpl.figure.prototype._init_canvas = function() { var fig = this; var canvas_div = $('<div/>'); canvas_div.attr('style', 'position: relative; clear: both; outline: 0'); function canvas_keyboard_event(event) { return fig.key_event(event, event['data']); } canvas_div.keydown('key_press', canvas_keyboard_event); canvas_div.keyup('key_release', canvas_keyboard_event); this.canvas_div = canvas_div this._canvas_extra_style(canvas_div) this.root.append(canvas_div); var canvas = $('<canvas/>'); canvas.addClass('mpl-canvas'); canvas.attr('style', \"left: 0; top: 0; z-index: 0; outline: 0\") this.canvas = canvas[0]; this.context = canvas[0].getContext(\"2d\"); var backingStore = this.context.backingStorePixelRatio || this.context.webkitBackingStorePixelRatio || this.context.mozBackingStorePixelRatio || this.context.msBackingStorePixelRatio || this.context.oBackingStorePixelRatio || this.context.backingStorePixelRatio || 1; mpl.ratio = (window.devicePixelRatio || 1) / backingStore; var rubberband = $('<canvas/>'); rubberband.attr('style', \"position: absolute; left: 0; top: 0; z-index: 1;\") var pass_mouse_events = true; canvas_div.resizable({ start: function(event, ui) { pass_mouse_events = false; }, resize: function(event, ui) { fig.request_resize(ui.size.width, ui.size.height); }, stop: function(event, ui) { pass_mouse_events = true; fig.request_resize(ui.size.width, ui.size.height); }, }); function mouse_event_fn(event) { if (pass_mouse_events) return fig.mouse_event(event, event['data']); } rubberband.mousedown('button_press', mouse_event_fn); rubberband.mouseup('button_release', mouse_event_fn); // Throttle sequential mouse events to 1 every 20ms. rubberband.mousemove('motion_notify', mouse_event_fn); rubberband.mouseenter('figure_enter', mouse_event_fn); rubberband.mouseleave('figure_leave', mouse_event_fn); canvas_div.on(\"wheel\", function (event) { event = event.originalEvent; event['data'] = 'scroll' if (event.deltaY < 0) { event.step = 1; } else { event.step = -1; } mouse_event_fn(event); }); canvas_div.append(canvas); canvas_div.append(rubberband); this.rubberband = rubberband; this.rubberband_canvas = rubberband[0]; this.rubberband_context = rubberband[0].getContext(\"2d\"); this.rubberband_context.strokeStyle = \"#000000\"; this._resize_canvas = function(width, height) { // Keep the size of the canvas, canvas container, and rubber band // canvas in synch. canvas_div.css('width', width) canvas_div.css('height', height) canvas.attr('width', width * mpl.ratio); canvas.attr('height', height * mpl.ratio); canvas.attr('style', 'width: ' + width + 'px; height: ' + height + 'px;'); rubberband.attr('width', width); rubberband.attr('height', height); } // Set the figure to an initial 600x600px, this will subsequently be updated // upon first draw. this._resize_canvas(600, 600); // Disable right mouse context menu. $(this.rubberband_canvas).bind(\"contextmenu\",function(e){ return false; }); function set_focus () { canvas.focus(); canvas_div.focus(); } window.setTimeout(set_focus, 100); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items) { var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { // put a spacer in here. continue; } var button = $('<button/>'); button.addClass('ui-button ui-widget ui-state-default ui-corner-all ' + 'ui-button-icon-only'); button.attr('role', 'button'); button.attr('aria-disabled', 'false'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); var icon_img = $('<span/>'); icon_img.addClass('ui-button-icon-primary ui-icon'); icon_img.addClass(image); icon_img.addClass('ui-corner-all'); var tooltip_span = $('<span/>'); tooltip_span.addClass('ui-button-text'); tooltip_span.html(tooltip); button.append(icon_img); button.append(tooltip_span); nav_element.append(button); } var fmt_picker_span = $('<span/>'); var fmt_picker = $('<select/>'); fmt_picker.addClass('mpl-toolbar-option ui-widget ui-widget-content'); fmt_picker_span.append(fmt_picker); nav_element.append(fmt_picker_span); this.format_dropdown = fmt_picker[0]; for (var ind in mpl.extensions) { var fmt = mpl.extensions[ind]; var option = $( '<option/>', {selected: fmt === mpl.default_extension}).html(fmt); fmt_picker.append(option) } // Add hover states to the ui-buttons $( \".ui-button\" ).hover( function() { $(this).addClass(\"ui-state-hover\");}, function() { $(this).removeClass(\"ui-state-hover\");} ); var status_bar = $('<span class=\"mpl-message\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; } mpl.figure.prototype.request_resize = function(x_pixels, y_pixels) { // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client, // which will in turn request a refresh of the image. this.send_message('resize', {'width': x_pixels, 'height': y_pixels}); } mpl.figure.prototype.send_message = function(type, properties) { properties['type'] = type; properties['figure_id'] = this.id; this.ws.send(JSON.stringify(properties)); } mpl.figure.prototype.send_draw_message = function() { if (!this.waiting) { this.waiting = true; this.ws.send(JSON.stringify({type: \"draw\", figure_id: this.id})); } } mpl.figure.prototype.handle_save = function(fig, msg) { var format_dropdown = fig.format_dropdown; var format = format_dropdown.options[format_dropdown.selectedIndex].value; fig.ondownload(fig, format); } mpl.figure.prototype.handle_resize = function(fig, msg) { var size = msg['size']; if (size[0] != fig.canvas.width || size[1] != fig.canvas.height) { fig._resize_canvas(size[0], size[1]); fig.send_message(\"refresh\", {}); }; } mpl.figure.prototype.handle_rubberband = function(fig, msg) { var x0 = msg['x0'] / mpl.ratio; var y0 = (fig.canvas.height - msg['y0']) / mpl.ratio; var x1 = msg['x1'] / mpl.ratio; var y1 = (fig.canvas.height - msg['y1']) / mpl.ratio; x0 = Math.floor(x0) + 0.5; y0 = Math.floor(y0) + 0.5; x1 = Math.floor(x1) + 0.5; y1 = Math.floor(y1) + 0.5; var min_x = Math.min(x0, x1); var min_y = Math.min(y0, y1); var width = Math.abs(x1 - x0); var height = Math.abs(y1 - y0); fig.rubberband_context.clearRect( 0, 0, fig.canvas.width, fig.canvas.height); fig.rubberband_context.strokeRect(min_x, min_y, width, height); } mpl.figure.prototype.handle_figure_label = function(fig, msg) { // Updates the figure title. fig.header.textContent = msg['label']; } mpl.figure.prototype.handle_cursor = function(fig, msg) { var cursor = msg['cursor']; switch(cursor) { case 0: cursor = 'pointer'; break; case 1: cursor = 'default'; break; case 2: cursor = 'crosshair'; break; case 3: cursor = 'move'; break; } fig.rubberband_canvas.style.cursor = cursor; } mpl.figure.prototype.handle_message = function(fig, msg) { fig.message.textContent = msg['message']; } mpl.figure.prototype.handle_draw = function(fig, msg) { // Request the server to send over a new figure. fig.send_draw_message(); } mpl.figure.prototype.handle_image_mode = function(fig, msg) { fig.image_mode = msg['mode']; } mpl.figure.prototype.updated_canvas_event = function() { // Called whenever the canvas gets updated. this.send_message(\"ack\", {}); } // A function to construct a web socket function for onmessage handling. // Called in the figure constructor. mpl.figure.prototype._make_on_message_function = function(fig) { return function socket_on_message(evt) { if (evt.data instanceof Blob) { /* FIXME: We get \"Resource interpreted as Image but * transferred with MIME type text/plain:\" errors on * Chrome. But how to set the MIME type? It doesn't seem * to be part of the websocket stream */ evt.data.type = \"image/png\"; /* Free the memory for the previous frames */ if (fig.imageObj.src) { (window.URL || window.webkitURL).revokeObjectURL( fig.imageObj.src); } fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL( evt.data); fig.updated_canvas_event(); fig.waiting = false; return; } else if (typeof evt.data === 'string' && evt.data.slice(0, 21) == \"data:image/png;base64\") { fig.imageObj.src = evt.data; fig.updated_canvas_event(); fig.waiting = false; return; } var msg = JSON.parse(evt.data); var msg_type = msg['type']; // Call the \"handle_{type}\" callback, which takes // the figure and JSON message as its only arguments. try { var callback = fig[\"handle_\" + msg_type]; } catch (e) { console.log(\"No handler for the '\" + msg_type + \"' message type: \", msg); return; } if (callback) { try { // console.log(\"Handling '\" + msg_type + \"' message: \", msg); callback(fig, msg); } catch (e) { console.log(\"Exception inside the 'handler_\" + msg_type + \"' callback:\", e, e.stack, msg); } } }; } // from http://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas mpl.findpos = function(e) { //this section is from http://www.quirksmode.org/js/events_properties.html var targ; if (!e) e = window.event; if (e.target) targ = e.target; else if (e.srcElement) targ = e.srcElement; if (targ.nodeType == 3) // defeat Safari bug targ = targ.parentNode; // jQuery normalizes the pageX and pageY // pageX,Y are the mouse positions relative to the document // offset() returns the position of the element relative to the document var x = e.pageX - $(targ).offset().left; var y = e.pageY - $(targ).offset().top; return {\"x\": x, \"y\": y}; }; /* * return a copy of an object with only non-object keys * we need this to avoid circular references * http://stackoverflow.com/a/24161582/3208463 */ function simpleKeys (original) { return Object.keys(original).reduce(function (obj, key) { if (typeof original[key] !== 'object') obj[key] = original[key] return obj; }, {}); } mpl.figure.prototype.mouse_event = function(event, name) { var canvas_pos = mpl.findpos(event) if (name === 'button_press') { this.canvas.focus(); this.canvas_div.focus(); } var x = canvas_pos.x * mpl.ratio; var y = canvas_pos.y * mpl.ratio; this.send_message(name, {x: x, y: y, button: event.button, step: event.step, guiEvent: simpleKeys(event)}); /* This prevents the web browser from automatically changing to * the text insertion cursor when the button is pressed. We want * to control all of the cursor setting manually through the * 'cursor' event from matplotlib */ event.preventDefault(); return false; } mpl.figure.prototype._key_event_extra = function(event, name) { // Handle any extra behaviour associated with a key event } mpl.figure.prototype.key_event = function(event, name) { // Prevent repeat events if (name == 'key_press') { if (event.which === this._key) return; else this._key = event.which; } if (name == 'key_release') this._key = null; var value = ''; if (event.ctrlKey && event.which != 17) value += \"ctrl+\"; if (event.altKey && event.which != 18) value += \"alt+\"; if (event.shiftKey && event.which != 16) value += \"shift+\"; value += 'k'; value += event.which.toString(); this._key_event_extra(event, name); this.send_message(name, {key: value, guiEvent: simpleKeys(event)}); return false; } mpl.figure.prototype.toolbar_button_onclick = function(name) { if (name == 'download') { this.handle_save(this, null); } else { this.send_message(\"toolbar_button\", {name: name}); } }; mpl.figure.prototype.toolbar_button_onmouseover = function(tooltip) { this.message.textContent = tooltip; }; mpl.toolbar_items = [[\"Home\", \"Reset original view\", \"fa fa-home icon-home\", \"home\"], [\"Back\", \"Back to previous view\", \"fa fa-arrow-left icon-arrow-left\", \"back\"], [\"Forward\", \"Forward to next view\", \"fa fa-arrow-right icon-arrow-right\", \"forward\"], [\"\", \"\", \"\", \"\"], [\"Pan\", \"Pan axes with left mouse, zoom with right\", \"fa fa-arrows icon-move\", \"pan\"], [\"Zoom\", \"Zoom to rectangle\", \"fa fa-square-o icon-check-empty\", \"zoom\"], [\"\", \"\", \"\", \"\"], [\"Download\", \"Download plot\", \"fa fa-floppy-o icon-save\", \"download\"]]; mpl.extensions = [\"eps\", \"jpeg\", \"pdf\", \"png\", \"ps\", \"raw\", \"svg\", \"tif\"]; mpl.default_extension = \"png\";var comm_websocket_adapter = function(comm) { // Create a \"websocket\"-like object which calls the given IPython comm // object with the appropriate methods. Currently this is a non binary // socket, so there is still some room for performance tuning. var ws = {}; ws.close = function() { comm.close() }; ws.send = function(m) { //console.log('sending', m); comm.send(m); }; // Register the callback with on_msg. comm.on_msg(function(msg) { //console.log('receiving', msg['content']['data'], msg); // Pass the mpl event to the overriden (by mpl) onmessage function. ws.onmessage(msg['content']['data']) }); return ws; } mpl.mpl_figure_comm = function(comm, msg) { // This is the function which gets called when the mpl process // starts-up an IPython Comm through the \"matplotlib\" channel. var id = msg.content.data.id; // Get hold of the div created by the display call when the Comm // socket was opened in Python. var element = $(\"#\" + id); var ws_proxy = comm_websocket_adapter(comm) function ondownload(figure, format) { window.open(figure.imageObj.src); } var fig = new mpl.figure(id, ws_proxy, ondownload, element.get(0)); // Call onopen now - mpl needs it, as it is assuming we've passed it a real // web socket which is closed, not our websocket->open comm proxy. ws_proxy.onopen(); fig.parent_element = element.get(0); fig.cell_info = mpl.find_output_cell(\"<div id='\" + id + \"'></div>\"); if (!fig.cell_info) { console.error(\"Failed to find cell for figure\", id, fig); return; } var output_index = fig.cell_info[2] var cell = fig.cell_info[0]; }; mpl.figure.prototype.handle_close = function(fig, msg) { var width = fig.canvas.width/mpl.ratio fig.root.unbind('remove') // Update the output cell to use the data from the current canvas. fig.push_to_output(); var dataURL = fig.canvas.toDataURL(); // Re-enable the keyboard manager in IPython - without this line, in FF, // the notebook keyboard shortcuts fail. IPython.keyboard_manager.enable() $(fig.parent_element).html('<img src=\"' + dataURL + '\" width=\"' + width + '\">'); fig.close_ws(fig, msg); } mpl.figure.prototype.close_ws = function(fig, msg){ fig.send_message('closing', msg); // fig.ws.close() } mpl.figure.prototype.push_to_output = function(remove_interactive) { // Turn the data on the canvas into data in the output cell. var width = this.canvas.width/mpl.ratio var dataURL = this.canvas.toDataURL(); this.cell_info[1]['text/html'] = '<img src=\"' + dataURL + '\" width=\"' + width + '\">'; } mpl.figure.prototype.updated_canvas_event = function() { // Tell IPython that the notebook contents must change. IPython.notebook.set_dirty(true); this.send_message(\"ack\", {}); var fig = this; // Wait a second, then push the new image to the DOM so // that it is saved nicely (might be nice to debounce this). setTimeout(function () { fig.push_to_output() }, 1000); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items){ var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { continue; }; var button = $('<button class=\"btn btn-default\" href=\"#\" title=\"' + name + '\"><i class=\"fa ' + image + ' fa-lg\"></i></button>'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); nav_element.append(button); } // Add the status bar. var status_bar = $('<span class=\"mpl-message\" style=\"text-align:right; float: right;\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; // Add the close button to the window. var buttongrp = $('<div class=\"btn-group inline pull-right\"></div>'); var button = $('<button class=\"btn btn-mini btn-primary\" href=\"#\" title=\"Stop Interaction\"><i class=\"fa fa-power-off icon-remove icon-large\"></i></button>'); button.click(function (evt) { fig.handle_close(fig, {}); } ); button.mouseover('Stop Interaction', toolbar_mouse_event); buttongrp.append(button); var titlebar = this.root.find($('.ui-dialog-titlebar')); titlebar.prepend(buttongrp); } mpl.figure.prototype._root_extra_style = function(el){ var fig = this el.on(\"remove\", function(){ fig.close_ws(fig, {}); }); } mpl.figure.prototype._canvas_extra_style = function(el){ // this is important to make the div 'focusable el.attr('tabindex', 0) // reach out to IPython and tell the keyboard manager to turn it's self // off when our div gets focus // location in version 3 if (IPython.notebook.keyboard_manager) { IPython.notebook.keyboard_manager.register_events(el); } else { // location in version 2 IPython.keyboard_manager.register_events(el); } } mpl.figure.prototype._key_event_extra = function(event, name) { var manager = IPython.notebook.keyboard_manager; if (!manager) manager = IPython.keyboard_manager; // Check for shift+enter if (event.shiftKey && event.which == 13) { this.canvas_div.blur(); event.shiftKey = false; // Send a \"J\" for go to next cell event.which = 74; event.keyCode = 74; manager.command_mode(); manager.handle_keydown(event); } } mpl.figure.prototype.handle_save = function(fig, msg) { fig.ondownload(fig, null); } mpl.find_output_cell = function(html_output) { // Return the cell and output element which can be found *uniquely* in the notebook. // Note - this is a bit hacky, but it is done because the \"notebook_saving.Notebook\" // IPython event is triggered only after the cells have been serialised, which for // our purposes (turning an active figure into a static one), is too late. var cells = IPython.notebook.get_cells(); var ncells = cells.length; for (var i=0; i<ncells; i++) { var cell = cells[i]; if (cell.cell_type === 'code'){ for (var j=0; j<cell.output_area.outputs.length; j++) { var data = cell.output_area.outputs[j]; if (data.data) { // IPython >= 3 moved mimebundle to data attribute of output data = data.data; } if (data['text/html'] == html_output) { return [cell, data, j]; } } } } } // Register the function which deals with the matplotlib target/channel. // The kernel may be null if the page has been refreshed. if (IPython.notebook.kernel != null) { IPython.notebook.kernel.comm_manager.register_target('matplotlib', mpl.mpl_figure_comm); } var element = $('#6fb6e520-4b9f-43b3-9e65-4a697fc0ae90'); {\"model_id\": \"ad7749477dbf49efa0d0377d6f792ef0\", \"version_major\": 2, \"version_minor\": 0} Gamma slider In [12]: x_train = np . array ([ [ 1 , 1 ], [ 2 , 1 ], [ 3 , 3 ], [ 4 , 1 ], [ 2 , 2 ], [ 2.5 , 2 ], #really good non-seperable example # [2.5,1.5], #really good seperable example ]) y_train = np . array ([ 0 , 0 , 1 , 1 , 1 , 0 ]) fig , ax = plt . subplots ( 1 , 1 ) # grid delta =. 01 x_grid , y_grid = np . meshgrid ( np . arange ( 0 , 4 , delta ), np . arange ( 0 , 4 , delta )) grid_dataset = np . hstack ([ x_grid . reshape ( - 1 , 1 ), y_grid . reshape ( - 1 , 1 )]) def contour ( cur_c ): plt . cla () fitted_model = SVC ( kernel = 'linear' , C = cur_c ) . fit ( x_train , y_train ) out = fitted_model . decision_function ( grid_dataset ) # points ax . scatter ( x_train [:, 0 ], x_train [:, 1 ], c = y_train ); # contour model_grid = out . reshape ( x_grid . shape ) cs = ax . contour ( x_grid , y_grid , model_grid , [ - 1 , 0 , 1 ]) plt . clabel ( cs ); fig . show () contour ( 1 ) def update ( cur_c , gamma = 0 ): cur_kernel = 'rbf' plt . cla () fitted_model = SVC ( kernel = cur_kernel , C = cur_c , gamma = gamma ) . fit ( x_train , y_train ) out = fitted_model . decision_function ( grid_dataset ) # points ax . scatter ( x_train [:, 0 ], x_train [:, 1 ], c = y_train ); # contour model_grid = out . reshape ( x_grid . shape ) cs = ax . contour ( x_grid , y_grid , model_grid ) plt . clabel ( cs ); fig . show () interact ( update , cur_c = widgets . FloatSlider ( min =. 001 , max = 50 , value = 1 , step =. 1 ), gamma = widgets . FloatSlider ( min =. 001 , max = 50 , value = 1 , step =. 1 )); var element = $('#ac49e267-c9b9-43ba-bdc0-237fbb67a042'); /* Put everything inside the global mpl namespace */ window.mpl = {}; mpl.get_websocket_type = function() { if (typeof(WebSocket) !== 'undefined') { return WebSocket; } else if (typeof(MozWebSocket) !== 'undefined') { return MozWebSocket; } else { alert('Your browser does not have WebSocket support.' + 'Please try Chrome, Safari or Firefox ≥ 6. ' + 'Firefox 4 and 5 are also supported but you ' + 'have to enable WebSockets in about:config.'); }; } mpl.figure = function(figure_id, websocket, ondownload, parent_element) { this.id = figure_id; this.ws = websocket; this.supports_binary = (this.ws.binaryType != undefined); if (!this.supports_binary) { var warnings = document.getElementById(\"mpl-warnings\"); if (warnings) { warnings.style.display = 'block'; warnings.textContent = ( \"This browser does not support binary websocket messages. \" + \"Performance may be slow.\"); } } this.imageObj = new Image(); this.context = undefined; this.message = undefined; this.canvas = undefined; this.rubberband_canvas = undefined; this.rubberband_context = undefined; this.format_dropdown = undefined; this.image_mode = 'full'; this.root = $('<div/>'); this._root_extra_style(this.root) this.root.attr('style', 'display: inline-block'); $(parent_element).append(this.root); this._init_header(this); this._init_canvas(this); this._init_toolbar(this); var fig = this; this.waiting = false; this.ws.onopen = function () { fig.send_message(\"supports_binary\", {value: fig.supports_binary}); fig.send_message(\"send_image_mode\", {}); if (mpl.ratio != 1) { fig.send_message(\"set_dpi_ratio\", {'dpi_ratio': mpl.ratio}); } fig.send_message(\"refresh\", {}); } this.imageObj.onload = function() { if (fig.image_mode == 'full') { // Full images could contain transparency (where diff images // almost always do), so we need to clear the canvas so that // there is no ghosting. fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height); } fig.context.drawImage(fig.imageObj, 0, 0); }; this.imageObj.onunload = function() { fig.ws.close(); } this.ws.onmessage = this._make_on_message_function(this); this.ondownload = ondownload; } mpl.figure.prototype._init_header = function() { var titlebar = $( '<div class=\"ui-dialog-titlebar ui-widget-header ui-corner-all ' + 'ui-helper-clearfix\"/>'); var titletext = $( '<div class=\"ui-dialog-title\" style=\"width: 100%; ' + 'text-align: center; padding: 3px;\"/>'); titlebar.append(titletext) this.root.append(titlebar); this.header = titletext[0]; } mpl.figure.prototype._canvas_extra_style = function(canvas_div) { } mpl.figure.prototype._root_extra_style = function(canvas_div) { } mpl.figure.prototype._init_canvas = function() { var fig = this; var canvas_div = $('<div/>'); canvas_div.attr('style', 'position: relative; clear: both; outline: 0'); function canvas_keyboard_event(event) { return fig.key_event(event, event['data']); } canvas_div.keydown('key_press', canvas_keyboard_event); canvas_div.keyup('key_release', canvas_keyboard_event); this.canvas_div = canvas_div this._canvas_extra_style(canvas_div) this.root.append(canvas_div); var canvas = $('<canvas/>'); canvas.addClass('mpl-canvas'); canvas.attr('style', \"left: 0; top: 0; z-index: 0; outline: 0\") this.canvas = canvas[0]; this.context = canvas[0].getContext(\"2d\"); var backingStore = this.context.backingStorePixelRatio || this.context.webkitBackingStorePixelRatio || this.context.mozBackingStorePixelRatio || this.context.msBackingStorePixelRatio || this.context.oBackingStorePixelRatio || this.context.backingStorePixelRatio || 1; mpl.ratio = (window.devicePixelRatio || 1) / backingStore; var rubberband = $('<canvas/>'); rubberband.attr('style', \"position: absolute; left: 0; top: 0; z-index: 1;\") var pass_mouse_events = true; canvas_div.resizable({ start: function(event, ui) { pass_mouse_events = false; }, resize: function(event, ui) { fig.request_resize(ui.size.width, ui.size.height); }, stop: function(event, ui) { pass_mouse_events = true; fig.request_resize(ui.size.width, ui.size.height); }, }); function mouse_event_fn(event) { if (pass_mouse_events) return fig.mouse_event(event, event['data']); } rubberband.mousedown('button_press', mouse_event_fn); rubberband.mouseup('button_release', mouse_event_fn); // Throttle sequential mouse events to 1 every 20ms. rubberband.mousemove('motion_notify', mouse_event_fn); rubberband.mouseenter('figure_enter', mouse_event_fn); rubberband.mouseleave('figure_leave', mouse_event_fn); canvas_div.on(\"wheel\", function (event) { event = event.originalEvent; event['data'] = 'scroll' if (event.deltaY < 0) { event.step = 1; } else { event.step = -1; } mouse_event_fn(event); }); canvas_div.append(canvas); canvas_div.append(rubberband); this.rubberband = rubberband; this.rubberband_canvas = rubberband[0]; this.rubberband_context = rubberband[0].getContext(\"2d\"); this.rubberband_context.strokeStyle = \"#000000\"; this._resize_canvas = function(width, height) { // Keep the size of the canvas, canvas container, and rubber band // canvas in synch. canvas_div.css('width', width) canvas_div.css('height', height) canvas.attr('width', width * mpl.ratio); canvas.attr('height', height * mpl.ratio); canvas.attr('style', 'width: ' + width + 'px; height: ' + height + 'px;'); rubberband.attr('width', width); rubberband.attr('height', height); } // Set the figure to an initial 600x600px, this will subsequently be updated // upon first draw. this._resize_canvas(600, 600); // Disable right mouse context menu. $(this.rubberband_canvas).bind(\"contextmenu\",function(e){ return false; }); function set_focus () { canvas.focus(); canvas_div.focus(); } window.setTimeout(set_focus, 100); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items) { var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { // put a spacer in here. continue; } var button = $('<button/>'); button.addClass('ui-button ui-widget ui-state-default ui-corner-all ' + 'ui-button-icon-only'); button.attr('role', 'button'); button.attr('aria-disabled', 'false'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); var icon_img = $('<span/>'); icon_img.addClass('ui-button-icon-primary ui-icon'); icon_img.addClass(image); icon_img.addClass('ui-corner-all'); var tooltip_span = $('<span/>'); tooltip_span.addClass('ui-button-text'); tooltip_span.html(tooltip); button.append(icon_img); button.append(tooltip_span); nav_element.append(button); } var fmt_picker_span = $('<span/>'); var fmt_picker = $('<select/>'); fmt_picker.addClass('mpl-toolbar-option ui-widget ui-widget-content'); fmt_picker_span.append(fmt_picker); nav_element.append(fmt_picker_span); this.format_dropdown = fmt_picker[0]; for (var ind in mpl.extensions) { var fmt = mpl.extensions[ind]; var option = $( '<option/>', {selected: fmt === mpl.default_extension}).html(fmt); fmt_picker.append(option) } // Add hover states to the ui-buttons $( \".ui-button\" ).hover( function() { $(this).addClass(\"ui-state-hover\");}, function() { $(this).removeClass(\"ui-state-hover\");} ); var status_bar = $('<span class=\"mpl-message\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; } mpl.figure.prototype.request_resize = function(x_pixels, y_pixels) { // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client, // which will in turn request a refresh of the image. this.send_message('resize', {'width': x_pixels, 'height': y_pixels}); } mpl.figure.prototype.send_message = function(type, properties) { properties['type'] = type; properties['figure_id'] = this.id; this.ws.send(JSON.stringify(properties)); } mpl.figure.prototype.send_draw_message = function() { if (!this.waiting) { this.waiting = true; this.ws.send(JSON.stringify({type: \"draw\", figure_id: this.id})); } } mpl.figure.prototype.handle_save = function(fig, msg) { var format_dropdown = fig.format_dropdown; var format = format_dropdown.options[format_dropdown.selectedIndex].value; fig.ondownload(fig, format); } mpl.figure.prototype.handle_resize = function(fig, msg) { var size = msg['size']; if (size[0] != fig.canvas.width || size[1] != fig.canvas.height) { fig._resize_canvas(size[0], size[1]); fig.send_message(\"refresh\", {}); }; } mpl.figure.prototype.handle_rubberband = function(fig, msg) { var x0 = msg['x0'] / mpl.ratio; var y0 = (fig.canvas.height - msg['y0']) / mpl.ratio; var x1 = msg['x1'] / mpl.ratio; var y1 = (fig.canvas.height - msg['y1']) / mpl.ratio; x0 = Math.floor(x0) + 0.5; y0 = Math.floor(y0) + 0.5; x1 = Math.floor(x1) + 0.5; y1 = Math.floor(y1) + 0.5; var min_x = Math.min(x0, x1); var min_y = Math.min(y0, y1); var width = Math.abs(x1 - x0); var height = Math.abs(y1 - y0); fig.rubberband_context.clearRect( 0, 0, fig.canvas.width, fig.canvas.height); fig.rubberband_context.strokeRect(min_x, min_y, width, height); } mpl.figure.prototype.handle_figure_label = function(fig, msg) { // Updates the figure title. fig.header.textContent = msg['label']; } mpl.figure.prototype.handle_cursor = function(fig, msg) { var cursor = msg['cursor']; switch(cursor) { case 0: cursor = 'pointer'; break; case 1: cursor = 'default'; break; case 2: cursor = 'crosshair'; break; case 3: cursor = 'move'; break; } fig.rubberband_canvas.style.cursor = cursor; } mpl.figure.prototype.handle_message = function(fig, msg) { fig.message.textContent = msg['message']; } mpl.figure.prototype.handle_draw = function(fig, msg) { // Request the server to send over a new figure. fig.send_draw_message(); } mpl.figure.prototype.handle_image_mode = function(fig, msg) { fig.image_mode = msg['mode']; } mpl.figure.prototype.updated_canvas_event = function() { // Called whenever the canvas gets updated. this.send_message(\"ack\", {}); } // A function to construct a web socket function for onmessage handling. // Called in the figure constructor. mpl.figure.prototype._make_on_message_function = function(fig) { return function socket_on_message(evt) { if (evt.data instanceof Blob) { /* FIXME: We get \"Resource interpreted as Image but * transferred with MIME type text/plain:\" errors on * Chrome. But how to set the MIME type? It doesn't seem * to be part of the websocket stream */ evt.data.type = \"image/png\"; /* Free the memory for the previous frames */ if (fig.imageObj.src) { (window.URL || window.webkitURL).revokeObjectURL( fig.imageObj.src); } fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL( evt.data); fig.updated_canvas_event(); fig.waiting = false; return; } else if (typeof evt.data === 'string' && evt.data.slice(0, 21) == \"data:image/png;base64\") { fig.imageObj.src = evt.data; fig.updated_canvas_event(); fig.waiting = false; return; } var msg = JSON.parse(evt.data); var msg_type = msg['type']; // Call the \"handle_{type}\" callback, which takes // the figure and JSON message as its only arguments. try { var callback = fig[\"handle_\" + msg_type]; } catch (e) { console.log(\"No handler for the '\" + msg_type + \"' message type: \", msg); return; } if (callback) { try { // console.log(\"Handling '\" + msg_type + \"' message: \", msg); callback(fig, msg); } catch (e) { console.log(\"Exception inside the 'handler_\" + msg_type + \"' callback:\", e, e.stack, msg); } } }; } // from http://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas mpl.findpos = function(e) { //this section is from http://www.quirksmode.org/js/events_properties.html var targ; if (!e) e = window.event; if (e.target) targ = e.target; else if (e.srcElement) targ = e.srcElement; if (targ.nodeType == 3) // defeat Safari bug targ = targ.parentNode; // jQuery normalizes the pageX and pageY // pageX,Y are the mouse positions relative to the document // offset() returns the position of the element relative to the document var x = e.pageX - $(targ).offset().left; var y = e.pageY - $(targ).offset().top; return {\"x\": x, \"y\": y}; }; /* * return a copy of an object with only non-object keys * we need this to avoid circular references * http://stackoverflow.com/a/24161582/3208463 */ function simpleKeys (original) { return Object.keys(original).reduce(function (obj, key) { if (typeof original[key] !== 'object') obj[key] = original[key] return obj; }, {}); } mpl.figure.prototype.mouse_event = function(event, name) { var canvas_pos = mpl.findpos(event) if (name === 'button_press') { this.canvas.focus(); this.canvas_div.focus(); } var x = canvas_pos.x * mpl.ratio; var y = canvas_pos.y * mpl.ratio; this.send_message(name, {x: x, y: y, button: event.button, step: event.step, guiEvent: simpleKeys(event)}); /* This prevents the web browser from automatically changing to * the text insertion cursor when the button is pressed. We want * to control all of the cursor setting manually through the * 'cursor' event from matplotlib */ event.preventDefault(); return false; } mpl.figure.prototype._key_event_extra = function(event, name) { // Handle any extra behaviour associated with a key event } mpl.figure.prototype.key_event = function(event, name) { // Prevent repeat events if (name == 'key_press') { if (event.which === this._key) return; else this._key = event.which; } if (name == 'key_release') this._key = null; var value = ''; if (event.ctrlKey && event.which != 17) value += \"ctrl+\"; if (event.altKey && event.which != 18) value += \"alt+\"; if (event.shiftKey && event.which != 16) value += \"shift+\"; value += 'k'; value += event.which.toString(); this._key_event_extra(event, name); this.send_message(name, {key: value, guiEvent: simpleKeys(event)}); return false; } mpl.figure.prototype.toolbar_button_onclick = function(name) { if (name == 'download') { this.handle_save(this, null); } else { this.send_message(\"toolbar_button\", {name: name}); } }; mpl.figure.prototype.toolbar_button_onmouseover = function(tooltip) { this.message.textContent = tooltip; }; mpl.toolbar_items = [[\"Home\", \"Reset original view\", \"fa fa-home icon-home\", \"home\"], [\"Back\", \"Back to previous view\", \"fa fa-arrow-left icon-arrow-left\", \"back\"], [\"Forward\", \"Forward to next view\", \"fa fa-arrow-right icon-arrow-right\", \"forward\"], [\"\", \"\", \"\", \"\"], [\"Pan\", \"Pan axes with left mouse, zoom with right\", \"fa fa-arrows icon-move\", \"pan\"], [\"Zoom\", \"Zoom to rectangle\", \"fa fa-square-o icon-check-empty\", \"zoom\"], [\"\", \"\", \"\", \"\"], [\"Download\", \"Download plot\", \"fa fa-floppy-o icon-save\", \"download\"]]; mpl.extensions = [\"eps\", \"jpeg\", \"pdf\", \"png\", \"ps\", \"raw\", \"svg\", \"tif\"]; mpl.default_extension = \"png\";var comm_websocket_adapter = function(comm) { // Create a \"websocket\"-like object which calls the given IPython comm // object with the appropriate methods. Currently this is a non binary // socket, so there is still some room for performance tuning. var ws = {}; ws.close = function() { comm.close() }; ws.send = function(m) { //console.log('sending', m); comm.send(m); }; // Register the callback with on_msg. comm.on_msg(function(msg) { //console.log('receiving', msg['content']['data'], msg); // Pass the mpl event to the overriden (by mpl) onmessage function. ws.onmessage(msg['content']['data']) }); return ws; } mpl.mpl_figure_comm = function(comm, msg) { // This is the function which gets called when the mpl process // starts-up an IPython Comm through the \"matplotlib\" channel. var id = msg.content.data.id; // Get hold of the div created by the display call when the Comm // socket was opened in Python. var element = $(\"#\" + id); var ws_proxy = comm_websocket_adapter(comm) function ondownload(figure, format) { window.open(figure.imageObj.src); } var fig = new mpl.figure(id, ws_proxy, ondownload, element.get(0)); // Call onopen now - mpl needs it, as it is assuming we've passed it a real // web socket which is closed, not our websocket->open comm proxy. ws_proxy.onopen(); fig.parent_element = element.get(0); fig.cell_info = mpl.find_output_cell(\"<div id='\" + id + \"'></div>\"); if (!fig.cell_info) { console.error(\"Failed to find cell for figure\", id, fig); return; } var output_index = fig.cell_info[2] var cell = fig.cell_info[0]; }; mpl.figure.prototype.handle_close = function(fig, msg) { var width = fig.canvas.width/mpl.ratio fig.root.unbind('remove') // Update the output cell to use the data from the current canvas. fig.push_to_output(); var dataURL = fig.canvas.toDataURL(); // Re-enable the keyboard manager in IPython - without this line, in FF, // the notebook keyboard shortcuts fail. IPython.keyboard_manager.enable() $(fig.parent_element).html('<img src=\"' + dataURL + '\" width=\"' + width + '\">'); fig.close_ws(fig, msg); } mpl.figure.prototype.close_ws = function(fig, msg){ fig.send_message('closing', msg); // fig.ws.close() } mpl.figure.prototype.push_to_output = function(remove_interactive) { // Turn the data on the canvas into data in the output cell. var width = this.canvas.width/mpl.ratio var dataURL = this.canvas.toDataURL(); this.cell_info[1]['text/html'] = '<img src=\"' + dataURL + '\" width=\"' + width + '\">'; } mpl.figure.prototype.updated_canvas_event = function() { // Tell IPython that the notebook contents must change. IPython.notebook.set_dirty(true); this.send_message(\"ack\", {}); var fig = this; // Wait a second, then push the new image to the DOM so // that it is saved nicely (might be nice to debounce this). setTimeout(function () { fig.push_to_output() }, 1000); } mpl.figure.prototype._init_toolbar = function() { var fig = this; var nav_element = $('<div/>') nav_element.attr('style', 'width: 100%'); this.root.append(nav_element); // Define a callback function for later on. function toolbar_event(event) { return fig.toolbar_button_onclick(event['data']); } function toolbar_mouse_event(event) { return fig.toolbar_button_onmouseover(event['data']); } for(var toolbar_ind in mpl.toolbar_items){ var name = mpl.toolbar_items[toolbar_ind][0]; var tooltip = mpl.toolbar_items[toolbar_ind][1]; var image = mpl.toolbar_items[toolbar_ind][2]; var method_name = mpl.toolbar_items[toolbar_ind][3]; if (!name) { continue; }; var button = $('<button class=\"btn btn-default\" href=\"#\" title=\"' + name + '\"><i class=\"fa ' + image + ' fa-lg\"></i></button>'); button.click(method_name, toolbar_event); button.mouseover(tooltip, toolbar_mouse_event); nav_element.append(button); } // Add the status bar. var status_bar = $('<span class=\"mpl-message\" style=\"text-align:right; float: right;\"/>'); nav_element.append(status_bar); this.message = status_bar[0]; // Add the close button to the window. var buttongrp = $('<div class=\"btn-group inline pull-right\"></div>'); var button = $('<button class=\"btn btn-mini btn-primary\" href=\"#\" title=\"Stop Interaction\"><i class=\"fa fa-power-off icon-remove icon-large\"></i></button>'); button.click(function (evt) { fig.handle_close(fig, {}); } ); button.mouseover('Stop Interaction', toolbar_mouse_event); buttongrp.append(button); var titlebar = this.root.find($('.ui-dialog-titlebar')); titlebar.prepend(buttongrp); } mpl.figure.prototype._root_extra_style = function(el){ var fig = this el.on(\"remove\", function(){ fig.close_ws(fig, {}); }); } mpl.figure.prototype._canvas_extra_style = function(el){ // this is important to make the div 'focusable el.attr('tabindex', 0) // reach out to IPython and tell the keyboard manager to turn it's self // off when our div gets focus // location in version 3 if (IPython.notebook.keyboard_manager) { IPython.notebook.keyboard_manager.register_events(el); } else { // location in version 2 IPython.keyboard_manager.register_events(el); } } mpl.figure.prototype._key_event_extra = function(event, name) { var manager = IPython.notebook.keyboard_manager; if (!manager) manager = IPython.keyboard_manager; // Check for shift+enter if (event.shiftKey && event.which == 13) { this.canvas_div.blur(); event.shiftKey = false; // Send a \"J\" for go to next cell event.which = 74; event.keyCode = 74; manager.command_mode(); manager.handle_keydown(event); } } mpl.figure.prototype.handle_save = function(fig, msg) { fig.ondownload(fig, null); } mpl.find_output_cell = function(html_output) { // Return the cell and output element which can be found *uniquely* in the notebook. // Note - this is a bit hacky, but it is done because the \"notebook_saving.Notebook\" // IPython event is triggered only after the cells have been serialised, which for // our purposes (turning an active figure into a static one), is too late. var cells = IPython.notebook.get_cells(); var ncells = cells.length; for (var i=0; i<ncells; i++) { var cell = cells[i]; if (cell.cell_type === 'code'){ for (var j=0; j<cell.output_area.outputs.length; j++) { var data = cell.output_area.outputs[j]; if (data.data) { // IPython >= 3 moved mimebundle to data attribute of output data = data.data; } if (data['text/html'] == html_output) { return [cell, data, j]; } } } } } // Register the function which deals with the matplotlib target/channel. // The kernel may be null if the page has been refreshed. if (IPython.notebook.kernel != null) { IPython.notebook.kernel.comm_manager.register_target('matplotlib', mpl.mpl_figure_comm); } var element = $('#f407070c-2233-4cfb-af9e-dbd061e18222'); {\"model_id\": \"29aabb46328d435cbde975b3255327ea\", \"version_major\": 2, \"version_minor\": 0} if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"a-sections","url":"a-sections/a-section-9/demo/"},{"title":"Lab 1: Introduction to Python and its Numerical Stack","text":"Jupyter Notebooks Lab 1: Introduction to Python and its Numerical Stack - Student Version Lab 1: Introduction to Python and its Numerical Stack - Solutions","tags":"labs","url":"labs/lab-1/"},{"title":"Lab 1: Introduction to Python and its Numerical Stack","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 1: Introduction to Python and its Numerical Stack Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) print ( 'hello' ) hello Programming Expectations All assignments for this class will use Python and the browser-based iPython notebook format you are currently viewing. Python experience is not a prerequisite for this course, as long as you are comfortable learning on your own as needed. Note though that the programming at the level of CS 50 is a prerequisite for this course. If you have concerns about the prerequisite, please come speak with any of the instructors. We will refer to the Python 3 documentation in this lab and throughout the course. There are also many introductory tutorials to help build programming skills, which we are listed in the last section of this lab. Table of Contents Learning Goals Getting Started Lists Simple Functions Numpy Scipy.stats and plotting distributions Conclusions Additional Stuff Dictionaries Reading CSVs using pandas Learning Goals This introductory lab is a condensed introduction to Python numerical programming. By the end of this lab, you will feel more comfortable: Writing short Python code using functions, loops, lists, numpy arrays, and dictionaries. Manipulating Python lists and numpy arrays and understanding the difference between them. Using probability distributions from scipy.stats Making very simple plots using matplotlib Reading and writing CSV files using pandas Learning and reading Python documentation. Lab 1 relates to material in lecture 0,1,2,3 and homework 0. Part 1: Getting Started Importing modules All notebooks should begin with code that imports modules , collections of built-in, commonly-used Python functions. Below we import the Numpy module, a fast numerical programming library for scientific computing. Future labs will require additional modules, which we'll import with the same import MODULE_NAME as MODULE_NICKNAME syntax. In [2]: import numpy as np #imports a fast numerical programming library Now that Numpy has been imported, we can access some useful functions. For example, we can use mean to calculate the mean of a set of numbers. In [3]: np . mean ([ 1.2 , 2 , 3.3 ]) to calculate the mean of 1.2, 2, and 3.3. The code above is not particularly efficient, and efficiency will be important for you when dealing with large data sets. Later and in lab 2 we will see more efficient options. Calculations and variables In [4]: # // is integer division 1 / 2 , 1 // 2 , 1.0 / 2.0 , 3 * 3.2 The last line in a cell is returned as the output value, as above. For cells with multiple lines of results, we can display results using print , as can be seen below. In [5]: print ( 1 + 3.0 , \" \\n \" , 9 , 7 ) 5 / 3 We can store integer or floating point values as variables. The other basic Python data types -- booleans, strings, lists -- can also be stored as variables. (more on types here: http://www.diveintopython3.net/native-datatypes.html ) In [6]: a = 1 b = 2.0 Here is the storing of a list (more about what a list is later): In [7]: a = [ 1 , 2 , 3 ] Think of a variable as a label for a value, not a box in which you put the value (image taken from Fluent Python by Luciano Ramalho) In [8]: b = a b This DOES NOT create a new copy of a . It merely puts a new label on the memory at a, as can be seen by the following code: In [9]: print ( \"a\" , a ) print ( \"b\" , b ) a [ 1 ] = 7 print ( \"a after change\" , a ) print ( \"b after change\" , b ) Tuples Multiple items on one line in the interface are returned as a tuple , an immutable sequence of Python objects. In [10]: a = 1 b = 2.0 a + a , a - b , b * b , 10 * a We can obtain the type of a variable, and use boolean comparisons to test these types. In [11]: type ( a ) == float In [12]: type ( a ) == int For reference, below are common arithmetic and comparison operations. EXERCISE**: Create a tuple called `tup` with the following seven objects: . The first element is an integer of your choice The second element is a float of your choice The third element is the sum of the first two elements The fourth element is the difference of the first two elements The fifth element is first element divided by the second element Display the output of tup . What is the type of the variable tup ? What happens if you try and chage an item in the tuple? In [13]: # your code here Part 2: Lists Much of Python is based on the notion of a list. In Python, a list is a sequence of items separated by commas, all within square brackets. The items can be integers, floating points, or another type. Unlike in C arrays, items in a Python list can be different types, so Python lists are more versatile than traditional arrays in C or in other languages. Let's start out by creating a few lists. In [14]: empty_list = [] float_list = [ 1. , 3. , 5. , 4. , 2. ] int_list = [ 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ] mixed_list = [ 1 , 2. , 3 , 4. , 5 ] print ( empty_list ) print ( int_list ) print ( mixed_list , float_list ) Lists in Python are zero-indexed, as in C. The first entry of the list has index 0, the second has index 1, and so on. In [15]: print ( int_list [ 0 ]) print ( float_list [ 1 ]) What happens if we try to use an index that doesn't exist for that list? Python will complain! In [16]: print ( float_list [ 10 ]) You can find the length of a list using the builtin function len : In [17]: print ( float_list ) len ( float_list ) Indexing on lists And since Python is zero-indexed, the last element of float_list is In [18]: float_list [ len ( float_list ) - 1 ] It is more idiomatic in python to use -1 for the last element, -2 for the second last, and so on In [19]: float_list [ - 1 ] We can use the : operator to access a subset of the list. This is called slicing. In [20]: print ( float_list [ 1 : 5 ]) print ( float_list [ 0 : 2 ]) Below is a summary of list slicing operations: You can slice \"backwards\" as well: In [21]: float_list [: - 2 ] # up to second last In [22]: float_list [: 4 ] # up to but not including 5th element You can also slice with a stride: In [23]: float_list [: 4 : 2 ] # above but skipping every second element We can iterate through a list using a loop. Here's a for loop. In [24]: for ele in float_list : print ( ele ) Or, if we like, we can iterate through a list using the indices using a for loop with in range . This is not idiomatic and is not recommended, but accomplishes the same thing as above. In [25]: for i in range ( len ( float_list )): print ( float_list [ i ]) What if you wanted the index as well? Use the built-in python method enumerate , which can be used to create a list of tuples with each tuple of the form (index, value) . In [26]: for i , ele in enumerate ( float_list ): print ( i , ele ) In [27]: # or make a list from it using the list constructor list ( enumerate ( float_list )) Appending and deleting We can also append items to the end of the list using the + operator or with append . In [28]: float_list + [ . 333 ] In [29]: float_list . append ( . 444 ) In [30]: print ( float_list ) len ( float_list ) Go and run the cell with float_list.append a second time. Then run the next line. What happens? To remove an item from the list, use del. In [31]: del ( float_list [ 2 ]) print ( float_list ) List Comprehensions Lists can be constructed in a compact way using a list comprehension . Here's a simple example. In [32]: squaredlist = [ i * i for i in int_list ] squaredlist And here's a more complicated one, requiring a conditional. In [33]: comp_list1 = [ 2 * i for i in squaredlist if i % 2 == 0 ] print ( comp_list1 ) This is entirely equivalent to creating comp_list1 using a loop with a conditional, as below: In [34]: comp_list2 = [] for i in squaredlist : if i % 2 == 0 : comp_list2 . append ( 2 * i ) print ( comp_list2 ) The list comprehension syntax [expression for item in list if conditional] is equivalent to the syntax for item in list: if conditional: expression Exercise: Build a list that contains every prime number between 1 and 100, in two different ways: Using for loops and conditional if statements. (Stretch Goal) Using a list comprehension. You should be able to do this in one line of code, and it may be helpful to look up the function all in the documentation. In [35]: # your code here In [36]: # your code here Part 4: Simple Functions A function object is a reusable block of code that does a specific task. Functions are all over Python, either on their own or on other objects. To invoke a function func , you call it as func(arguments) . We've seen built-in Python functions and methods. For example, len and print are built-in Python functions. And at the beginning, you called np.mean to calculate the mean of three numbers, where mean is a function in the numpy module and numpy was abbreviated as np . This syntax allows us to have multiple \"mean\" functions in different modules; calling this one as np.mean guarantees that we will pick up numpy's mean function, as opposed to a mean function from a different module. Methods A function that belongs to an object is called a method . By \"object\" here we mean an \"instance\" of a list, or integer, or floating point variable. An example of this is append on an existing list. In other words, a method is a function on an instance of a type of object (also called class , in this case, list type). In [37]: float_list = [ 1.0 , 2.09 , 4.0 , 2.0 , 0.444 ] print ( float_list ) float_list . append ( 56.7 ) float_list User-defined functions We'll now learn to write our own user-defined functions. Below is the syntax for defining a basic function with one input argument and one output. You can also define functions with no input or output arguments, or multiple input or output arguments. def name_of_function(arg): ... return(output) We can write functions with one input and one output argument. Here are two such functions. In [38]: def square ( x ): x_sqr = x * x return ( x_sqr ) def cube ( x ): x_cub = x * x * x return ( x_cub ) square ( 5 ), cube ( 5 ) What if you want to return two variables at a time? The usual way is to return a tuple: In [39]: def square_and_cube ( x ): x_cub = x * x * x x_sqr = x * x return ( x_sqr , x_cub ) square_and_cube ( 5 ) Lambda functions Often we quickly define mathematical functions with a one-line function called a lambda function. Lambda functions are great because they enable us to write functions without having to name them, ie, they're anonymous . No return statement is needed. In [40]: # create an anonymous function and assign it to the variable square square = lambda x : x * x print ( square ( 3 )) hypotenuse = lambda x , y : x * x + y * y ## Same as # def hypotenuse(x, y): # return(x*x + y*y) hypotenuse ( 3 , 4 ) Refactoring using functions In an exercise from Lab 0, you wrote code that generated a list of the prime numbers between 1 and 100. For the excercise below, it may help to revisit that code. Write a function called `isprime` that takes in a positive integer $N$, and determines whether or not it is prime. Return `True` if it's prime and return `False` if it isn't. Then, using a list comprehension and `isprime`, create a list `myprimes` that contains all the prime numbers less than 100. In [41]: # your code here Part 5: Introduction to Numpy Scientific Python code uses a fast array structure, called the numpy array. Those who have worked in Matlab will find this very natural. For reference, the numpy documention can be found here . Let's make a numpy array. In [42]: my_array = np . array ([ 1 , 2 , 3 , 4 ]) my_array In [43]: # works as in lists len ( my_array ) The shape array of an array is very useful (we'll see more of it later when we talk about 2D and higher dimensional arrays). In [44]: my_array . shape Numpy arrays are typed . This means that by default, all the elements will be assumed to be of one type In [45]: my_array . dtype Numpy arrays are listy (i.e. they act like lists)! Below we compute length, slice, and iterate. In [46]: print ( len ( my_array )) print ( my_array [ 2 : 4 ]) for ele in my_array : print ( ele ) In general you should manipulate numpy arrays by using numpy module functions ( np.mean , for example). This is for efficiency purposes, and a discussion about this will happen in Lab2. You can calculate the mean of the array elements either by calling the method .mean on a numpy array or by applying the function np.mean with the numpy array as an argument. In [47]: print ( my_array . mean ()) print ( np . mean ( my_array )) The way we constructed the numpy array above seems redundant. After all we already had a regular python list. Indeed, it is the other ways we have to construct numpy arrays that make them super useful. There are many such numpy array constructors . Here are some commonly used constructors. Look them up in the documentation. In [48]: np . ones ( 10 ) # generates 10 floating point ones Numpy gains a lot of its efficiency from being typed. That is, all elements in the array have the same type, such as integer or floating point. The default type, as can be seen above, is a float of size appropriate for the machine (64 bit on a 64 bit machine). In [49]: np . dtype ( float ) . itemsize # in bytes In [50]: np . ones ( 10 , dtype = 'int' ) # generates 10 integer ones In [51]: np . zeros ( 10 ) Often you will want random numbers. Use the random constructor! In [52]: np . random . random ( 10 ) # uniform on [0,1] You can generate random numbers from a normal distribution with mean 0 and variance 1: In [53]: normal_array = np . random . randn ( 1000 ) print ( \"The sample mean and standard devation are %f and %f , respectively.\" % ( np . mean ( normal_array ), np . std ( normal_array ))) You can sample with and without replacement from an array. Lets first construct a grid: In [54]: grid = np . arange ( 0. , 1.01 , 0.1 ) grid Without replacement In [55]: np . random . choice ( grid , 5 , replace = False ) In [56]: np . random . choice ( grid , 20 , replace = False ) With replacement: In [57]: np . random . choice ( grid , 12 , replace = True ) Numpy supports vector operations What does this mean? It means that instead of adding two arrays, element by element, you can just say: add the two arrays. Note that this behavior is very different from python lists. In [58]: first = np . ones ( 5 ) second = np . ones ( 5 ) first + second In [59]: first_list = [ 1. , 1. , 1. , 1. , 1. ] second_list = [ 1. , 1. , 1. , 1. , 1. ] first_list + second_list #not what u want On some computer chips this addition actually happens in parallel, so speedups can be high. But even on regular chips, the advantage of greater readability is important. Numpy supports a concept known as broadcasting , which dictates how arrays of different sizes are combined together. There are too many rules to list here, but importantly, multiplying an array by a number multiplies each element by the number. Adding a number adds the number to each element. In [60]: first + 1 In [61]: first * 5 This means that if you wanted the distribution $N(5, 7)$ you could do: In [62]: normal_5_7 = 5 + 7 * normal_array np . mean ( normal_5_7 ), np . std ( normal_5_7 ) Multiplying two arrays multiplies them element-by-element In [63]: ( first + 1 ) * ( first * 5 ) You might have wanted to compute the dot product instead: In [64]: np . dot (( first + 1 ) , ( first * 5 )) You can also use the @ operator for this purpose In [65]: ( first + 1 ) @ ( first * 5 ) Part 6: Probabilitiy Distributions from scipy.stats Since we'll be using many distributions, we'll want to access the pdf/pmf functions of these distributions and obtain samples from them. We already saw how to obtain samples from the continuous uniform and normal distributions. But we might want to obtain their pdfs as well. scipy.stats allows us to obtain the pdf function as well as samples. The programming interface is identical for all the distributions. To plot samples from and the pdfs of these distributions, we'll first import matplotlib , python's plotting library. The %matplotlib inline incantation ensures that plots are rendered inline in the browser. In [66]: % matplotlib inline import matplotlib.pyplot as plt Lets get the normal distribution namespace from scipy.stats . Docs here . In [67]: from scipy.stats import norm Lets create 1000 points between -10 and 10 In [68]: x = np . linspace ( - 10 , 10 , 1000 ) x [: 10 ], x [ - 10 :] Lets get the pdf of a normal distribution with a mean of 1 and standard deviation 3 and plot it using the grid points computed before... In [69]: pdf_x = norm . pdf ( x , 1 , 3 ) plt . plot ( x , pdf_x ); And you can get random variables using the rvs function. In [70]: norm . rvs ( size = 30 , loc = 1 , scale = 3 ) We can use a more instance based way of getting both the pdf and samples. The documentation calls this instance a \"frozen\" distribution: In [71]: frozen_norm = norm ( loc = 1 , scale = 3 ) type ( frozen_norm ) In [72]: plt . plot ( x , frozen_norm . pdf ( x )) In [73]: frozen_norm . rvs ( 10 ) We can now plot a histogram of the samples using matplotlib: (see docs on plt.hist by typing ?plt.hist in a cell by itself) In [74]: plt . hist ( frozen_norm . rvs ( 1000 ), bins = 30 ); By default the histogram gives us counts. We can re-normalize these counts to get an approximation to the probability distribution from the samples. In [75]: plt . hist ( frozen_norm . rvs ( 1000 ), bins = 30 , normed = True ); Part 7: Conclusions For more practice exercises (with solutions) and discussion, see this page . Some of these exercises are particularly relevant. Check them out! Don't forget to look up Jake's book . Finally, we would like to suggest using Chris Albon's web site as a reference. Lots of useful information there. Additional Stuff Part 1: Dictionaries A dictionary is another storage container. Like a list, a dictionary is a sequence of items. Unlike a list, a dictionary is unordered and its items are accessed with keys and not integer positions. Dictionaries are the closest container we have to a database. Let's make a dictionary with a few Harvard courses and their corresponding enrollment numbers. In [76]: enroll2017_dict = { 'CS50' : 692 , 'CS109A / Stat 121A / AC 209A' : 352 , 'Econ1011a' : 95 , 'AM21a' : 153 , 'Stat110' : 485 } enroll2017_dict One can obtain the value corrsponding to a key thus: In [77]: enroll2017_dict [ 'CS50' ] Or thus, which allows for the key to not be in the dictionary In [78]: enroll2017_dict . get ( 'CS01' , 5 ), enroll2017_dict . get ( 'CS01' ) In [79]: enroll2017_dict . get ( 'CS50' ) All sorts of iterations are supported: In [80]: enroll2017_dict . values () In [81]: enroll2017_dict . items () We can iterate over the tuples obtained above: (to read more about how the print formatting works , look at https://docs.python.org/3/library/stdtypes.html#old-string-formatting and https://docs.python.org/3/tutorial/inputoutput.html ) In [82]: for key , value in enroll2017_dict . items (): print ( \" %s : %d \" % ( key , value )) Simply iterating over a dictionary gives us the keys. This is useful when we want to do something with each item: In [83]: second_dict = {} for key in enroll2017_dict : second_dict [ key ] = enroll2017_dict [ key ] second_dict The above is an actual copy to another part of memory, unlike, second_dict = enroll2017_dict which would have made both variables label the same memory location. In this example, the keys were strings corresponding to course names. Keys don't have to be strings though. Like lists, you can construct dictionaries using a dictionary comprehension , which is similar to a list comprehension. Notice the brackets {} and the use of zip , which is another iterator that combines two lists together. In [84]: my_dict = { k : v for ( k , v ) in zip ( int_list , float_list )} my_dict You can also create dictionaries using the constructor function dict . In [85]: dict ( a = 1 , b = 2 ) Part 2: Introduction to Pandas Often data is stored in comma separated values (CSV) files. For the remainder of this lab, we'll be working with automobile data , where we've extracted relevant parts below. Note that CSV files can be output by any spreadsheet software, and are plain text, hence are a great way to share data. Importing data with pandas Now let's read in our automobile data as a pandas dataframe structure. In [86]: import pandas as pd In [87]: # Read in the csv files dfcars = pd . read_csv ( \"data/mtcars.csv\" ) type ( dfcars ) In [88]: dfcars . head () What we have now is a spreadsheet with indexed rows and named columns, called a dataframe in pandas. dfcars is an instance of the pd.DataFrame class , created by calling the pd.read_csv \"constructor function\". The take-away is that dfcars is a dataframe object, and it has methods (functions) belonging to it. For example, df.head() is a method that shows the first 5 rows of the dataframe. A pandas dataframe is a set of columns pasted together into a spreadsheet, as shown in the schematic below, which is taken from the cheatsheet above. The columns in pandas are called series objects. Let's look again at the first five rows of dfcars . In [89]: dfcars . head () Notice the poorly named first column: \"Unnamed: 0\". Why did that happen? The first column, which seems to be the name of the car, does not have a name. Here are the first 3 lines of the file: \"\",\"mpg\",\"cyl\",\"disp\",\"hp\",\"drat\",\"wt\",\"qsec\",\"vs\",\"am\",\"gear\",\"carb\" \"Mazda RX4\",21,6,160,110,3.9,2.62,16.46,0,1,4,4 \"Mazda RX4 Wag\",21,6,160,110,3.9,2.875,17.02,0,1,4,4 Lets clean that up: In [90]: dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () In the above, the argument columns = {\"Unnamed: 0\": \"name\"} of rename changed the name of the first column in the dataframe from Unnamed: 0 to name . Lets save this cleaned dataframe out to a CSV file. In [91]: # dont store the 0,1,2,3,4.. index dfcars . to_csv ( \"data/cleaned-mtcars.csv\" , index = False , header = True ) The output will look something like this: name,mpg,cyl,disp,hp,drat,wt,qsec,vs,am,gear,carb Mazda RX4,21.0,6,160.0,110,3.9,2.62,16.46,0,1,4,4 Mazda RX4 Wag,21.0,6,160.0,110,3.9,2.875,17.02,0,1,4,4 Datsun 710,22.8,4,108.0,93,3.85,2.32,18.61,1,1,4,1 Hornet 4 Drive,21.4,6,258.0,110,3.08,3.215,19.44,1,0,3,1 Hornet Sportabout,18.7,8,360.0,175,3.15,3.44,17.02,0,0,3,2 Valiant,18.1,6,225.0,105,2.76,3.46,20.22,1,0,3,1 To access a series (column), you can use either dictionary syntax or instance-variable syntax. Dictionary syntax is very useful when column names have spaces: Python variables cannot have spaces in them. In [92]: dfcars . mpg In [93]: dfcars [ 'mpg' ] You can get a numpy array of values from the Pandas Series: In [94]: dfcars . mpg . values And we can produce a histogram from these values In [95]: # the .values isnt really need, a series behaves like a list for # plotting purposes plt . hist ( dfcars . mpg . values , bins = 20 ); plt . xlabel ( \"mpg\" ); plt . ylabel ( \"Frequency\" ) plt . title ( \"Miles per Gallon\" ); But pandas is very cool: you can get a histogram directly: In [96]: dfcars . mpg . hist ( bins = 20 ); plt . xlabel ( \"mpg\" ); plt . ylabel ( \"Frequency\" ) plt . title ( \"Miles per Gallon\" ); We can also get sub-dataframes by choosing a set of series. We pass a list of the columns we want as \"dictionary keys\" to the dataframe. In [97]: dfcars [[ 'am' , 'mpg' ]] Scatter plots We often want to see co-variation among our columns, for example, miles/gallon versus weight. This can be done with a scatter plot. In [98]: plt . scatter ( dfcars . wt , dfcars . mpg ); plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); You could have used plot instead of scatter . In [99]: plt . plot ( dfcars . wt , dfcars . mpg , 'o' ); plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); Usually we use plt.show() at the end of every plot to display the plot. Our magical incantation %matplotlib inline takes care of this for us, and we don't have to do it in the Jupyter notebook. But if you run your Python program from a file, you will need to explicitly have a call to show. We include it for completion. In [100]: plt . plot ( dfcars . wt , dfcars . mpg , 'ko' ) #black dots plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); plt . show () Suppose we'd like to save a figure to a file. We do this by including the savefig command in the same cell as the plotting commands. The file extension tells you how the file will be saved. In [101]: plt . plot ( dfcars . wt , dfcars . mpg , 'o' ) plt . xlabel ( \"weight\" ); plt . ylabel ( \"miles per gallon\" ); plt . savefig ( 'images/foo1.pdf' ) plt . savefig ( 'images/foo1.png' , bbox_inches = 'tight' ) #less whitespace around image And this is what the saved png looks like. Code in Markdown to show this is: ![](images/foo1.png) Below is a summary of the most commonly used matplotlib plotting routines. Exercise Create a scatter plot showing the co-variation between two columns of your choice. Label the axes. See if you can do this without copying and pasting code from earlier in the lab. What can you conclude, if anything, from your scatter plot? In [102]: # your code here if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-1/student/"},{"title":"Lab 2: Pandas for Data Cleaning","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 2 Pandas Harvard University Summer 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructors: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh and Pavlos Protopaps In [7]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING from IPython.core.display import HTML def css_styling (): styles = open ( \"../../styles/cs109.css\" , \"r\" ) . read () return HTML ( styles ) css_styling () Out[7]: h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Learning Goals Loading and Cleaning with Pandas Parsing and Completing the Dataframe Grouping Learning Goals About 6000 odd \"best books\" were fetched and parsed from Goodreads . The \"bestness\" of these books came from a proprietary formula used by Goodreads and published as a list on their web site. We parsed the page for each book and saved data from all these pages in a tabular format as a CSV file. In this lab we'll clean and further parse the data. We'll then do some exploratory data analysis to answer questions about these best books and popular genres. By the end of this lab, you should be able to: Load and systematically address missing values, ancoded as NaN values in our data set, for example, by removing observations associated with these values. Parse columns in the dataframe to create new dataframe columns. Use groupby to aggregate data on a particular feature column, such as author. This lab corresponds to lectures 2, 3 and 4 and maps on to homework 1 and further. Basic EDA workflow (From the lecture, repeated here for convenience). The basic workflow is as follows: Build a DataFrame from the data (ideally, put all data in this object) Clean the DataFrame. It should have the following properties: Each row describes a single object Each column describes a property of that object Columns are numeric whenever appropriate Columns contain atomic properties that cannot be further decomposed Explore global properties . Use histograms, scatter plots, and aggregation functions to summarize the data. Explore group properties . Use groupby and small multiples to compare subsets of the data. This process transforms your data into a format which is easier to work with, gives you a basic overview of the data's properties, and likely generates several questions for you to followup in subsequent analysis. Part 1: Loading and Cleaning with Pandas Read in the goodreads.csv file, examine the data, and do any necessary data cleaning. Here is a description of the columns (in order) present in this csv file: rating: the average rating on a 1-5 scale achieved by the book review_count: the number of Goodreads users who reviewed this book isbn: the ISBN code for the book booktype: an internal Goodreads identifier for the book author_url: the Goodreads (relative) URL for the author of the book year: the year the book was published genre_urls: a string with '|' separated relative URLS of Goodreads genre pages dir: a directory identifier internal to the scraping code rating_count: the number of ratings for this book (this is different from the number of reviews) name: the name of the book Let us see what issues we find with the data and resolve them. After loading appropriate libraries In [8]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) Cleaning: Reading in the data We read in and clean the data from goodreads.csv . In [9]: #Read the data into a dataframe df = pd . read_csv ( \"data/goodreads.csv\" ) #Examine the first few rows of the dataframe df . head () Out[9]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 4.40 136455 0439023483 good_reads:book https://www.goodreads.com/author/show/153394.Suzanne_Collins 2008 /genres/young-adult|/genres/science-fiction|/genres/dystopia|/genres/fantasy|/genres/science-fiction|/genres/romance|/genres/adventure|/genres/book-club|/genres/young-adult|/genres/teen|/genres/apocalyptic|/genres/post-apocalyptic|/genres/action dir01/2767052-the-hunger-games.html 2958974 The Hunger Games (The Hunger Games, #1) 0 4.41 16648 0439358078 good_reads:book https://www.goodreads.com/author/show/1077326.... 2003.0 /genres/fantasy|/genres/young-adult|/genres/fi... dir01/2.Harry_Potter_and_the_Order_of_the_Phoe... 1284478 Harry Potter and the Order of the Phoenix (Har... 1 3.56 85746 0316015849 good_reads:book https://www.goodreads.com/author/show/941441.S... 2005.0 /genres/young-adult|/genres/fantasy|/genres/ro... dir01/41865.Twilight.html 2579564 Twilight (Twilight, #1) 2 4.23 47906 0061120081 good_reads:book https://www.goodreads.com/author/show/1825.Har... 1960.0 /genres/classics|/genres/fiction|/genres/histo... dir01/2657.To_Kill_a_Mockingbird.html 2078123 To Kill a Mockingbird 3 4.23 34772 0679783261 good_reads:book https://www.goodreads.com/author/show/1265.Jan... 1813.0 /genres/classics|/genres/fiction|/genres/roman... dir01/1885.Pride_and_Prejudice.html 1388992 Pride and Prejudice 4 4.25 12363 0446675539 good_reads:book https://www.goodreads.com/author/show/11081.Ma... 1936.0 /genres/classics|/genres/historical-fiction|/g... dir01/18405.Gone_with_the_Wind.html 645470 Gone with the Wind Oh dear. That does not quite seem to be right. We are missing the column names. We need to add these in! But what are they? Here is a list of them in order: [\"rating\", 'review_count', 'isbn', 'booktype','author_url', 'year', 'genre_urls', 'dir','rating_count', 'name'] Exercise Use these to load the dataframe properly! And then \"head\" the dataframe... (you will need to look at the read_csv docs) In [10]: # your code here df = pd . read_csv ( \"data/goodreads.csv\" , header = None , names = [ \"rating\" , 'review_count' , 'isbn' , 'booktype' , 'author_url' , 'year' , 'genre_urls' , 'dir' , 'rating_count' , 'name' ], ) #Examine the first few rows of the dataframe df . head () Out[10]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } rating review_count isbn booktype author_url year genre_urls dir rating_count name 0 4.40 136455 0439023483 good_reads:book https://www.goodreads.com/author/show/153394.S... 2008.0 /genres/young-adult|/genres/science-fiction|/g... dir01/2767052-the-hunger-games.html 2958974 The Hunger Games (The Hunger Games, #1) 1 4.41 16648 0439358078 good_reads:book https://www.goodreads.com/author/show/1077326.... 2003.0 /genres/fantasy|/genres/young-adult|/genres/fi... dir01/2.Harry_Potter_and_the_Order_of_the_Phoe... 1284478 Harry Potter and the Order of the Phoenix (Har... 2 3.56 85746 0316015849 good_reads:book https://www.goodreads.com/author/show/941441.S... 2005.0 /genres/young-adult|/genres/fantasy|/genres/ro... dir01/41865.Twilight.html 2579564 Twilight (Twilight, #1) 3 4.23 47906 0061120081 good_reads:book https://www.goodreads.com/author/show/1825.Har... 1960.0 /genres/classics|/genres/fiction|/genres/histo... dir01/2657.To_Kill_a_Mockingbird.html 2078123 To Kill a Mockingbird 4 4.23 34772 0679783261 good_reads:book https://www.goodreads.com/author/show/1265.Jan... 1813.0 /genres/classics|/genres/fiction|/genres/roman... dir01/1885.Pride_and_Prejudice.html 1388992 Pride and Prejudice Cleaning: Examing the dataframe - quick checks We should examine the dataframe to get a overall sense of the content. Exercise Lets check the types of the columns. What do you find? In [11]: # your code here ####### df . dtypes ####### Out[11]: rating float64 review_count object isbn object booktype object author_url object year float64 genre_urls object dir object rating_count object name object dtype: object your answer here Notice that review_count and rating_counts are objects instead of ints, and the year is a float! There are a couple more quick sanity checks to perform on the dataframe. In [ ]: print ( df . shape ) df . columns Cleaning: Examining the dataframe - a deeper look Beyond performing checking some quick general properties of the data frame and looking at the first $n$ rows, we can dig a bit deeper into the values being stored. If you haven't already, check to see if there are any missing values in the data frame. Let's see for a column which seemed OK to us. In [ ]: #Get a sense of how many missing values there are in the dataframe. np . sum ([ df . rating . isnull ()]) In [ ]: #Try to locate where the missing values occur df [ df . rating . isnull ()] How does pandas or numpy handle missing values when we try to compute with data sets that include them? We'll now check if any of the other suspicious columns have missing values. Let's look at year and review_count first. One thing you can do is to try and convert to the type you expect the column to be. If something goes wrong, it likely means your data are bad. Lets test for missing data: In [ ]: df [ df . year . isnull ()] Cleaning: Dealing with Missing Values How should we interpret 'missing' or 'invalid' values in the data (hint: look at where these values occur)? One approach is to simply exclude them from the dataframe. Is this appropriate for all 'missing' or 'invalid' values? In [ ]: #Treat the missing or invalid values in your dataframe ####### df = df [ df . year . notnull ()] Ok so we have done some cleaning. What do things look like now? Notice the float has not yet changed. In [ ]: df . dtypes In [ ]: print ( np . sum ( df . year . isnull ())) print ( np . sum ( df . rating_count . isnull ())) print ( np . sum ( df . review_count . isnull ())) # We removed seven rows df . shape Suspect observations for rating and rating_count were removed as well! Exercise Ok so lets fix those types. Convert them to ints. If the type conversion fails, we now know we have further problems. In [ ]: # your code here df . rating_count = df . rating_count . astype ( int ) df . review_count = df . review_count . astype ( int ) df . year = df . year . astype ( int ) Once you do this, we seem to be good on these columns (no errors in conversion). Lets look: In [ ]: df . dtypes Sweet! Some of the other colums that should be strings have NaN. In [ ]: df . loc [ df . genre_urls . isnull (), 'genre_urls' ] = \"\" df . loc [ df . isbn . isnull (), 'isbn' ] = \"\" Part 2: Parsing and Completing the Data Frame We will parse the author column from the author_url and genres column from the genre_urls. Keep the genres column as a string separated by '|'. We will use panda's map to assign new columns to the dataframe. Examine an example author_url and reason about which sequence of string operations must be performed in order to isolate the author's name. In [ ]: #Get the first author_url test_string = df . author_url [ 0 ] test_string In [ ]: #Test out some string operations to isolate the author name test_string . split ( '/' )[ - 1 ] . split ( '.' )[ 1 :][ 0 ] Exercise Lets wrap the above code into a function which we will then use In [ ]: # Write a function that accepts an author url and returns the author's name based on your experimentation above def get_author ( url ): # your code here name = url . split ( '/' )[ - 1 ] . split ( '.' )[ 1 :][ 0 ] ####### return name In [ ]: #Apply the get_author function to the 'author_url' column using '.map' #and add a new column 'author' to store the names df [ 'author' ] = df . author_url . map ( get_author ) df . author [ 0 : 5 ] Exercise Now parse out the genres from genre_url . This is a little more complicated because there be more than one genre. In [ ]: df . genre_urls . head () In [ ]: # your code here #Examine some examples of genre_urls #Test out some string operations to isolate the genre name test_genre_string = df . genre_urls [ 0 ] genres = test_genre_string . strip () . split ( '|' ) for e in genres : print ( e . split ( '/' )[ - 1 ]) \"|\" . join ( genres ) Exercise Write a function that accepts a genre url and returns the genre name based on your experimentation above In [ ]: def split_and_join_genres ( url ): # your code here genres = url . strip () . split ( '|' ) genres = [ e . split ( '/' )[ - 1 ] for e in genres ] return \"|\" . join ( genres ) Test your function In [ ]: split_and_join_genres ( \"/genres/young-adult|/genres/science-fiction\" ) In [ ]: split_and_join_genres ( \"\" ) Exercise Use map again to create a new \"genres\" column In [ ]: df [ 'genres' ] = df . genre_urls . map ( split_and_join_genres ) df . head () Finally, let's pick an author at random so we can see the results of the transformations. Scroll to see the author and genre columns that we added to the dataframe. In [ ]: df [ df . author == \"Marguerite_Yourcenar\" ] Let us delete the genre_urls column. In [ ]: del df [ 'genre_urls' ] And then save the dataframe out! In [ ]: df . to_csv ( \"data/cleaned-goodreads.csv\" , index = False , header = True ) Part 3: Grouping It appears that some books were written in negative years! Print out the observations that correspond to negative years. What do you notice about these books? In [ ]: # your code here df [ df . year < 0 ] . name #These are books written before the Common Era (BCE, equivalent to BC). We can determine the \"best book\" by year! For this we use Pandas groupby. Groupby allows grouping a dataframe by any (usually categorical) variable. In [ ]: dfgb_author = df . groupby ( 'author' ) type ( dfgb_author ) Perhaps we want the number of books each author wrote In [ ]: dfgb_author . count () Lots of useless info there. One column should suffice In [ ]: dfgb_author [ 'author' ] . count () Perhaps you want more detailed info... In [ ]: dfgb_author [[ 'rating' , 'rating_count' , 'review_count' , 'year' ]] . describe () You can also access a groupby dictionary style. In [ ]: ratingdict = {} for author , subset in dfgb_author : ratingdict [ author ] = ( subset [ 'rating' ] . mean (), subset [ 'rating' ] . std ()) ratingdict Exercise Lets get the best-rated book(s) for every year in our dataframe. In [ ]: #Using .groupby, we can divide the dataframe into subsets by the values of 'year'. #We can then iterate over these subsets # your code here for year , subset in df . groupby ( 'year' ): #Find the best book of the year bestbook = subset [ subset . rating == subset . rating . max ()] if bestbook . shape [ 0 ] > 1 : print ( year , bestbook . name . values , bestbook . rating . values ) else : print ( year , bestbook . name . values [ 0 ], bestbook . rating . values [ 0 ]) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-2/pandas/solutions/"},{"title":"Lab 2: Pandas for Data Cleaning","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 2 Pandas Harvard University Summer 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructors: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh and Pavlos Protopaps In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING from IPython.core.display import HTML def css_styling (): styles = open ( \"../../styles/cs109.css\" , \"r\" ) . read () return HTML ( styles ) css_styling () Table of Contents Learning Goals Loading and Cleaning with Pandas Parsing and Completing the Dataframe Grouping Learning Goals About 6000 odd \"best books\" were fetched and parsed from Goodreads . The \"bestness\" of these books came from a proprietary formula used by Goodreads and published as a list on their web site. We parsed the page for each book and saved data from all these pages in a tabular format as a CSV file. In this lab we'll clean and further parse the data. We'll then do some exploratory data analysis to answer questions about these best books and popular genres. By the end of this lab, you should be able to: Load and systematically address missing values, ancoded as NaN values in our data set, for example, by removing observations associated with these values. Parse columns in the dataframe to create new dataframe columns. Use groupby to aggregate data on a particular feature column, such as author. This lab corresponds to lectures 2, 3 and 4 and maps on to homework 1 and further. Basic EDA workflow (From the lecture, repeated here for convenience). The basic workflow is as follows: Build a DataFrame from the data (ideally, put all data in this object) Clean the DataFrame. It should have the following properties: Each row describes a single object Each column describes a property of that object Columns are numeric whenever appropriate Columns contain atomic properties that cannot be further decomposed Explore global properties . Use histograms, scatter plots, and aggregation functions to summarize the data. Explore group properties . Use groupby and small multiples to compare subsets of the data. This process transforms your data into a format which is easier to work with, gives you a basic overview of the data's properties, and likely generates several questions for you to followup in subsequent analysis. Part 1: Loading and Cleaning with Pandas Read in the goodreads.csv file, examine the data, and do any necessary data cleaning. Here is a description of the columns (in order) present in this csv file: rating: the average rating on a 1-5 scale achieved by the book review_count: the number of Goodreads users who reviewed this book isbn: the ISBN code for the book booktype: an internal Goodreads identifier for the book author_url: the Goodreads (relative) URL for the author of the book year: the year the book was published genre_urls: a string with '|' separated relative URLS of Goodreads genre pages dir: a directory identifier internal to the scraping code rating_count: the number of ratings for this book (this is different from the number of reviews) name: the name of the book Let us see what issues we find with the data and resolve them. After loading appropriate libraries In [2]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) Cleaning: Reading in the data We read in and clean the data from goodreads.csv . In [3]: #Read the data into a dataframe df = pd . read_csv ( \"data/goodreads.csv\" ) #Examine the first few rows of the dataframe df . head () Oh dear. That does not quite seem to be right. We are missing the column names. We need to add these in! But what are they? Here is a list of them in order: [\"rating\", 'review_count', 'isbn', 'booktype','author_url', 'year', 'genre_urls', 'dir','rating_count', 'name'] Exercise Use these to load the dataframe properly! And then \"head\" the dataframe... (you will need to look at the read_csv docs) In [4]: # your code here Cleaning: Examing the dataframe - quick checks We should examine the dataframe to get a overall sense of the content. Exercise Lets check the types of the columns. What do you find? In [5]: # your code here your answer here There are a couple more quick sanity checks to perform on the dataframe. In [6]: print ( df . shape ) df . columns Cleaning: Examining the dataframe - a deeper look Beyond performing checking some quick general properties of the data frame and looking at the first $n$ rows, we can dig a bit deeper into the values being stored. If you haven't already, check to see if there are any missing values in the data frame. Let's see for a column which seemed OK to us. In [7]: #Get a sense of how many missing values there are in the dataframe. np . sum ([ df . rating . isnull ()]) In [8]: #Try to locate where the missing values occur df [ df . rating . isnull ()] How does pandas or numpy handle missing values when we try to compute with data sets that include them? We'll now check if any of the other suspicious columns have missing values. Let's look at year and review_count first. One thing you can do is to try and convert to the type you expect the column to be. If something goes wrong, it likely means your data are bad. Lets test for missing data: In [9]: df [ df . year . isnull ()] Cleaning: Dealing with Missing Values How should we interpret 'missing' or 'invalid' values in the data (hint: look at where these values occur)? One approach is to simply exclude them from the dataframe. Is this appropriate for all 'missing' or 'invalid' values? In [10]: #Treat the missing or invalid values in your dataframe ####### df = df [ df . year . notnull ()] Ok so we have done some cleaning. What do things look like now? Notice the float has not yet changed. In [11]: df . dtypes In [12]: print ( np . sum ( df . year . isnull ())) print ( np . sum ( df . rating_count . isnull ())) print ( np . sum ( df . review_count . isnull ())) # We removed seven rows df . shape Suspect observations for rating and rating_count were removed as well! Exercise Ok so lets fix those types. Convert them to ints. If the type conversion fails, we now know we have further problems. In [13]: # your code here Once you do this, we seem to be good on these columns (no errors in conversion). Lets look: In [14]: df . dtypes Sweet! Some of the other colums that should be strings have NaN. In [15]: df . loc [ df . genre_urls . isnull (), 'genre_urls' ] = \"\" df . loc [ df . isbn . isnull (), 'isbn' ] = \"\" Part 2: Parsing and Completing the Data Frame We will parse the author column from the author_url and genres column from the genre_urls. Keep the genres column as a string separated by '|'. We will use panda's map to assign new columns to the dataframe. Examine an example author_url and reason about which sequence of string operations must be performed in order to isolate the author's name. In [16]: #Get the first author_url test_string = df . author_url [ 0 ] test_string In [17]: #Test out some string operations to isolate the author name test_string . split ( '/' )[ - 1 ] . split ( '.' )[ 1 :][ 0 ] Exercise Lets wrap the above code into a function which we will then use In [18]: # Write a function that accepts an author url and returns the author's name based on your experimentation above def get_author ( url ): # your code here In [19]: #Apply the get_author function to the 'author_url' column using '.map' #and add a new column 'author' to store the names df [ 'author' ] = df . author_url . map ( get_author ) df . author [ 0 : 5 ] Exercise Now parse out the genres from genre_url . This is a little more complicated because there be more than one genre. In [20]: df . genre_urls . head () In [21]: # your code here Exercise Write a function that accepts a genre url and returns the genre name based on your experimentation above In [22]: def split_and_join_genres ( url ): # your code here Test your function In [23]: split_and_join_genres ( \"/genres/young-adult|/genres/science-fiction\" ) In [24]: split_and_join_genres ( \"\" ) Exercise Use map again to create a new \"genres\" column In [25]: df [ 'genres' ] = df . genre_urls . map ( split_and_join_genres ) df . head () Finally, let's pick an author at random so we can see the results of the transformations. Scroll to see the author and genre columns that we added to the dataframe. In [26]: df [ df . author == \"Marguerite_Yourcenar\" ] Let us delete the genre_urls column. In [27]: del df [ 'genre_urls' ] And then save the dataframe out! In [28]: df . to_csv ( \"data/cleaned-goodreads.csv\" , index = False , header = True ) Part 3: Grouping It appears that some books were written in negative years! Print out the observations that correspond to negative years. What do you notice about these books? In [29]: # your code here We can determine the \"best book\" by year! For this we use Pandas groupby. Groupby allows grouping a dataframe by any (usually categorical) variable. In [30]: dfgb_author = df . groupby ( 'author' ) type ( dfgb_author ) Perhaps we want the number of books each author wrote In [31]: dfgb_author . count () Lots of useless info there. One column should suffice In [32]: dfgb_author [ 'author' ] . count () Perhaps you want more detailed info... In [33]: dfgb_author [[ 'rating' , 'rating_count' , 'review_count' , 'year' ]] . describe () You can also access a groupby dictionary style. In [34]: ratingdict = {} for author , subset in dfgb_author : ratingdict [ author ] = ( subset [ 'rating' ] . mean (), subset [ 'rating' ] . std ()) ratingdict Exercise Lets get the best-rated book(s) for every year in our dataframe. In [35]: #Using .groupby, we can divide the dataframe into subsets by the values of 'year'. #We can then iterate over these subsets # your code here if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-2/pandas/student/"},{"title":"Lab 2: BeautifulSoup for Scraping - Solutions","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 2 Scraping Harvard University Summer 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructors: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh and Pavlos Protopaps In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING from IPython.core.display import HTML def css_styling (): styles = open ( \"../../styles/cs109.css\" , \"r\" ) . read () return HTML ( styles ) css_styling () Out[1]: h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [2]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn.apionly as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) /Users/eleni/anaconda2/envs/bunny/lib/python3.6/site-packages/seaborn/apionly.py:6: UserWarning: As seaborn no longer sets a default style on import, the seaborn.apionly module is deprecated. It will be removed in a future version. warnings.warn(msg, UserWarning) In [3]: import time , requests In this lab, we'll scrape Goodread's Best Books list: https://www.goodreads.com/list/show/1.Best_Books_Ever?page=1 . We'll walk through scraping the list pages for the book names/urls Table of Contents Learning Goals Exploring the Web pages and downloading them Parse the page, extract book urls Parse a book page, extract book properties Set up a pipeline for fetching and parsing Learning Goals Understand the structure of a web page. Use Beautiful soup to scrape content from these web pages. This lab corresponds to lectures 2, 3 and 4 and maps on to homework 1 and further. 1. Exploring the web pages and downloading them We're going to see the structure of Goodread's best books list. We'll use the Developer tools in chrome, safari and firefox have similar tools available To getch this page we use the requests module. But are we allowed to do this? Lets check: https://www.goodreads.com/robots.txt Yes we are. In [4]: URLSTART = \"https://www.goodreads.com\" BESTBOOKS = \"/list/show/1.Best_Books_Ever?page=\" url = URLSTART + BESTBOOKS + '1' print ( url ) page = requests . get ( url ) https://www.goodreads.com/list/show/1.Best_Books_Ever?page=1 We can see properties of the page. Most relevant are status_code and text . The former tells us if the web-page was found, and if found , ok. (See lecture notes.) In [5]: page . status_code # 200 is good Out[5]: 200 In [6]: page . text [: 5000 ] Out[6]: '\\n \\n\\n\\n \\n \\nBest Books Ever (54400 books)\\n\\n\\n\\n var ue_t0=window.ue_t0||+new Date();\\n \\n \\n (function(e){var c=e;var a=c.ue||{};a.main_scope=\"mainscopecsm\";a.q=[];a.t0=c.ue_t0||+new Date();a.d=g;function g(h){return +new Date()-(h?0:a.t0)}function d(h){return function(){a.q.push({n:h,a:arguments,t:a.d()})}}function b(m,l,h,j,i){var k={m:m,f:l,l:h,c:\"\"+j,err:i,fromOnError:1,args:arguments};c.ueLogError(k);return false}b.skipTrace=1;e.onerror=b;function f(){c.uex(\"ld\")}if(e.addEventListener){e.addEventListener(\"load\",f,false)}else{if(e.attachEvent){e.attachEvent(\"onload\",f)}}a.tag=d(\"tag\");a.log=d(\"log\");a.reset=d(\"rst\");c.ue_csm=c;c.ue=a;c.ueLogError=d(\"err\");c.ues=d(\"ues\");c.uet=d(\"uet\");c.uex=d(\"uex\");c.uet(\"ue\")})(window);(function(e,d){var a=e.ue||{};function c(g){if(!g){return}var f=d.head||d.getElementsByTagName(\"head\")[0]||d.documentElement,h=d.createElement(\"script\");h.async=\"async\";h.src=g;f.insertBefore(h,f.firstChild)}function b(){var k=e.ue_cdn||\"z-ecx.images-amazon.com\",g=e.ue_cdns||\"images-na.ssl-images-amazon.com\",j=\"/images/G/01/csminstrumentation/\",h=e.ue_file||\"ue-full-11e51f253e8ad9d145f4ed644b40f692._V1_.js\",f,i;if(h.indexOf(\"NSTRUMENTATION_FIL\")>=0){return}if(\"ue_https\" in e){f=e.ue_https}else{f=e.location&&e.location.protocol==\"https:\"?1:0}i=f?\"https://\":\"http://\";i+=f?g:k;i+=j;i+=h;c(i)}if(!e.ue_inline){if(a.loadUEFull){a.loadUEFull()}else{b()}}a.uels=c;e.ue=a})(window,document);\\n\\n if (window.ue && window.ue.tag) { window.ue.tag(\\'list:show:signed_out\\', ue.main_scope);window.ue.tag(\\'list:show:signed_out:desktop\\', ue.main_scope); }\\n \\n\\n\\n\\n \\n if (window.Mobvious === undefined) {\\n window.Mobvious = {};\\n }\\n window.Mobvious.device_type = \\'desktop\\';\\n \\n\\n\\n \\n \\n \\n//<![CDATA[\\n\\n WebFont.load({\\n classes: false,\\n custom: {\\n families: [\"Lato:n4,n7,i4\", \"Merriweather:n4,n7,i4\"],\\n urls: [\"https://s.gr-assets.com/assets/gr/fonts-e256f84093cc13b27f5b82343398031a.css\"]\\n }\\n });\\n\\n//]]>\\n \\n\\n \\n \\n \\n .bigTabs {\\n margin-bottom: 10px;\\n }\\n\\n .list_read{\\n background-color: #D7D2C4;\\n float: left;\\n }\\n \\n\\n\\n \\n\\n \\n\\n \\n \\n \\n\\n \\n \\n\\n \\n //<![CDATA[\\n var gptAdSlots = gptAdSlots || [];\\n var googletag = googletag || {};\\n googletag.cmd = googletag.cmd || [];\\n (function() {\\n var gads = document.createElement(\"script\");\\n gads.async = true;\\n gads.type = \"text/javascript\";\\n var useSSL = \"https:\" == document.location.protocol;\\n gads.src = (useSSL ? \"https:\" : \"http:\") +\\n \"//www.googletagservices.com/tag/js/gpt.js\";\\n var node = document.getElementsByTagName(\"script\")[0];\\n node.parentNode.insertBefore(gads, node);\\n })();\\n // page settings\\n //]]>\\n \\n \\n //<![CDATA[\\n googletag.cmd.push(function() {\\n googletag.pubads().setTargeting(\"sid\", \"osid.77da3382ab59401c0cd7edf0f2809352\");\\n googletag.pubads().setTargeting(\"grsession\", \"osid.77da3382ab59401c0cd7edf0f2809352\");\\n googletag.pubads().setTargeting(\"surface\", \"desktop\");\\n googletag.pubads().setTargeting(\"signedin\", \"false\");\\n googletag.pubads().setTargeting(\"gr_author\", \"false\");\\n googletag.pubads().setTargeting(\"author\", []);\\n googletag.pubads().setTargeting(\"shelf\", [\"best\",\"earliestlist\",\"favourites\",\"fiction\",\"writer\"]);\\n googletag.pubads().setTargeting(\"gtargeting\", \"1z141z5\");\\n googletag.pubads().setTargeting(\"resource\", \"List_1\");\\n googletag.pubads().enableAsyncRendering();\\n googletag.pubads().enableSingleRequest();\\n googletag.pubads().collapseEmptyDivs(true);\\n googletag.pubads().disableInitialLoad();\\n googletag.enableServices();\\n });\\n /'</pre> </div> </div> </div> </div> </div> <div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\"> </div><div class=\"inner_cell\"> <div class=\"text_cell_render border-box-sizing rendered_html\"> <p>Let us write a loop to fetch 2 pages of \"best-books\" from goodreads. Notice the use of a format string. This is an example of old-style python format strings</p> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [7]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"n\">URLSTART</span><span class=\"o\">=</span><span class=\"s2\">\"https://www.goodreads.com\"</span> <span class=\"n\">BESTBOOKS</span><span class=\"o\">=</span><span class=\"s2\">\"/list/show/1.Best_Books_Ever?page=\"</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">):</span> <span class=\"n\">bookpage</span><span class=\"o\">=</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span> <span class=\"n\">stuff</span><span class=\"o\">=</span><span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">URLSTART</span><span class=\"o\">+</span><span class=\"n\">BESTBOOKS</span><span class=\"o\">+</span><span class=\"n\">bookpage</span><span class=\"p\">)</span> <span class=\"n\">filetowrite</span><span class=\"o\">=</span><span class=\"s2\">\"files/page\"</span><span class=\"o\">+</span> <span class=\"s1\">'</span><span class=\"si\">%02d</span><span class=\"s1\">'</span> <span class=\"o\">%</span> <span class=\"n\">i</span> <span class=\"o\">+</span> <span class=\"s2\">\".html\"</span> <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"FTW\"</span><span class=\"p\">,</span> <span class=\"n\">filetowrite</span><span class=\"p\">)</span> <span class=\"n\">fd</span><span class=\"o\">=</span><span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"n\">filetowrite</span><span class=\"p\">,</span><span class=\"s2\">\"w\"</span><span class=\"p\">)</span> <span class=\"n\">fd</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"n\">stuff</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">)</span> <span class=\"n\">fd</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">sleep</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)</span> </pre></div> </div> </div> </div> <div class=\"output_wrapper\"> <div class=\"output\"> <div class=\"output_area\"> <div class=\"prompt\"></div> <div class=\"output_subarea output_stream output_stdout output_text\"> <pre>FTW files/page01.html FTW files/page02.html </pre> </div> </div> </div> </div> </div> <div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\"> </div><div class=\"inner_cell\"> <div class=\"text_cell_render border-box-sizing rendered_html\"> <h2 id=\"2.-Parse-the-page,-extract-book-urls\">2. Parse the page, extract book urls<a class=\"anchor-link\" href=\"#2.-Parse-the-page,-extract-book-urls\"> </a></h2><p>Notice how we do file input-output, and use beautiful soup in the code below. The <code>with</code> construct ensures that the file being read is closed, something we do explicitly for the file being written. We look for the elements with class <code>bookTitle</code>, extract the urls, and write them into a file</p> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [8]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">bs4</span> <span class=\"k\">import</span> <span class=\"n\">BeautifulSoup</span> </pre></div> </div> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [9]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"n\">bookdict</span><span class=\"o\">=</span><span class=\"p\">{}</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">):</span> <span class=\"n\">books</span><span class=\"o\">=</span><span class=\"p\">[]</span> <span class=\"n\">stri</span> <span class=\"o\">=</span> <span class=\"s1\">'</span><span class=\"si\">%02d</span><span class=\"s1\">'</span> <span class=\"o\">%</span> <span class=\"n\">i</span> <span class=\"n\">filetoread</span><span class=\"o\">=</span><span class=\"s2\">\"files/page\"</span><span class=\"o\">+</span> <span class=\"n\">stri</span> <span class=\"o\">+</span> <span class=\"s1\">'.html'</span> <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"FTW\"</span><span class=\"p\">,</span> <span class=\"n\">filetoread</span><span class=\"p\">)</span> <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"n\">filetoread</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">fdr</span><span class=\"p\">:</span> <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">fdr</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">()</span> <span class=\"n\">soup</span> <span class=\"o\">=</span> <span class=\"n\">BeautifulSoup</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"s1\">'html.parser'</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">e</span> <span class=\"ow\">in</span> <span class=\"n\">soup</span><span class=\"o\">.</span><span class=\"n\">select</span><span class=\"p\">(</span><span class=\"s1\">'.bookTitle'</span><span class=\"p\">):</span> <span class=\"n\">books</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">e</span><span class=\"p\">[</span><span class=\"s1\">'href'</span><span class=\"p\">])</span> <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">books</span><span class=\"p\">[:</span><span class=\"mi\">10</span><span class=\"p\">])</span> <span class=\"n\">bookdict</span><span class=\"p\">[</span><span class=\"n\">stri</span><span class=\"p\">]</span><span class=\"o\">=</span><span class=\"n\">books</span> <span class=\"n\">fd</span><span class=\"o\">=</span><span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">\"files/list\"</span><span class=\"o\">+</span><span class=\"n\">stri</span><span class=\"o\">+</span><span class=\"s2\">\".txt\"</span><span class=\"p\">,</span><span class=\"s2\">\"w\"</span><span class=\"p\">)</span> <span class=\"n\">fd</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">books</span><span class=\"p\">))</span> <span class=\"n\">fd</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span> </pre></div> </div> </div> </div> <div class=\"output_wrapper\"> <div class=\"output\"> <div class=\"output_area\"> <div class=\"prompt\"></div> <div class=\"output_subarea output_stream output_stdout output_text\"> <pre>FTW files/page01.html ['/book/show/2767052-the-hunger-games', '/book/show/2.Harry_Potter_and_the_Order_of_the_Phoenix', '/book/show/2657.To_Kill_a_Mockingbird', '/book/show/1885.Pride_and_Prejudice', '/book/show/41865.Twilight', '/book/show/19063.The_Book_Thief', '/book/show/11127.The_Chronicles_of_Narnia', '/book/show/7613.Animal_Farm', '/book/show/18405.Gone_with_the_Wind', '/book/show/30.J_R_R_Tolkien_4_Book_Boxed_Set'] FTW files/page02.html ['/book/show/5470.1984', '/book/show/4989.The_Red_Tent', '/book/show/37435.The_Secret_Life_of_Bees', '/book/show/5.Harry_Potter_and_the_Prisoner_of_Azkaban', '/book/show/7171637-clockwork-angel', '/book/show/2187.Middlesex', '/book/show/2623.Great_Expectations', '/book/show/24583.The_Adventures_of_Tom_Sawyer', '/book/show/49552.The_Stranger', '/book/show/16299.And_Then_There_Were_None'] </pre> </div> </div> </div> </div> </div> <div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\"> </div><div class=\"inner_cell\"> <div class=\"text_cell_render border-box-sizing rendered_html\"> <p>Here is George Orwell's 1984</p> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [10]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"n\">bookdict</span><span class=\"p\">[</span><span class=\"s1\">'02'</span><span class=\"p\">][</span><span class=\"mi\">0</span><span class=\"p\">]</span> </pre></div> </div> </div> </div> <div class=\"output_wrapper\"> <div class=\"output\"> <div class=\"output_area\"> <div class=\"prompt output_prompt\">Out[10]:</div> <div class=\"output_text output_subarea output_execute_result\"> <pre>'/book/show/5470.1984'</pre> </div> </div> </div> </div> </div> <div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\"> </div><div class=\"inner_cell\"> <div class=\"text_cell_render border-box-sizing rendered_html\"> <p>Lets go look at the first URLs on both pages</p> </div> </div> </div> <div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\"> </div><div class=\"inner_cell\"> <div class=\"text_cell_render border-box-sizing rendered_html\"> <p><img alt=\"\" src=\"images/goodreads2.png\"></p> </div> </div> </div> <div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\"> </div><div class=\"inner_cell\"> <div class=\"text_cell_render border-box-sizing rendered_html\"> <h2 id=\"3.-Parse-a-book-page,-extract-book-properties\">3. Parse a book page, extract book properties<a class=\"anchor-link\" href=\"#3.-Parse-a-book-page,-extract-book-properties\"> </a></h2><p>Ok so now lets dive in and get one of these these files and parse them.</p> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [11]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"n\">furl</span><span class=\"o\">=</span><span class=\"n\">URLSTART</span><span class=\"o\">+</span><span class=\"n\">bookdict</span><span class=\"p\">[</span><span class=\"s1\">'02'</span><span class=\"p\">][</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">furl</span> </pre></div> </div> </div> </div> <div class=\"output_wrapper\"> <div class=\"output\"> <div class=\"output_area\"> <div class=\"prompt output_prompt\">Out[11]:</div> <div class=\"output_text output_subarea output_execute_result\"> <pre>'https://www.goodreads.com/book/show/5470.1984'</pre> </div> </div> </div> </div> </div> <div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\"> </div><div class=\"inner_cell\"> <div class=\"text_cell_render border-box-sizing rendered_html\"> <p><img alt=\"\" src=\"images/goodreads3.png\"></p> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [12]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"n\">fstuff</span><span class=\"o\">=</span><span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">furl</span><span class=\"p\">)</span> <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">fstuff</span><span class=\"o\">.</span><span class=\"n\">status_code</span><span class=\"p\">)</span> </pre></div> </div> </div> </div> <div class=\"output_wrapper\"> <div class=\"output\"> <div class=\"output_area\"> <div class=\"prompt\"></div> <div class=\"output_subarea output_stream output_stdout output_text\"> <pre>200 </pre> </div> </div> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [13]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"n\">d</span><span class=\"o\">=</span><span class=\"n\">BeautifulSoup</span><span class=\"p\">(</span><span class=\"n\">fstuff</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"s1\">'html.parser'</span><span class=\"p\">)</span> </pre></div> </div> </div> </div> </div> <div class=\"cell border-box-sizing code_cell rendered\"> <div class=\"input\"> <div class=\"prompt input_prompt\">In [15]:</div> <div class=\"inner_cell\"> <div class=\"input_area\"> <div class=\"highlight hl-ipython3\"><pre><span></span><span class=\"n\">d</span><span class=\"o\">.</span><span class=\"n\">prettify</span><span class=\"p\">()</span> </pre></div> </div> </div> </div> <div class=\"output_wrapper\"> <div class=\"output\"> <div class=\"output_area\"> <div class=\"prompt output_prompt\">Out[15]:</div> <div class=\"output_text output_subarea output_execute_result\"> <pre>'<!DOCTYPE html>\\n<html class=\"desktop \">\\n <head prefix=\"og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# good_reads: http://ogp.me/ns/fb/good_reads#\">\\n <title>\\n 1984 by George Orwell\\n </title>\\n <script type=\"text/javascript\">\\n if (window.Mobvious === undefined) {\\n window.Mobvious = {};\\n }\\n window.Mobvious.device_type = \\'desktop\\';\\n \\n \\n \\n \\n //<![CDATA[\\n\\n WebFont.load({\\n classes: false,\\n custom: {\\n families: [\"Lato:n4,n7,i4\", \"Merriweather:n4,n7,i4\"],\\n urls: [\"https://s.gr-assets.com/assets/gr/fonts-e256f84093cc13b27f5b82343398031a.css\"]\\n }\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var gptAdSlots = gptAdSlots || [];\\n var googletag = googletag || {};\\n googletag.cmd = googletag.cmd || [];\\n (function() {\\n var gads = document.createElement(\"script\");\\n gads.async = true;\\n gads.type = \"text/javascript\";\\n var useSSL = \"https:\" == document.location.protocol;\\n gads.src = (useSSL ? \"https:\" : \"http:\") +\\n \"//www.googletagservices.com/tag/js/gpt.js\";\\n var node = document.getElementsByTagName(\"script\")[0];\\n node.parentNode.insertBefore(gads, node);\\n })();\\n // page settings\\n //]]>\\n \\n \\n //<![CDATA[\\n googletag.cmd.push(function() {\\n googletag.pubads().setTargeting(\"sid\", \"osid.8ea0b2007cce9af0d1e774f1ac2e07b6\");\\n googletag.pubads().setTargeting(\"grsession\", \"osid.8ea0b2007cce9af0d1e774f1ac2e07b6\");\\n googletag.pubads().setTargeting(\"surface\", \"desktop\");\\n googletag.pubads().setTargeting(\"signedin\", \"false\");\\n googletag.pubads().setTargeting(\"gr_author\", \"false\");\\n googletag.pubads().setTargeting(\"author\", [3706]);\\n googletag.pubads().setTargeting(\"shelf\", [\"classics\",\"fiction\",\"sciencefiction\",\"dystopia\"]);\\n googletag.pubads().setTargeting(\"gtargeting\", \"s46us64h\");\\n googletag.pubads().setTargeting(\"resource\", \"Work_153313\");\\n googletag.pubads().enableAsyncRendering();\\n googletag.pubads().enableSingleRequest();\\n googletag.pubads().collapseEmptyDivs(true);\\n googletag.pubads().disableInitialLoad();\\n googletag.enableServices();\\n });\\n //]]>\\n \\n \\n //<![CDATA[\\n ! function(a9, a, p, s, t, A, g) {\\n if (a[a9]) return;\\n \\n function q(c, r) {\\n a[a9]._Q.push([c, r])\\n }\\n a[a9] = {\\n init: function() {\\n q(\"i\", arguments)\\n },\\n fetchBids: function() {\\n q(\"f\", arguments)\\n },\\n setDisplayBids: function() {},\\n _Q: []\\n };\\n A = p.createElement(s);\\n A.async = !0;\\n A.src = t;\\n g = p.getElementsByTagName(s)[0];\\n g.parentNode.insertBefore(A, g)\\n }(\"apstag\", window, document, \"script\", \"//c.amazon-adsystem.com/aax2/apstag.js\");\\n \\n apstag.init({\\n pubID: \\'3211\\', adServer: \\'googletag\\', bidTimeout: 4e3\\n });\\n //]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n !function(d,s,id)\\n {var js, fjs = d.getElementsByTagName(s)[0];\\n if(!d.getElementById(id))\\n {js=d.createElement(s);\\n js.id=id;\\n js.src=\\'https://platform.twitter.com/widgets.js\\';\\n fjs.parentNode.insertBefore(js,fjs);\\n }}(document,\\'script\\',\\'twitter-wjs\\');\\n //]]>\\n \\n \\n \\n //<![CDATA[\\n\\n var GoodreadsAnalytics = GoodreadsAnalytics || {};\\n var _gaq = _gaq || [];\\n\\n GoodreadsAnalytics.push = function () {\\n _gaq.push.apply(_gaq, arguments);\\n }\\n\\n GoodreadsAnalytics.push([\\'_setAccount\\', \\'UA-968618-1\\']);\\n GoodreadsAnalytics.push([\\'_setCustomVar\\',\\n 1, // Slot 1\\n \\'User Status\\', // Custom variable name\\n \\'signed_out\\', // Custom variable value: signed_out, signed_in,\\n // signed_in_facebook_connected, or\\n // goodreads_member_previously_signed_in\\n 2 // Visit-level scope, which means slot 1 will be\\n // free when the visit ends.\\n ]);\\n GoodreadsAnalytics.push([\\'_setCustomVar\\',\\n 2, // Slot 2\\n \\'Device Type\\', // Custom variable name\\n \\'desktop\\', // Custom variable value: desktop, mobile, or\\n // tablet\\n 2 // Visit-level scope, which means slot 2 will be\\n // free when the visit ends.\\n ]);\\n GoodreadsAnalytics.push([\\'_trackPageview\\']);\\n\\n (function () {\\n var ga = document.createElement(\\'script\\');\\n ga.type = \\'text/javascript\\';\\n ga.async = true;\\n ga.src = (\\'https:\\' == document.location.protocol ? \\'https://\\' : \\'http://\\') + \\'stats.g.doubleclick.net/dc.js\\';\\n var s = document.getElementsByTagName(\\'script\\')[0];\\n s.parentNode.insertBefore(ga, s);\\n })();\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\nReactStores.GoogleAdsStore.initializeWith({\"targeting\":{\"sid\":\"osid.8ea0b2007cce9af0d1e774f1ac2e07b6\",\"grsession\":\"osid.8ea0b2007cce9af0d1e774f1ac2e07b6\",\"surface\":\"desktop\",\"signedin\":\"false\",\"gr_author\":\"false\",\"author\":[3706],\"shelf\":[\"classics\",\"fiction\",\"sciencefiction\",\"dystopia\"],\"gtargeting\":\"s46us64h\",\"resource\":\"Work_153313\"},\"ads\":{\"div-gpt-ad-goodr-book-top-970x66\":{\"isNativeAd\":false,\"hasCreative\":false,\"hasRequestedCreative\":false,\"path\":\"/4215/goodr.book.top.970x66\",\"dimensions\":[\"970x66\",\"970x90\",\"970x250\"],\"adSizeMapping\":null,\"adDeviceType\":\"desktop\",\"pmetImpressionTrackUrl\":\"https://www.goodreads.com/dfp/impression\",\"pmetClickTrackUrl\":\"https://www.goodreads.com/dfp/click\",\"creativeSelector\":\"div#google_image_div\",\"isLazyLoaded\":false},\"div-gpt-ad-goodr-book-top-300x250\":{\"isNativeAd\":false,\"hasCreative\":false,\"hasRequestedCreative\":false,\"path\":\"/4215/goodr.book.top.300x250\",\"dimensions\":\"300x250\",\"adSizeMapping\":null,\"adDeviceType\":\"desktop\",\"pmetImpressionTrackUrl\":\"https://www.goodreads.com/dfp/impression\",\"pmetClickTrackUrl\":\"https://www.goodreads.com/dfp/click\",\"creativeSelector\":\"div#google_image_div\",\"isLazyLoaded\":false},\"div-gpt-ad-goodr-book-cb-300x250\":{\"isNativeAd\":false,\"hasCreative\":false,\"hasRequestedCreative\":false,\"path\":\"/4215/goodr.book.cb.300x250\",\"dimensions\":[\"300x250\",\"2x1\"],\"adSizeMapping\":null,\"adDeviceType\":\"desktop\",\"pmetImpressionTrackUrl\":\"https://www.goodreads.com/dfp/impression\",\"pmetClickTrackUrl\":\"https://www.goodreads.com/dfp/click\",\"creativeSelector\":\"div#google_image_div\",\"isLazyLoaded\":false},\"div-gpt-ad-goodr-book-bottom-300x250\":{\"isNativeAd\":false,\"hasCreative\":false,\"hasRequestedCreative\":false,\"path\":\"/4215/goodr.book.bottom.300x250\",\"dimensions\":[\"300x250\",\"3x1\"],\"adSizeMapping\":null,\"adDeviceType\":\"desktop\",\"pmetImpressionTrackUrl\":\"https://www.goodreads.com/dfp/impression\",\"pmetClickTrackUrl\":\"https://www.goodreads.com/dfp/click\",\"creativeSelector\":\"div#google_image_div\",\"isLazyLoaded\":false}},\"nativeAds\":{},\"polls\":{}});ReactStores.UserShelvesStore.initializeWith({\"defaultShelves\":[{\"name\":\"read\",\"url\":\"\",\"displayName\":\"Read\",\"bookCount\":0},{\"name\":\"currently-reading\",\"url\":\"\",\"displayName\":\"Currently Reading\",\"bookCount\":0},{\"name\":\"to-read\",\"url\":\"\",\"displayName\":\"Want to Read\",\"bookCount\":0}],\"customExclusiveShelves\":[],\"nonExclusiveShelves\":[]});\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n // Load Facebook JS SDK\\n $grfb.initialize({\\n appId: \"2415071772\",\\n grSession: false,\\n serverFBUser: \"null\",\\n suppressAutoLogin: \"false\"\\n });\\n //]]>\\n \\n \\n \\n //<![CDATA[\\n ReactStores.NotificationsStore.updateWith({});\\n ReactStores.CurrentUserStore.initializeWith({\"currentUser\":null});\\n ReactStores.FavoriteGenresStore.updateWith({\"allGenres\":[{\"name\":\"Art\",\"url\":\"/genres/art\"},{\"name\":\"Biography\",\"url\":\"/genres/biography\"},{\"name\":\"Business\",\"url\":\"/genres/business\"},{\"name\":\"Children\\'s\",\"url\":\"/genres/children-s\"},{\"name\":\"Christian\",\"url\":\"/genres/christian\"},{\"name\":\"Classics\",\"url\":\"/genres/classics\"},{\"name\":\"Comics\",\"url\":\"/genres/comics\"},{\"name\":\"Cookbooks\",\"url\":\"/genres/cookbooks\"},{\"name\":\"Ebooks\",\"url\":\"/genres/ebooks\"},{\"name\":\"Fantasy\",\"url\":\"/genres/fantasy\"},{\"name\":\"Fiction\",\"url\":\"/genres/fiction\"},{\"name\":\"Graphic Novels\",\"url\":\"/genres/graphic-novels\"},{\"name\":\"Historical Fiction\",\"url\":\"/genres/historical-fiction\"},{\"name\":\"History\",\"url\":\"/genres/history\"},{\"name\":\"Horror\",\"url\":\"/genres/horror\"},{\"name\":\"Memoir\",\"url\":\"/genres/memoir\"},{\"name\":\"Music\",\"url\":\"/genres/music\"},{\"name\":\"Mystery\",\"url\":\"/genres/mystery\"},{\"name\":\"Nonfiction\",\"url\":\"/genres/non-fiction\"},{\"name\":\"Poetry\",\"url\":\"/genres/poetry\"},{\"name\":\"Psychology\",\"url\":\"/genres/psychology\"},{\"name\":\"Romance\",\"url\":\"/genres/romance\"},{\"name\":\"Science\",\"url\":\"/genres/science\"},{\"name\":\"Science Fiction\",\"url\":\"/genres/science-fiction\"},{\"name\":\"Self Help\",\"url\":\"/genres/self-help\"},{\"name\":\"Sports\",\"url\":\"/genres/sports\"},{\"name\":\"Thriller\",\"url\":\"/genres/thriller\"},{\"name\":\"Travel\",\"url\":\"/genres/travel\"},{\"name\":\"Young Adult\",\"url\":\"/genres/young-adult\"}],\"favoriteGenres\":[],\"sponsoredGenres\":[{\"name\":\"Audiobooks\",\"url\":\"/genres/audiobooks\"}],\"adId\":\"div-gpt-ad-goodr-nav-browse-400x300\"});\\n ReactStores.TabsStore.updateWith({\"communitySpotlight\":\"groups\"});\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Home\\n \\n \\n \\n \\n My Books\\n \\n \\n \\n \\n \\n \\n Browse ▾\\n \\n \\n \\n \\n \\n \\n \\n Recommendations\\n \\n \\n \\n \\n Choice Awards\\n \\n \\n \\n \\n Genres\\n \\n \\n \\n \\n Giveaways\\n \\n \\n \\n \\n New Releases\\n \\n \\n \\n \\n Lists\\n \\n \\n \\n \\n News & Interviews\\n \\n \\n \\n \\n Explore\\n \\n \\n \\n \\n Blog\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Listen with Audible\\n \\n \\n \\n \\n \\n \\n \\n \\n Sponsored\\n \\n \\n \\n \\n \\n \\n Genres\\n \\n \\n \\n \\n Art\\n \\n \\n \\n \\n Biography\\n \\n \\n \\n \\n Business\\n \\n \\n \\n \\n Children\\'s\\n \\n \\n \\n \\n Christian\\n \\n \\n \\n \\n Classics\\n \\n \\n \\n \\n Comics\\n \\n \\n \\n \\n Cookbooks\\n \\n \\n \\n \\n Ebooks\\n \\n \\n \\n \\n Fantasy\\n \\n \\n \\n \\n \\n \\n Fiction\\n \\n \\n \\n \\n Graphic Novels\\n \\n \\n \\n \\n Historical Fiction\\n \\n \\n \\n \\n History\\n \\n \\n \\n \\n Horror\\n \\n \\n \\n \\n Memoir\\n \\n \\n \\n \\n Music\\n \\n \\n \\n \\n Mystery\\n \\n \\n \\n \\n Nonfiction\\n \\n \\n \\n \\n Poetry\\n \\n \\n \\n \\n \\n \\n Psychology\\n \\n \\n \\n \\n Romance\\n \\n \\n \\n \\n Science\\n \\n \\n \\n \\n Science Fiction\\n \\n \\n \\n \\n Self Help\\n \\n \\n \\n \\n Sports\\n \\n \\n \\n \\n Thriller\\n \\n \\n \\n \\n Travel\\n \\n \\n \\n \\n Young Adult\\n \\n \\n \\n \\n More Genres\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Community ▾\\n \\n \\n \\n \\n \\n \\n Groups\\n \\n \\n \\n \\n Discussions\\n \\n \\n \\n \\n Quotes\\n \\n \\n \\n \\n Ask the Author\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Sign In\\n \\n \\n \\n \\n Join\\n \\n \\n \\n \\n \\n Sign up\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n View profile\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Profile\\n \\n \\n \\n \\n \\n Friends\\n \\n \\n \\n \\n \\n \\n Groups\\n \\n \\n \\n \\n \\n \\n Discussions\\n \\n \\n \\n \\n Comments\\n \\n \\n \\n \\n Reading Challenge\\n \\n \\n \\n \\n Kindle Notes & Highlights\\n \\n \\n \\n \\n Quotes\\n \\n \\n \\n \\n Favorite genres\\n \\n \\n \\n \\n \\n \\n Friends' recommendations\\n \\n \\n \\n \\n \\n \\n Account settings\\n \\n \\n \\n \\n Help\\n \\n \\n \\n \\n Sign out\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Home\\n \\n \\n \\n \\n My Books\\n \\n \\n \\n \\n \\n \\n Browse ▾\\n \\n \\n \\n \\n \\n \\n \\n Recommendations\\n \\n \\n \\n \\n Choice Awards\\n \\n \\n \\n \\n Genres\\n \\n \\n \\n \\n Giveaways\\n \\n \\n \\n \\n New Releases\\n \\n \\n \\n \\n Lists\\n \\n \\n \\n \\n News & Interviews\\n \\n \\n \\n \\n Explore\\n \\n \\n \\n \\n Blog\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Listen with Audible\\n \\n \\n \\n \\n \\n \\n \\n \\n Sponsored\\n \\n \\n \\n \\n \\n \\n Genres\\n \\n \\n \\n \\n Art\\n \\n \\n \\n \\n Biography\\n \\n \\n \\n \\n Business\\n \\n \\n \\n \\n Children\\'s\\n \\n \\n \\n \\n Christian\\n \\n \\n \\n \\n Classics\\n \\n \\n \\n \\n Comics\\n \\n \\n \\n \\n Cookbooks\\n \\n \\n \\n \\n Ebooks\\n \\n \\n \\n \\n Fantasy\\n \\n \\n \\n \\n \\n \\n Fiction\\n \\n \\n \\n \\n Graphic Novels\\n \\n \\n \\n \\n Historical Fiction\\n \\n \\n \\n \\n History\\n \\n \\n \\n \\n Horror\\n \\n \\n \\n \\n Memoir\\n \\n \\n \\n \\n Music\\n \\n \\n \\n \\n Mystery\\n \\n \\n \\n \\n Nonfiction\\n \\n \\n \\n \\n Poetry\\n \\n \\n \\n \\n \\n \\n Psychology\\n \\n \\n \\n \\n Romance\\n \\n \\n \\n \\n Science\\n \\n \\n \\n \\n Science Fiction\\n \\n \\n \\n \\n Self Help\\n \\n \\n \\n \\n Sports\\n \\n \\n \\n \\n Thriller\\n \\n \\n \\n \\n Travel\\n \\n \\n \\n \\n Young Adult\\n \\n \\n \\n \\n More Genres\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Community ▾\\n \\n \\n \\n \\n \\n \\n Groups\\n \\n \\n \\n \\n Discussions\\n \\n \\n \\n \\n Quotes\\n \\n \\n \\n \\n Ask the Author\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n ReactRailsUJS.mountComponents();\\n //]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Goodreads helps you keep track of books you want to read.\\n \\n \\n Start by marking \"1984\" as Want to Read:\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Want to Read\\n \\n \\n saving…\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Want to Read\\n \\n \\n \\n \\n \\n \\n \\n Currently Reading\\n \\n \\n \\n \\n \\n \\n \\n Read\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Other editions\\n \\n \\n \\n \\n \\n Enlarge cover\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Want to Read\\n \\n \\n saving…\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Error rating book. Refresh and try again.\\n \\n \\n Rate this book\\n \\n \\n Clear rating\\n \\n \\n \\n 1 of 5 stars\\n \\n \\n 2 of 5 stars\\n \\n \\n 3 of 5 stars\\n \\n \\n 4 of 5 stars\\n \\n \\n 5 of 5 stars\\n \\n \\n \\n \\n \\n \\n Open Preview\\n \\n \\n \\n \\n See a Problem?\\n \\n \\n \\n We'd love your help.\\n Let us know what's wrong with this preview of\\n \\n 1984\\n \\n by George Orwell.\\n \\n \\n \\n \\n \\n Problem:\\n \\n \\n \\n It's the wrong book\\n \\n \\n It's the wrong edition\\n \\n \\n Other\\n \\n \\n \\n \\n \\n \\n Details (if other):\\n \\n \\n \\n \\n \\n \\n Cancel\\n \\n \\n \\n \\n \\n \\n \\n Thanks for telling us about the problem.\\n \\n \\n Return to Book Page\\n \\n \\n \\n \\n \\n Not the book you're looking for?\\n \\n \\n Preview —\\n \\n 1984\\n \\n by George Orwell\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n 1984\\n \\n \\n \\n \\n \\n by\\n \\n \\n \\n \\n \\n George Orwell\\n \\n \\n ,\\n \\n \\n \\n \\n Erich Fromm\\n \\n \\n \\n (Afterword)\\n \\n \\n \\n \\n \\n \\n \\n 1984\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n 4.16\\n \\n \\n \\n ·\\n \\n \\n Rating details\\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'rating_details\\'), \"\\\\n <div id=\\\\\"moreBookData\\\\\" class=\\\\\"bookMeta\\\\\" >\\\\n \\\\n\\\\n \\\\n\\\\n<table border=\\\\\"0\\\\\" id=\\\\\"rating_distribution\\\\\" style=\\\\\"width: auto; max-width: 500px;\\\\\" cellspacing=\\\\\"5\\\\\" cellpadding=\\\\\"0\\\\\">\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">5&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <div style=\\\\\"display: block; background-color: #215625; width: 100%;\\\\\" title=\\\\\"1103055 ratings\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/div>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 45% (1103055)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">4&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <div style=\\\\\"display: block; background-color: #215625; width: 72%;\\\\\" title=\\\\\"800381 ratings\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/div>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 33% (800381)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">3&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <div style=\\\\\"display: block; background-color: #215625; width: 33%;\\\\\" title=\\\\\"366488 ratings\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/div>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 15% (366488)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">2&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <div style=\\\\\"display: block; background-color: #215625; width: 8%;\\\\\" title=\\\\\"97723 ratings\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/div>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 4% (97723)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">1&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <div style=\\\\\"display: block; background-color: #215625; width: 4%;\\\\\" title=\\\\\"48905 ratings\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/div>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 2% (48905)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n\\\\n<\\\\/table>\\\\n\\\\n\\\\n <span class=\\\\\"value\\\\\">94<\\\\/span>% of people liked it\\\\n\\\\n <table>\\\\n <tr>\\\\n <td><strong>All editions:<\\\\/strong><\\\\/td>\\\\n <td>\\\\n <span class=\\\\\"value\\\\\">4.16<\\\\/span> average rating,\\\\n <span class=\\\\\"value\\\\\">2416552<\\\\/span> ratings,\\\\n <span class=\\\\\"value\\\\\">53688<\\\\/span> reviews,\\\\n added by <span class=\\\\\"value\\\\\">3573900<\\\\/span> people,\\\\n <span class=\\\\\"value\\\\\">905234<\\\\/span> to-reads\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n\\\\n <tr>\\\\n <td><strong>This edition:<\\\\/strong><\\\\/td>\\\\n <td>\\\\n <span class=\\\\\"value\\\\\">4.15<\\\\/span> average rating,\\\\n <span class=\\\\\"value\\\\\">2236849<\\\\/span> ratings,\\\\n <span class=\\\\\"value\\\\\">42208<\\\\/span> reviews,\\\\n added by <span class=\\\\\"value\\\\\">3253571<\\\\/span> people\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <\\\\/table>\\\\n<\\\\/div>\\\\n\\\\n\", { style: \\'goodreads\\', stem: \\'topMiddle\\', hook: { tip: \\'topMiddle\\', target: \\'bottomMiddle\\' }, offset: { x: 5, y: 5 }, hideOn: \\'click\\', showOn: \\'click\\', closeButton: true, title: \\'Rating details\\' });\\n $(\\'rating_details\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n $(\\'rating_details\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n ·\\n \\n \\n \\n \\n 2,416,552\\n \\n Ratings\\n \\n \\n ·\\n \\n \\n \\n 53,688\\n \\n Reviews\\n \\n \\n \\n \\n \\n Among the seminal texts of the 20th century,\\n \\n Nineteen Eighty-Four\\n \\n is a rare work that grows more haunting as its futuristic purgatory becomes more real. Published in 1949, the book offers political satirist George Orwell\\'s nightmare vision of a totalitarian, bureaucratic world and one poor stiff\\'s attempt to find individuality. The brilliance of the novel is Orwell\\'s presc\\n \\n \\n Among the seminal texts of the 20th century,\\n \\n Nineteen Eighty-Four\\n \\n is a rare work that grows more haunting as its futuristic purgatory becomes more real. Published in 1949, the book offers political satirist George Orwell\\'s nightmare vision of a totalitarian, bureaucratic world and one poor stiff\\'s attempt to find individuality. The brilliance of the novel is Orwell\\'s prescience of modern life--the ubiquity of television, the distortion of the language--and his ability to construct such a thorough version of hell. Required reading for students since it was published, it ranks among the most terrifying novels ever written.\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n Get A Copy\\n \\n \\n \\n \\n \\n Kindle Store\\n \\n \\n \\n \\n Amazon\\n \\n \\n \\n \\n \\n Online Stores\\xa0▾\\n \\n \\n \\n Audible\\n \\n \\n \\n Barnes & Noble\\n \\n \\n \\n Kobo\\n \\n \\n \\n Apple iBooks\\n \\n \\n \\n Google Play\\n \\n \\n \\n Abebooks\\n \\n \\n \\n Book Depository\\n \\n \\n \\n Indigo\\n \\n \\n \\n Alibris\\n \\n \\n \\n Better World Books\\n \\n \\n \\n IndieBound\\n \\n \\n \\n \\n \\n \\n Libraries\\n \\n \\n \\n \\n \\n \\n Or buy for\\n \\n \\n \\n \\n \\n \\n \\n Mass Market Paperback\\n \\n ,\\n \\n Signet Classics\\n \\n ,\\n \\n 328 pages\\n \\n \\n \\n Published\\n July 1st 1950\\n by New American Library\\n \\n (first published June 8th 1949)\\n \\n \\n \\n \\n More Details...\\n \\n \\n \\n \\n Original Title\\n \\n \\n Nineteen Eighty-Four\\n \\n \\n \\n \\n ISBN\\n \\n \\n 0451524934\\n \\n (ISBN13:\\n \\n 9780451524935\\n \\n )\\n \\n \\n \\n \\n \\n Edition Language\\n \\n \\n English\\n \\n \\n \\n \\n Characters\\n \\n \\n \\n Winston Smith\\n \\n ,\\n \\n Big Brother\\n \\n ,\\n \\n O\\'Brien\\n \\n ,\\n \\n Emmanuel Goldstein\\n \\n ,\\n \\n Tom Parsons\\n \\n \\n \\n ...more\\n \\n \\n \\n ,\\n \\n Syme\\n \\n ,\\n \\n Julia\\n \\n \\n \\n ...less\\n \\n \\n \\n \\n \\n \\n setting\\n \\n \\n \\n London, England\\n \\n ,\\n1984\\n \\n \\n Oceania, South Pacific Ocean\\n \\n \\n \\n \\n \\n \\n Literary Awards\\n \\n \\n \\n Prometheus Hall of Fame Award (1984)\\n \\n ,\\n \\n Locus Award Nominee for All-Time Best Science Fiction Novel (1987)\\n \\n \\n \\n \\n \\n \\n \\n \\n Other Editions (1228)\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'edition_40961427\\'), \"<div class=\\\\\\'editionTitle\\\\\\'>\\\\n1984 (Kindle Edition) \\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nasin: B003JTHWKU\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nformat: Kindle Edition\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nPublished\\\\nSeptember 3rd 2013\\\\nby Houghton Mifflin Harcourt\\\\n<\\\\/div>\\\\n<div class=\\\\\\'enlargeCover\\\\\\' id=\\\\\\'edition_40961427_enlarge\\\\\\'>\\\\n<a>\\\\nEnlarge cover\\\\n<\\\\/a>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionCover\\\\\\' id=\\\\\\'edition_40961427_enlarge_cover\\\\\\' style=\\\\\\'display: none;\\\\\\'>\\\\n<img src=\\\\\"https://images.gr-assets.com/books/1532714506l/40961427.jpg\\\\\" alt=\\\\\"40961427\\\\\" />\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionAction\\\\\\'>\\\\n<div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'3_book_40961427\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"6UNy+cVWd8zZtNeA9MlP/iZkyMcqPnEpJH+Jiox5134XBMo0Xv6brci7UIUkKnCyT9LufKUUQEiqNSmBAwOpCA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"40961427\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"3_book_40961427\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"zop0N503mP3XEvcNTbddlXBve3JMZBPvgoe5H/BrDQcwzcz6Bp90nMYdcAidVGLZGdldycNOIo4MzRkUfxFzcQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"3_book_40961427\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"40961427\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"40961427\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/40961427?stars_click=true&wtr_button_id=3_book_40961427\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n<\\\\/div>\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'bottomMiddle\\', hook: { tip: \\'bottomMiddle\\', target: \\'topMiddle\\' }, offset: { y: -3, x: 0 }, hideOn: false, width: 325, hideAfter: 0.05 });\\n $(\\'edition_40961427\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'edition_40961427\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'edition_40961427\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'edition_40961427\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'edition_9577857\\'), \"<div class=\\\\\\'editionTitle\\\\\\'>\\\\n1984 (Kindle Edition) \\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nformat: Kindle Edition\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nPublished\\\\nSeptember 3rd 2013\\\\nby Houghton Mifflin Harcourt\\\\n<\\\\/div>\\\\n<div class=\\\\\\'enlargeCover\\\\\\' id=\\\\\\'edition_9577857_enlarge\\\\\\'>\\\\n<a>\\\\nEnlarge cover\\\\n<\\\\/a>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionCover\\\\\\' id=\\\\\\'edition_9577857_enlarge_cover\\\\\\' style=\\\\\\'display: none;\\\\\\'>\\\\n<img src=\\\\\"https://images.gr-assets.com/books/1504611957l/9577857.jpg\\\\\" alt=\\\\\"9577857\\\\\" />\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionAction\\\\\\'>\\\\n<div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'4_book_9577857\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"6oqn/QJbe0ruyLhudkUQrxrL/4921S7F91Ca5GVCiFUUzR8wmfOXK//HP2umpi/jc33ZNPn/H6R5Gjrv6jj2Iw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"9577857\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"4_book_9577857\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"m8LkHeFknlbhq3BkRY3pitYCB2klccU8LAF331I5dO1lhVzQesxyN/Ck92GVbtbGv7Qh0qpb9F2iS9fU3UMKmw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"4_book_9577857\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"9577857\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"9577857\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/9577857?stars_click=true&wtr_button_id=4_book_9577857\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n<\\\\/div>\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'bottomMiddle\\', hook: { tip: \\'bottomMiddle\\', target: \\'topMiddle\\' }, offset: { y: -3, x: 0 }, hideOn: false, width: 325, hideAfter: 0.05 });\\n $(\\'edition_9577857\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'edition_9577857\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'edition_9577857\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'edition_9577857\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'edition_3744438\\'), \"<div class=\\\\\\'editionTitle\\\\\\'>\\\\n1984 (Paperback) \\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nisbn: 0141036141\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nisbn13: 9780141036144\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nformat: Paperback\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nPublished\\\\nJuly 3rd 2008\\\\nby Penguin Books\\\\n<\\\\/div>\\\\n<div class=\\\\\\'enlargeCover\\\\\\' id=\\\\\\'edition_3744438_enlarge\\\\\\'>\\\\n<a>\\\\nEnlarge cover\\\\n<\\\\/a>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionCover\\\\\\' id=\\\\\\'edition_3744438_enlarge_cover\\\\\\' style=\\\\\\'display: none;\\\\\\'>\\\\n<img src=\\\\\"https://images.gr-assets.com/books/1327144697l/3744438.jpg\\\\\" alt=\\\\\"3744438\\\\\" />\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionAction\\\\\\'>\\\\n<div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'5_book_3744438\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"XJ/hTLZsqkEcSYB6TAJXQLC8bY6Hkvo6TpMawVF3QEKi2FmBLcRGIA1GB3+c4WgM2QpLNQi4y1vA2brK3g0+NA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"3744438\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"5_book_3744438\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"qGwWp5DhIg1JZNXQz9HmJa1s9ttOqLuTkRL9pzPPJ2pWK65qC0nObFhrUtUfMtlpxNrQYMGCivIfWF2svLVZHA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"5_book_3744438\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"3744438\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"3744438\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/3744438?stars_click=true&wtr_button_id=5_book_3744438\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n<\\\\/div>\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'bottomMiddle\\', hook: { tip: \\'bottomMiddle\\', target: \\'topMiddle\\' }, offset: { y: -3, x: 0 }, hideOn: false, width: 325, hideAfter: 0.05 });\\n $(\\'edition_3744438\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'edition_3744438\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'edition_3744438\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'edition_3744438\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'edition_5471\\'), \"<div class=\\\\\\'editionTitle\\\\\\'>\\\\nNineteen Eighty-Four (Paperback) \\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nisbn: 0452284236\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nisbn13: 9780452284234\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nformat: Paperback\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nPublished\\\\nMay 6th 2003\\\\nby Plume\\\\n<\\\\/div>\\\\n<div class=\\\\\\'enlargeCover\\\\\\' id=\\\\\\'edition_5471_enlarge\\\\\\'>\\\\n<a>\\\\nEnlarge cover\\\\n<\\\\/a>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionCover\\\\\\' id=\\\\\\'edition_5471_enlarge_cover\\\\\\' style=\\\\\\'display: none;\\\\\\'>\\\\n<img src=\\\\\"https://images.gr-assets.com/books/1327892247l/5471.jpg\\\\\" alt=\\\\\"5471\\\\\" />\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionAction\\\\\\'>\\\\n<div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'6_book_5471\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"XAolAhglmHj7mjynotGWgHW6noNOozzbixqaHRhZKTuiTZ3Pg410GeqVu6JyMqnMHAy4OMGJDboFUDoWlyNXTQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"5471\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"6_book_5471\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"/DTcwyCvZco5jlVF5Q1u9z3EvLYPDiyuhMmu5fuGpVQCc2QOuweJqyiB0kA17lG7VHKaDYAkHc8Kgw7udPzbIg==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"6_book_5471\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"5471\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"5471\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/5471?stars_click=true&wtr_button_id=6_book_5471\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n<\\\\/div>\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'bottomMiddle\\', hook: { tip: \\'bottomMiddle\\', target: \\'topMiddle\\' }, offset: { y: -3, x: 0 }, hideOn: false, width: 325, hideAfter: 0.05 });\\n $(\\'edition_5471\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'edition_5471\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'edition_5471\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'edition_5471\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'edition_16282204\\'), \"<div class=\\\\\\'editionTitle\\\\\\'>\\\\n1984 (Paperback) \\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nisbn: 9953681449\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nisbn13: 9789953681443\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nformat: Paperback\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionInfo\\\\\\'>\\\\nPublished\\\\nJune 1st 2006\\\\nby المركز الثقافي العربي\\\\n<\\\\/div>\\\\n<div class=\\\\\\'enlargeCover\\\\\\' id=\\\\\\'edition_16282204_enlarge\\\\\\'>\\\\n<a>\\\\nEnlarge cover\\\\n<\\\\/a>\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionCover\\\\\\' id=\\\\\\'edition_16282204_enlarge_cover\\\\\\' style=\\\\\\'display: none;\\\\\\'>\\\\n<img src=\\\\\"https://images.gr-assets.com/books/1362298987l/16282204.jpg\\\\\" alt=\\\\\"16282204\\\\\" />\\\\n<\\\\/div>\\\\n<div class=\\\\\\'editionAction\\\\\\'>\\\\n<div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'7_book_16282204\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"b3RAm2N3jhAQfz/pNJ3Z9AH+ZGrazVGVAD57BBcvsXWRM/hW+N9icQFwuOzkfua4aEhC0VXnYPSOdNsPmFXPAw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"16282204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"7_book_16282204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"JeBUL0YmDyLx85hGxl3bOecouw52X1C4bXK/K0SYxOzbp+zi3Y7jQ+D8H0MWvuR1jp6dtfl1YdnjOB8gy+K6mg==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"7_book_16282204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"16282204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"16282204\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/16282204?stars_click=true&wtr_button_id=7_book_16282204\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n<\\\\/div>\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'bottomMiddle\\', hook: { tip: \\'bottomMiddle\\', target: \\'topMiddle\\' }, offset: { y: -3, x: 0 }, hideOn: false, width: 325, hideAfter: 0.05 });\\n $(\\'edition_16282204\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'edition_16282204\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'edition_16282204\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'edition_16282204\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n All Editions\\n \\n \\n |\\n \\n \\n Add a New Edition\\n \\n \\n |\\n \\n \\n Combine\\n \\n \\n \\n \\n \\n ...Less Detail\\n \\n \\n edit details\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Friend Reviews\\n \\n \\n \\n \\n \\n To see what your friends thought of this book,\\n \\n please sign up.\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Reader Q&A\\n \\n \\n \\n \\n \\n To ask other readers questions about\\n \\n 1984\\n \\n ,\\n \\n please sign up\\n \\n .\\n \\n \\n \\n \\n Popular Answered Questions\\n \\n \\n \\n \\n \\n \\n Why do people rate this book so high? Surely I am missing something.\\n \\n \\n \\n \\n \\n \\n \\n \\n 149 likes\\n \\n \\n ·\\n \\n like\\n \\n \\n \\n \\n \\n 4 years ago\\n \\n \\n \\n \\n See all 73 answers\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Bigsoph\\n \\n \\n \\n \\n \\n Maybe you are expecting a happy ending, where love triumphs over all and human spirit is set free?\\n \\n If this was made into a movie now, they would likely\\n \\n …more\\n \\n \\n \\n \\n Maybe you are expecting a happy ending, where love triumphs over all and human spirit is set free?\\n \\n If this was made into a movie now, they would likely cast Will Smith as Winston and have him overthrow the government and rescue Julia\\n \\n (less)\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n I\\'m reading this for school and I really like it so far but I\\'m kind of confused on what Big Brother actually is?\\n \\n \\n \\n \\n \\n \\n \\n \\n 28 likes\\n \\n \\n ·\\n \\n like\\n \\n \\n \\n \\n \\n 4 years ago\\n \\n \\n \\n \\n See all 21 answers\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Niklas\\n \\n \\n \\n \\n \\n Big Brother is the personification of the state of Oceania. The book explains that the existence of Big Brother is necessary because it is easier to\\n \\n …more\\n \\n \\n \\n Big Brother is the personification of the state of Oceania. The book explains that the existence of Big Brother is necessary because it is easier to love a person than an organisation, and that the name \"Big Brother\" was selected because it plays on family loyalty.\\n \\n (less)\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n See all 142 questions about 1984…\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Lists with This Book\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Books That Everyone Should Read At Least Once\\n \\n \\n \\n 19,317 books\\n —\\n 90,155 voters\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Best Books of the 20th Century\\n \\n \\n \\n 7,516 books\\n —\\n 47,874 voters\\n \\n \\n \\n \\n \\n \\n \\n More lists with this book...\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Community Reviews\\n \\n \\n \\n \\n \\n \\n \\n (showing 1-30)\\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n $j(document).ready(function() {\\n var vis = renderRatingGraph(\\n [1103055, 800381, 366488, 97723, 48905],\\n \"reviewControls__ratingDetailsMiniGraph\");\\n $j(\"#reviewControls__ratingDetailsMiniGraph\").prependTo(\"#rating_details_tip\");\\n });\\n //]]>\\n \\n \\n \\n Rating details\\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'rating_details_tip\\'), \"\\\\n <div id=\\\\\"moreBookData\\\\\" class=\\\\\"bookMeta\\\\\" >\\\\n \\\\n\\\\n \\\\n\\\\n<table border=\\\\\"0\\\\\" id=\\\\\"rating_distribution\\\\\" style=\\\\\"width: auto; max-width: 500px;\\\\\" cellspacing=\\\\\"5\\\\\" cellpadding=\\\\\"0\\\\\">\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">5&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <a style=\\\\\"display: block; background-color: #215625; width: 100%;\\\\\" title=\\\\\"1103055 ratings\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(\\\\\\'/book/reviews/5470.1984?rating=5\\\\\\', {asynchronous:true, evalScripts:true, method:\\\\\\'get\\\\\\', parameters:\\\\\\'authenticity_token=\\\\\\' + encodeURIComponent(\\\\\\'2VgXN+w0K0mvfrNCznBWLjwCGScWUoR+26+6HkdObAcnH6/6d5zHKL5xNEcek2liVbQ/nJl4tR9V5RoVyDQScQ==\\\\\\')})\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/a>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 45% (1103055)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">4&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <a style=\\\\\"display: block; background-color: #215625; width: 72%;\\\\\" title=\\\\\"800381 ratings\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(\\\\\\'/book/reviews/5470.1984?rating=4\\\\\\', {asynchronous:true, evalScripts:true, method:\\\\\\'get\\\\\\', parameters:\\\\\\'authenticity_token=\\\\\\' + encodeURIComponent(\\\\\\'0mwwuEDl71bCk0Yt5IV2HL02+KFt1ZMDH4QnVxLaEKssK4h1200DN9OcwSg0ZklQ1IDeGuL/omKRzodcnaBu3Q==\\\\\\')})\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/a>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 33% (800381)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">3&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <a style=\\\\\"display: block; background-color: #215625; width: 33%;\\\\\" title=\\\\\"366488 ratings\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(\\\\\\'/book/reviews/5470.1984?rating=3\\\\\\', {asynchronous:true, evalScripts:true, method:\\\\\\'get\\\\\\', parameters:\\\\\\'authenticity_token=\\\\\\' + encodeURIComponent(\\\\\\'iQWg+8yHSBe8atwkItXSw5NIEO+7CX6l6v9v+YPr9QZ3Qhg2Vy+kdq1lWyHyNu2P+v42VDQjT8Rktc/yDJGLcA==\\\\\\')})\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/a>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 15% (366488)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">2&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <a style=\\\\\"display: block; background-color: #215625; width: 8%;\\\\\" title=\\\\\"97723 ratings\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(\\\\\\'/book/reviews/5470.1984?rating=2\\\\\\', {asynchronous:true, evalScripts:true, method:\\\\\\'get\\\\\\', parameters:\\\\\\'authenticity_token=\\\\\\' + encodeURIComponent(\\\\\\'F/TZzsKOdz8yL2hk735cCn2uwsN+dpgyuROzaXfvN4fps2EDWSabXiMg72E/nWNGFBjkePFcqVM3WRNi+JVJ8Q==\\\\\\')})\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/a>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 4% (97723)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <tr>\\\\n <th width=\\\\\"25\\\\\" class=\\\\\"right\\\\\">1&nbsp;<a size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\" style=\\\\\"float: right;\\\\\"><\\\\/a><\\\\/th>\\\\n <td width=\\\\\"350\\\\\">\\\\n <a style=\\\\\"display: block; background-color: #215625; width: 4%;\\\\\" title=\\\\\"48905 ratings\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(\\\\\\'/book/reviews/5470.1984?rating=1\\\\\\', {asynchronous:true, evalScripts:true, method:\\\\\\'get\\\\\\', parameters:\\\\\\'authenticity_token=\\\\\\' + encodeURIComponent(\\\\\\'tnKxN+fvscPufD+RYTCqU3Dh1SQYNczusLjnhkUm3IVINQn6fEddov9zuJSx05UfGVfzn5cf/Y8+8keNylyi8w==\\\\\\')})\\\\\" data-remote=\\\\\"true\\\\\">&nbsp;<\\\\/a>\\\\n <\\\\/td>\\\\n <td width=\\\\\"90\\\\\">\\\\n 2% (48905)\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n\\\\n<\\\\/table>\\\\n\\\\n\\\\n <span class=\\\\\"value\\\\\">94<\\\\/span>% of people liked it\\\\n\\\\n <table>\\\\n <tr>\\\\n <td><strong>All editions:<\\\\/strong><\\\\/td>\\\\n <td>\\\\n <span class=\\\\\"value\\\\\">4.16<\\\\/span> average rating,\\\\n <span class=\\\\\"value\\\\\">2416552<\\\\/span> ratings,\\\\n <span class=\\\\\"value\\\\\">53688<\\\\/span> reviews,\\\\n added by <span class=\\\\\"value\\\\\">3573900<\\\\/span> people,\\\\n <span class=\\\\\"value\\\\\">905234<\\\\/span> to-reads\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n\\\\n <tr>\\\\n <td><strong>This edition:<\\\\/strong><\\\\/td>\\\\n <td>\\\\n <span class=\\\\\"value\\\\\">4.15<\\\\/span> average rating,\\\\n <span class=\\\\\"value\\\\\">2236849<\\\\/span> ratings,\\\\n <span class=\\\\\"value\\\\\">42208<\\\\/span> reviews,\\\\n added by <span class=\\\\\"value\\\\\">3253571<\\\\/span> people\\\\n <\\\\/td>\\\\n <\\\\/tr>\\\\n <\\\\/table>\\\\n<\\\\/div>\\\\n\\\\n\", { style: \\'goodreads\\', stem: \\'topLeft\\', hook: { tip: \\'topLeft\\', target: \\'bottomMiddle\\' }, offset: { x: 5, y: 5 }, hideOn: false, showOn: \\'mouseover\\', closeButton: false, hideAfter: 1, hideOthers: true, title: \\'book data\\' });\\n $(\\'rating_details_tip\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n $(\\'rating_details_tip\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Sort\\n \\n : Default\\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'span_class_gr-hyperlink_sort_span_default_tip_829\\'), \"\\\\n <span class=\\\\\"reviewControls__sortOrders\\\\\">\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\"actionLinkLite greyText loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?sort=default\\\\\">Default<\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\"actionLinkLite loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?sort=newest\\\\\">Newest<\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\"actionLinkLite loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?sort=oldest\\\\\">Oldest<\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n <\\\\/span>\\\\n\", { style: \\'goodreads\\', stem: \\'topLeft\\', hook: { tip: \\'topLeft\\', target: \\'bottomMiddle\\' }, offset: { x: 5, y: 5 }, hideOn: false, showOn: \\'mouseover\\', closeButton: false, hideAfter: 1, hideOthers: true });\\n $(\\'span_class_gr-hyperlink_sort_span_default_tip_829\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n $(\\'span_class_gr-hyperlink_sort_span_default_tip_829\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n |\\n \\n \\n \\n \\n \\n Filter\\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'span_class_gr-hyperlink_filter_span_tip_372\\'), \"\\\\n <div class=\\\\\"greyText smallText\\\\\" style=\\\\\"white-space:nowrap\\\\\">\\\\n\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\"actionLinkLite greyText loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?rating=\\\\\">all <span class=\\\\\"greyText\\\\\">(3573900)<\\\\/span><\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\">\\\\n <a class=\\\\\"actionLinkLite loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(&#39;/book/reviews/5470.1984?rating=5&#39;, {asynchronous:true, evalScripts:true, method:&#39;get&#39;, parameters:&#39;authenticity_token=&#39; + encodeURIComponent(&#39;+iOvjPqLCS2p1OeizmL6pAnK/mseEbZW8IZ3VOHo5DsEZBdBYSPlTLjbYKcegcXoYHzY0JE7hzd+zNdfbpKaTQ==&#39;)}); return false;\\\\\">5 stars <span class=\\\\\"greyText\\\\\">(1103055)<\\\\/span><\\\\/a>\\\\n <span class=\\\\\"loadingAnimation\\\\\"><\\\\/span>\\\\n <span class=\\\\\"loadingError\\\\\"><\\\\/span>\\\\n <\\\\/span>\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\">\\\\n <a class=\\\\\"actionLinkLite loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(&#39;/book/reviews/5470.1984?rating=4&#39;, {asynchronous:true, evalScripts:true, method:&#39;get&#39;, parameters:&#39;authenticity_token=&#39; + encodeURIComponent(&#39;6RSE+umHm8Porm3+qYGPC1/y53SlcyjBMU71DB50oTcXUzw3ci93ovmh6vt5YrBHNkTBzypZGaC/BFUHkQ7fQQ==&#39;)}); return false;\\\\\">4 stars <span class=\\\\\"greyText\\\\\">(800381)<\\\\/span><\\\\/a>\\\\n <span class=\\\\\"loadingAnimation\\\\\"><\\\\/span>\\\\n <span class=\\\\\"loadingError\\\\\"><\\\\/span>\\\\n <\\\\/span>\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\">\\\\n <a class=\\\\\"actionLinkLite loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(&#39;/book/reviews/5470.1984?rating=3&#39;, {asynchronous:true, evalScripts:true, method:&#39;get&#39;, parameters:&#39;authenticity_token=&#39; + encodeURIComponent(&#39;htlHhBWmnEiHnBcV0/CZW5W64AMjcyIiQh3c8zznMol4nv9Jjg5wKZaTkBADE6YX/AzGuKxZE0PMV3z4s51M/w==&#39;)}); return false;\\\\\">3 stars <span class=\\\\\"greyText\\\\\">(366488)<\\\\/span><\\\\/a>\\\\n <span class=\\\\\"loadingAnimation\\\\\"><\\\\/span>\\\\n <span class=\\\\\"loadingError\\\\\"><\\\\/span>\\\\n <\\\\/span>\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\">\\\\n <a class=\\\\\"actionLinkLite loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(&#39;/book/reviews/5470.1984?rating=2&#39;, {asynchronous:true, evalScripts:true, method:&#39;get&#39;, parameters:&#39;authenticity_token=&#39; + encodeURIComponent(&#39;bPkoP36aSbLv2Mi/40SorOOui3GWTtFaM6sicU2M/GWSvpDy5TKl0/7XT7ozp5fgihityhlk4Du94YJ6wvaCEw==&#39;)}); return false;\\\\\">2 stars <span class=\\\\\"greyText\\\\\">(97723)<\\\\/span><\\\\/a>\\\\n <span class=\\\\\"loadingAnimation\\\\\"><\\\\/span>\\\\n <span class=\\\\\"loadingError\\\\\"><\\\\/span>\\\\n <\\\\/span>\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\">\\\\n <a class=\\\\\"actionLinkLite loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"new Ajax.Request(&#39;/book/reviews/5470.1984?rating=1&#39;, {asynchronous:true, evalScripts:true, method:&#39;get&#39;, parameters:&#39;authenticity_token=&#39; + encodeURIComponent(&#39;jzvkTc4IBzdln2qmvrTF3QbzHmL6TgJrrgW7gKlcl3ZxfFyAVaDrVnSQ7aNuV/qRb0U42XVkMwogTxuLJibpAA==&#39;)}); return false;\\\\\">1 star <span class=\\\\\"greyText\\\\\">(48905)<\\\\/span><\\\\/a>\\\\n <span class=\\\\\"loadingAnimation\\\\\"><\\\\/span>\\\\n <span class=\\\\\"loadingError\\\\\"><\\\\/span>\\\\n <\\\\/span>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"bookMeta\\\\\">\\\\n editions:\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\"value loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?edition_reviews=false\\\\\">all<\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\" loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?edition_reviews=true\\\\\">this edition<\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n\\\\n &nbsp;\\\\n content:\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\"value loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?text_only=false\\\\\">any<\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n\\\\n <span class=\\\\\"greyText\\\\\">&nbsp;|&nbsp;<\\\\/span>\\\\n <span class=\\\\\"loadingLinkSpan\\\\\"><a class=\\\\\" loadingLink\\\\\" rel=\\\\\"nofollow\\\\\" data-keep-on-success=\\\\\"true\\\\\" data-remote=\\\\\"true\\\\\" href=\\\\\"/book/reviews/5470.1984?text_only=true\\\\\">text-only<\\\\/a><span class=\\\\\"loadingAnimation\\\\\"><\\\\/span><span class=\\\\\"loadingError\\\\\"><\\\\/span><\\\\/span>\\\\n <\\\\/div>\\\\n\", { style: \\'goodreads\\', stem: \\'topLeft\\', hook: { tip: \\'topLeft\\', target: \\'bottomMiddle\\' }, offset: { x: 5, y: 5 }, hideOn: false, showOn: \\'mouseover\\', closeButton: false, hideAfter: 1, hideOthers: true });\\n $(\\'span_class_gr-hyperlink_filter_span_tip_372\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n $(\\'span_class_gr-hyperlink_filter_span_tip_372\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n May 28, 2007\\n \\n \\n \\n Bill Kerwin\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n This book is far from perfect. Its characters lack depth, its rhetoric is sometimes didactic, its plot (well, half of it anyway) was lifted from Zumyatin's\\n \\n We\\n \\n , and the lengthy Goldstein treatise shoved into the middle is a flaw which alters the structure of the novel like a scar disfigures a face.\\n \\n \\n But in the long run, all that does not matter, because George Orwell got it right.\\n \\n \\n Orwell, a socialist who fought against Franco, watched appalled as the great Soviet experiment was reduced to a totalita\\n \\n \\n \\n \\n This book is far from perfect. Its characters lack depth, its rhetoric is sometimes didactic, its plot (well, half of it anyway) was lifted from Zumyatin's\\n \\n We\\n \\n , and the lengthy Goldstein treatise shoved into the middle is a flaw which alters the structure of the novel like a scar disfigures a face.\\n \\n \\n But in the long run, all that does not matter, because George Orwell got it right.\\n \\n \\n Orwell, a socialist who fought against Franco, watched appalled as the great Soviet experiment was reduced to a totalitarian state, a repressive force equal in evil to Fascist Italy or Nazi Germany. He came to realize that ideology in an authoritarian state is nothing but a distraction, a shiny thing made for the public to stare at. He came to realize that the point of control was more control, the point of torture was more torture, that the point of all their \"alternative facts\" was to fashion a world where people would no longer possess even a word for truth.\\n \\n \\n \\n If you want a picture of the future, imagine a boot stamping on a human face — forever.\\n \\n \\n \\n Orwell's vision of the world is grim; too grim, some would argue, for it may deprive the faint-hearted among us of hope. But Orwell never wanted to take away hope. No, he wished to shock our hearts into resistance by showing us the authoritarian nightmare achieved: a monument of stasis, a tribute to surveillance and control.\\n \\n \\n Here, in the USA, in 2017, our would-be totalitarians are a long way from stasis. Right now they're stirring up chaos and confusion, spreading lies and then denying they spread them, hoping to gaslight us into a muddle of helplessness and inactivity. They are trying to destroy a vigorous democracy, and they know it will take much chaos and confusion to bring that democracy down. They hate us most when we march together, when we occupy senate offices and jam the congressional switchboard, when we congregate in pubs and coffee houses and share our outrage and fear, for they know that freedom thrives on solidarity and resistance, and that solidarity and resistance engender love and hope. They much prefer it when we brood in solitude, despairing and alone.\\n \\n \\n Which reminds me...one of the things we should\\n \\n never\\n \\n do is brood about the enemy's ideology (\\n \\n Is Steve Bannon a Fascist? A Nazi? A Stalinist?\\n \\n ), for while we try to discern his \"ideological goals,\" the enemy is busy pulling on his boots, and his boots are made with hobnails, with heel irons, and equipped with toecaps of steel.\\n \\n \\n Finally, it does not matter who heads up the authoritarian state: a bully boy like Mussolini, a strutting coprophiliac like Hitler, a Napoleonic pig like Stalin, or a brainless dancing bear like Trump. Whatever the current incarnation of \"Big Brother\" may be, the goal is always the same:\\n \\n \\n A nation of warriors and fanatics, marching forward in perfect unity, all thinking the same thoughts and shouting the same slogans, perpetually working, fighting, triumphing, persecuting - three hundred million people all with the same face.\\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 728 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 105 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n John Devlin\\n \\n \\n \\n William wrote: \"Got a \"taxes are always bad\" bug in your code?\"\\n \\n \\n You reading lacks nuance. Never wrote, taxes are ALWAYS bad.\\n \\n \\n But when sales tax has incr\\n \\n \\n \\n William wrote: \"Got a \"taxes are always bad\" bug in your code?\"\\n \\n \\n You reading lacks nuance. Never wrote, taxes are ALWAYS bad.\\n \\n \\n But when sales tax has increased by a 150% over just fifty years. When a country used to get by without a federal income tax, when states like Florida and Texas do fine with out state taxes, I think it\\'s fair to question the efficacy of the govt\\'s use of said money.\\n \\n \\n ...more\\n \\n \\n \\n Sep 27, 2018 03:07PM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Daniel Pane\\n \\n \\n Bill review of 1984 was way to long without making any point . 1984 is one of the great book of our time an about our time.a must read 4 any thinking\\n \\n \\n Bill review of 1984 was way to long without making any point . 1984 is one of the great book of our time an about our time.a must read 4 any thinking person!!! What l\\n \\n \\n ...more\\n \\n \\n \\n Sep 28, 2018 06:20PM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Dec 07, 2007\\n \\n \\n \\n Silvana\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n \\n Recommends it for:\\n \\n \\n everyone\\n \\n \\n \\n Shelves:\\n \\n classics\\n \\n ,\\n \\n dark-and-depressing\\n \\n ,\\n \\n mine-mine-mine\\n \\n ,\\n \\n scary-stuff\\n \\n ,\\n \\n dead-trees\\n \\n \\n \\n \\n \\n \\n WAR IS PEACE.\\n \\n \\n FREEDOM IS SLAVERY.\\n \\n \\n IGNORANCE IS STRENGTH.\\n \\n \\n Those words keep sounding in my head since I read this book. Gosh, probably the most haunting not to mention frightening book I\\'ve ever read. 1984 should also be included in the horror genre.\\n \\n \\n 1984 describes a Utopia. Not Thomas More\\'s version of Utopia, but this is one is the antithesis, i.e. Dystopia. Imagine living in a country, whose leaders apply a totalitarian system in regulating their citizen, in the most extreme ways, which make Hitler\\n \\n \\n WAR IS PEACE.\\n \\n \\n FREEDOM IS SLAVERY.\\n \\n \\n IGNORANCE IS STRENGTH.\\n \\n \\n Those words keep sounding in my head since I read this book. Gosh, probably the most haunting not to mention frightening book I\\'ve ever read. 1984 should also be included in the horror genre.\\n \\n \\n 1984 describes a Utopia. Not Thomas More\\'s version of Utopia, but this is one is the antithesis, i.e. Dystopia. Imagine living in a country, whose leaders apply a totalitarian system in regulating their citizen, in the most extreme ways, which make Hitler, Mao, Stalin and that old bloke in\\n \\n V for Vendetta\\n \\n look like sissies.\\n \\n \\n Working, eating, drinking, sleeping, talking, thinking, procreating...in short living, all are controlled by the state. Any hint of obedience or dislike can be detected by various state apparatus such as the Thought Police, telescreen, or even your children, who will not hesitate to betray you to the authorities. Even language is modified in such ways that you cannot express yourself, since individualism is a crime.\\n \\n \\n The past is controlled, rewritten into something that will strengthen the incumbent ruler. Who controls the past, controls the future. Who controls the present, controls the past. There is no real truth. The \"truth\" is what the state says it is. Black is white, 2+2=5, if the state says so.\\n \\n \\n The world in 1984 is divided into three states, originated from the ashes from World War II: Oceania (British Isles, the Americas, Pacific, Australia), Eurasia (Europe & Russia), and Eastasia (the rest of it). Continuous warfare between those three (who hold similar ideologies) is required to keep the society\\'s order and peace. Si vis pacem para bellum. That\\'s describes the first slogan.\\n \\n \\n The second slogan, freedom is slavery, means the only way to be free is by letting you lose yourself and to be integrated within the Party. That way, you\\'ll be indestructible and immortal.\\n \\n \\n Ignorance is strength, means the division on high, middle, low classes in society will never be changed. The middle wants to be the high and they\\'ll act \"on behalf of the low\" to dethrone the high. Afterwards, a new middle class arises, all will change except the low. The high and middle make and uphold the law, the low (proletarian) is just too stupid to revolt. The state maintains its structure by torture, intimidation, violence, and brainwashing.\\n \\n \\n Blimey, Orwell\\'s Animal Farm is already depressing, but 1984 gives \"depression\" a new meaning, at least for me.\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 1230 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 81 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Seif Ahmed\\n \\n \\n Scary and more realistic point of view fir certain countries nowadays\\n \\n \\n \\n Sep 24, 2018 12:33AM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Xue Yan\\n \\n \\n You're right! I also read Animal Farm a few years ago, but Orwell takes the dystopian society to another level in 1984. The Party definitely reminded\\n \\n \\n You're right! I also read Animal Farm a few years ago, but Orwell takes the dystopian society to another level in 1984. The Party definitely reminded me of the dictators in history...only WORSE! His novel really surprised me and made me reflect on aspects of our society today. I'm glad you enjoyed it!\\n \\n \\n ...more\\n \\n \\n \\n Sep 30, 2018 10:40AM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jul 28, 2007\\n \\n \\n \\n Dave\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n In George Orwell\\'s 1984, Winston Smith is an open source developer who writes his code offline because his ISP has installed packet sniffers that are regulated by the government under the Patriot Act. It\\'s really for his own protection, though. From, like, terrorists and DVD pirates and stuff. Like every good American, he drinks Coca-Cola and his processed food has desensitized his palate to all but four flavors: sweet, salty-so-that-you-will-drink-more-coca-cola, sweet, and Cooler Ranch!(tm). H\\n \\n \\n In George Orwell\\'s 1984, Winston Smith is an open source developer who writes his code offline because his ISP has installed packet sniffers that are regulated by the government under the Patriot Act. It\\'s really for his own protection, though. From, like, terrorists and DVD pirates and stuff. Like every good American, he drinks Coca-Cola and his processed food has desensitized his palate to all but four flavors: sweet, salty-so-that-you-will-drink-more-coca-cola, sweet, and Cooler Ranch!(tm). His benevolent overlords have provided him with some war happening somewhere for some reason so that he, and the rest of the population, can be sure that the government is really in his best interests. In fact, the news always has some story about Paris Hilton or yet another white girl who has been abducted by some evil bastard who is biologically wired by 200,000 years of human evolution to fuck 12-year-olds, but is socially conditioned to be obsessed with sex, yet also to feel guilty about it. This culminates into a distorted view of sexuality, and results in rape and murder, which both make for very good news topics. This, too, is in Winston\\'s best interests because, while fear is healthy, thinking *too* much about his own mortality is strictly taboo, as it may lead to something dangerously insightful, and he might lose his taste for Coca Cola and breast implants. The television also plays on his fears of the unknown by exaggerating stereotypes of minorities and homosexuals, under the guise of celebrating \"diversity\", but even these images of being ghetto-fabulous and a lisping interior designer actually exist solely to promote racism and homophobia, which also prove to be efficient distractions.\\n \\n \\n For some reason, Winston gets tired of eating recycled Pop Tarts and eating happy pills and pretending to be interested in sports and manufactured news items. But, in the end, they fix him and he\\'s happy again. Or something.\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 1681 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 144 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Aug 12, 2007\\n \\n \\n \\n John Wiswell\\n \\n \\n rated it\\n \\n \\n it was ok\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Recommends it for:\\n \\n \\n Classics readers, political readers concerned with overreaches\\n \\n \\n \\n \\n \\n \\n \\n 1984\\n \\n is not a particularly good novel, but it is a very good essay. On the novel front, the characters are bland and you only care about them because of the awful things they live through. As a novel all the political exposition is heavyhanded, and the message completely overrides any sense of storytelling. As an essay, the points it makes can be earthshaking. It seems everyone who has so much as gotten a parking ticket thinks he lives in a 1984-dystopia. Every administration that reaches for po\\n \\n \\n \\n 1984\\n \\n is not a particularly good novel, but it is a very good essay. On the novel front, the characters are bland and you only care about them because of the awful things they live through. As a novel all the political exposition is heavyhanded, and the message completely overrides any sense of storytelling. As an essay, the points it makes can be earthshaking. It seems everyone who has so much as gotten a parking ticket thinks he lives in a 1984-dystopia. Every administration that reaches for power, injures civil liberties or collaborates too much with media is accused of playing Big Brother. These are the successes of\\n \\n 1984\\n \\n \\'s paranoia, far outliving its original intent as a battery against where Communism was going (Orwell was a severely disappointed Marxist), and while people who compare their leaders to Big Brother are usually overreaching themselves and speak far away from Orwell\\'s intent and vision, it is a useful catchcloth for dissent. Like so many immortalized books with a social vision,\\n \\n 1984\\n \\n \\'s actual substance is so thin that its ideologies and fear-mongering aspects can be stretched and skewed to suit the readers. If you\\'d like a better sense of the real world and Orwell\\'s intents, rather than third-hand interpretations of his fiction, then his\\n \\n Homage to Catalonia\\n \\n is highly recommended.\\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 970 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 147 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Feb 04, 2013\\n \\n \\n \\n Mohammed Arabey\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n \\n \\n \\n It\\'s written 1948? Clearly History has its twisted ways to repeat itself..\\n \\n A Note that MUST be written in the cover of every edition..\\n \\n \\n \\n لم اتوقع أن هذا التحذير\\n \\n \"إن هذه الرواية تحذير وليست بدليل\"\\n \\n بهذه الواقعية، مازالت الحكومات العربية تراقب الجميع لحماية أمن الحكام..بينما مازال أمن الأفراد هزيلا..منعدما\\n \\n \\n \\n \\n هي الرواية التي كتبت في 1948 بعبقرية، أرسي بها جورج أورويل قواعد روايات الديستوبيا بحق\\n \\n وإن كانت مستوحاه من واقع محيط به ولكن التاريخ دائما يجد وسيلة ليتكرر ويزيد وينتشر ويتوغل\\n \\n هي رواية مازالت صداها في\\n \\n \\n \\n It\\'s written 1948? Clearly History has its twisted ways to repeat itself..\\n \\n A Note that MUST be written in the cover of every edition..\\n \\n \\n \\n لم اتوقع أن هذا التحذير\\n \\n \"إن هذه الرواية تحذير وليست بدليل\"\\n \\n بهذه الواقعية، مازالت الحكومات العربية تراقب الجميع لحماية أمن الحكام..بينما مازال أمن الأفراد هزيلا..منعدما\\n \\n \\n \\n \\n هي الرواية التي كتبت في 1948 بعبقرية، أرسي بها جورج أورويل قواعد روايات الديستوبيا بحق\\n \\n وإن كانت مستوحاه من واقع محيط به ولكن التاريخ دائما يجد وسيلة ليتكرر ويزيد وينتشر ويتوغل\\n \\n هي رواية مازالت صداها في روايات شبابية تصدر حتي الأن متأثرة بها..بل وقد تكون اكثر امتاعا منها\\n \\n \\n *تحذير هام قبل البدء*\\n \\n كاتب الريفيو متأثرا ويعاني أعراض \"ازدواجية التفكير\" بشكل خطير\\n \\n فأذا لم تقرأ الرواية بعد فستستشعر ان كاتب الريفيو \"مجنونا\"، أما اذا قد قرأتها فستتيقن انه حتما يعاني من الجنون\\n \\n \\n =======*****=======\\n \\n \\n عشقت هذه الروايه لدرجه الكراهيه\\n \\n احببت جمال قبح العامه، وكرهت الحريه بشده..اقتنعت باننا يجب ان نخطئ وارتعبت جدا من الصواب\\n \\n \\n وقد كرهت بشده الاجزاء السياسيه و ضجرت من تلك المقاله السياسيه الطويله \"في الجزء الثاني\" والتي عزمت علي ان اقرأها قراءه سريعه ..ولكن قرأت مايقرب من 40 صفحه في ساعه ونصف!! لأني شعرت انها فعلا يجب ان تقرأ بتمعن, فهي من اهم المقالات السياسية الواقعية\\n \\n \\n كرهت تلك المشاهد الجنسيه البسيطه ولعلي استشطت غضبا اذا لم تحدث\\n \\n وكم كرهت تلك النهايه التي شعرت انها قُدمت كنهاية سعيده..واكرهها اكثر كلما اشعر انها فعلا ليست سعيده\\n \\n \\n لقد عشقت تلك الروايه لاني شعرت بالملل المثير طوال احداثها\\n \\n لم اشعر انها كلاسيكيه,رايتها معاصره واحداثها واقعية وتدور في الوقت الحالي , ومع ذلك شعرت بملل الكلاسيكيات بها\\n \\n روايه ينعدم فيها العواطف ولكني تأثرت لدرجه الدمع في احد مشاهدها\\n \\n روايه عشقت فيها اشمئزازي الرهيب منها, واحداثها وشخصياتها\\n \\n روايه كنت اسابق الزمن كي انهي عذابي معها..وافكر في نفس الوقت متي سأقرأها مره ثانيه..قريبا\\n \\n \\n =======*****=======\\n \\n الاحداث\\n \\n ------\\n \\n \\n اذا كنت من هواة قراءة الروايات الحديثة -مثلي- واعجبتك تلك الروايات المصنفه كديستوبيا - حيث يعم المدينه او الدوله او العالم ككل الظلم و القهر والفساد والاستبداد, الدمار والتجارب اللاانسانيه - تلك الروايات مثل\\n \\n \\n The Hunger Games\\n \\n و\\n \\n The Maze Runner\\n \\n و\\n \\n Divergent\\n \\n \\n \\n او تجربه الرائع احمد خالد توفيق المصريه يوتوبيا\\n \\n \\n \\n \\n \\n \\n \\n فعليك بالبدء في تلك الروايه الكلاسيكيه للروائي العبقري \"جورج اورويل\" 1984\\n \\n -فهي مدخل رائع لمثل ذلك النوع من الروايات, ولن تشعر أبدا انها كلاسيكية او قديمة, حتي وان كانت ترجع ل1948...قبل عنوان الرواية بأربعون عاما\\n \\n \\n يجب التنويه انه اذا كنت قراءتها واعجبتك بالفعل فعليك بقراءه تلك الروايات الحديثه ايضا- ..بالأخص العاب المجاعات\\n \\n \\n \\n عقب الحرب العالميه الثانيه وفي وقت صراعات النازيه والشيوعيه ,فتره الاربعينات من القرن الماضي ينقلك المؤلف الي لندن في الديستوبيا التي يتنبأ بها بعد اقل من 40 عاما\\n \\n ففي عام 1984 ستجد ان العالم بعد صراعاته الدمويه النوويه صار مقسما الي 3 قوي رئيسيه تتحكم في العالم بكل ما تحمله كلمه \"تحكم\" من معني\\n \\n فتتحكم في مسكنك ومأكلك ومشربك,تتحكم في اسلوب حياتك,تتحكم في أراءك,توجهاتك\\n \\n تتحكم في افكارك,مشاعرك,عواطفك..فتذكر ان الاخ الكبير يراقبك..دائما وابدا\\n \\n \\n هل العالم كله هكذا؟ كيف لك ان تعرف ماذا يحدث في باقي العالم..اصمت واستمع للاخ الكبير فحسب..لا يوجد لك سبيل تواصل مع العالم الخارجي..فكلهم عدو لبلدك\\n \\n انت منعزل تماما عن العالم..لايصلك من اخباره الا ما يقوله لك الأخ الكبير - هل يبدو ذلك مألوفا لك؟؟\\n \\n \\n \\n ستقابل مفاجأت واحداث مثيره, ثوره داخليه بعقلك,عقل وينستون البطل الذي تتعايش معه..كراهيه التمرد والشغف الشديد به\\n \\n نبذ الحريه التي هي العبوديه..نبذ السلام الذي هو الحرب\\n \\n \\n \\n بالنسبه لي ما يعيب الاحداث شيئا ما هو الجزء المطول من \"كتاب حكم الاقليه\" والذي ذكرني كثيرا بجو كتب الفلسفه السياسيه كتلك التي يقدمها \"يوسف زيدان\" وغيره من مدعي الحنكة السياسية...ولكن يقدمها جورج اورويل هنا بطريقه محايده, مفهومة ومتميزة وبالرغم من الملل الذي اعتراني في الجزء الثاني ربما اغلبه بسبب هذا الجزء والذي بالرغم من انك قد قرأت ملخصه في الجزء الاول من الاحداث الا انك ستجد انه من الصعب ان تتركه دون قراءه\\n \\n \\n ويحسب بحق للمؤلف \"تعمقه الشديد\"في احداث روايته ورسمها فعلا كانها عن عالم حقيقي.. \"ذكرني بعبقريه اخري معاصره هي جي كي رولينج عندما تسهب في عرض مقالات من جرائد عالمها الساحر او عرض صفحات عده لاحد كتب ذلك العالم الخيالي الذي ابتكرته\" وهذا ان دل علي شئ فانما يدل عن انك امام روايه ثريه لم يبخل المؤلف بها بشئ ليجعل من الخيال واقعيه فهو ايضا مزج تاريخ اوقيانيا بتاريخ تلك الاحداث العالميه الحقيقيه والمعاصره -وقت صدور الروايه - من نازيه و شيوعيه\\n \\n \\n \\n راعني ايضا ملاحظه وجدتها علي الويكابيديا هو ان \"تبخير الانسان\" واعتباره لم يكن\\n \\n Unperson\\n \\n كان امرا حقيقيا واتبعه بتعديل الصور وذلك في الاتحاد السوفييتي في الثلاثينات في صوره لستالين مع نيكولاي يزوف رئيس الشرطه السريه والتي تم تعديلها بعد اعدام الاخير لينسب الفضل لستالين وحده في حمله التطهير الشيوعيه وليكون وحده صاحب الفضل في بناء الاتحاد السوفييتي..اي ان الامر له اصول حقيقيه\\n \\n \\n \\n \\n وأه من مظهر ستالين نفسه :)\\n \\n \\n \\n \\n \\n \\n \\n وكما قلت في بدايه الريفيو ان ازدواجيه التفكير قادتني الي الجنون في هذا الريفيو\\n \\n \\n فاني من اعجابي الشديد بالروايه كنت اتمني ان لا تنتشر, ولا يتم طبعها ولا قراءتها علي نطاق واسع...فكم من اخ كبير ظهر بعدها ونفذ قليلا او كثيرا من سياسته...سواء كان علي حق وصواب في جزء من سياسته او علي خطأ\\n \\n كم منا وصل الامر معه لعشق الاخ الكبير وحبه وتوقف عقله وذهنه وكأن هذا الاخ الكبير الذي نصبه لنفسه لا يخطئ؟\\n \\n \\n \\n \\n \\n \\n \\n \\n وايضا من اعجابي الشديد بالروايه اتمني ان تنتشر ويتم طبعها كثيرا و تقرأ علي نطاق واسع\\n \\n فكم منا يجب ان يفيق ويدرك ان عليه ان يعمل بعقله ويفكر كثيرا في حريه فكره وعقله...يفكر لصالحه ولصالح المجتمع ويتخلص من سلطه الاخ الكبير عندما يراه خاطئا كاذبا او منافقا\\n \\n \\n \\n الصور مجرد صور..لاتعبر عن راي شخصي فمابين تلك الصور ناس احترم سياستهم ولكني لا اراهم دائما علي حق ..فهم بشر اولا واخيرا بعضهم اصابوا ويصيبون قليلا و اخطئوا و يخطئون كثيرا و بعضهم العكس\\n \\n \\n \\n \\n تناقض؟ هذا هو مايسمي بازدواجيه الفكر التي ستجدها في تلك الروايه الرائعه بحق\\n \\n اقرأها لتتعرف كيف تحكم عقلك في مايعرض عليك من تاريخ..لتحاول التفرقه بين الزيف وبين الحق\\n \\n لعلنا نستطيع القضاء علي من يسيطر علينا باسم الاخ الكبير..او من يدعي انه جولدشتاين عصره..اقرأها فانها بحق\\n \\n روايه مرهقه للعقل\\n \\n \\n =======*****=======\\n \\n الشخصيات\\n \\n -------\\n \\n \\n \\n وينستون سميث\\n \\n \\n هو من ستتوحد معه خلال احداث الروايه\\n \\n وهو الاختيار المناسب ,فهو الطبقه المتوسطه-ماتحت النخبة-..فهو يتوافر له الطعام والشراب والمسكن...ليس ادميا او يتناسب مع كونه احد اعضاء الحزب الخارجي وانما علي الاقل ادميا بما فيه الكفايه مقارنه بعامه الشعب ,اللاشئ , هؤلاء الذين يمثلون 85% من السكان,وهو في وضع أأمن منهم بعيدا عن اماكنهم المعرضه للقصف باستمرار\\n \\n \\n ولكنه ليس افضل حالا منهم\\n \\n فقيود حريته اعظم بكثير فهو -عكس عامه الشعب-مراقب 24/7حتي في احلامه واغوار عقله الباطن فيجب ان يكون منضبطا كالمسطره..تاركا افكارك ومشاعرك وعواطفك وتوجهاتك في يد \"الاخ الكبير\"..في يد حزبك الداخلي والذي يمثل 2% من السكان..اسيادك\\n \\n \\n ذلك الحزب الداخلي الذي لا تعرف كيف يعيش..هل هو مثلك في تلك المعيشه..معيشه الكفاف او ما دونه؟ بالتاكيد لا, هم ليسوا كعامه الشعب الذين صاروا تحت مستوي الفقر..بل تحت مستوي الحياه نفسها, فلا يلقوا الكفاف..وحياتهم مهدده من وقت لاخر جراء عمليات القصف الحربيه التي لا احد يعرف كنهها بالتحديد\\n \\n \\n \\n \\n برع المؤلف في رسم شخصيته بطريقه ممتازه,تحولاته ودوافعه وافكاره بل ورسم ذكرياته باتقان وربط بينها وبين الاحداث بطريقه..عبقريه جورج اورويل فعلا ايقنتها برسمه لشخصيته\\n \\n \\n (view spoiler)\\n \\n \\n [ادمعت بحق كما قلت في بدايه الريفيو في تلك الذكري التي تذكرها قبل لحظات النهايه عندما كان يلعب السلم والثعبان مع امه\\n \\n تبا ها انا ارفض الكتابه عن تلك اللحظه لاني شعرت بالقشعريره الان مره اخري\\n \\n \\n بالطبع وغضبت جدا لتلك النهايه السعيده..انها ليست تلك التي تمناها وينستون وانا معاه..ومع ذلك فاني متقبل تماما ان يلقي مصيره..سعيدا\\n \\n \\n الم اقل لك؟ انها ازدواجيه التفكير تبا لها تلك اللعينه\\n \\n \\n (hide spoiler)\\n \\n ]\\n \\n \\n \\n \\n \\n \\n جوليا\\n \\n \\n جوليا جوليا جوليا..اه من جوليا..لازدواجيه الفكر ظللت اعشقها واعشق فكرها واعشق ايضا فكره تحطيم راسها في اغلب الوقت\\n \\n هي زميله وينستون في وزاره الحقيقه في الحزب الخارجي..زميلته الغامضه المريبه المتزمته لدرجة انك ستشعر انها روح الحزب نفسه..ولكنك ستكتشف عنها اشياء لم تخطر علي بال\\n \\n \\n \\n \\n \\n اوبراين\\n \\n \\n عضو الحزب الداخلي الموقر..واحد من الساده ..ال2% من الشعب والذي من خلاله ستعرف مميزات هذه النخبه\\n \\n رجل وقور..مهيب..محترم..ستشعر كم يتفهمك بمجرد نظرته\\n \\n وكم من المفاجأت التي يطويها في طياتها\\n \\n \\n \\n فستفاجأ انه مثلك ومعك في الفكر..ولعلك ستفاجأ بحق عندما تجد انه بالفعل روح متمردة تغلغلت الي هذا الحد بالحزب\\n \\n \\n \\n روايه لن تشعر معها بالوقت..روايه ستقلب تفكيرك\\n \\n \\n وكما يقول المترجم \"الرائع بحق\" انور الشامي لهذه النسخه العربيه\\n \\n \\n إنها رواية تقرأ، ثم تقرأ من جديد\\n \\n \\n وبالفعل..الي قراءه اخري ربما للنسخه الانجليزيه المره القادمه ان شاء الله\\n \\n \\n \\n محمد العربي\\n \\n من 27 مايو 2013\\n \\n الي 30 مايو 2013\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 525 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 97 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Apr 19, 2012\\n \\n \\n \\n Huda Yahya\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n dystopia\\n \\n ,\\n \\n history\\n \\n ,\\n \\n favourites\\n \\n \\n \\n \\n \\n \\n \\n حدثني عن القهر\\n \\n عن الاستعباد\\n \\n عن الذل\\n \\n ثم حدثني بأدق التفاصيل\\n \\n عن مراحل تقويض الكائن الانساني\\n \\n \\n حدثني كثيرا وطويلا كي أعي هذا الدمار\\n \\n كي أتشربه\\n \\n كي أدميه في لحمي وأعصابي نصلا حادا طويلا\\n \\n كي أنزف روحي بكاء\\n \\n كي أتعلم شيئا نافعا قبل أن أغادر هذا العالم البائس\\n \\n \\n حدثني يا أورويل فما أشهى وجع حديثك\\n \\n وما أشهى ألم المعرفة النازف\\n \\n \\n \\n الحرب هي السلام\\n \\n \\n \\n ما المفترض علي فعله\\n \\n الكتابة عن نفسي أم عن وطني أم عن وينستون\\n \\n بمن أبدأ\\n \\n \\n ولكن مهلا\\n \\n لما التفرقة..؟\\n \\n كلنا واحد\\n \\n أنا.. وينستون..جوليا..أنت..\\n \\n بقعة الأرض التي تنتمي إليها روحك\\n \\n وتدعوها وطن\\n \\n \\n \\n الحريّة هي العبود\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n حدثني عن القهر\\n \\n عن الاستعباد\\n \\n عن الذل\\n \\n ثم حدثني بأدق التفاصيل \\u200f\\n \\n عن مراحل تقويض الكائن الانساني\\u200f\\n \\n \\n حدثني كثيرا وطويلا كي أعي هذا الدمار\\n \\n كي أتشربه\\n \\n كي أدميه في لحمي وأعصابي نصلا حادا طويلا\\n \\n كي أنزف روحي بكاء\\n \\n كي أتعلم شيئا نافعا قبل أن أغادر هذا العالم البائس\\n \\n \\n حدثني يا أورويل فما أشهى وجع حديثك\\n \\n وما أشهى ألم المعرفة النازف\\n \\n \\n \\u200f\\n \\n الحرب هي السلام\\n \\n \\n \\n ما المفترض علي فعله\\n \\n الكتابة عن نفسي أم عن وطني أم عن وينستون\\n \\n بمن أبدأ\\n \\n \\n ولكن مهلا\\n \\n لما التفرقة..؟\\n \\n كلنا واحد\\n \\n أنا.. وينستون..جوليا..أنت..\\u200f\\n \\n بقعة الأرض التي تنتمي إليها روحك\\n \\n وتدعوها وطن\\n \\n \\n \\n الحريّة هي العبودية\\n \\n \\n \\n كلنا كتلة معجونة بألف نوع من النزف\\n \\n كلنا ذرات اجتمعت وتشكلت آدميين ونباتات وصخور\\n \\n \\n \\n الجهل هو القّوة\\n \\n \\n \\n كلنا غبار نجوم أراد له حظه السيئ أن يتشكل ليكون العائلة \\u200fالإنسانية على كوكب ملعون أسميناه الأرض\\n \\n \\n \\u200f\\n \\n الأخ الكبير يراقبك\\n \\n \\n \\n من نحن يا أورويل..؟\\n \\n من نحن حتى نفعل ذلك بأنفسنا\\n \\n من نحن حتى نهزم بعضنا البعض بهذه الطريقة\\n \\n أي لعنة حلت بنا فأصبحنا بشرا يأكل بعضه بعضا بأبشع \\u200fالصور..؟\\n \\n \\n ::::::::::::::::::::\\n \\n \\n الولاء يعني إنعدام التفكير .. بل إنعدام الحاجة للتفكير\\n \\n الولاء هو عدم الوعي\\n \\n ____________\\n \\n \\n \\n \\n \\n يقول أورويل أن الكتاب الأفضل\\n \\n هو ما يخبرك بما تعرفه بالفعل\\n \\n ولكننا باختلاف خبراتنا لم نكن نعرف أننا يمكن لنا كبشر أن \\u200fننحط لهذه الدرجة\\n \\n أن ننهزم لهذه الدرجة\\n \\n كان هناك أمل أهوج يناطح بداخل كل واحد فينا بدرجة متفاوتة\\n \\n يحاول الاحتفاظ بصورته الآدمية التي تمزقت أشلاء مرة تلو \\u200fالمرة\\n \\n بعد كل قراءة للتاريخ\\n \\n أو معايشة لأحداث ثورة\\n \\n \\n ولكنه كان كذلك حقا بالنسبة لي\\n \\n لقد أخبرني بما كنت أعرفه بالفعل\\n \\n لكنني أنكر بعضه بعناد\\n \\n أهوّن على نفسي بابتداعات دماغية \\u200f\\n \\n بهلوسات أمل عن انتصار العدل ذات يوم\\n \\n \\n ::::::::::::::::::::\\n \\n \\n من وجهة نظر الطبقة الدنيا \\u200f\\n \\n فإن أي تغيير تاريخي لا يعدو أن يكون مجرد تغيير في أسماء \\u200f\\u200fسادتها\\n \\n ــــــــــــــــ\\n \\n \\n \\n \\n من منا نظر إلى ما حوله بنفس الطريقة بعد قراءة كتاب \\u200fكهذا..؟\\n \\n من منا لم تتغير رؤيته لأشياء كثيرة كثيرة كان عنها غافل\\n \\n أو متغافل\\n \\n إن لم يكن هذا الكتاب ضربة الفأس التي تحدث عنها كافكا\\n \\n والتي تهزك من الأعماق\\n \\n فماذا يكون إذا..؟\\n \\n ::::::::::::::::::::\\n \\n \\n \\u200fإن ألد أعدائك هو جهازك العصبي\\n \\n ــــــــــــ\\n \\n \\n \\n إنها الديستوبيا الأكثر سوادا في تاريخ الأدب\\n \\n فيها يعيش الكائن الحي في خوف دائم\\n \\n خوف من شرطة الفكر\\n \\n من شاشات الرصد\\n \\n من التفوه بكلمة قد تدمر حياته بأكملها\\n \\n من تعبير وجه قد ينفلت منه دون قصد فيسحق بلا رحمة\\n \\n من خطرٍ محتمل الوقوع\\n \\n من عدو مجهول قد ينقض عليك في أي لحظة\\n \\n من عيون الأخ الكبير\\n \\n الإله..المخلص..المحبوب غصبا عن الكل.. وبرضا الكل\\n \\n تلك العيون التي لم تترك شيئا لم تتواجد عليه\\u200f\\n \\n أغلفة الكتب ..الطوابع.. \\u200fالأعلام .. أغلفة الحلوى..لعملات \\u200f\\n \\n إنه يلاحقك أينما تكون\\n \\n وفي كل وقت\\n \\n \\n الأخ الأكبر \\u200f\\n \\n الطاغية المعبود في كل زمان ومكان\\n \\n هذا الذي قد يكون مستوحى من ستالين\\n \\n ولكنه يجثم على أنفاس الخلائق منذ بدأ تاريخ الأرض\\u200f\\n \\n \\n وأوقيانيا هي الدولة\\u200f التي اخترعها أورويل\\n \\n ليبني على أرضها \\u200fهذه الديستوبيا المريعة\\n \\n \\n فيها شاشات الرصد تترصد كل \\u200fتحركاتك\\n \\n فيها يحافظ الجميع على دقيقتي الكراهية\\n \\n للتنفيس عن غضبهم من المعارض غولدشتاين\\n \\n أو بمعنى آخر الشيطان الأعظم كما يصور له سادته\\n \\n \\n إنه مجتمع مصادر الحقوق منتهك الحريات \\u200f\\n \\n \\u200fمحروم حتى من مجرد التفكير\\n \\n مجتمع يقضي عمره كله تحت الرقابة\\n \\n التي تحصي عليه أنفاسه \\u200f وتحركاته \\u200f\\n \\n مجتمع يعرف مصيره منذ أن يولد\\n \\n يعرف أن الطاغية الأعظم قد حدد له كل شيء سلفا\\n \\n طعامه.. شرابه .. نوع قهوته -بن النصر \\u200f\\n \\n عدد \\u200fشفرات الحلاقة\\n \\n \\n \\u200fفيه وزارة الحقيقة \\u200f تزور الحقيقة وتختلق الأكاذيب \\u200f\\n \\n وزارة \\u200fالسلام تختص بشؤون الحرب والسلاح\\n \\n وزارة الوفرة تجوع المواطنين\\n \\n \\u200f ووارة الحب تعذب الخلائق وتناهض الجنس \\u200f\\n \\n \\n أهي تسميات ساخرة حقا..؟\\n \\n أوزارة الحب تختلف عن الأمن الوطني أو أمن الدولة عندنا..؟\\n \\n في الرواية تبررها فلسفة الحزب-الدولة للتفكير المزدوج\\n \\n \\n أما عندنا فما هو التبرير يا ترى\\n \\n \\n ::::::::::::::::::::\\n \\n \\n \\u200eإن جريمة الفكر لا تفضي إلى الموت إنها الموت نفسه\\u200e\\n \\n ـــــــــــــ\\n \\n \\n \\n يعتمد الحزب الميمون على ما أسماه بالتفكير الازدواجي\\n \\n إنه يعني ببساطة أن تعي \\u200fالحقيقة كاملة \\u200f\\n \\n ومع ذلك تصدق عكسها وبنفس القناعة\\n \\n \\u200f أن \\u200fتؤمن برأيين متناقضين \\u200f\\n \\n \\u200f\" أن تجهض المنطق بالمنطق\\u200f\\n \\n \\u200f أن ترفض الالتزام \\u200fبالأخلاق فيما أنت واحدٌ من الداعين إليها\\n \\n \\u200f أن تعتقد أن \\u200fالديمقراطية ضربٌ من المستحيل في حين أن \\u200fالحزب وصيّ عليه\\n \\n \\u200fأن تنسى كل ما يتعين عليك نسيانه ثم تستحضره في الذاكرة \\u200fحينما \\u200fتمس الحاجة إليه\\n \\n \\u200f ثم تنساه مرة ثانية فورًا..\"\\u200f\\n \\n \\n إنه ليس تجردا من الإنسانية فحسب\\u200f\\n \\n إنه إعادة تصنيع للمخ البشري\\n \\n بعد محو كل ما بداخله\\n \\n إنهم لا يكتفون بأن تخاف\\n \\n بأن تصير كتلة ممزقة اللحم والأعصاب تستعطفهم الموت حتى \\u200fينتهي عذابك\\n \\n إنهم يحيلونك آخر\\n \\n ليصير عقلك ألة\\n \\n مجرد آلة صماء تنفذ الأوامر\\u200f\\n \\n وهذا الآخر أو الآلة يصير مقتنعا تمام الاقتناع بكل استبداد كان \\u200fيناضل لأجل زواله\\u200f\\n \\n \\n إنهم يمسخونك ..\\u200f\\n \\n وهذا أشنع ما في الأمر\\n \\n هذا أشنع ما في الأمر\\n \\n \\n ::::::::::::::::::::\\n \\n \\n وأدرك أيضاً أن هذا هو ما يعتري الإنسان في كل المواقف \\u200f\\u200fالبطولية والمأساوية\\n \\n ففي ميدان القتال أو في غرفة التعذيب أو على متن سفينة \\u200fتغرق\\n \\n تغدو القضايا التي تحارب من أجلها طيّ النسيان دائما\\n \\n ذلك لأن جسدك يظل يتضخم حتى يملأ عليك العالم فلا ترى \\u200fسواه\\n \\n ــــــــــــــــ\\n \\n \\n \\n يعمل وينستون سميث في وزارة \\u200fالحقيقة\\n \\n يشاهد ويشارك يوميا في تزوير التاريخ \\u200f\\n \\n كل السجلات تم إتلافها \\u200f\\n \\n وكل كتاب أعيدت كتابته وكل \\u200fصورة أعيد رسمها\\n \\n واسم كل تمثال وشارع وبناية جرى استبداله\\n \\n وكل تاريخ جرى تحريفه \\u200f\\n \\n \\n \\u200f\"إننا نقوم بتدمير الكلمات –عشرات بل مئات الكلمات\\n \\n \"كل يوم \\u200f\\u200fيجري تدميرها.. إننا نسلخ اللغة حتى العظام\\n \\n \\n ولكن وينستون ارتكب الجريمة العظمى\\n \\n فقد بدأ في الشك\\u200f\\n \\n والتفكير في هذا الهراء الذي يعيش بداخله\\n \\n لقد تمرد في عقله ثم على أرض الواقع\\n \\n يقيم \\u200fعلاقةً مع جوليا المتمردة كذلك\\u200f\\n \\n ينخرط معها في تنظيم للتآمر على الحزب \\u200f\\n \\n أو هكذا خيل لهما\\n \\n \\n وهكذا يلقى تحت رحمة من لا يرحم\\n \\n \\n \\u200f \"إننا \\u200fسنسحقك إلى درجة لا يمكنك بعدها أن تعود بحياتك إلى \\u200fسيرتها \\u200fالأولى وستحدث لك أشياء لن يمكنك أن تبرأ من \\u200fآثارها حتى لو \\u200fعشت ألف عام وأبدا لن تقدر ثانيةً على الشعور \\u200fبما يشعر به \\u200fالأحياء\\n \\n إن كل شيء سيموت داخلك ولن تعود \\u200fقادرا على الحب أو \\u200fالصداقة أو الاستمتاع بالحياة أو الضحك أو \\u200fحب الاستطلاع أو \\u200fالشجاعة أو الاستقامة\\n \\n \"ستكون أجوف لأننا \\u200fسنعصرك حتى تصبح \\u200fخواء من كل شيء ثم نملأك بذواتنا\\n \\n \\n والتعذيب الرهيب الذي يتعرض له وينستون هو تعذيب ممنهج \\u200f\\n \\n \"نحن لا نحطم أعداءنا فحسب\\n \\n \\u200fوإنما نغير ما في أنفسهم\"\\n \\n \\n لا بطش من أجل الانتقام\\n \\n أو تلقين الخارجين عن قوانين الحزب \\u200fدرسا قاسيا\\n \\n \\n إنهم لا يقبلون بالطاعة السلبية أو حتى بالخضوع\\u200f بمعناه المعروف\\n \\n فعندما يخضع السجين في النهاية يجب أن يكون ذلك نابعًا من \\u200fإرادته الحرة\\u200f\\n \\n لا يكفي أن \\u200f\\u200fتقول أن 2 \\u200f\\u200f+ 2 =5\\u200f\\n \\n يجب أن تؤمن بها \\u200f\\n \\n \\n \"إننا نبدد فكره ونجعله \\u200fواحدًا منا قبل أن نقتله\\n \\n إننا نجري للدماغ غسيلا شاملاً قبل أن \\u200fنعصف به\\n \\n نحن نختلف عن طغاة الماضي الذين يقولون: \\u200f\\n \\n يجب \\u200fأن لا تفعل ذلك\\n \\n \\u200f وعن الاستبداديين الذين يقولون: \\u200f\\n \\n يجب أن تفعل \\u200fذلك\\n \\n \"نحن نقول: كن..\\u200f\\n \\n \\n إنهم لا يسمحون لأحد بأن يخرج \\u200fمن سجنهم شهيدا\\u200f\\n \\n \\n إنهم لن يسمعوا عنك أبدًا لأنّك ستُزال تمامًا من سجل \\u200fالتاريخ\"\\n \\n سنحيلك إلى غاز ثم نطلقك في الهواء. سنجعلك نسيًا \\u200fمنسيًّا. \\u200fولن يبقى منك شيء لا اسمًا في سجل ولا أثرًا في ذاكرةٍ \\u200fحيّة\\n \\n \\u200fستمحى كل علاقةٍ لك بالماضي كما بالمستقبل وستصبح \\u200fوكأنك \\u200fلم تكن \"\\u200f\\n \\n \\n \\n \\u200f-كم اصبعا تري يا ونستون \\u200f..؟\\n \\n \\u200f-أربعا.. خمسا \\u200f\\n \\n الرقم الذي تريده ..كل ما أرجوه أن توقف \\u200fالألم\\u200f...\\u200f\\n \\n \\n \\n تحت وطأة التعذيب يعترف وينستون \"بجرائم\" لم يرتكبها أصلا\\n \\n \\n \\u200fوغدا همه الوحيد أن يكتشف ما يريدون أن يعترف به\" \\u200f\\n \\n حتى يبادر إلي الاعتراف قبل أن يلجأ المحققون لحمله علي \\u200fذلك\\u200f\"\\n \\n \\n اغتيال \\u200fعدد من أعضاء الحزب البارزين \\u200f\\n \\n وتوزيع \\u200fمنشورات تحرض علي الفتنة \\u200f\\n \\n واختلاس أموال عامة وبيع أسرار \\u200fعسكرية والاشتراك في \\u200fعمليات التخريب \\u200f\\n \\n وبأنه كان \\u200fعميلا مأجورا لحكومة استاسيا \\u200f\\n \\n وبأنه كان مؤمنا بالله ومعجبا \\u200fبالرأسمالية \\u200f\\n \\n وبأنه انزلق الي الشذوذ الجنسي \\u200f\\n \\n وأنه قتل \\u200fزوجته بالرغم من أنه يعرف مثلما يعرف المحققون \\u200fأن زوجته لا \\u200fتزال علي قيد الحياة\\n \\n ......\\n \\n \\n يمر وينستون بمراحل عدة حتى يصل لمرحلة القبول\\n \\n \\n لقد شعر في غحدى المراحل بأن بقاءه إنسانا\\n \\n هو أمر يستحق \\u200fالتضحية من أجله \\u200f\\n \\n حتى لو لم يؤد ذلك إلى نتيجة فإنه يكون قد \\u200fألحق بهم الهزيمة\\u200f\\n \\n \\n وقد مرت عليه أوقات كانت رؤيته للحرية\\n \\n هي أن يموت وهو يكرههم\\u200f\\n \\n \\n ولكن ذلك كما نعلم.. لم يدم طويلا\\n \\n \\n ::::::::::::::::::::\\n \\n \\n كان الذي استهواه من ذلك كله هو تلك الحركة\\n \\n التي نزعت بها \\u200f\\u200fثيابها وطوحت بها أرضا\\n \\n فبرشاقتها وعدم مبالاتها بدا كأنها \\u200f\\u200fتقوض \\u200fثقافة كاملة\\n \\n وتنقض نظاما فكريا بكليته، كما لو لن الأخ \\u200f\\u200fالكبير والحزب وشرطة الفكر يمكن أن تذهب أدراج الرياح \\u200fبحركة \\u200fبارعة \\u200fكحركة ذراعها \\u200f \\u200f\\n \\n ــــــــــ\\n \\n \\n إنه هذا المزج العجيب الذي تمكن منه أورويل تمكن أستاذ\\n \\n فبرغم كون الرواية تحمل عمقا وقوة تجعلها بلا جدال من \\u200fالطراز \\u200fالرفيع\\n \\n إلا أنها تصل لجميع نوعيات القراء\\u200f\\n \\n ولا تحتاج فئة معينة كي تفهمها\\n \\n هي موجهة للجميع\\n \\n واستطاعت أن تصل إلى قلوب الجميع\\n \\n لقد صنع المعادلة الصعبة بالفعل\\u200f\\n \\n فلا تدع براعتها السياسية تنسيك أنها رواية أدبية من أعلى \\u200fطراز\\n \\n \\n ::::::::::::::::::::\\n \\n \\n \\n السلطة عند الحزب الحاكم\\n \\n \\u200f\\n \\n \\n اقرأ جيدا ما يقوله أورويل على لسان أوبراين\\n \\n \\n إن الحزب يسعى إلى بلوغ السلطة لذاتها تلك المطلقة. \\u200fالسلطة \\u200fغاية وليست وسيلة. لا نسعى وراء الثروة ولا الرفاهية \\u200fولا \\u200fالعمر المديد ولا السعادة. إننا ندرك أنه ما من أحد يمسك بزمام \\u200f\\u200fالسلطة وهو ينتوي التخلي عنها. فالمرء لا يقيم حكما \\u200fاستبداديا \\u200fلحماية الثورة وإنما يشعل الثورة لاقامة حكم \\u200fاستبدادي. إن الهدف \\u200fمن الاضطهاد هو الاضطهاد. والهدف \\u200fمن التعذيب هو التعذيب \\u200fوغاية السلطة هي السلطة. والسلطة \\u200fهي سلطان على البشر، على \\u200fأجسامهم وعلى عقولهم قبل كل \\u200fشيء. أما أن يكون لك سلطان \\u200fعلى المادة فليس بالأمر الهام إذ \\u200fنحن نسيطر على المادة سيطرة \\u200fمطلقة.\\u200f\\n \\n \\n ::::::::::::::::::::\\n \\n \\n \\n النهــــاية\\n \\n \\n \\n وينستون يذبحنا بكلماته الأخيرة\\n \\n أذكر أنني وقت القراءة الأولى ظللت أردد تلك الجملة \\u200f\\n \\n بلا وعي وبانذهال تام\\n \\n \\n (view spoiler)\\n \\n \\n [\\n \\n وهكذا انتصرت على نفسي \\u200fوصرت أحبّ الأخ الكبير\\n \\n وهكذا انتصرت على نفسي \\u200fوصرت أحبّ الأخ الكبير\\n \\n وهكذا انتصرت على نفسي \\u200fوصرت أحبّ الأخ الكبير\\n \\n وهكذا انتصرت على نفسي \\u200fوصرت أحبّ الأخ الكبير\\n \\n ...\\n \\n (hide spoiler)\\n \\n ]\\n \\n \\n \\n فاكتب معي الآن ضاحكا حتى ينخلع قلبك \\u200f\\n \\n \\n الحرب هي السلام\\n \\n العبودية هي الحرية\\n \\n الجهل هو القوة\\n \\n 2+2=5\\n \\n \\n وحاول معي أن تحل هذه الأحجية\\n \\n :\\n \\n :\\n \\n \\n لن يثوروا حتى يعوا\\n \\n ولن يعوا إلا بعد أن يثوروا\\n \\n \\n \\n !\\n \\n -------------\\n \\n \\n هذه المراجعة أرهقتني\\n \\n وعذبتني\\n \\n وأضنت روحي تماما\\n \\n أعتذر لطولها..كما أعتذر \\u200f لكثرة الاقتباسات ولكثرة ثرثرتي\\n \\n \\n إنني فقط أحاول محاولات طفولية\\n \\n أحاول كتابة ما يليق بعظمة مثل هذه الرواية\\n \\n \\n وأرجو أن أكون قد وفقت في أن أصف\\n \\n ولو بعض مما اعتراني مع هذا العمل البديع\\n \\n ..\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 475 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 28 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jun 03, 2011\\n \\n \\n \\n Obaydah Amer\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n \\n \\n \\n هذه الرواية لا يجب أن تصنف أدبا ورواية وفنا وحسب ..\\n \\n كلا .. هي أكبر من ذلك,\\n \\n يجب أن تدرس كحالة مستعصية في علم الاجتماع وعلم السياسة .. !\\n \\n \\n عندما كتب جورج أورويل في الـ1949 كان متشائما لدرجة بعيدة لما سيؤول له العالم بعد 1984\\n \\n نعم، ربما لم يتحقق ما قاله أورويل تماما، لكنه قد حصل بصورة موازية وشبيهة في كثير من المجتمعات الشمولية\\n \\n لنتحدث عن سوريا مثلا :\\n \\n \\n الأخ الكبير : القائد الملهم والرئيس الشاب الدكتور بشار الأسد ..\\n \\n أعضاء الحزب الداخلي: بعض المكونات الرئيسية للنظام\\n \\n أعضاء الحزب الخارجي: حزب البعث\\n \\n العامة: 19 مليون\\n \\n \\n هذه الرواية لا يجب أن تصنف أدبا ورواية وفنا وحسب ..\\n \\n كلا .. هي أكبر من ذلك,\\n \\n يجب أن تدرس كحالة مستعصية في علم الاجتماع وعلم السياسة .. !\\n \\n \\n عندما كتب جورج أورويل في الـ1949 كان متشائما لدرجة بعيدة لما سيؤول له العالم بعد 1984\\n \\n نعم، ربما لم يتحقق ما قاله أورويل تماما، لكنه قد حصل بصورة موازية وشبيهة في كثير من المجتمعات الشمولية\\n \\n لنتحدث عن سوريا مثلا :\\n \\n \\n الأخ الكبير : القائد الملهم والرئيس الشاب الدكتور بشار الأسد ..\\n \\n أعضاء الحزب الداخلي: بعض المكونات الرئيسية للنظام\\n \\n أعضاء الحزب الخارجي: حزب البعث\\n \\n العامة: 19 مليون ونصف المليون مواطن سوري\\n \\n أوقيانوسيا: سوريا الأسد\\n \\n الله هو السلطة: الله سوريا بشار وبس\\n \\n التفكير المزدوج: \"دولة ممانعة لم تطلق رصاصة واحدة على عدوها الذي وجدت لممانعته\" مثلا\\n \\n شاشات الرصد: الهواتف والتجسس على الإنترنت\\n \\n اللغة الجديدة: الإصلاح، الممانعة، التقدم، القومية وغيرها\\n \\n أوبراين: نموذج للمخبر السوري الذي تمنحه روحك وثقتك ليضربك ويهينك\\n \\n غرفة 101: السجن الصحراوي\\n \\n غرف وأقبية وزارة الحب: المقار الأمنية المنتشرة في كل مكان\\n \\n حتى الجهاز ذا القرص موجود باسم بساط الريح\\n \\n وغيرها ..\\n \\n \\n المقصود أن بإمكانك إسقاط الرواية على أي مجتمع شمولي لترى منظورا مشابها لذاك العالم المظلم.\\n \\n لكن النتيجة المختلفة ..\\n \\n \\n هناك بعض الجمل التي يجب أن تحفظ حفظا، لا أن تسجل فقط :\\n \\n \\n الولاء يعني عدم التفكير، بل هو عدم الحاجة للتفكير. الولاء يعني عدم الوعي\\n \\n \\n وهذا ما نحفظه وندرسه في المدارس بنفس المصطلح، الولاء للأخ الكبير .. بغض النظر عن تصرفاته ونتائجها وأفكاره وما يقوم به، أي فعلا عدم الوعي ..\\n \\n \\n \\n إن كان هناك من أمل فهو في العامة\\n \\n \\n تماما .. فقط أعطهم بعض الوعي وسيصنعون المعجزات ..\\n \\n أي :\\n \\n \\n لكي يثوروا يجب أن يعوا، ولكي يعوا يجب أن يثورووا\\n \\n \\n \\n أرجوك .. إن نسيت كل الرواية، فاخرج منها بهذه الثلاث كلمات فقط .. !\\n \\n \\n غاية السلطة هي السلطة\\n \\n \\n السلطة وحسب ..\\n \\n ولا تصدقوا كل الخطابات الخالدة والوعود الاقتصادية والسياسية والعسكرية والتنموية ..\\n \\n السلطة للسلطة، لا لخدمة أحد أو شعب أو إنسانية أو قيمة أو خلق أو أي شيء آخر ..\\n \\n لذلك فالسلطة المطلقة دائما مفسدة مطلقة ..\\n \\n \\n مقاطع كتاب غولدشتاين وإن كانت طوباوية إلى حد ما، لكنها صحيحة وأكاديمية . !\\n \\n \\n الوضع الطبيعي يجب أن يسير كما تحدث عنه أورويل، ولو أن صاحب الحانوت - نسيت اسمه - وأوبراين ما كانا مخبرين لنجحت الثورة ..\\n \\n وهذا ما حصل في مصر وتونس، وسيحصل في بقية المجتمعات الشمولية ..\\n \\n بوعي العامة وثورتهم ثم وعيهم مرة أخرى ..\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 454 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 53 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Aug 28, 2008\\n \\n \\n \\n Stephen\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Shelves:\\n \\n all-time-favorites\\n \\n ,\\n \\n 6-star-books\\n \\n ,\\n \\n easton-press\\n \\n ,\\n \\n audiobook\\n \\n ,\\n \\n 1930-1953\\n \\n ,\\n \\n world-in-the-shitter\\n \\n ,\\n \\n science-fiction\\n \\n ,\\n \\n favorite-ideas\\n \\n ,\\n \\n literature\\n \\n ,\\n \\n classics\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n I am a big fan of speculative fiction and in my literary travels I have encountered a myriad of dystopias, anti-utopias and places and societies that make one want to scream and.....\\n \\n \\n \\n \\n ...\\n \\n (with or without contemporaneous loss of bladder and other bodily functions)\\n \\n ....\\n \\n \\n Simply put, George Orwell\\'s 1984 is unquestionably the most memorable and\\n \\n MOST DISTURBING\\n \\n vision of a world gone\\n \\n mad\\n \\n utterly bat-shit psycho that I have ever experienced. Ever!!! Despite being published back in 1948, I have yet to f\\n \\n \\n \\n \\n \\n \\n I am a big fan of speculative fiction and in my literary travels I have encountered a myriad of dystopias, anti-utopias and places and societies that make one want to scream and.....\\n \\n \\n \\n \\n ...\\n \\n (with or without contemporaneous loss of bladder and other bodily functions)\\n \\n ....\\n \\n \\n Simply put, George Orwell\\'s 1984 is unquestionably the most memorable and\\n \\n MOST DISTURBING\\n \\n vision of a world gone\\n \\n mad\\n \\n utterly bat-shit psycho that I have ever experienced. Ever!!! Despite being published back in 1948, I have yet to find a more chilling, nightmarish locale than Orwell\\'s iconic world of\\n \\n BIG BROTHER\\n \\n and\\n \\n INGSOC\\n \\n . The very mention of either of those terms invokes images of Nazis and Soviet gulags in my mind. Yet Orwell\\'s creation is in many ways even more insidious than these real-world bogeymen.\\n \\n \\n I first read this book when I was 12 years old in 7th grade as a...get this...class reading assignment. Looking back on it, I have NO IDEA why on Earth we were reading this book at that age but I do recall we spent quite a bit of time discussing it. I wish I could recall the substance of those discussions because I can only imagine the kind of PIERCING INSIGHT that a group of hormonally challenged pre-teens thought up in regards to this book. Needless to say, I think that this is a book that is best appreciated AFTER your first pimple.\\n \\n \\n Anyway, I decided to re-read this book recently as an adult in the hopes that I would be able to gain a great appreciation for this classic. Well, the book did more than that.\\n \\n IT ABSOLUTELY FLOORED ME\\n \\n . From the very first sentence,\\n \\n \"It was a bright, cold day in April, and the clocks were striking thirteen\"\\n \\n to the unforgettable final sentence (which I will not give away here), this story sucked me in, beat the living shit out of me and through me out the other side a hollow, wasted wreck. I know, it doesn\\'t sound very cheery, but it is a life-changing experience.\\n \\n \\n I have always thought that one of the best and most important qualities of science fiction is that it frees the author to take the controversial, politically charged issues and trends of the day and create a possible future based on exaggerations of such trends and in so doing present a compelling and critical argument for change. Well NO ONE has ever done a better job than better Orwell in showing the possible nightmare (and thus potential danger) of a society without basic civil liberties and a government with complete and unchallenged control.\\n \\n \\n This book is bleak, dreary, frightening, upsetting and absolutely BRILLIANT and one of my \"All Time Favorite\" novels. HIGHEST POSSIBLE RECOMMENDATION!! 6.0 stars.\\n \\n \\n ...........\\n \\n REMEMBER, BIG BROTHER IS WATCHING YOU\\n \\n .............\\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 405 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 43 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Feb 19, 2018\\n \\n \\n \\n Maria\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n favorites\\n \\n \\n \\n \\n \\n \\n I\\'m gonna ask myself a mandatory question and say nothing more.\\n \\n \\n Why the fuck had I not read this book before?\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 364 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 18 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jan 06, 2011\\n \\n \\n \\n Lyndsey\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Shelves:\\n \\n about-dystopia-or-utopia\\n \\n ,\\n \\n i-recommend\\n \\n ,\\n \\n reviewed-2010\\n \\n ,\\n \\n reviewed-2011\\n \\n ,\\n \\n reviewed-5-stars\\n \\n ,\\n \\n favorites\\n \\n ,\\n \\n pov-primarily-male\\n \\n ,\\n \\n 3rd-person-limited\\n \\n ,\\n \\n experience\\n \\n ,\\n \\n my-top-dystopian-or-utopian\\n \\n \\n \\n \\n \\n \\n \\n YOU. ARE. THE. DEAD.\\n \\n Oh my God. I got the chills so many times toward the end of this book. It completely blew my mind. It managed to surpass my high expectations AND be nothing at all like I expected. Or in Newspeak \"Double Plus Good.\"\\n \\n \\n Let me preface this with an apology. If I sound stunningly inarticulate at times in this review, I can\\'t help it. My mind is completely fried.\\n \\n \\n \\n This book is like the dystopian Lord of the Rings\\n \\n , with its richly developed culture and economics, not to mention a fully\\n \\n \\n \\n \\n \\n \\n \\n YOU. ARE. THE. DEAD.\\n \\n Oh my God. I got the chills so many times toward the end of this book. It completely blew my mind. It managed to surpass my high expectations AND be nothing at all like I expected. Or in Newspeak \"Double Plus Good.\"\\n \\n \\n Let me preface this with an apology. If I sound stunningly inarticulate at times in this review, I can\\'t help it. My mind is completely fried.\\n \\n \\n \\n This book is like the dystopian Lord of the Rings\\n \\n , with its richly developed culture and economics, not to mention a fully developed language called Newspeak, or rather more of the anti-language, whose purpose is to limit speech and understanding instead of to enhance and expand it. The world-building is so fully fleshed out and spine-tinglingly terrifying that it\\'s almost as if George travelled to such a place, escaped from it, and then just wrote it all down.\\n \\n \\n I read Fahrenheit 451 over ten years ago in my early teens. At the time, I remember really wanting to read 1984, although I never managed to get my hands on it. I\\'m almost glad I didn\\'t. Though I would not have admitted it at the time, it would have gone over my head. Or at the very least, I wouldn\\'t have been able to appreciate it fully.\\n \\n \\n From the start, the author manages to articulate so many of the things I have thought about but have never been able to find a way to put into words. Even in the first few chapters I found myself having to stop just to quietly consider the words of Mr Orwell.\\n \\n \\n For instance, he talks about how\\n \\n the act of writing itself is a type of time travel\\n \\n . It is communicating with the future. I write these words now, but others may not discover them for hours, weeks, or even years. For me, it is one time. For you the reader, it is an entirely different one.\\n \\n \\n Just the thought that reading and writing could one day be outlawed just shivers my timbers. I related to Winston so much in that way. I would have found a way to read or write.\\n \\n \\n \\n The politics and psychology of this novel run deep\\n \\n . The society in the book has no written laws, but many acts are punishable by death. The slogan of the Party (War is Peace...) is entirely convoluted. Individuality is frowned upon and could lead to being labeled a traitor to the Party.\\n \\n \\n I also remember always wondering why the title was 1984. I was familiar with the concept of Big Brother and wondered why that wasn\\'t the name of the book. In the story, they don\\'t actually know what year it is because so much of the past has been erased by the Ministry of Truth. It could very easily have been 1981. I think that makes the title more powerful. Something as simple as the year or date is unknown to these people. They have to believe it is whatever day that they are told it is. They don\\'t have the right to keep track. Knowledge is powerful. Knowledge is necessary. But according to Big Brother. Ignorance is strength.\\n \\n \\n 1984 is written in past tense and has long paragraphs of exposition, recounting events, and explaining the society. These are usually things that distance me from a book and from the characters, but Orwell managed to keep me fully enthralled. He frequently talks in circles and ideas are often repeated but it is still intriguing, none the less. I must admit that I zoned out a bit while Winston was reading from The Book, but I was very fascinated by the culture.\\n \\n \\n Sometimes it seems as though the only way to really experience a characters emotions is through first person. This is not the case with this book, as it is written in third person; yet, I never failed to be encompassed in Winston\\'s feelings. George manages to ensure that the reader never feels disconnected from the events that are unfolding around them, with the exception of the beginning when Winston is just starting to become awakened. I developed a strong attachment to Winston and thrived on living inside his mind. I became a member of the Thought Police, hearing everything, feeling everything and last but not least, (what the Thought Police are not allowed to do) questioning everything.\\n \\n \\n I wasn\\'t expecting a love story in this book, but the relationship between Julia and Winston was truly profound. I enjoyed it even more than I would have expected and thought the moments between them were beautiful. I wasn\\'t sure whether he was going to eventually betray Julia to the Party or not, but I certainly teared up often when it came to their relationship.\\n \\n \\n George has an uncanny ability to get to the base of the human psyche, at times suggesting that we need to be at war for many different reasons, whether it\\'s at war with ourselves or with others. That is one thing I have never understood: why humans feel the need to destroy and control each other.\\n \\n \\n It seems that the main and recurring message in this book is about censorship and brainwashing. One, censorship, is limited and little exposure to ideas of the world; the other, brainwashing, is forced and too much exposure to a certain ideas. Both can be extremely dangerous.\\n \\n \\n Inside the ministry of Truth, he demonstrates the dangers of censorship by showing how the Party has completely rewritten the past by forging and abolishing documents and physical evidence. We also spend quite a bit of time with Winston in the Ministry of Love, where the brainwashing takes place. Those who commit thoughtcrime are tortured until they grow to love and obey Big Brother and serve only the interests of the Party.\\n \\n \\n A common theme occurred to me throughout the book, although it wasn\\'t necessarily referenced consistently. The good of the many is more important than the good of the one. There are so many variables when it comes to this statement and for the most part it seems natural to say, \"Of course, the many is more important than the one\", but when inside Winston\\'s head, all that I began to care about was his well-being and not if he was able to help disband or conquer the Party and Big Brother. I just wanted him to be at peace.\\n \\n \\n Whether or not the good of all is more important than that of the one, I can\\'t answer. I think most people feel their own happiness is more important than the rest of the world\\'s, and maybe that\\'s part of the problem but it\\'s also human nature. I only wish we could all accept one other regardless of belief and culture and not try to force ways of life onto other people. Maybe I\\'m naive for thinking that way, but so be it.\\n \\n \\n I almost don\\'t know what to think about this book. I\\'m not even sure my brain still works, or if it ever worked right at all. This book has a way of making you think you know exactly what you believe about everything and then turning you completely upside down and making you question whether or not you believe anything at all about anything. It\\'s the strangest thing. Hmmm. Doublethink? Perhaps. Perhaps not.\\n \\n \\n Everything about this book is captivating. It\\'s groundbreaking yet at the same time, purely classic. Ahead of its time, yet timeless. From Big Brother to the Thought Police, I was hooked and wanted to know more about it all.\\n \\n \\n Basically, I think everyone should read 1984 at some point. You really have to be in the mood to work at reading it, though. But it\\'s all worth it in the end. It\\'s absolutely incredible and I loved it. I don\\'t re-read many books but this will definitely be one of them. It is a hard read, but more importantly, it is a MUST read.\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 347 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 32 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jun 06, 2008\\n \\n \\n \\n Amanda\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n kick-ass\\n \\n ,\\n \\n book-club-made-me-do-it\\n \\n ,\\n \\n blog\\n \\n \\n \\n \\n \\n \\n I\\'ve put off writing a review for 1984 because it\\'s simply too daunting to do so. I liked 1984 even better after a second reading (bumping it up from a 4 star to a 5 star) because I think that, given the complexity of the future created by Orwell, multiple readings may be needed to take it all in. I thought it was genius the first time and appreciated that genius even more the second time.\\n \\n \\n Orwell had a daunting task: creating a future nearly half a century away from the time period in which he w\\n \\n \\n I\\'ve put off writing a review for 1984 because it\\'s simply too daunting to do so. I liked 1984 even better after a second reading (bumping it up from a 4 star to a 5 star) because I think that, given the complexity of the future created by Orwell, multiple readings may be needed to take it all in. I thought it was genius the first time and appreciated that genius even more the second time.\\n \\n \\n Orwell had a daunting task: creating a future nearly half a century away from the time period in which he was writing. This future had to be its own complex, independent society, but it also had to be the natural end result of the totalitarianism Orwell witnessed in the communist and socialist regimes of World War II. That\\'s part of the horror of 1984: this future is a recognizable one, even in the 21st century. It\\'s easy to see how those in control can, through manipulation and propaganda, maintain that control simply for the sake of sating their own power hunger. It\\'s easy to say \"no one could ever tell me what to think or what to do,\" but the Party\\'s use of Big Brother, the Thought Police, the Two-Minute Hate, and Doublethink make it easy to see how a person\\'s ability to think independently and discern fiction from reality can be eroded when there is no touchstone to fact. Revising and rewriting the past to make certain that Big Brother and the Party are always correct has effectively eliminated historical accuracy. How can one think and reason in a society where everything is a fabrication?\\n \\n \\n Another facet of 1984 that I find fascinating is the relationship between Winston and Julia. Winston claims Julia is a \"rebel from the waist down,\" engaging in promiscuity and hedonistic indulgences forbidden by the Party. She doesn\\'t care about social injustice or defining \"reality\"; she only longs for what will make her feel good in the moment and only rebels far enough to get what she wants. By comparison, Winston is an intellectual rebel, constantly worrying over the issues of truth and freedom and the real, unvarnished past, but limited in how far he\\'s willing to push the boundaries (until he meets Julia). Together, they make a complete rebellion--physical and mental, but apart they find themselves impotent to stand up to the Party.\\n \\n \\n A cautionary tale, social commentary, and exemplary example of dystopian fiction, 1984 is one of those perfect novels that not only entertains, but forces one to think about the danger associated with giving any one person or entity too much power or control over our lives--issues well worth consideration in post-9/11 America.\\n \\n \\n Cross posted at\\n \\n This Insignificant Cinder\\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 282 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 17 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Nov 09, 2017\\n \\n \\n \\n Leo .\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Is Orwell turning in his grave? Does his epitaph read. \"I fucking warned you! Don\\'t say I never told you so! \"\\n \\n \\n Did he have a crystal fucking ball?\\n \\n \\n ***\\n \\n If you want truth, go out and see\\n \\n \\n Not like in 1984, Richard Burton on TV\\n \\n \\n Orwell must have been psychic, or was he in the know\\n \\n \\n Cos\\' what\\'s going on in the world clearly shows\\n \\n \\n That humanity is programmed through a TV screen\\n \\n \\n Since its conception, its all its ever been\\n \\n \\n News, films, dramas, sports, soaps and cartoons\\n \\n \\n Leaving the masses wide eyed, like Buffoons\\n \\n \\n Al\\n \\n \\n Is Orwell turning in his grave? Does his epitaph read. \"I fucking warned you! Don\\'t say I never told you so! \"\\n \\n \\n Did he have a crystal fucking ball?\\n \\n \\n ***\\n \\n If you want truth, go out and see\\n \\n \\n Not like in 1984, Richard Burton on TV\\n \\n \\n Orwell must have been psychic, or was he in the know\\n \\n \\n Cos\\' what\\'s going on in the world clearly shows\\n \\n \\n That humanity is programmed through a TV screen\\n \\n \\n Since its conception, its all its ever been\\n \\n \\n News, films, dramas, sports, soaps and cartoons\\n \\n \\n Leaving the masses wide eyed, like Buffoons\\n \\n \\n All the rhetoric and propaganda, oozing about us, every place we look, and go\\n \\n \\n It is everywhere, embedded, enveloping, as people to and fro\\n \\n \\n Screens on buildings, bus stops, train stations, all over the place, fuelling our vices\\n \\n \\n PC\\'s, laptops, google glass, tablets and mobile devices\\n \\n \\n Its in the ether, the air and the subconscious brain\\n \\n \\n Whether one is aware or not, the information leaves its stain\\n \\n \\n Orwell must have been psychic, or was he in the know\\n \\n \\n Perpetual war, a bogeyman, terrorists, must be real, its all a TV show\\n \\n \\n Censored press, hacking phones, spying on the masses\\n \\n \\n Every email, phone call, text message, and google eye glasses\\n \\n \\n Technocratic Dystopia, hunger games, people put into factions\\n \\n \\n Not allowed to speak, monitoring our actions\\n \\n \\n In the name of security, no person is free\\n \\n \\n Unless your blood is Royal, or have connections to the family\\n \\n \\n Or a valued member in Vatican State, purple robes, velvet glove, and iron fist\\n \\n \\n A Freemason, a congressman, senator, president, PM, you get the gist\\n \\n \\n Social engineering, eugenics, deep state, cabals and satanic cults\\n \\n \\n Lodges, temples, hail, thunder and lightening bolts\\n \\n \\n Rapture, ragnarok, jihad, ends of days TV\\n \\n \\n In dramas, films, cartoons, its all we ever see\\n \\n \\n Monsters and bogeymen, cold war, terrorism, and disease, and destruction\\n \\n \\n People trafficking, drug smuggling, arms deals, and child abduction\\n \\n \\n All entertainment, to keep the masses distracted\\n \\n \\n No freedom of information, cos the juicy bits are redacted\\n \\n \\n In the name of security, or for the security of a famous name\\n \\n \\n The whole thing is inverted, its all a game\\n \\n \\n Cos\\' rules are lures, and laws are walls\\n \\n \\n And all of the people are silly fools\\n \\n \\n Glued to a PC, Mob Phone or TV screen\\n \\n \\n Since its conception, its all its ever been\\n \\n \\n Was Orwell a psychic, or was he in the know\\n \\n \\n One things for certain, it won\\'t be on a TV show\\n \\n \\n By Leo.🐯👍\\n \\n \\n \\n When one is young and immersed into the seas of academia one is asked what one wants to be when one grows up? Which pigeon hole? What label? What career?\\n \\n \\n When a car driver loses control of the vehicle and strays from the path that was ahead, the car careers off the road. One might crash. One is no longer on the journey one originally set out on. One is lost. Off the beaten track.\\n \\n \\n So, when one is a child and asked what career one wants, esoterically it means how can one be swayed or crashed and stopped from what one may want to be when one grows up. The only answer a child should give to their teacher (indoctrinater) is...HAPPY!👍🐯\\n \\n \\n Who are these people? These authorities with all the powers?\\n \\n \\n Deciding what we say, or do, or go, from their Ivory Towers\\n \\n \\n A deviant neighbour moves in next door, behaviour abnormal, and hoarding trash\\n \\n \\n Puts his waste in his shed, a festering, mouldy stash\\n \\n \\n Attracting rats, mice, flies and vermin of all kinds\\n \\n \\n Breaking other residents resolve, distorting their minds\\n \\n \\n For when the community complain about it, every day, week in week out, all the time\\n \\n \\n These authorities point the finger at us, accuse us of a Bloody Hate Crime!\\n \\n \\n Rationale has been replaced, with the word Hate\\n \\n \\n As the lines blur, in this New World Order, is it too late?\\n \\n \\n To change this world? To take a stance? Maybe our last Chance!\\n \\n \\n This world is going to Hell in a Shitstorm! If we don\\'t restore the Earth\\'s Balance. 🐯👍\\n \\n \\n \\n Politics, or many ticks? Crawling all over society\\n \\n \\n Police or Po-Lice? Crawling over people who are Free\\n \\n \\n Choose and Lose, for they are not there, for the likes of You and Me\\n \\n \\n Look around and thus, Beware!\\n \\n \\n These parasites, are only there to Scare\\n \\n \\n To enforce Order, in the chaos they Create\\n \\n \\n On behest of the Magicians behind the curtains, the One\\'s that preach Hate.\\n \\n \\n In this Cube, this false construct, this Square.\\n \\n \\n So look around, see the whole, and Beware!\\n \\n \\n I am full aware of what is going on in this pursuit for a New World Order, an Old World Order, whereby the void between the few and the majority broadens. I am so frustrated how the Sheeple just seem to lap it up. Every day the Inter-NET tightens it\\'s grip or, the World Wide Spider Web lures and traps millions with the Glitsy new smart phone. A cell phone. A smart cell phone that is all singing and dancing...Blah! Blah! Blah! It is called a Cell phone for a reason. Like the Net and the Web. Soon all appliances and mob devices will be Smart. If one does not own one then when 5G is rolled out and the Smart Grid comes into being, one will be left behind. Soon all money paid in wages or commerce will be digital and people will not survive in the New Virtual World unless one is chipped or connected to the 5G network. Understand that money is phony. It is paper or a figure on a PC screen. Soon to be a digital concept, like in the film In Time. Money used to be made of copper, silver and gold. This is when coins actually held value, worth it\\'s weight in gold actually meant something. Then the Templars invented the Banking system, (now they are called Freemasons) a Fiat pyramid system that is illegal yet, no person seems to care. That is the way it is. Only because of ignorance. Acquiescence, Taxation is a fraud. It is theft. Time to wake up before it is too late.\\n \\n \\n Club of Rome, Skull and Bones, Knights of the Realm, Knights of Malta, Rosicrucians, CFR, just a few of the Nefarious institutions. London School Of Economics and the Tavistock Institute. Oh! And the female freemasonic Eastern Star. Maybe I have said too much but, I don\\'t care anymore.\\n \\n \\n That is today\\'s Rant.\\n \\n \\n Everybody should read 1984 and also watch the film.\\n \\n \\n Update:\\n \\n \\n The Sex Pistols, a great British band\\n \\n \\n Fully aware, of the hidden hand\\n \\n \\n The entity, that controls, from most high, looking down\\n \\n \\n Elevated, Godlike, Alpha, The Crown💓👍🐯\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 274 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 16 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Mar 27, 2017\\n \\n \\n \\n Starjustin\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n What can I possibly say about this amazing novel, 1984 by George Orwell, that hasn\\'t been already said by many who have read the book for over half a century. When it is said that the book is \\'haunting\\', \\'nightmarish\\', and \\'startling\\' any reader would have to agree! This well known novel grips the reader from the beginning and does not even let go of the grip at the finished reading. A classic you won\\'t want to miss if you haven\\'t taken the time to read it yet.\\n \\n I actually listened to this novel\\n \\n \\n What can I possibly say about this amazing novel, 1984 by George Orwell, that hasn\\'t been already said by many who have read the book for over half a century. When it is said that the book is \\'haunting\\', \\'nightmarish\\', and \\'startling\\' any reader would have to agree! This well known novel grips the reader from the beginning and does not even let go of the grip at the finished reading. A classic you won\\'t want to miss if you haven\\'t taken the time to read it yet.\\n \\n I actually listened to this novel on audio and Simon Prebble was the \\'perfect\\' narrator.\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 236 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 33 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jun 25, 2011\\n \\n \\n \\n فهد الفهد\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n 0-favorites\\n \\n ,\\n \\n fiction-europe-british\\n \\n \\n \\n \\n \\n \\n 1984\\n \\n \\n نشر أورويل هذه الرواية بعد أربع سنوات من نشر روايته (مزرعة الحيوان)، كانت مزرعة الحيوان عن انهيار الحلم الشيوعي، وتبعثره على يد الستالينيين، وكيف أن المجتمع الشيوعي أصبح أسوأ بكثير من المجتمع الرأسمالي، وأنه ليست أرزاق العمال والفلاحين المهددة الآن تحت ظل الشيوعية، وإنما حرياتهم بل وحياتهم ذاتها.\\n \\n \\n احتاج النظام السوفييتي إلى عشرين عام فقط بعد الثورة (1917 – 1937 م)، ليظهر أقبح وجوهه في مهزلة محاكمات موسكو، وحملات التطهير التي قتل فيها ما يقترب من المليوني شخص في الاتحاد السوفييتي، فلذا عندما\\n \\n \\n 1984\\n \\n \\n نشر أورويل هذه الرواية بعد أربع سنوات من نشر روايته (مزرعة الحيوان)، كانت مزرعة الحيوان عن انهيار الحلم الشيوعي، وتبعثره على يد الستالينيين، وكيف أن المجتمع الشيوعي أصبح أسوأ بكثير من المجتمع الرأسمالي، وأنه ليست أرزاق العمال والفلاحين المهددة الآن تحت ظل الشيوعية، وإنما حرياتهم بل وحياتهم ذاتها.\\n \\n \\n احتاج النظام السوفييتي إلى عشرين عام فقط بعد الثورة (1917 – 1937 م)، ليظهر أقبح وجوهه في مهزلة محاكمات موسكو، وحملات التطهير التي قتل فيها ما يقترب من المليوني شخص في الاتحاد السوفييتي، فلذا عندما نشر أورويل كتابه هذا في سنة 1949 م، كان يتوقع بأن 35 سنة كافية ليتحول العالم كله إلى الصورة المرعبة التي رسمها في روايته هذه، حيث تنقسم الكرة الأرضية إلى ثلاث دول فقط، إيستاسيا وهي الدولة التي تضم بلاد شرق آسيا وجنوبها من الصين واليابان والهند وغيرها من الدول المحيطة، وأوراسيا وهي الدولة التي تسيطر على روسيا وأوروبا، وأوقيانيا التي تسيطر على الأمريكتين والجزيرة البريطانية.\\n \\n \\n بطل الرواية وينستون سميث خمسيني يعيش في لندن ضمن حدود دولة أوقيانيا، والتي يسيطر عليها حزب وحيد يقوده الأخ الأكبر، والذي يحمل ملامح ستالينية لا يمكن أن يخطئها القارئ، الأخ الأكبر تتمحور حوله عبادة الشخصية كما ظهرت في الفترة الستالينية، وصوره في كل مكان من الدولة، وتحتها العبارة الشهيرة (الأخ الأكبر يراقبك)، وطيلة الرواية لا ندري هل الأخ الأكبر موجود أم لا؟ ربما يكون ميتاً منذ زمن بعيد، ولكن عبادة الشخصية تحوله إلى كائن أسطوري خالد، وتمحور كل شيء حول شخصه، وهي حالة مخزية جداً، لازالت موجودة في واقعنا المعاصر وإن بدرجات متفاوتة، ومثالها البارز كوريا الشمالية.\\n \\n \\n نتعرف مع وينستون على الحالة الغريبة التي وصل إليها ذلكم المجتمع الشمولي، حيث أربع وزارات تدير البلد، وزارة السلم وهي المسئولة عن الحرب، وزارة الوفرة وهي المسئولة عن الاقتصاد، الذي نعرف من خلال الرواية أنه بعيد تماماً عن الوفرة، وزارة الحقيقة وهي مشابهة لوزارة الإعلام ولكنها متخصصة في نشر الأكاذيب والشائعات، وأخيراً وزارة الحب وهي الوزارة المرعبة التي تشرف على شرطة الفكر، وعلى عمليات التعذيب المنهجية للمعارضين، والتي تتابع الناس من خلال شاشات الرصد الموجودة في كل مكان حتى في منازل أتباع الحزب.\\n \\n \\n قد تبدو لنا تسمية الوزارات ساخرة، حيث تقوم كل وزارة بمهام معاكسة لاسمها، ولكننا نكتشف أن وراء التسمية فلسفة رهيبة، هي فلسفة التفكير المزدوج، التي يحاول الحزب من خلالها قتل كل فكر مناهض، هذه الفلسفة نفهمها ونفهم المراد منها في الفصول الأخيرة من الرواية.\\n \\n \\n في هذا المجتمع المخيف، يحاول وينستون المشوش، والذي يعمل في وزارة الحقيقة، حيث يقوم بمهام تعديل الأخبار القديمة لتتوافق مع معطيات الحاضر، وهي مهمة يحرص عليها الحزب ليتلاعب بالتاريخ ويجعله يأتي وفقاً لفلسفته وخططه، يحاول وينستون البحث عن الحقيقة، التساؤل، هل كان الأمر هكذا دائماً؟ لا يوجد ذاكرة للمجتمع، لقد تلاعب بها الحزب، أعاد كتابة التاريخ ليجعله يبدأ من الثورة التي أتت بالحزب، وسلطته على رقاب الناس، فلذا صار وينستون لا يعرف إلا أطياف من المعلومات عن أوضاع ما قبل الثورة، ما قبل الحزب، وفي رحلته في البحث عن الحقيقة، تنشأ قصة حب خفية بينه وبين جوليا، وهي فتاة من الحزب، تتظاهر بأنها مؤمنة بالمبادئ قلباً وقالباً، ولكنها هي من يقود وينستون في قصة الحب هذه التي يخفيانها عن شاشات الرصد، وعن شرطة الفكر.\\n \\n \\n في أثناء هذا يلتقي وينستون بأوبراين، أحد قادة الدائرة الداخلية للحزب، والذي يكشف له أنه مؤمن بأفكار عدو الحزب الأساس (عمانوئيل جولدشتين)، والوصف الذي يعطينا إياه المؤلف لجولدشتين هذا يذكرنا بتروتسكي، يمني أوبراين وينستون بثورة قادمة، ويعطيه كتاباً لجولدشتين يقرؤه وينستون أثناء لقاءاته بجوليا.\\n \\n \\n يتم القبض على وينستون وجوليا أثناء أحد لقاءاتهما، حيث يكتشفان أنهما كانا مراقبين منذ البداية، وأن كل ما فعلاه رصدته شرطة الفكر، بل والأسوأ هو أن أوبراين ذاته من شرطة الفكر، وهو من سيتولى تعذيب وتحطيم شخصية وينستون.\\n \\n \\n يصف لنا المؤلف وبدقة التعذيب الذي يتعرض له وينستون، وهو ليس تعذيب جسدي فقط، وإنما هو عملية منهجية يتم فيها غسل دماغ وينستون، وتلقينه التفكير المزدوج الذي يجعله يصدق أن 2 زائد 2 يساوي خمسة عندما يقول له الحزب ذلك، لا يكفي أن يقولها خوفاً، لا... وإنما يجب أن يؤمن بها في قلبه، وهذا هو الطريق الذي سيحمله إلى محبة الأخ الأكبر.\\n \\n \\n هذه العملية المرعبة نتابع نتائجها المؤلمة على وينستون حتى النهاية، المرعب هو أننا نعرف من خلال التاريخ أن أورويل لم يبتكر كل هذا، فبرامج التعذيب هذه مطبقة خلال الفترة السوفياتية، حتى أن المعذبين كانوا عندما يعدمون، يبكون، لا على أنفسهم، وإنما لأنهم يشعرون بأنهم خذلوا الأخ الأكبر، خذلوا الزعيم الأبدي.\\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 232 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 26 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Feb 08, 2017\\n \\n \\n \\n Joe\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Social media is a cage full of starved rats and all of us have our heads stuck in there now, like it or not.\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 225 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 8 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jan 29, 2011\\n \\n \\n \\n أحمد أبازيد Ahmad Abazed\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Shelves:\\n \\n favorites\\n \\n \\n \\n \\n \\n \\n \" انتبه : الأخ الكبير يراقبك ! \"\\n \\n رواية صادمة تمثّل زلزالا للوعي و اللاوعي لدى كلّ من يقرؤها , هذه الرواية التي شكّلت ذروة عبقريّة جورج أورويل و تأثّره و تأثيره في الوعي العالمي و التاريخ الحديث .\\n \\n الأخ الكبير عند أورويل له مرادفات في ثقافتنا العربية الراهنة ( مثلا : الأخ العقيد , القائد الخالد , القائد الضرورة ... أو الرئيس الشاب ! ) هذا الاختلاف في التسمية هو توافق عبقريّ في مأساويّته لدولة \" أوقيانيا \" مع دول مثل : سورية و العراق و ليبيا و تونس و مصر ... و باقي أنظمتنا الثوريّة التي تأكلنا و تفتّ\\n \\n \\n \" انتبه : الأخ الكبير يراقبك ! \"\\n \\n رواية صادمة تمثّل زلزالا للوعي و اللاوعي لدى كلّ من يقرؤها , هذه الرواية التي شكّلت ذروة عبقريّة جورج أورويل و تأثّره و تأثيره في الوعي العالمي و التاريخ الحديث .\\n \\n الأخ الكبير عند أورويل له مرادفات في ثقافتنا العربية الراهنة ( مثلا : الأخ العقيد , القائد الخالد , القائد الضرورة ... أو الرئيس الشاب ! ) هذا الاختلاف في التسمية هو توافق عبقريّ في مأساويّته لدولة \" أوقيانيا \" مع دول مثل : سورية و العراق و ليبيا و تونس و مصر ... و باقي أنظمتنا الثوريّة التي تأكلنا و تفتّتنا و تسحقنا منذ عقود , هذا التوافق في سايكولوجية الاستبداد و خلق القطيع و و تنصيب الصنم للجماهير , و توجيه غضبها نحو الوجهة التي ترضي \" الأخ الكبير \" , هذا التوافق في مفهوم \"الحقيقة\" الذي تلعب على أوتاره كلّ الأنظمة الشموليّة لتختصر البلد و تاريخه و ثقافته و حضارته و حروبه و سلامه في العقليّة الجمعيّة بأفق الحزب الحاكم و الوثن الأعلى فيه . ( أتذكّر هنا شعارات مثل : عراق صدّام أو سورية الأسد !! ) ـ\\n \\n كيف نصنع الخوف .. كيف نقتل التفكير .. كيف تمحو اللغة .. كيف نجمّد الزمن .. كيف نصنع حدود النظرة\\n \\n :\\n \\n \" الله هو السلطة \"\\n \\n هذاكان شعار الحزب , و هو الشعار المطبّق في كلّ الأنظمة الشمولية , لا إله سوى السلطة .. تخلق ما تشاء و تقرّر ما تشاء و تفعل ما تشاء , ولا يعلم حدود الرئيس و قدرته إلّا هو , هو الواحد الأحد و الفرد الصمد المحيي المميت الرزاق القهّار وحده !\\n \\n هذه الأنظمة لا تريد أن تحكمك و تنهبك فقط , إنّها تريد أن تمسخ إنسانيّتك لتكون مجرّد روبوت مسيّر بيدها و لذلك كتب ونستون في مذكّراته :\\n \\n \" هم يريدون أن يلغوا إنسانيّتك .. ولذلك فأن تحافظ على إنسانيّتك حتى موتك هو ما يعني انتصارك عليهم , حتى لو لم يؤدّ ذلك إلى أيّ نتائج ! \"\\n \\n لماذا نعذّب لماذا نسرق لماذا نستبدّ لماذا نقتل لماذا نحكم طيلة حياتنا ثمّ نورّث الجمهوريّة لأبنائنا ؟!:\\n \\n \" إننا ندرك أنه ما من احد يمسك بزمام السلطة و هو ينتوي التخلّي عنها , إن السلطة ليست وسيلة بل غاية , فالمرء لا يقيم حكما استبداديا لحماية الثورة , و إنما يشعل الثورة لإقامة حكم استبدادي , إن الهدف من الاضطهاد هو الاضطهاد , و الهدف من التعذيب هو التعذيب , و غاية السلطة هي السلطة ... هل بدأت تفهم ما أقول الآن ؟!! \"\\n \\n هذا جواب أوبراين !\\n \\n 1984 رواية يجب على كلّ عربيّ أن يقرأها ليرى رموزه و أصنامه مرسومة , و ليجد نفسه أيضا مرسوما داخلها كما شاءت أنظمة الثورة و حكم الحزب الواحد و الفرد الواحد .\\n \\n 1984 بكلّ ما تنبّا و كتب و تعمّق و حلّل أورويل فيها عمل عبقريّ يقرأ و يقرأ و يقرأ .\\n \\n الشيء الوحيد الذي لم يتوقّعه أورويل : هو أن التونسيّين و المصريين و اليمنيين و الجزائريين ( و آمل أن أكتب فيما بعد و السوريين و اللليبيّين... و .. و.. الخ ) سوف يثبتون بدمهم و حرّيتهم خطأ \" النهاية \" !!!ـ\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 226 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 15 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Oct 11, 2008\\n \\n \\n \\n Ahmad Sharabiani\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n fiction\\n \\n ,\\n \\n classic\\n \\n ,\\n \\n literature\\n \\n ,\\n \\n 1001-book\\n \\n ,\\n \\n dystopia\\n \\n ,\\n \\n 20th-century\\n \\n \\n \\n \\n \\n \\n 547. Nineteen Eighty-Four, George Orwell\\n \\n Nineteen Eighty-Four, often published as 1984, is a dystopian novel published in 1949 by English author George Orwell. The novel is set in Airstrip One, formerly Great Britain, a province of the superstate Oceania, whose residents are victims of perpetual war, omnipresent government surveillance and public manipulation. Oceania\\'s political ideology, euphemistically named English Socialism (shortened to \"Ingsoc\" in Newspeak, the government\\'s invented langua\\n \\n \\n 547.\\tNineteen Eighty-Four, George Orwell\\n \\n Nineteen Eighty-Four, often published as 1984, is a dystopian novel published in 1949 by English author George Orwell. The novel is set in Airstrip One, formerly Great Britain, a province of the superstate Oceania, whose residents are victims of perpetual war, omnipresent government surveillance and public manipulation. Oceania\\'s political ideology, euphemistically named English Socialism (shortened to \"Ingsoc\" in Newspeak, the government\\'s invented language) is enforced by the privileged, elite Inner Party. Via the \"Thought Police\", the Inner Party persecutes individualism and independent thinking, which are regarded as \"thoughtcrimes\".\\n \\n عنوانها: 1984؛ ۱۹۸۴؛ هزار و نهصد وهشتاد و چهار 1984 - نویسنده: جورج اورول؛ (نیلوفر)؛ تاریخ نخستین خوانش: سال 1982 میلادی\\n \\n عنوان: 1984 (۱۹۸۴)؛ نویسنده: جورج اورول؛ مترجم: صالح حسینی؛ تهران، نیلوفر، 1361؛ در 272 ص؛ چاپ دوم 1364؛ سوم 1367؛ چهارم 1369؛ شابک: 9644480449؛ پنجم 1374؛ ششم 1376؛ هفتم 1380؛ هشتم 1382؛ یازدهم و دوازدهم 1388؛ شابک: 9789644480447؛ سیزدهم 1389؛ در 312 ص؛ چاپ چهاردهم 1395؛ عنوان گسترده: هزار و نهصد وهشتاد و چهار؛ موضوع: داستانهای نویسندگلن انگلیسی - سده 20 م\\n \\n مترجمین دیگر: رضا زارع، در 384 ص، قزوین آزرمیدخت، 1392؛ خدیجه خدایی، در 318 ص، تبریز، یاران، 1391؛ نرگس حیدری منجیلی، در 352 ص، تهران، اردیبهشت، 1389،؛ مریم فیروزبخت، در 392 ص، تهران، حکایتی دگر، 1389؛ زهره زندیه، در 400 ص، قزوین، آزرمیدخت؛ کتایون شاهوردی، در 465 ص، تهران، فراموشی، 1396؛ فهیمه رحمتی، در 400 ص، تهران، ماهانه، 1394؛ امیر سالارکیا، در 384 ص؛ تهران، هنر پارینه، 1394؛ مرتضی، سعیدی تبار، در 384 ص، کرمان، انتشارات ولی، 1393؛ محمدعلی جدیری، تهران، اختر، چاپ یازدهم 1392، در 399 ص؛ چاپ سیزدهم، تبریز، سومر، 1393، در 283 ص؛ وحید کیان، تهران، کارگاه فیلم و گرافیک سپاس، 1394، در 375 ص؛ حمیدرضا بلوچ، در 288 ص، تهران، گهبد، 1384، چاپ دوم 1385، سوم 1386، پنجم 1388؛ چاپ دیگر: تهران، مجید، 1386؛ در 288 ص؛ چاپ هشتم 1392؛\\n \\n کتاب «1984» را «اریک آرتور بلر» با نام مستعار «جرج اورول»؛ نویسنده و شاعر انگلیسی بنوشته است و تا\\u200c به\\u200c امروز به بیش از 65 زبان گوناگون برگردان، و میلیون\\u200cها نسخه از آن فروخته شده است. با توجه به تصویر روشنی که اورول در داستان از نظامهای تمامیت\\u200cخواه ارائه می\\u200cدهد، انگار کنید بیانیه\\u200c ای سیاسی برای رد همه ی نظام\\u200cهای توتالیتر و کمونیستی است. «جهان اورولی»، 1984 داستان وینستون اسمیت را روایت می\\u200cکند؛ فردی که نماد یک شهروند عادی دگراندیش در دنیای اورولی ست. رمان در سال 1949 میلادی نوشته شده، زمانی\\u200cکه جنگ دوم جهانگیر به\\u200c تازگی پایان یافته بود؛ و جهانیان خطر تسلیم\\u200c شدن در پیشگاه دیکتاتورها را نیک فهمیده بودند. در آن زمان جنگ سرد هنوز آغاز نشده بود، و در دنیای غرب نیز هنوز روشنفکران بسیاری بودند که از کمونیسم هواداری و دفاع میکردند. در واقع اورول کتاب را برای اخطار به غربیان، برای گوشزد کردن خطر گسترش کمونیسم نوشته است؛ اما داستان این اثر را می\\u200cتوان به شرایط حاکم بر تمام جوامع تحت سلطه\\u200c ی حکومت\\u200cها\\u200cی استبدادی نیز گسترش داد. داستان در سال 1984 میلادی (35 سال پس از تاریخ نگارش کتاب) در شهر لندن رخ می\\u200cدهد. پس از جنگ جهانگیر، حاکمان کشورهای قدرتمند، به این نتیجه رسیده\\u200c اند که اگر جهان به روند افزایش ثروت ادامه دهد، ارکان جامعه\\u200c ی طبقاتی به خطر می\\u200cافتد؛ و حکومتها سرنگون میشوند. آن\\u200cها تنها راه جلوگیری از این امر را نابود کردن ثروت تولید شده در جنگی بی\\u200c پایان می\\u200cبینند. ا. شربیانی\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 218 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 6 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Apr 25, 2014\\n \\n \\n \\n Ahmed\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Shelves:\\n \\n إنجليزى\\n \\n \\n \\n \\n \\n \\n \\n \\n كل ما تشوف صور الرئيس السيسي حفظه الله في الشوارع، اِفتكر الأخ الكبير، وكل ما تشوف الإعلام المصري، افتكر الرواية دي، وغسيل الدماغ اللي بيُمارس علينا.\\n \\n \\n المؤسسات المصرية أصبحت بتمنح مميزات لمن يبلغ عن (إرهابي) , من فرص\\n \\n عمل وخلافه , يعني بورقة وسخة ممكن تأذي جارك اللي بينك وبينه مشاكل أو تسجن زميلك اللي بينافسك في الشغل , يعني المفروض نعمل لجورج أورويل مقام ونطوف حواليه.\\n \\n \\n الرواية التى سنسجن بسببها جميعا , ونوضع فى الأغلال ويركبونا على حمير بالشقلوب ويلفوا بينا الأسواق وهاتف يهتف : انهم يدعون إلى دين جد\\n \\n \\n \\n \\n \\n كل ما تشوف صور الرئيس السيسي حفظه الله في الشوارع، اِفتكر الأخ الكبير، وكل ما تشوف الإعلام المصري، افتكر الرواية دي، وغسيل الدماغ اللي بيُمارس علينا.\\n \\n \\n المؤسسات المصرية أصبحت بتمنح مميزات لمن يبلغ عن (إرهابي) , من فرص\\n \\n عمل وخلافه , يعني بورقة وسخة ممكن تأذي جارك اللي بينك وبينه مشاكل أو تسجن زميلك اللي بينافسك في الشغل , يعني المفروض نعمل لجورج أورويل مقام ونطوف حواليه.\\n \\n \\n الرواية التى سنسجن بسببها جميعا , ونوضع فى الأغلال ويركبونا على حمير بالشقلوب ويلفوا بينا الأسواق وهاتف يهتف : انهم يدعون إلى دين جديد , يدعون إلى عدم تقديس الحاكم وسلطته .\\n \\n إنها الرواية التى يقبض على مالكها (لا فى الاتحاد السوفيتى ولا ما يشبهه) بل فى ام الدنيا مصر .\\n \\n \\n أنا قرأت كم كتب مترجمه عظيم من حيث الكم (حتى انى وانا صغير) كنت بقول صعب ان حاجه اجنبيه تبهرنى تانى(هطل بعيد عنكم ) . ايه اللى ممكن يبهرنى بعد تولستوى او دستويفسكى او شكسبير او هوجو اوغيرهم وغيرهم .\\n \\n وخاصة لو روايه ذات طابع سياسى بحت لجوروج اورويل . (انا ما بحبش الروايات السياسيه البحته)\\n \\n \\n لكنى فوجئت بوجهة نظر مستقبليه عظيمه لاديب صاحب قلم ادبى راقى بيكتب عن النفس الانسانيه بصورة بليغه تجبرك انك تشغل دماغك وتندمج فى العمل الموضوع امامك. عمل يبين لك الحقيقه البشريه فى اسمى واحط صورها.\\n \\n لو كان اورويل ديكتاتور سابق لم يكن لينجح فى تقديم هذا العمل بهذه الجوده. تحليل دقيق لنظام الحكم القمعى يبين لك كيفية اداء هذه الانظمه .\\n \\n لمن شاهد فيلم (V for Vendetta ) ممكن يكون فكرة سطحيه عن النظام المقصود . اينعم الروايه حولت لفيلم سينمائى ولكنى لم اشاهده .\\n \\n \\n 1984 تتحدث عن اى نظام قمعى شمولى وكل نظام قمعى شمولى .\\n \\n الاخ\\n \\n الكبير هو كل ديكتاتور افتكر نفسه اله فى تاريخ البشريه : هو هتلر هو موسولينى هو عبدالناصر هو صدام هو حافظ الاسد وابنه هو ستالين هو تيتو و فرانكو وسالازار وغيرهم وغيرهم\\n \\n هو كل حاكم اتخذ من سلطته صنم ليعبده الناس.\\n \\n \\n 1984 هو زمن كل مجتمع متخلف ارتضى ان تسوقه انظمته الى عصور التخلف والجهاله\\n \\n 1984 شهادة وتأريخ سيظل حقيقى الى ان تقوم الساعه.\\n \\n هى وصمة عار على كل ديكتاتور وعلى كل مجتمع متخلف .\\n \\n ايها الساده : الادب فى اسمى صوره عندما يؤرخ للماضى والحاضر والمستقبل وهذا ما فعله اورويل\\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 200 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 10 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jun 09, 2018\\n \\n \\n \\n Bookdragon Sean\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n \\n Recommends it for:\\n \\n \\n fahrenheit 451 fans\\n \\n \\n \\n Shelves:\\n \\n 4-star-reads\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \"The best books... are those that tell you what you know already.\"\\n \\n \\n \\n \\n \\n Just about everything Orwell says in\\n \\n 1984\\n \\n is a maniacal truism. In some twisted form, everything reflects the truth of reality.\\n \\n \\n Of course there are exaggerations, though nothing is far from plausibility. We are controlled by our governments, and often in ways we are not consciously aware of. Advertisements, marketing campaigns and political events are all designed for us to elicit a certain response and think in a desired way\\n \\n \\n \\n \\n \\n \"The best books... are those that tell you what you know already.\"\\n \\n \\n \\n \\n \\n Just about everything Orwell says in\\n \\n 1984\\n \\n is a maniacal truism. In some twisted form, everything reflects the truth of reality.\\n \\n \\n Of course there are exaggerations, though nothing is far from plausibility. We are controlled by our governments, and often in ways we are not consciously aware of. Advertisements, marketing campaigns and political events are all designed for us to elicit a certain response and think in a desired way.\\n \\n \\n \\n 1984\\n \\n takes this to the extreme. Cultural brainwashing becomes the chief goal. Assimilation into a passionless (and completely ignorant) mind-set becomes the most effective means of keeping the population down. If you can make a man forget (or deny) his past then he knows of no situation better than his current state: it's all he knows, so why would he act to change it? Subjugation becomes normality.\\n \\n \\n \\n \\n \"If you want a picture of the future, imagine a boot stamping on a human face—for ever.\"\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Big brother does this by harsh policing, excessive surveillance and language manipulation. The streets are claustrophobic and the people (the workers) can escape nothing. Every action, every word spoken, is recorded. The police are ready to grab anyone who steps remotely out of line. Controlling language is perhaps the most effective thought control method I've ever heard of. If language can be broken down into the absolute basics, the simplest and ordinary units, then people can only express themselves on a very minor level. They cannot think beyond their daily tasks because there are no words that connote dreams and fantasy.\\n \\n \\n Step out of line and you are killed, though not before being dragged to room 101 for torture and even stronger methods of thought control. As such through the plot the book depicts a stark transformation, a transformation of man who was once willing to fight and to think but falls into one of the ingenious traps big brother sets for him to expose his criminality. Orwell's words are frightening because of their eerie parallels with reality. He shows us that we are not so far from big brother as we may think.\\n \\n \\n \\n \"We do not merely destroy our enemies; we change them.\"\\n \\n \\n \\n Unlike\\n \\n Animal Farm\\n \\n this also leaves much to the imagination. It's a much more successful book and one that once it has been read, it certainly cannot be unread.\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 197 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 14 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jun 25, 2014\\n \\n \\n \\n Lisa\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n favorites\\n \\n ,\\n \\n havanas-en-masse\\n \\n ,\\n \\n postliterate-fiction\\n \\n ,\\n \\n so-good-it-hurts\\n \\n ,\\n \\n unforgettable\\n \\n ,\\n \\n 1001-books-to-read-before-you-die\\n \\n \\n \\n \\n \\n \\n Doubleplusgood Maxitruth in Oldspeak on Doublethink and Crimestop!\\n \\n \\n (Translation from Newspeak: Excellent, accurate analysis of oppressive, selective society in well-written Standard English reflecting on the the capacity to hold two contradictory opinions for truth at the same time and on the effectiveness of protective stupidity as a means to keep a power structure stable.)\\n \\n \\n There is not much left to say about this prophetic novel by Orwell which has not been said over and over again since its pu\\n \\n \\n \\n \\n \\n \\n Doubleplusgood Maxitruth in Oldspeak on Doublethink and Crimestop!\\n \\n \\n (Translation from Newspeak: Excellent, accurate analysis of oppressive, selective society in well-written Standard English reflecting on the the capacity to hold two contradictory opinions for truth at the same time and on the effectiveness of protective stupidity as a means to keep a power structure stable.)\\n \\n \\n There is not much left to say about this prophetic novel by Orwell which has not been said over and over again since its publication at the beginning of the Cold War in 1949. There are obviously elements which refer directly to Stalinist socialism, and the life conditions of people in the 1940s, but what strikes as sadly true, not for Communist propaganda behind the historical Iron Curtain, but for the celebrated democracies in the Western tradition, is the idea of rewriting history and altering facts a posteriori into their opposite to suit political agendas, and the usurpation of scientific and political language to follow a path of absolute brainwashing. Western reality has caught up with 1984 in the era of \"alternative facts\" instead of falsehoods, and the denunciation of non-existent massacres to create fear, and an increasingly \"blackwhite\" take on society in general.\\n \\n \\n Reading this novel for the third time with the speeches of the current President of the United States and his followers ringing in my ears, it is hard not to cringe at the reduction of language that Orwell predicted in \"1984\" (1949):\\n \\n \\n \"Don\\'t you see that the whole aim of Newspeak is to narrow the range of thought? In the end we shall make thoughtcrime literally impossible, because there will be no words in which to express it.\"\\n \\n \\n \"But if thought corrupts language, language can also corrupt thought.\"\\n \\n \\n Just listening to the current reductionist rhetoric, expressing a less than shallow understanding of basic political thought and knowledge, shows the increasing spread of Newspeak at the highest level of command in democratic societies, claiming to be celebrating education, equality, freedom and human rights.\\n \\n \\n \"So sad! Very dishonest! Total loser! You are fake news! Russia is fake news! The failing NYTimes! It's great! It's SO great! You wouldn't believe how great that is (doubleplusgreat, I assume...). The largest! The best! Running like a fine-tuned machine! The least racist! The most humble! The one with the best polls, for the negative ones are fake!\"\\n \\n \\n - Doublethink and crimestop nonstop!\\n \\n \\n The problem with dictatorships, and dogmas of a specific faith, is that they will never shy away from usurping and then destroying the generally accepted conventions of communication if it serves their purposes. Thus a creationist believer in the literal truth of the Bible will use the argument of \"enquiry\", \"controversy\" or \"evidence\" in order to attack real scientists with their own vocabulary, while refusing to question the default setting of their own dogmas, which cannot deliver any evidence at all, being as real as the Bowling Green massacre. The argument of \"controversy\" is a one-way road to kill opposition with their own weapons while staying safely within the \"protective stupidity\" (crimestop) of absolute, monofocal faith. The \"tolerance\" of the open-minded scientist becomes a weapon for the fundamentalist.\\n \\n \\n \\n (view spoiler)\\n \\n \\n [ (One example of typical crimestop (=protective stupidity) is the Creation Museum in Kentucky, US, advertising their love for science, while starting with the slogan \"Be prepared to believe\":\\n \\n \"Creationists love science! In fact, the word science means \"knowledge.\" We invite you to dive into the Bible and the scientific evidence with us to gather as much knowledge about God's creation as you can. You'll learn about the different types of science and discover facts and logical arguments you might have never considered. When you start with the Bible as your ultimate authority, you're ready to discover creation science.\"\\n \\n They also have \"REAL CREATION SCIENTISTS\" (no kidding, they are real, not fake, according to website):\\n \\n \"Did you know the Creation Museum employs PhD creation scientists who teach about anatomy, astronomy, biology, geology, and more from a biblical worldview? \")\\n \\n (hide spoiler)\\n \\n ]\\n \\n \\n \\n The same selective use of language, a consistent tool to exert power in \"1984\", can be seen in the Pro Life movement, a violent anti-abortion, anti-contraception fundamentalist Christian group, whose derogatory, misogynistic vocabulary strongly calls Atwood's\\n \\n The Handmaid\\'s Tale\\n \\n to mind. Their aim, they claim, is to protect unborn life, which sounds honourable until you start to think about their opinions about and treatment of human beings that already dwell on earth: they are conservatives, mostly pro weapons, pro (ideological) wars, pro death penalty, anti welfare, anti climate change and anti health care. That does not rhyme well with the militant need to control female sexuality, labelled protection of the foetus' right. Controlling sexuality is a major topic in Orwell's dystopia as well - goodsex being newspeak for chastity.\\n \\n \\n What struck me as overwhelmingly sad in the main character of \"1984\", which did not catch my attention the first two times I read the novel, was the breaking down of the man's sanity and mental capacities, rather than his body. The scary development for Winston Smith is not the prospect of torture, once he starts rebelling against the oppressive (\"free\") society, it is the fear to lose his humanity in the process:\\n \\n \\n \"To die hating them, that was freedom.\"\\n \\n \\n This idea, expressed by Ionesco in his fabulous play\\n \\n Rhinocéros\\n \\n as well, is denied Orwell's main character, however. He is broken, not only physically, but mentally, and after torture of unimaginable dimensions, his closing lines show complete surrender, body and soul, to the evil brainwashing machinery of Big Brother:\\n \\n \\n \"He had won the victory over himself. He loved Big Brother!\"\\n \\n \\n Put this man into the context of an interview on television, where the President of the United States is questioned on his position regarding torture as a means to receive \"information\". Dodging the question, he speaks about an undefined opposition \"chopping off Christians' heads\", thus creating the necessary atmosphere of fear to evade direct challenge, and then, in his reduced, stupid language, he says:\\n \\n \\n \"Torture? Do I feel it works? Absolutely, I feel it works.\"\\n \\n \\n And depending on what is your desired outcome (\"confession\" of facts, alternative or otherwise), it does. Unfortunately. You can force a human being to speak against his or her will, using torture. And as long as you are not finicky regarding the accuracy of the received confession, you will be able to report results. An easy task for any doublethinker.\\n \\n \\n As for CRIMESTOP - the protective stupidity practised by most dogmatic, orthodox people in all parts of the world - that is the root of the evil. And it can only be challenged with a proper, objective, fact-based, politically and religiously untainted EDUCATION! And please do not confuse that with information! Information, as we know, can be \"bad\". Really bad. Rotten. So unfair. So dishonest. The most dishonest information in the world. Total loser information.\\n \\n \\n Education Against Crimestop Now!\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 201 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 51 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Sep 21, 2017\\n \\n \\n \\n James Trevino\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n I reread this recently, knowing my mind from a few years ago is different from my mind now. But it was surprisingly just as scary! Maybe even more so, if that is possible!!\\n \\n \\n I wonder if there is someone who has read 1984 and has not felt angry and helpless. It is a good book. It is so good that it made my want to throw away my Kindle. And that is a lot, considering the last time that happened was when I read about The Red Wedding in George R.R. Martin\\'s series.\\n \\n \\n I also wonder if this world Orwell d\\n \\n \\n I reread this recently, knowing my mind from a few years ago is different from my mind now. But it was surprisingly just as scary! Maybe even more so, if that is possible!!\\n \\n \\n I wonder if there is someone who has read 1984 and has not felt angry and helpless. It is a good book. It is so good that it made my want to throw away my Kindle. And that is a lot, considering the last time that happened was when I read about The Red Wedding in George R.R. Martin\\'s series.\\n \\n \\n I also wonder if this world Orwell describes is that far from ours. Big Brother may have become a stupid internet meme and an even stupider TV show (if there are fans here sorrynotsorry), but that somehow makes it even more frightening. In 1984 the oppression is very in your face, but in reality it is hidden through nice words and fancy laws.\\n \\n \\n At the end of the day, it really makes you ask yourself if safety and security are really what you want. And if they are worth the price...\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 195 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 7 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Dec 05, 2010\\n \\n \\n \\n Emily May\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n dystopia-utopia\\n \\n ,\\n \\n sci-fi\\n \\n ,\\n \\n classics\\n \\n \\n \\n \\n \\n \\n This was the book that started my love affair with the dystopian genre. And maybe indirectly influenced my decision to do a politics degree. I was only 12 years old when I first read it but I suddenly saw how politics could be taken and manipulated to tell one hell of a scary and convincing story. I\\'m a lot more well-read now but, back then, this was a game-changer. I started to think about things differently. I started to think about 2 + 2 = 5 and I wanted to read more books that explored the i\\n \\n \\n This was the book that started my love affair with the dystopian genre. And maybe indirectly influenced my decision to do a politics degree. I was only 12 years old when I first read it but I suddenly saw how politics could be taken and manipulated to tell one hell of a scary and convincing story. I\\'m a lot more well-read now but, back then, this was a game-changer. I started to think about things differently. I started to think about 2 + 2 = 5 and I wanted to read more books that explored the idea of control.\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 196 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 19 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jan 12, 2016\\n \\n \\n \\n Joey Woolfardis\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n 2016\\n \\n ,\\n \\n bookshelf\\n \\n ,\\n \\n ce20\\n \\n ,\\n \\n champion\\n \\n ,\\n \\n masculine\\n \\n ,\\n \\n sterling\\n \\n \\n \\n \\n \\n \\n Read as part of\\n \\n The Infinite Variety Reading Challenge\\n \\n , based on the BBC\\'s Big Read Poll of 2003.\\n \\n \\n \\n \\n \"For, if leisure and security were enjoyed by all alike, the great mass of human beings who are normally stupefied by poverty would become literate and would learn to think for themselves; and when once they had done this, they would sooner or later realise that the privileged minority had no function, and they would sweep it away.\"\\n \\n \\n \\n \\n \\n Nineteen Eighty-Four\\n \\n is an insanely relevant novel in this day and\\n \\n \\n Read as part of\\n \\n The Infinite Variety Reading Challenge\\n \\n , based on the BBC\\'s Big Read Poll of 2003.\\n \\n \\n \\n \\n \"For, if leisure and security were enjoyed by all alike, the great mass of human beings who are normally stupefied by poverty would become literate and would learn to think for themselves; and when once they had done this, they would sooner or later realise that the privileged minority had no function, and they would sweep it away.\"\\n \\n \\n \\n \\n \\n Nineteen Eighty-Four\\n \\n is an insanely relevant novel in this day and age, but it\\'s also a rather soothing novel that contains some of the horrors that could never come to pass, though there are some horrific parallels between the England in the book and some countries around the world in the 21st Century.\\n \\n \\n Winston is a very complex, sane person in a world full of insanity and utter destitution. Julia is on par with Winston, but other than the charming and mysterious O\\'Brien, no other character is developed enough to be anything but a filler, someone to push the plot along. In any other novel this would be a bad thing, but in this world it is perfect, and it\\'s exactly what those people are in any case.\\n \\n \\n It is so superbly written I cannot fault it at all concerning that. At the beginning I was drawn in so far that I was almost in love. It was a five-star book up until Julia turned up: whilst I completely understand her character and her paradoxical nature (being so openly physically against Big Brother and yet intelligence-wise and mentally not), I did not like her even remotely, but I understood her character fully. The other thing that put me off was the huge info-dump. Whilst I completely understood that this was an intentional info-drop and it really could not have been conveyed to either the reader or the character in any other way, it really made the whole thing very disjointed. Again, it felt hugely intentional but I still did not enjoy it.\\n \\n \\n Overall, there\\'s really nothing I can fault except my own opinions. Good writing is Fact: punctuation in the correct places, the right use of words, syntax and all that; building up worlds and characters to a certain degree of solidness. Enjoyment of writing is Opinion: characters being likeable, understandable; worlds being full or non-descript. This was a perfect book that I simply had a few too many low opinions of to be delighted by it completely.\\n \\n \\n \\n \\n \\n Blog\\n \\n |\\n \\n Instagram\\n \\n |\\n \\n Twitter\\n \\n |\\n \\n Pinterest\\n \\n |\\n \\n Shop\\n \\n |\\n \\n Etsy\\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 190 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 5 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n May 30, 2008\\n \\n \\n \\n Cecily\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Shelves:\\n \\n classics\\n \\n ,\\n \\n scifi-future-speculative-fict\\n \\n ,\\n \\n dystopian\\n \\n ,\\n \\n language-related\\n \\n \\n \\n \\n \\n \\n \\n Revised for 2017, with added \"Alternative Facts\"\\n \\n \\n \\n \\n \\n \\n Ten Shades of Grey?\\n \\n \\n \\n The colour of this book is grey, relentless grey: of skin, sky, food, floor, walls, mind, life itself. Added piquancy comes from general decay, drudgery, exploitation, chronic sickness, and malaise.\\n \\n \\n There is also sex and (non-sexual) bondage, domination, and torture.\\n \\n \\n I don't expect a dystopian book to be happy reading, but this reread was far grimmer than I remembered it, partly because I read it immediately after the lyrical beaut\\n \\n \\n \\n Revised for 2017, with added \"Alternative Facts\"\\n \\n \\n \\n \\n \\n \\n Ten Shades of Grey?\\n \\n \\n \\n The colour of this book is grey, relentless grey: of skin, sky, food, floor, walls, mind, life itself. Added piquancy comes from general decay, drudgery, exploitation, chronic sickness, and malaise.\\n \\n \\n There is also sex and (non-sexual) bondage, domination, and torture.\\n \\n \\n I don't expect a dystopian book to be happy reading, but this reread was far grimmer than I remembered it, partly because I read it immediately after the lyrical beauty of another dystopia,\\n \\n Fahrenheit 451\\n \\n , reviewed\\n \\n HERE\\n \\n , and partly because I've probably watched Terry Gilliam's magical film,\\n \\n Brazil\\n \\n so many times (though he claimed he had not read the book before making the film).\\n \\n \\n Nevertheless, more than 50 years after it was written, 1984 is still powerful, important, and relevant - a feat EL James' \"Fifty Shades\" books are unlikely to achieve. On the other hand, I gather Fifty Shades lacks page after page of heavy-handed political theory, so on that criterion, it might be ahead of 1984.\\n \\n \\n \"\\n \\n If there is hope, it lies in the proles\\n \\n \" - they are not any shade of grey.\\n \\n \\n \\n Have We Reached 1984? (written in 2015)\\n \\n \\n \\n In some ways, this book is very dated.\\n \\n \\n •\\tThe underlying\\n \\n misogyny\\n \\n is unchallenged (Winston \"\\n \\n disliked nearly all women, and especially the young pretty ones… who were the most bigoted adherents of the Party\\n \\n \" and he quickly goes from wanting to rape and murder a woman (he even tells her!) to lusting after \"her youthful body desperate for him\" and feeling \"he had a right to\" her). On the other hand, Winston is uncritical - enthusiastic even - about her promiscuity.\\n \\n \\n •\\tRelated to that - and to Fahrenheit 451 - Derek (Guilty of thoughtcrime) wrote in a group discussion: \"there\\'s a distinct echo in both books of the\\n \\n Garden of Eden\\n \\n story, with Eve tempting Adam to eat of the fruit of the tree of knowledge of good and evil. And in each case, it\\'s a denial of the dogma that this is the original sin.\"\\n \\n \\n •\\tA contemporary writer would probably avoid the lengthy passages of\\n \\n exposition and theory\\n \\n found here (especially ~20 pages of closely typed text from Goldstein's snappily titled \"The Theory and Practice of Oligarchical Collectivism\").\\n \\n \\n •\\tThe post-war\\n \\n Cold War\\n \\n fears are ancient history, and the rise of supposedly Islamic groups like Daesh/ISIS/ISIL pose a different sort of threat.\\n \\n \\n BUT, where this is still pertinent, it's not quite in the ways that Orwell might have expected.\\n \\n \\n •\\tWe're blasé about\\n \\n ubiquitous CCTV\\n \\n cameras, and we voluntarily, enthusiastically, surrender details of our interests, activities, location, and friends via our smartphone apps, and Google (see Vox article about how Google Trends reveals the truths that people don\\'t tell researchers,\\n \\n here\\n \\n ).\\n \\n \\n •\\tWe think we're too smart to fall for lies like those of the Party, but a quick trawl of trending stories on social media demonstrates the untruth of that:\\n \\n people are gullible\\n \\n . The patent nonsense that people believe and share, without ever engaging the weakest of critical faculties is staggering. Most of those are trivial compared with the lies of Big Brother, but they show how easy it is to believe what everyone else believes, regardless of ample evidence to the contrary.\\n \\n \\n •\\tWe may not have Two Minutes' Hate or Hate Week, but we certainly have hate figures, and again, social media exacerbates the crowd mentality: \"\\n \\n The horrible thing… was not that one was obliged to act a part, but… that it was impossible to avoid joining in\\n \\n \". I've not read Jon Ronson's\\n \\n \\n So You\\'ve Been Publicly Shamed\\n \\n \\n , but I'm familiar with many of the stories in it (if you're not, look at the many excellent reviews on GR). Scary stuff.\\n \\n \\n \\n Update, January 2017, \"Alternative Facts\"\\n \\n \\n \\n On 20 January 2017, Donald Trump was inaugurated as President of the USA. He campaigned in the style of an autocratic, narcissistic demagogue. He had a long track record of flagrantly denying obvious, provable truths, even on trivial matters. The day after numerous photos and other measures showed unimpressive attendance at his inauguration, rather than blame poor weather or practical and financial difficulties of travel, Sean Spicer, White House Press Secretary flat-out denied realistic estimates, refused to take questions, and threatened to crack down on the press. The resulting furore led to Kellyanne Conway, a Trump Strategist, defended him, saying he had merely presented\\n \\n \"Alternative Facts\"\\n \\n .\\n \\n \\n \"\\n \\n The Party told you to reject the evidence of your eyes and ears. It was their final, most essential command… And yet he was in the right! They were wrong and he was right. The obvious, the silly, and the true had got to be defended. Truisms are true, hold on to that! The solid world exists, its laws do not change. Stones are hard, water is wet, objects unsupported fall towards the earth\\'s centre. With the feeling that he was speaking to O\\'Brien, and also that he was setting forth an important axiom, he wrote: .....Freedom is the freedom to say that two plus two make four. If that is granted, all else follows.\\n \\n \"\\n \\n \\n \"\\n \\n If the Party could thrust its hand into the past and say of this or that event, it never happened – that, surely, was more terrifying than mere torture and death?\\n \\n \"\\n \\n \\n \"\\n \\n The Ministry of Peace concerns itself with war, the Ministry of Truth with lies, the Ministry of Love with torture and the Ministry of Plenty with starvation. These contradictions are not accidental, nor do they result from ordinary hypocrisy: they are deliberate exercises in doublethink\\n \\n .\"\\n \\n \\n \"\\n \\n Being in a minority, even in a minority of one, did not make you mad. There was truth and there was untruth, and if you clung to the truth even against the whole world, you were not mad.\\n \\n \"\\n \\n \\n \\n UnTruth and UnReality - Three Types\\n \\n \\n \\n •\\t\"The mutability of the past\" means history is forever being\\n \\n rewritten\\n \\n corrected for slips, errors, misprints and misquotes, making truth unknowable (Winston is not even sure of his age or year of birth).\\n \\n \\n •\\tThe doublethink slogans of the Party are another deliberate type of unreality.\\n \\n \\n •\\tThe third confusion of reality is subtler, in stark contrast to the gritty realism of the rest of the book, and not one I'd really considered on previous readings. It relates to dreams, premonitions, hallucinations, and (in)sanity. Confusion from deprivation and torture is one thing, but there are possible magical-realist aspects. Early on, Winston dreams of meeting O'Brien \"in the place where there is no darkness\"; later mentions are ambiguous as to whether this is coincidence or something else. A country landscape is also familiar from a dream, and he has a muddled dream about the coral paperweight, his mother and a Jewish woman. Furthermore, there are times in prison when the interrogator's knowledge seems too precise and secret to be inferred from spies, screens or microphones: can he read Winston's mind?!\\n \\n \\n \"\\n \\n Reality exists in the human mind and nowhere else.\\n \\n \"\\n \\n \\n \\n \"If there is hope, it lies in the proles\"\\n \\n \\n \\n \"\\n \\n The proles were not loyal to a party or a country or an idea, they were loyal to one another… The proles had stayed human.\\n \\n \" As unimportant drones, they have freedom denied to Party members and \"were beneath suspicion\".\\n \\n \\n Conditions in Airstrip One are dire, with food and basic services in very limited supply, but sanity is scarcest of all. \"\\n \\n Stupidity was as necessary as intelligence, and as difficult to attain.\\n \\n \"\\n \\n \\n For some, \"\\n \\n By lack of understanding they remained sane\\n \\n \".\\n \\n \\n \\n Three Parts\\n \\n \\n \\n •\\tThe first part sets the scene of Winston's Smith's predictable life as an unimportant Party member in Big Brother's terrifying regime in Airstrip One, ever at war with either Eurasia or Eastasia.\\n \\n \\n •\\tThe second part concerns actions: freedom, courage, love/lust, betrayal.\\n \\n \\n •\\tThe final part is about the consequences of those actions.\\n \\n \\n Again and again, brief, apparently trivial things turn out to be significant.\\n \\n \\n \\n Newspeak\\n \\n \\n \\n \"\\n \\n But if thought corrupts language, language can also corrupt thought.\\n \\n \"\\n \\n \\n \"\\n \\n Newspeak is the only language in the world whose vocabulary gets smaller every year\\n \\n \", with the aim of making \"\\n \\n thoughtcrime literally impossible, because there will be no words in which to express it\\n \\n \".\\n \\n \\n This is really an extreme form of linguistic determinism (aka Sapir-Whorf hypothesis): the idea that the structure of a language can affect the cognition of those who use it. A very different extrapolation of that is in Ted Chiang\\'s\\n \\n The Story of Your Life\\n \\n (filmed for 2016 as Arrival), reviewed\\n \\n HERE\\n \\n .\\n \\n \\n I thought the linguistic aspect would be something I'd especially enjoy this time, but the key features are familiar and it's explained in an appendix (which is where most of the lengthy extracts of Goldstein's book should have gone, imo.) However, it\\'s worth noting that the appendix, written after the main story, is in conventional English.\\n \\n Newspeak is/was no more\\n \\n .\\n \\n \\n \\n Feelings – and Troublesome Questions\\n \\n \\n \\n This is a grey, cold book. Even the lust and passion it contains is chilling. But it asks timeless and difficult questions about love and loyalty:\\n \\n \\n •\\tWould you risk everything - absolutely everything - for a few passionate meetings with someone you may not even love?\\n \\n \\n •\\tTo serve your ideology, would you lie, murder, steal… throw acid in a child's face?\\n \\n \\n •\\tIf you could save your partner by doubling your own pain, would you? Would you really?\\n \\n \\n •\\tIs failure of love the only betrayal that counts? (If you tell all, but secretly love, are you loyal?)\\n \\n \\n \\n Quotes\\n \\n \\n \\n Some are so well-known, it might seem superfluous to type them here, but that's exactly why I've included them.\\n \\n \\n •\\t\"It was a bright cold day in April and the clocks were striking thirteen.\"\\n \\n •\\t\"Although the sun was shining and the sky a harsh blue, there seemed to be no colour in anything, except the posters that were plastered everywhere.\"\\n \\n •\\t\"An active man of almost paralysing stupidity.\"\\n \\n •\\t\"All history was a palimpsest.\"\\n \\n •\\t\"It was not by making yourself heard but by staying sane that you carried on the human heritage.\"\\n \\n •\\t\"The old man's memory was nothing but a rubbish-heap of details.\"\\n \\n •\\t\"A hanging oil lamp which gave off an unclean but friendly smell.\"\\n \\n •\\t\"He would buy further scraps of beautiful rubbish.\" (In addition to coral in glass.)\\n \\n •\\t\"It was camouflage. If you kept the small rules, you could break the big ones.\"\\n \\n •\\tA dash of lipstick and \"she had become not only much prettier, but… far more feminine.\"\\n \\n •\\tCharrington, the junk shop owner had \"vaguely the air of being a collector rather than a tradesman\".\\n \\n •\\t\"The end was contained in the beginning.\"\\n \\n •\\t\"Our only true life was in the future.\"\\n \\n •\\t\"Winston was gelatinous with fatigue… His body seemed to have not only the weakness of a jelly, but its transparency.\"\\n \\n •\\t\"The best books, he [Winston] perceived, are those that tell you what you know already.\" No, no, no!\\n \\n •\\t\"The blade would bite into him with a sort of burning coldness.\"\\n \\n •\\t\"Never, for any reason on earth, could you wish for an increase in pain… Nothing in the world was so bad as physical pain.\" Hmm. What about emotional pain?\\n \\n •\\t\"If you want to keep a secret you must also hide it from yourself.\"\\n \\n •\\t\"The confession was a formality. The torture was real.\"\\n \\n •\\t\"Perhaps one did not want to be loved so much as to be understood.\"\\n \\n •\\t\"In the old days the heretic walked to the stake still a heretic… But we make the brain perfect before we blow it out.\" Shades of Kafka's\\n \\n In the Penal Colony\\n \\n , reviewed\\n \\n HERE\\n \\n .\\n \\n \\n \\n Slogans\\n \\n \\n \\n •\\t\"War is peace. Freedom is slavery. Ignorance is strength.\"\\n \\n •\\t\"Who controls the past controls the future; who controls the present controls the past.\"\\n \\n •\\t\"2 + 2 = 5\" \"Sometimes they are five. Sometimes they are three. Sometimes they are all of them at once.\"\\n \\n •\\t\"It is not enough to obey him: you must love him.\"\\n \\n •\\t\"We are interested solely in power… Power is not a means, it is an end.\"\\n \\n •\\t\"Outside man there is nothing… The earth is the centre of the universe.\"\\n \\n •\\t\"Big Brother is watching.\"\\n \\n \\n Image source:\\n \\n http://www.artsparx.com/images/bl_val...\\n \\n \\n \\n \\n OLD Review from 2008\\n \\n \\n The year 1984 may be long passed, but this book is more pertinent than ever: big brother is watching us, history is rewritten (though that has always been true) and free speech is constrained (albeit often under the misused guise of political correctness).\\n \\n \\n It\\'s a shame that the humorous TV programme \"Room 101\" and reality TV franchise \"Big Brother\" have distracted people from the seriousness of Orwell\\'s message.\\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 185 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 106 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Mar 02, 2014\\n \\n \\n \\n Amira Mahmoud\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n Shelves:\\n \\n translated\\n \\n ,\\n \\n أدب-روايات\\n \\n ,\\n \\n كتبي-المفضلة\\n \\n ,\\n \\n مراجعاتي-المفضلة\\n \\n \\n \\n \\n \\n \\n 2+2=5\\n \\n وعليك اعتباراها حقيقة مُسلم بها\\n \\n كيف؟\\n \\n والمنطق والفكر والمعادلات والدلائل والتاريخ ...إلخ، ليس لها قيمة إذن\\n \\n \\n فالجهل هو القوة\\n \\n \\n وأين حريتك في التفكير والرأي!\\n \\n \\n الحرية هي العبودية\\n \\n \\n أسوء أنواع القمع، هي تلك التي تُمارس على العقل والتفكير\\n \\n \\n أنت لا تملك سوى تلك السنتيميترات المربعة في جمجمتك\\n \\n \\n لكن حتى تلك، تنوء بِحملها\\n \\n وملكيتها تُشكل لك خوف ورهبة من أن يظهر ما تُفكر فيه في انفعالاتك\\n \\n أو على صفحة وجهك أو لغة جسدك\\n \\n أو حتى أن ينطبع لديك في اللاوعي\\n \\n فيُصبح أخشى ما تخشاه أن تهلوس به أثناء نومك\\n \\n قمع فكري، وعملية غسيل للمخ و\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n 2+2=5\\n \\n وعليك اعتباراها حقيقة مُسلم بها\\n \\n كيف؟\\n \\n والمنطق والفكر والمعادلات والدلائل والتاريخ ...إلخ، ليس لها قيمة إذن\\n \\n \\n فالجهل هو القوة\\n \\n \\n وأين حريتك في التفكير والرأي!\\n \\n \\n الحرية هي العبودية\\n \\n \\n أسوء أنواع القمع، هي تلك التي تُمارس على العقل والتفكير\\n \\n \\n أنت لا تملك سوى تلك السنتيميترات المربعة في جمجمتك\\n \\n \\n لكن حتى تلك، تنوء بِحملها\\n \\n وملكيتها تُشكل لك خوف ورهبة من أن يظهر ما تُفكر فيه في انفعالاتك\\n \\n أو على صفحة وجهك أو لغة جسدك\\n \\n أو حتى أن ينطبع لديك في اللاوعي\\n \\n فيُصبح أخشى ما تخشاه أن تهلوس به أثناء نومك\\n \\n قمع فكري، وعملية غسيل للمخ وإعادة صياغته\\n \\n للدرجة التي توصلك للتشكك في قواك العقلية\\n \\n أأنت المجنون أم ما يحدث من حولك هو هذيان لا أكثر؟\\n \\n \\n أكثر الأعمال التي تُبهرني، هي تلك التي تعبث بعقلك\\n \\n وتغير تفكيرك\\n \\n تلك التي من المستحيل أن تقرأها ويبقى تفكيرك كما كان قبل قراءتها\\n \\n تلك التي تصوّر فظاعة الواقع، تجرده وتعريه\\n \\n وتكشف الحقيقة التي نتغاضى عنها، ونتجنبها\\n \\n الرواية على الرغم من بعض الملل الذي يتخللها\\n \\n إلا أن فكرتها تُجبرك على استكمالها\\n \\n الجزء الأخير منها كارثي وصادم!\\n \\n \\n أعُجبت بفكرة كتاب غولدشتاين\\n \\n تلك الحيلة التي أستخدمها أورويل\\n \\n ليُوضح مقصده وفكرته بتفصيل أكبر\\n \\n لنُصدم بالحقيقة أكثر\\n \\n \\n \\n من يملك الماضي يملك المستقبل، من يملك الحاضر يملك الماضي\\n \\n \\n ووطن بماضي مُزيف، هو وطن لا مستقبل له\\n \\n اسأل الله ألا يُفقدنا ماضينا، ذاك الشيء الوحيد الذي بقى لنا للتباهي به\\n \\n \\n هي كما قيل\\n \\n \\n رواية تُقرأ ثم تُقرأ من جديد\\n \\n \\n \\n تمّت\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 170 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 80 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n May 02, 2015\\n \\n \\n \\n Zoë\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Goodness gracious this was very unsettling. I\\'m already a pretty paranoid person, so the idea of Big Brother was both very intriguing but also extremely frightening.\\n \\n I really enjoyed reading this, but there were moments when I wasn\\'t invested in the story and wanted to take a break from it, mostly in the last half of the book. Still DEFINITELY worth the read, though!\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 166 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 5 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Christy Foss\\n \\n \\n Ian, I was thinking exactly the same thing. We have sheepishly allowed ourselves to be controlled by B.B. We are addicted to what society tells us we\\n \\n \\n Ian, I was thinking exactly the same thing. We have sheepishly allowed ourselves to be controlled by B.B. We are addicted to what society tells us we must. We spend our days with our faces glued to our cell phones and we have not a moment of privacy because they go everywhere we go. The whole \"I mentioned xyz in conversation and then xyz showed up on my Facebook feed\" thing should be enough to alarm us and wake us up to the realization that we have given B.B. and whoever else possesses the technology/ability complete access to our lives. It's frightening how accurate 1984 is, if not in exact details, but in the methods and the thought control. (I apologize if my comment isn't fully coherent, it's late and I'm exhausted from finishing this book)!\\n \\n \\n ...more\\n \\n \\n \\n Jan 01, 2018 10:50PM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Kinga\\n \\n \\n I know exactly what you mean. Personally I am someone who enjoys a good conspiracy theory binge from time to time but wow. This book put me on the edg\\n \\n \\n I know exactly what you mean. Personally I am someone who enjoys a good conspiracy theory binge from time to time but wow. This book put me on the edge of my seats and made me tape the camera on my laptop. If I am being completely honest I think we all knew how to book was going to end but the grafic description of a decaying personality truly shocked me. I am curious, was there any part in the book where you had to put it down? For me, towards the end was extremely stressful to read so I kept on putting it down. Once I finally finished I lost all hope in our current society for a solid couple of days. I believe that that is what makes a piece of art truly intriguing, when it undeniable forces the reader to have an emotional reaction to. As my last few words I would also touch on the inspiration that this book might give some.\\n \\n \\n Ps.: We are the dead.\\n \\n \\n \\n \\n ...more\\n \\n \\n \\n Sep 30, 2018 08:48PM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Aug 02, 2011\\n \\n \\n \\n Lyn\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \"It was a bright cold day in April, and the clocks were striking thirteen.\"\\n \\n \\n This changed the way that I looked at ideologies and changed the way I looked at leadership. Cynical, scathing, and not without its flaws, this is still a stark, haunting glimpse at what could be.\\n \\n \\n \"War is peace.\\n \\n Freedom is slavery.\\n \\n Ignorance is strength.\"\\n \\n \\n Chilling.\\n \\n \\n The closing lines still come to me sometimes and remind me of depths that I can only imagine.\\n \\n \\n \"He gazed up at the enormous face. Forty years it had taken him to\\n \\n \\n \"It was a bright cold day in April, and the clocks were striking thirteen.\"\\n \\n \\n This changed the way that I looked at ideologies and changed the way I looked at leadership. Cynical, scathing, and not without its flaws, this is still a stark, haunting glimpse at what could be.\\n \\n \\n \"War is peace.\\n \\n Freedom is slavery.\\n \\n Ignorance is strength.\"\\n \\n \\n Chilling.\\n \\n \\n The closing lines still come to me sometimes and remind me of depths that I can only imagine.\\n \\n \\n \"He gazed up at the enormous face. Forty years it had taken him to learn what kind of smile was hidden beneath the dark moustache. O cruel, needless misunderstanding! O stubborn, self-willed exile from the loving breast! Two gin-scented tears trickled down the sides of his nose. But it was all right, everything was all right, the struggle was finished. He had won the victory over himself.\\n \\n \\n He loved Big Brother\"\\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 159 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 26 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jan 13, 2017\\n \\n \\n \\n Joe Valdez\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Shelves:\\n \\n sci-fi-general\\n \\n \\n \\n \\n \\n \\n My preparedness for the regime change taking place in the United States--with elements of the Electoral College, the Kremlin and the FBI helping to install a failed business promoter who the majority of American voters did not support in the election--begins with\\n \\n 1984\\n \\n by George Orwell. Like many, this 1949 novel was assigned reading for me in high school. What stood out to me then was that I needed to finish it because there would be a test. Studying how civics is supposed to work in 3rd period\\n \\n \\n My preparedness for the regime change taking place in the United States--with elements of the Electoral College, the Kremlin and the FBI helping to install a failed business promoter who the majority of American voters did not support in the election--begins with\\n \\n 1984\\n \\n by George Orwell. Like many, this 1949 novel was assigned reading for me in high school. What stood out to me then was that I needed to finish it because there would be a test. Studying how civics is supposed to work in 3rd period government did not prepare me in 7th period English for this harrowing and precise depiction of fear and hatred run amok.\\n \\n \\n \\n 1990 Joe\\n \\n \\n \\n We\\'re in the future! At least, what George Orwell thought postwar England might be like in in the future. Great Britain is now governed by Oceania and resembles a Warsaw Pact nation--the Party controls every action and thought of its miserable population through propaganda, surveillance and torture--but what\\'s happened is that an atomic war in the 1950s left survivors in the United States and Western Europe desperate for law and order. Party members who pledge absolute loyalty to a figure known as Big Brother have their essential needs provided for, while the lower caste are known as Proles and regarded as rubbish. It sucks here!\\n \\n \\n \\n 2016 Joe\\n \\n \\n \\n Winston Smith is a contemplative thirty-nine year old Outer Party member who works at the Ministry of Truth in London. Like many great literary characters, he does not feel well. Winston is employed in the Records Department, altering (or as it\\'s officially known, rectifying) articles for The Times which no longer adhere to the reality of The Party. Winston suffers from an ulcer on his leg and like many, subsists on Victory Gin. He leaves work on his lunch break to return his flat in Victory Gardens, hiding in a nook where he believes the telescreen installed in his home cannot see him. He begins a handwritten diary in an old book, with paper, that he found in a junk shop.\\n \\n \\n \\n For a moment he was seized by a kind of hysteria. He began writing in a hurried untidy scrawl:\\n \\n \\n \\n theyll shoot me i don't care theyll shoot me in the back of the neck i dont care down with big brother they always shoot you in the back of the neck i dont care down with big brother--\\n \\n \\n \\n He sat back in his chair, slightly ashamed of himself, and laid down the pen. The next moment he started violently. There was a knocking at the door.\\n \\n \\n \\n \\n 1990 Joe\\n \\n \\n \\n Whoa so there\\'s some heavy stuff in this book, like, telescreens that scream at you to do calisthenics in the morning, shout propaganda at you in the afternoon and listen to you talking in your sleep at night. There are periodic shortages of essential goods like razor blades and a perpetual war with Oceania\\'s foe, Eurasia. At least the Party says so. No one trusts anyone else. In addition to hidden microphones, there are informers and spies everywhere prepared to turn you in to the Thought Police for thought crimes. Children most of all revel in ratting out their Outer Party moms and dads.\\n \\n \\n \\n It was always at night — the arrests invariably happened at night. The sudden jerk out of sleep, the rough hand shaking your shoulder, the lights glaring in your eyes, the ring of hard faces round the bed. In the vast majority of cases there was no trial, no report of the arrest. People simply disappeared, always during the night. Your name was removed from the registers, every record of everything you had ever done was wiped out, your one-time existence was denied and then forgotten. You were abolished, annihilated: VAPORIZED was the usual word.\\n \\n \\n \\n \\n 2016 Joe\\n \\n \\n \\n The Party has so eradicated records of the past and traumatized its Outer Party members into obedience that its slogans are: WAR IS PEACE, FREEDOM IS SLAVERY, IGNORANCE IS STRENGTH. But Winston\\'s mind is his own. He\\'s old enough to keep a mental inventory of the inconsistencies of the Party--like the one that says they invented aeroplanes--and contemplate that the glance of a co-worker named O\\'Brien reveals a fellow rebel. Believing that the only hope to overthrow Big Brother lies with the proles, Winston ventures into the slums. He buys an old man a pint and grills him for information on the past. Everyone seems blind, except, to Winston\\'s terror, a dark-haired woman he works with at the Ministry of Truth. She sees Winston in the slums.\\n \\n \\n \\n 1990 Joe\\n \\n \\n \\n This book is hard to enjoy. Just when things start to slow, there is a love story introduced between Winston and his co-worker, Julia. She works at the Fiction Department, operating the press (that\\'s kinda hot) that cranks out the only books that are allowed in Oceania. Winston initially suspects her of being a typical frigid Party femmebot, but Julia slips him a love note and arranges a series meetings with the aplomb of a spy. Separated in age by about fifteen years, I never understood what Julia\\'s attraction to Winston was or why the couple didn\\'t band together to escape or to take down Big Brother. If I was Winston, I\\'d stab Inner Party members all day without a lunch break.\\n \\n \\n \\n 2016 Joe\\n \\n \\n \\n George Orwell\\'s writing is so precise, so penetrative, that I felt like he was broadcasting truths into my mind with a laser. I could appreciate that Winston and Julia were doing what they had to survive, that staying alive another day, even under tyranny, had become paramount to all other concerns. As an adult, I can now appreciate how fear and hatred warp democracy and how people who feel they have nothing left to lose surrender their once cherished freedoms and throw their lot in with a Big Brother who promises to take care of them. And did I mention the writing?\\n \\n \\n \\n ‘You are very young,' he said. ‘You are ten or fifteen years younger than I am. What could you see to attract you in a man like me?'\\n \\n \\n ‘It was something in your face. I thought I'd take a chance. I'm good at spotting people who don't belong. As soon as I saw you I knew you were against THEM.'\\n \\n \\n THEM, it appeared, meant the Party, and above all the Inner Party, about whom she talked with an open jeering hatred which made Winston feel uneasy, although he knew that they were safe here if they could be safe anywhere. A thing that astonished him about her was the coarseness of her language. Party members were supposed not to swear, and Winston himself very seldom did swear, aloud, at any rate. Julia, however, seemed unable to mention the Party, and especially the Inner Party, without using the kind of words that you saw chalked up in dripping alley-ways. He did not dislike it. It was merely one symptom of her revolt against the Party and all its ways, and somehow it seemed natural and healthy, like the sneeze of a horse that smells bad hay.\\n \\n \\n \\n \\n \\n \\n \\n The devil is in the details. What stands out to me in\\n \\n 1984\\n \\n is precision with which Orwell depicts the joys of humanity thriving under inhumane rule as well as the terror of being exposed. Thinking men like Winston know that they\\'ll be arrested, tortured and possibly vaporized for allowing themselves the indulgences that they do, but no amount of reason can prepare them for that moment of betrayal, arrest and interrogation. The third act of\\n \\n 1984\\n \\n is terrifying. The Party\\'s true methodology--to convert political prisoners to embrace Big Brother before disposing of them--is chilling, something whose force I wasn\\'t prepared to appreciate in high school.\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 156 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 60 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n May 27, 2010\\n \\n \\n \\n Nawal Al-Qussyer\\n \\n \\n rated it\\n \\n \\n it was amazing\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Shelves:\\n \\n changed-the-way-i-see-the-world\\n \\n \\n \\n \\n \\n \\n أضفت مراجعة الرواية في مدونتي ضمن 50 كتاب غيرني\\n \\n \\n http://www.nawalsaad.com/?p=4108\\n \\n \\n وأضفت رابط لتقرير رحالة قام بزيارة كوريا الشمالية، وكان صادمًا تطابق استراتيجات الرواية مع ما يفعل في كوريا الشمالية.\\n \\n \\n المجد للكتب التي تحدث ضجة داخل عقلك.. المجد للكتب التي تحفز اليقطة الذهنية فيك .. المجد للكتاب الذي يصفعك ويجعلك تعيد النظر في أشياء كثيرة .. هذا الكتاب من الكتب النادرة التي توازي شهرتها وضجتها قيمتها الفكرية والروائية ..\\n \\n \\n قرأت الكتاب في الطائرة رحلة عودة من امستردام إلى الرياض .. استغرق معي الكتاب 6 ساع\\n \\n \\n \\n \\n \\n \\n \\n \\n أضفت مراجعة الرواية في مدونتي ضمن 50 كتاب غيرني\\n \\n \\n http://www.nawalsaad.com/?p=4108\\n \\n \\n وأضفت رابط لتقرير رحالة قام بزيارة كوريا الشمالية، وكان صادمًا تطابق استراتيجات الرواية مع ما يفعل في كوريا الشمالية.\\n \\n \\n المجد للكتب التي تحدث ضجة داخل عقلك.. المجد للكتب التي تحفز اليقطة الذهنية فيك .. المجد للكتاب الذي يصفعك ويجعلك تعيد النظر في أشياء كثيرة .. هذا الكتاب من الكتب النادرة التي توازي شهرتها وضجتها قيمتها الفكرية والروائية ..\\n \\n \\n قرأت الكتاب في الطائرة رحلة عودة من امستردام إلى الرياض .. استغرق معي الكتاب 6 ساعات ونصف لم أشعر بالاقلاع ولم أشعر بأي مطبات هوائية حينها وأنا التي تربكني تحركات الطائرة واهتزازاتها ..\\n \\n تعرف تماما الكتاب النخبوي حين يحرض حاسة البحث لديك ويجعلك تبحث عن كتب أخرى تتحدث عن ذات الموضوع .. تعرف جودة الكتاب حين تظل تبحث عن كاتبه وخلفيته ونشأته ساعات طويلة ..\\n \\n هذا ما كنت أفعله عندما أنهيته وحتى يومي هذا .. ابتعت كتب تتحدث عن صناعة العدو ، والقدرة على الثورات وعلم النفس السياسي .. ولربما لو لم أقرأ هذا الكتاب ( وقبله كتب أخرى ) لن يحرضني غيرها للاهتمام بهذه الكتب ..\\n \\n \\n على الرغم من قراءاتي السابقة في فلسفة الاستبداد ، و حكومات القمع والاستبداد وما يمكن أن تفعله حتى تضمن بقاؤها واستمراها ، إلا أن هذا الكتاب صدمة لي .. لكنها صدمة تحثك على زيادة الوعي لديك وتقسم خمسين ألف مرة أنك لن تدع وعيك يموت ولن يدمره شيء !\\n \\n \\n يقدم جورج سياسات القمع والديكتاتورية بقالب درامي رمزي رفيع جدا ، حتى وإن قلت لوهلة هذا مبالغ به جدا ! دقيقتين من التفكير وستجد أن الاستراتيجية حدثت من قبل أو تحدث الآن لكن يختلف تلقينا لها واهتمامنا لها ..\\n \\n إنه لعمل عظيم أن تدرس الحاضر والماضي وتعير أدنى التفاصيل انتباهك، ثم بعد ذلك تستشرف المستقبل .. مرعب والله مرعب كمية الوقائع حاليا التي تشبه تنبؤات جورج ، تغير القوى ، تغيير العدو في يوم وليلة الخ ..\\n \\n \\n لدى حكومات القمع طرق سحرية حتى تقنعك بما يرفضه عقلك ابتداء، عليك أن تقتنع ب:\\n \\n \\n الحرب هي السلام\\n \\n الحرية هي العبودية\\n \\n الجهل هو القوة\\n \\n 2+2=5\\n \\n \\n وفي بعض المرات ممكن يساوي ثلاثة أو أربعة .. 2+2 يساوي العدد الذي تخبرك به حكومة القمع ..\\n \\n التاريخ يتغير حسب ما تريده الحكومات ، حسب ما تريدك أن تصدقه .. إنها حكومات تعمل على تسطيح عقولنا والهاءنا في ما لاينفع حتى تستمر هذه الحكومات بالتلاعب بالعالم ..\\n \\n وبنظرة سريعة للعالم وما يجري الآن تدرك أن معظم الحكومات هي حكومات قمع داخليا وخارجيا ، هناك فقط مستويات مختلفة ، وطرق مختلفة لتحقيق هذا القمع ..\\n \\n \\n فقدت الثقة بمعظم ما كُتب في التاريخ، فكلّا يكتب مايريده .. كلّا يكذب بما يتلائم مع مصلحته .. من الممكن جدا أن تقنع شعبك أن أسلافهم كانوا يعبدون القدور والأصنام، لكن تم انقاذك من هذا الوحل .. بينما الواقع يكون شيئا آخر !!\\n \\n اقرأ التاريخ من ألف مصدر ان استطعت .. وفوق كل هذا فالتحريف والسهو وارد جدا ..\\n \\n \\n الاستبداد يفقدك متع الحياة كلها ، لن تعيش كما ينبغي أن تعيش .. ستكون كما الآلة تتزوج وتنجب من أجل الواجب والحزب .. تأكل من أجل الحزب .. شاشة الرصد تحيطك يمنة ويسرة .. لا تكتب ولا تقرأ كما تريد ..\\n \\n لوحات بصورة الأخ الكبير تواجهك في كل مكان حتى تنغرس في عقلك بأنه لامحالة من أن تعيش .. الأسهل أن تخضع ، أن تتأقلم وتعيش بالكفاف ..\\n \\n الأخ الكبير يراقبك .. التبجيل في أعظم صوره .. نشر صور القادة بطريقة مبالغ بها وكبيرة ، وعبارات مدح وتبجيل لا يمكنها إلا أن تفسد كل ما في عقلك للأسف إن لم ننتبه لهذا .. كل هذه الاستراتيجيات لعبة سياسية قذرة .. لعبة نفسية مدروسة ..\\n \\n \\n ثلاث قوى استبدادية تتصارع حول بقية العالم ، من يظفر بمن ؟ وكيف بإمكانك إخضاع شعب لأي فكرة تأتي بها ؟ كيف يمكنك تطوير أسلحة ذهنية لدمار شامل للعقل .. كيف يمكنك تدليس الحقيقة، وجعل كل شيء صحيحا أو خاطئا كيفما تريد ومتى تريد .. كيف يمكنك زرع الكره تجاه ماضي أو حاضر أو مستقبل .. كيف يكون بإمكان القوى القوية أن تتنازع حول أراضي وقوة ليست من حقها ، إنه استبداد الانسان على الإنسان ، استبداد الإنسان على نفسه ..\\n \\n \\n \\n \\n - أوبراين : \"كيف يؤكد الانسان سلطته على انسان آخر يا ونستون؟\"\\n \\n \\n - ونستون: - \"بجعله يقاسي الألم\".\\n \\n \\n اوبراين: - \" \"أصبت فيما تقول. بتعريضه للألم، فالطاعة وحدها ليست كافية، وما لم يعاني الانسان من الألم كيف يمكنك أن تتحقق من أنه ينصاع لإرادتك لا لإرادته هو؟ إن السلطة هي إذلاله وإنزال الألم به، وهي أيضاً تمزيق العقول البشرية إلى أشلاء ثم جمعها وصياغتها في قوالب جديدة من اختيارنا.\\n \\n هل تفهم أي نوع من العالم نقوم بخلقه الآن؟ إنه النقيض التام ليوتوبيا المدينة الفاضلة التي تصورها المصلحون الأقدمون، إنه عالم الخوف والغدر والتعذيب، عالم يدوس الناس فيه بعضهم بعضاً، عالم يزداد قسوة كلما ازداد نقاء، إذ التقدم في عالمنا هو التقدم باتجاه مزيد من الألم. لقد زعمت الحضارات الغابرة بأنها قامت على الحب والعدالة أما حضارتنا فهي قائمة على الكراهية، ففي عالمنا لا مكان لعواطف غير الخوف والغضب والانتشاء بالنصر وإذلال الذات، وأي شيء خلاف ذلك سندمره تدميراً. إننا بالفعل نعمل على تفكيك العادات الفكرية التي ورثناها من العهد السابق للثورة، لقد فصمنا عرى العلاقة بين الطفل ووالديه، وبين الصديق وصديقه، وبين الزوج وزوجته، ولم يعد أحد قادراً على الثقة بزوجته أو بطفله أو بصديقه، وفي المستقبل لن يكون هناك زوجات أو أصدقاء. كما سينعدم كل ولاء ليس للحزب ، وسيباد كل حب ليس للأخ الكبير. ولن يكون هناك ضحك غير الضحك الذي يصاحب نشوة الانتصار على العدو المقهور، ولن يكون هنالك أدب أو فن أو علم، فحينما تجتمع في أيدينا كل أسباب القوة لن تكون بنا حاجة إلى العلم. كما ستزول الفروق بين الجمال والقبح، ولن يكون هناك حب للاستطلاع أو التمتع بالحياة ولن يكون هناك ميل نحو مباهج الحياة التي ستدمر تدميراً......\"\\n \\n \\n كيف يمكنك أن تشغل العامة بالرذيلة باختلاف أشكالها ، بالفوضى الصغيرة حتى لا يعودو قادرين على معرفة الفوضى الكبيرة .. كيف تأكل أنت جيدا وشعبك لا يعرف طعم الأشياء الحقيقي .. عليه فقط أن يصدق كل ماتقول ..\\n \\n حياتك كنفس غير مهمة لسلطات القمع، حياتك فكريا وانسانيا هي ما يقلقهم ، هي ما يجعلهم يصلون إليك ويخفونك من الوجود الواعي ، يتنزعون منك إنسانيتك .. يسخرون كل القوى والتقنيات والاستراتيجيات من أجل ذلك الهدف ، من أجل أن ينجحو في الأخير لتقول :\\n \\n لا بأس فقد انتهى النضال، وها قد انتصرت على نفسي وصرت أحب الأخ الكبير.\\n \\n \\n \\n لا يكفي حكومات القمع والاستبداد أن تكفر بما يكفرون به، بل يجب أن تؤمن بالأخ الكبير ، طاعة عمياء وتصديق لكل مايقوله عن ظهر قلب .. بدو شك .. بدون تفكير .. آمن من قلبك به وبكل مايقوله ..\\n \\n \\n \\n مؤلمة الرواية لأن نهايتها مؤلمة ومؤسف أنها تحدث حاليا، ونرى ما يشبه أحداثها ، مؤلمة لكن الحرب ماتزال قائة الى يوم الدين مع كل مايعطل العقل البشري ويقيد حريته ، قائمة حتى يأتي جيل يرفض هذا العنت السياسي وتزدهر الانسانية .. فتلك الأيام نداولها بين الناس ..\\n \\n \\n \\n شخصيا أرى أن الرواية لا تقتصر فقط على السياسة ، فهي بلا شك يمكن إسقاطها على أبسط الأمور مع تجاوز العديد من الدراما فيها ..\\n \\n \\n الناحية الأدبية كانت جميلة ومقبولة في الرواية على الرغم من قلة معرفتي بالنقد الأدبي ، لكن أرى أن الرواية مباشرة أكثر من اللازم .. ربما كان لجورج مغزى من ذلك فهو كان ينشر لبشر وعيهم يختلف عن وعينا، ومستوى تلقيهم يختلف ؟\\n \\n \\n \\n أرجو أن لاتفهم من تقييمي بخمسة نجوم بأن الراوية لا يوجد بها ضعف أو ملاحظات ، ولكني في مثل هذه الكتب أقيم بشكل عام مع ذكر الملاحظات ، وعلى الرغم من أن الرواية كمفهوم ليست جديدة كليا إلا أنها كتب في وقت قديم جدا وهذا ما يضفي عليها الكثير من الجمال الفكري ، كمقدمة ابن خلدون .. فمن العدل في نظري أن تقيم حسب وقت نشرها ، فهي كانت من القواعد لكثير من أعمال نشرت وصورت بعدها ..\\n \\n \\n هل تستحق القراءة ؟ نعم تستحق من وجهة نظري .. حتى ولو سبقت لك القراءة في حكومات القمع وغيرها فمن الجيد معرفة أحد الأساسات لمثل هذه الكتابات .. أيضا أجد أنها تساعد كثيرا لفهم وتحليل الواقع والمستقبل ..\\n \\n فمنذ أن قرأتها لم أتوقف عن الحديث عنها لزوجي ، وفي كل موقف أضرب له مثلا بما جاء في الرواية حتى رغب بشدة في قراءتها ..\\n \\n رواية بامتياز تستحق أن تقتنيها و تكون في رفوف مكتبتك بشكل دائم ..\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 149 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 11 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Jul 05, 2014\\n \\n \\n \\n Antonio\\n \\n \\n rated it\\n \\n \\n really liked it\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ·\\n \\n \\n review of another edition\\n \\n \\n \\n Recommends it for:\\n \\n \\n Todos\\n \\n \\n \\n Shelves:\\n \\n clásicos\\n \\n ,\\n \\n ciencia-ficción\\n \\n ,\\n \\n horror-terror\\n \\n ,\\n \\n favorites\\n \\n \\n \\n \\n \\n \\n Este libro me sigue atormentando...\\n \\n \\n Antes de hablar de la historia, primero quiero hablar un poco sobre géneros literarios, si yo se debería enfocarme en el libro pero denme un momento, nunca he sido fanático del género del terror, por dos razones: asustarse para divertirse no me parece muy lógico, y la otra razón es que siempre hay una vocecita en mi cabeza que, cuando se trata de monstruos, fantasmas, demonios, vampiros, posesiones, etc. me dice esto no es real, como te vas a asustar de lo que\\n \\n \\n Este libro me sigue atormentando...\\n \\n \\n Antes de hablar de la historia, primero quiero hablar un poco sobre géneros literarios, si yo se debería enfocarme en el libro pero denme un momento, nunca he sido fanático del género del terror, por dos razones: asustarse para divertirse no me parece muy lógico, y la otra razón es que siempre hay una vocecita en mi cabeza que, cuando se trata de monstruos, fantasmas, demonios, vampiros, posesiones, etc. me dice esto no es real, como te vas a asustar de lo que no existe ni existirá, y termino haciéndole caso, entonces me encuentro con este libro, que según GOODREADS me dice es un clásico, de ciencia ficción distópico, - y una mierda –\\n \\n este libro es de terror\\n \\n , este es el libro que me mantiene despierto en las noches, pensativo y con miedo porque todo lo que dice es casi (un insignificante casi) real.\\n \\n \\n Ahora si la reseña la dividiré en tres partes, porque el libro está dividido en tres partes a su vez, así que será algo larga, espero la leas, sino me conformo con que hayas leído el párrafo de arriba, en la tercera parte incluiré spoiler, así que si no han leído el libro recomiendo leer solo hasta la segunda parte.\\n \\n \\n \\n Primera parte:\\n \\n Conocemos a nuestro personaje principal Winston Smith y el nos ira describiendo que tan jodido esta su mundo.\\n \\n \\n \\n Era un día luminoso y frío de abril y los relojes daban las trece.\\n \\n \\n \\n El mundo está dividido en tres grandes potencias en guerra, Winston pertenece a Oceania, la cual esta comandada por el partido\\n \\n INGSOC\\n \\n y su líder es el\\n \\n Gran Hermano\\n \\n , uno de los lemas del partido es\\n \\n \\n \"El gran hermano siempre te vigila\"\\n \\n \\n y esto, lamentablemente es verdad, ya que en todas partes hay unas maquinas llamadas\\n \\n telepantallas\\n \\n , que se encargan de emitir publicidad para el gobierno, todos los logros de este, y por supuesto también mensajes de a quién debe odiar la población, esto es llevado al extremo en un acto, los \"dos minutos de odio\", donde toda la población se reúne a declararle su odio a los enemigos del partido. Pero las telepantallas no solo sirven para eso, las telepantallas vigilan, graban todo lo que sucede a su alrededor, para que, la población no pueda cometer ningún crimen sin que se sepa, y aquel que cometa un crimen, como hablar en contra del Gran hermano o del partido,\\n \\n \"desaparecerá\"\\n \\n , esto tendrá más sentido si conocemos en que trabaja Winston.\\n \\n \\n \\n «El que controla el pasado —decía el slogan del Partido—, controla también el futuro.El que controla el presente, controla el pasado.»\\n \\n \\n \\n Winston trabaja en el\\n \\n Ministerio de la verdad\\n \\n , que irónicamente, o\\n \\n doblepensando\\n \\n , se encarga de acomodar el pasado, cambiarlo al antojo y necesidad del partido, Winston se da cuenta por ejemplo de que Oceanía aunque siempre está en guerra, no siempre está en guerra con la misma potencia, a veces esta aliada con una de las potencias y peleada con la otra, pero estas posiciones suelen invertirse, entonces el ministerio de la verdad acomoda todo el pasado a su conveniencia, modificando todo periódico, libro o revista, para que digan que siempre se ha estado en guerra con digamos Eurasia.\\n \\n \\n Además de esto, cuando se encuentra un criminal que sea perteneciente al partido, todo su pasado es cambiado para decir que dicho criminal siempre fue malo y tuvo intenciones en contra del partido o\\n \\n \"desaparece\"\\n \\n , cuando una persona desaparece, no es que solamente ha dejado de vivir, no, se elimina todo información que haya sobre la persona, virtualmente nunca existió. Esta primera parte es un monologo casi ininterrumpido de Winston donde nos muestra su desacuerdo con la situación y sus intenciones de formar parte de la rebelión.\\n \\n \\n Segunda Parte.\\n \\n \\n \\n \\n LA GUERRA ES LA PAZ\\n \\n \\n LA LIBERTAD ES LA ESCLAVITUD\\n \\n \\n LA IGNORANCIA ES LA FUERZA\\n \\n \\n \\n \\n En esta parte cambia un poco el tono de la historia, Winston conoce a una chica llamada\\n \\n Julia\\n \\n , de la cual se enamora, ella también está en contra del partido, pero quizás con menos fervor que Winston, empiezan a reunirse en sitios clandestinos y a protestar a su manera en contra del partido, teniendo relaciones, cosa que, si se disfruta, en este mundo también es un crimen. Winston conoce a otro personaje acá,\\n \\n O'Brien\\n \\n un hombre que solo con verlo le inspira admiración y confianza, y que él cree forma parte de la Rebelión. Cosa que se confirma más adelante.\\n \\n \\n Winston y Julia logran reunirse con O'Brien y este los introduce a la rebelión y le entregara un libro a Winston donde se explica todo el movimiento y todas las razones de porque el mundo está en las condiciones en que esta.\\n \\n \\n Debo decir que esta fue mi parte favorita del libro, hay tanta\\n \\n filosofía política\\n \\n , tantas explicaciones que incluso siendo parte de esta historia se aplican perfectamente a nuestro mundo, entenderemos ese otro lema del partido LA GUERRA ES LA PAZ / LA LIBERTAD ES LA ESCLAVITUD/ LA IGNORANCIA ES LA FUERZA, todo está explicado tan clara y perfectamente que me hace pensar que el escritor\\n \\n \\n George Orwell era un genio\\n \\n \\n , subraye muchos párrafos y frases de esta parte, pero creo que es conveniente que ustedes los lean personalmente junto a la historia.\\n \\n \\n \\n Tercera parte: léase bajo su propio riesgo, de acá para abajo vienen los spoilers\\n \\n \\n \\n Winston y Julia son capturados, la verdad no duraron mucho como espías, pero resulta que O'Brien no era de la Rebelión sino del partido.\\n \\n \\n Winton es separado de Julia y empieza la tortura física y mental por parte de O'Brien, verán O'Brien no quiere matar a Winston, no, no eso sería muy sencillo, el lo quiero destruir psicológicamente, hacer que ame al gran hermano y al partido, que todo pensamiento que ha tenido en contra de ellos sea admitido como erróneo por parte de Winston y que nunca vuelva a pensar en contra de ellos.\\n \\n \\n \\n Esta es la parte más cruel del libro,\\n \\n odie a O'Brien es un sociópata, sicótico con el poder de hacer mucho daño a Winston y a todos en general, el representa al partido, EL es el partido o ¿debería decir todo es el partido?.\\n \\n \\n \\n El final\\n \\n , aquí llegamos te felicito y agradezco si has leído lo que escrito hasta este momento,\\n \\n \\n El final es lo más triste y la razón por la cual le baje una estrella al libro, Winston es sometido, Winston pierde su persona y llega a amar al Gran Hermano\\n \\n \\n \\n \\n \\n En este momento la voz de George Orwell (que suena extrañamente similar a la de su tocayo George R. R. Martin) dice en mi cabeza, \"\\n \\n si creías que habría un final feliz era que no estabas prestando atención\\n \\n \"\\n \\n \\n No, no creía que el final fuera feliz, ya había aceptado lo contrario, pero tonto, inocente de mi pensé que Winston haría algo, que la humanidad prevalecería, que de alguna manera ante toda esta catastrófica situación algo, aunque fuera mínimo, se podría hacer.\\n \\n \\n Winston no tiene importancia en la historia, su única función es ser narrador, pero no cambia nada, no hace nada, el mundo queda igual de jodido que como nos presentan al principio. Esto me aterra, me atemoriza, me niego a aceptarlo, si pierdo la fe en la humanidad (aun en la humanidad ficticia de un mundo cuasi ficticio) no podre dormir jamás.\\n \\n \\n \\n Este es un libro que todo el mundo debería leer, y reflexionar sobre él, una vez mas lo recomiendo mucho.\\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n flag\\n \\n \\n \\n \\n 143 likes\\n \\n \\n ·\\n \\n Like\\n \\n \\n ·\\n \\n see review\\n \\n \\n \\n \\n \\n \\n View all 46 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Likitha\\n \\n \\n Tom Corson-Knowles, the author who founded Bestseller Ranking Pro, spent six long years trying to get a traditional publishing deal (and failed misera\\n \\n \\n Tom Corson-Knowles, the author who founded Bestseller Ranking Pro, spent six long years trying to get a traditional publishing deal (and failed miserably). He finally decided to self publish his first book on Kindle in February, 2012.\\n \\n \\n That one decision changed his life (and the lives of the more than 30,000 authors he\\'s since taught how to write, publish and market their books professionally).\\n \\n \\n Just twelve months after self publishing his first book, Tom had his first $12,000+ month from Kindle ebook royalties alone.\\n \\n \\n In Bestseller Ranking Pro, Tom will share with you his step-by-step system for becoming a bestselling author.\\n \\n \\n These strategies have also helped Tom and his private publishing clients create more than sixty-seven #1 Amazon bestselling books and counting.\\n \\n \\n If you\\'re going to write, publish or promote a book this year, you need to see this:\\n \\n \\n \\n https://bestsellerrankingpro.com?vhbs...\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n Jul 03, 2018 01:32AM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Francisco Tavie\\n \\n \\n Me entretiene el 50% del libro, sin embargo al final te hace reflexionar sobre la libertad y la metafísica de nuestra realidad que \"compensa\" y hace d\\n \\n \\n Me entretiene el 50% del libro, sin embargo al final te hace reflexionar sobre la libertad y la metafísica de nuestra realidad que \"compensa\" y hace de este libro un libro recomendable.\\n \\n \\n ...more\\n \\n \\n \\n Sep 29, 2018 04:01PM\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n « previous\\n \\n \\n 1\\n \\n \\n 2\\n \\n \\n 3\\n \\n \\n 4\\n \\n \\n 5\\n \\n \\n 6\\n \\n \\n 7\\n \\n \\n 8\\n \\n \\n 9\\n \\n \\n …\\n \\n \\n next »\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n new topic\\n \\n \\n \\n Discuss This Book\\n \\n \\n \\n \\n \\n \\n \\n \\n topics\\n \\n \\n posts\\n \\n \\n views\\n \\n \\n last activity\\n \\n \\n \\n \\n \\n \\n \\n \\n Great American Re...:\\n \\n \\n \\n September 2018—1984 by George Orwell\\n \\n \\n \\n 40\\n \\n \\n 20\\n \\n \\n 5 hours, 55 min ago\\n \\n \\n \\n \\n \\n \\n \\n \\n UCAS English 11 R...:\\n \\n \\n \\n September Reading Assignment\\n \\n \\n \\n 1\\n \\n \\n 5\\n \\n \\n Sep 30, 2018 06:59PM\\n \\n \\n \\n \\n \\n \\n \\n \\n Fantasy Buddy Reads:\\n \\n \\n \\n 1984 [October 22, 2018]\\n \\n \\n \\n 5\\n \\n \\n 21\\n \\n \\n Sep 29, 2018 12:28PM\\n \\n \\n \\n \\n \\n \\n \\n what would happen to you if you were in 101 room\\n \\n \\n \\n 34\\n \\n \\n 350\\n \\n \\n Sep 29, 2018 04:58AM\\n \\n \\n \\n \\n \\n \\n \\n More topics...\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Share\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Recommend It\\n \\n \\n |\\n \\n \\n Stats\\n \\n \\n |\\n \\n \\n Recent Status Updates\\n \\n \\n \\n \\n \\n \\n \\n Readers Also Enjoyed\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[ \\n\\n function submitShelfLink(unique_id, book_id, shelf_id, shelf_name, submit_form, exclusive) {\\n var checkbox_id = \\'shelf_name_\\' + unique_id + \\'_\\' + shelf_id;\\n var element = document.getElementById(checkbox_id)\\n\\n var checked = element.checked\\n if (checked && exclusive) {\\n // can\\'t uncheck a radio by clicking it!\\n return\\n }\\n if(document.getElementById(\"savingMessage\")){\\n Element.show(\\'savingMessage\\')\\n }\\n var element_id = \\'shelfInDropdownName_\\' + unique_id + \\'_\\' + shelf_id;\\n Element.update(element_id, \"saving...\");\\n if (submit_form) {\\n Element.hide(\\'shelfDropdown_\\' + unique_id)\\n var form = document.getElementById(\\'addBookForm\\' + book_id)\\n if (form) {\\n form.shelf.value = shelf_name\\n form.onsubmit()\\n }\\n }\\n else {\\n var action = checked ? \\'remove\\' : \\'\\'\\n element.checked = !element.checked\\n new Ajax.Request(\\'/shelf/add_to_shelf\\', {asynchronous:true, evalScripts:true, onSuccess:function(request){shelfSubmitted(request, book_id, checkbox_id, element_id, unique_id, shelf_name)}, parameters:\\'book_id=\\' + book_id + \\'&name=\\' + shelf_name + \\'&a=\\' + action + \\'&authenticity_token=\\' + encodeURIComponent(\\'kX1COFbWqbE+NToBeGPKT3uw8h+gTW0l597bxyarce1vOvr1zX5F0C86vQSogPUDEgbUpC9nXERplHvMqdEPmw==\\')})\\n }\\n }\\n\\n function shelfSubmitted(request, book_id, checkbox_id, element_id, unique_id, shelf_name) {\\n Element.update(\\'shelfListfalse_\\' + book_id, request.responseText)\\n afterShelfSave(checkbox_id, element_id, unique_id, shelf_name.escapeHTML())\\n }\\n\\n function refreshGroupBox(group_id, book_id) {\\n new Ajax.Updater(\\'addGroupBooks\\' + book_id + \\'\\', \\'/group/add_book_box\\', {asynchronous:true, evalScripts:true, onSuccess:function(request){refreshGroupBoxComplete(request, book_id);}, parameters:\\'id=\\' + group_id + \\'&book_id=\\' + book_id + \\'&refresh=true\\' + \\'&authenticity_token=\\' + encodeURIComponent(\\'hOlEllglE+BiX+4JrZvwOKwyjZ9bBXoOdIcB+/OF38x6rvxbw43/gXNQaQx9eM90xYSrJNQvS2/6zaHwfP+hug==\\')})\\n }\\n//]]>\\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_13651\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/13651.The_Dispossessed?from_choice=false&amp;from_home_module=false\\\\\">The Dispossessed<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/874602.Ursula_K_Le_Guin?a=7&amp;origin=related_works\\\\\">Ursula K. Le Guin<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.20 avg rating &mdash; 65,864 ratings<\\\\/span> &mdash; published 1974\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer14404481498210501951\\\\\">Shevek, a brilliant physicist, decides to take action. He will seek answers, question the unquestionable, and attempt to tear down the walls of hatred that have isolated his planet of anarchists from the rest of the civilized universe. To do this dan<\\\\/span>\\\\n <span id=\\\\\"freeText14404481498210501951\\\\\" style=\\\\\"display:none\\\\\">Shevek, a brilliant physicist, decides to take action. He will seek answers, question the unquestionable, and attempt to tear down the walls of hatred that have isolated his planet of anarchists from the rest of the civilized universe. To do this dangerous task will mean giving up his family and possibly his life--Shevek must make the unprecedented journey to the utopian mother planet, Urras, to challenge the complex structures of life and living, and ignite the fires of change.<\\\\/span>\\\\n <a data-text-id=\\\\\"14404481498210501951\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'8_book_13651\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"c3NLR+TY1IoxI+PhfZIJ8Cv1FOmIfzsQhnkT7gBYrXGNNPOKf3A46yAsZOStcTa8QkMyUgdVCnEIM7PljyLTBw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"13651\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"8_book_13651\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"Qur+5Gc2eASkOAqAiq/BMk5Tb3Ky3PCdZe7dFoTSBNW8rUYp/J6UZbU3jYVaTP5+J+VJyT32wfzrpH0dC6h6ow==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"8_book_13651\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"13651\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"13651\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/13651?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=8_book_13651\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_13651\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_13651\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_13651\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_13651\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_17716\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/17716.Waiting_for_Godot?from_choice=false&amp;from_home_module=false\\\\\">Waiting for Godot<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/1433597.Samuel_Beckett?a=7&amp;origin=related_works\\\\\">Samuel Beckett<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.82 avg rating &mdash; 132,659 ratings<\\\\/span> &mdash; published 1952\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer3457594558354823962\\\\\">The story revolves around two seemingly homeless men waiting for someone—or something—named Godot. Vladimir and Estragon wait near a tree, inhabiting a drama spun of their own consciousness. The result is a comical wordplay of poetry, dreamscapes, an<\\\\/span>\\\\n <span id=\\\\\"freeText3457594558354823962\\\\\" style=\\\\\"display:none\\\\\">The story revolves around two seemingly homeless men waiting for someone—or something—named Godot. Vladimir and Estragon wait near a tree, inhabiting a drama spun of their own consciousness. The result is a comical wordplay of poetry, dreamscapes, and nonsense, which has been interpreted as mankind's inexhaustible search for meaning. Beckett's language pioneered an expressionistic minimalism that captured the existential post-World War II Europe. His play remains one of the most magical and beautiful allegories of our time.<\\\\/span>\\\\n <a data-text-id=\\\\\"3457594558354823962\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'9_book_17716\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"LW4W22FLybLWuh40mZSUqLyatBSHT94Sm+JXal8zRbbTKa4W+uMl08e1mTFJd6vk1SySrwhl73MVqPdh0Ek7wA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"17716\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"9_book_17716\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"QwFfvJRymexw3+ZQ8ToBg1cpfW5KsHa8kzyyFNR7UUG9RudxD9p1jWHQYVUh2T7PPp9b1cWaR90ddhIfWwEvNw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"9_book_17716\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"17716\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"17716\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/17716?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=9_book_17716\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_17716\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_17716\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_17716\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_17716\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_17876\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/17876.Notes_from_Underground_White_Nights_The_Dream_of_a_Ridiculous_Man_and_Selections_from_The_House_of_the_Dead?from_choice=false&amp;from_home_module=false\\\\\">Notes from Underground, White Nights, The Dream of a Ridiculous Man, and Selections from The House of the Dead<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/3137322.Fyodor_Dostoyevsky?a=7&amp;origin=related_works\\\\\">Fyodor Dostoyevsky<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.17 avg rating &mdash; 70,859 ratings<\\\\/span> &mdash; published 1864\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer17440172058695377164\\\\\">A collection of powerful stories by one of the masters of Russian literature, illustrating the author\\\\\\'s thoughts on political philosophy, religion and above all, humanity: Notes from Underground, White Nights, The Dream of a Ridiculous Man, and Selec<\\\\/span>\\\\n <span id=\\\\\"freeText17440172058695377164\\\\\" style=\\\\\"display:none\\\\\">A collection of powerful stories by one of the masters of Russian literature, illustrating the author\\\\\\'s thoughts on political philosophy, religion and above all, humanity: Notes from Underground, White Nights, The Dream of a Ridiculous Man, and Selections from The House of the Dead (150th Anniversary Edition)\\\\n\\\\nThe compelling works presented in this volume were written at distinct periods in Dostoyevsky\\\\\\'s life, at decisive moments in his groping for a political philosophy and a religious answer. From the primitive peasant who kills without understanding that he is destroying life to the anxious antihero of Notes from Underground—who both craves and despises affection—the writer\\\\\\'s often-tormented characters showcase his evolving outlook on our fate.\\\\n\\\\nThomas Mann described Dostoyevsky as &quot;an author whose Christian sympathy is ordinarily devoted to human misery, sin, vice, the depths of lust and crime, rather than to nobility of body and soul&quot; and Notes from Underground as &quot;an awe- and terror- inspiring example of this sympathy.&quot;<\\\\/span>\\\\n <a data-text-id=\\\\\"17440172058695377164\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'10_book_17876\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"JPQwHDVpcw12StP03IHqcvxIaJvyrkqJolQeUh2M42zas4jRrsGfbGdFVPEMYtU+lf5OIH2Ee+gsHr5ZkvadGg==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"17876\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"10_book_17876\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"L7xM5T6Ou61pRDZMn4D34LRJiGKP7Y4h3FaghO1scUDR+/QopSZXzHhLsUlPY8is3f+u2QDHv0BSHACPYhYPNg==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"10_book_17876\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"17876\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"17876\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/17876?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=10_book_17876\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_17876\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_17876\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_17876\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_17876\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_4985\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/4985.Welcome_to_the_Monkey_House?from_choice=false&amp;from_home_module=false\\\\\">Welcome to the Monkey House<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/2778055.Kurt_Vonnegut?a=7&amp;origin=related_works\\\\\">Kurt Vonnegut<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.14 avg rating &mdash; 47,033 ratings<\\\\/span> &mdash; published 1968\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer12993061018294291471\\\\\">Welcome to the Monkey House is a collection of Kurt Vonnegut's shorter works. Originally printed in publications as diverse as The Magazine of Fantasy and Science Fiction and The Atlantic Monthly, these superb stories share Vonnegut's audacious sense<\\\\/span>\\\\n <span id=\\\\\"freeText12993061018294291471\\\\\" style=\\\\\"display:none\\\\\">Welcome to the Monkey House is a collection of Kurt Vonnegut's shorter works. Originally printed in publications as diverse as The Magazine of Fantasy and Science Fiction and The Atlantic Monthly, these superb stories share Vonnegut's audacious sense of humor and extraordinary range of creative vision.<\\\\/span>\\\\n <a data-text-id=\\\\\"12993061018294291471\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'11_book_4985\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"ZpLUJiKnX872xF4ZAuipvgYWhlng7jHEBm4Wb6zH8HaY1WzruQ+zr+fL2RzSC5byb6Cg4m/EAKWIJLZkI72OAA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"4985\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"11_book_4985\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"XsMPiY7is1UVbGUibS1i1oOwSJptyrm6GzVu1QbhO5SghLdEFUpfNARj4ie9zl2a6gZuIeLgiNuVf87eiZtF4g==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"11_book_4985\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"4985\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"4985\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/4985?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=11_book_4985\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_4985\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_4985\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_4985\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_4985\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_5206937\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/5206937-a-modest-proposal?from_choice=false&amp;from_home_module=false\\\\\">A Modest Proposal<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/1831.Jonathan_Swift?a=7&amp;origin=related_works\\\\\">Jonathan Swift<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.05 avg rating &mdash; 36,918 ratings<\\\\/span> &mdash; published 1729\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer1778286966605983122\\\\\">A Modest Proposal for Preventing the Children of Poor People in Ireland From Being a Burden to Their Parents or Country, and for Making Them Beneficial to the Public, commonly referred to as A Modest Proposal, is a Juvenalian satirical essay written<\\\\/span>\\\\n <span id=\\\\\"freeText1778286966605983122\\\\\" style=\\\\\"display:none\\\\\">A Modest Proposal for Preventing the Children of Poor People in Ireland From Being a Burden to Their Parents or Country, and for Making Them Beneficial to the Public, commonly referred to as A Modest Proposal, is a Juvenalian satirical essay written and published anonymously by Jonathan Swift in 1729. Swift suggests in his essay that the impoverished Irish might ease their economic troubles by selling children as food for rich gentlemen and ladies. By doing this he mocks the authority of the British officials. A Modest Proposal is included in many literature programs as an example of early modern western satire. It also serves as an exceptional introduction to the concept and use of argumentative language, lending itself well to secondary and post-secondary essay courses. Outside of the realm of English studies, A Modest Proposal is a relevant piece included in many comparative and global literature and history courses, as well as those of numerous other disciplines in the arts, humanities, and even the social sciences.<\\\\/span>\\\\n <a data-text-id=\\\\\"1778286966605983122\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'12_book_5206937\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"1qIZpGscWEfuhGi17MGGYvlqYcZfS5tNJhI0o0OrJ+Mo5aFp8LS0Jv+L77A8IrkukNxHfdBhqiyoWJSozNFZlQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"5206937\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"12_book_5206937\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"wzonrjLj9LoVCDkARIE9mDYVm5MOZiFOGrBCaLq0g9k9fZ9jqUsY2wQHvgWUYgLUX6O9KIFMEC+U+uJjNc79rw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"12_book_5206937\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"5206937\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"5206937\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/5206937?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=12_book_5206937\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_5206937\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_5206937\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_5206937\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_5206937\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_30933\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/30933.Brideshead_Revisited?from_choice=false&amp;from_home_module=false\\\\\">Brideshead Revisited: The Sacred and Profane Memories of Captain Charles Ryder<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/11315.Evelyn_Waugh?a=7&amp;origin=related_works\\\\\">Evelyn Waugh<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\" title=\\\\\"really liked it\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\">really liked it<\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 4.00 avg rating &mdash; 83,467 ratings<\\\\/span> &mdash; published 1945\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer17465616236479771617\\\\\">The most nostalgic and reflective of Evelyn Waugh\\\\\\'s novels, Brideshead Revisited looks back to the golden age before the Second World War. It tells the story of Charles Ryder\\\\\\'s infatuation with the Marchmains and the rapidly-disappearing world of pri<\\\\/span>\\\\n <span id=\\\\\"freeText17465616236479771617\\\\\" style=\\\\\"display:none\\\\\">The most nostalgic and reflective of Evelyn Waugh\\\\\\'s novels, Brideshead Revisited looks back to the golden age before the Second World War. It tells the story of Charles Ryder\\\\\\'s infatuation with the Marchmains and the rapidly-disappearing world of privilege they inhabit. Enchanted first by Sebastian at Oxford, then by his doomed Catholic family, in particular his remote sister, Julia, Charles comes finally to recognize only his spiritual and social distance from them.<\\\\/span>\\\\n <a data-text-id=\\\\\"17465616236479771617\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'13_book_30933\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"RWtf7egfDxjwngeeFDTEalvEd1kBFf/WEOKeU7TzXGO7LOcgc7fjeeGRgJvE1/smMnJR4o4/zreeqD5YO4kiFQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"30933\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"13_book_30933\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"J9zlaRdEj0qgbiOhPgdgzJoGIn36XpQdYCcJ1GoHDWLZm12kjOxjK7FhpKTu5F+A87AExnV0pXzubanf5X1zFA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"13_book_30933\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"30933\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"30933\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/30933?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=13_book_30933\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_30933\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_30933\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_30933\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_30933\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_929783\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/929783.The_Iron_Heel?from_choice=false&amp;from_home_module=false\\\\\">The Iron Heel<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/1240.Jack_London?a=7&amp;origin=related_works\\\\\">Jack London<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.74 avg rating &mdash; 6,609 ratings<\\\\/span> &mdash; published 1908\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer17413923612331216854\\\\\">A dystopian novel about the terrible oppressions of an American oligarchy at the beginning of the Twentieth Century, and the struggles of a socialist revolutionary movement.<\\\\/span>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'14_book_929783\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"c/l/Ezbb3rHZnVaRHRze3BMoM5JYdeCkOorlFEyVVUiNvsferXMy0MiS0ZTN/+GQep4VKddf0cW0wEUfw+8rPg==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"929783\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"14_book_929783\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"TqpCaK4XivQx42vdf2GQWUL89/Yme35qJ4+Z3TDZVLqw7fqlNb9mlSDs7Nivgq8VK0rRTalRTwupxTnWv6MqzA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"14_book_929783\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"929783\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"929783\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/929783?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=14_book_929783\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_929783\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_929783\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_929783\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_929783\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_5129\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/5129.Brave_New_World?from_choice=false&amp;from_home_module=false\\\\\">Brave New World<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/3487.Aldous_Huxley?a=7&amp;origin=related_works\\\\\">Aldous Huxley<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.98 avg rating &mdash; 1,202,140 ratings<\\\\/span> &mdash; published 1932\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer9055299350856554090\\\\\">Brave New World is a dystopian novel written in 1931 by English author Aldous Huxley, and published in 1932. Largely set in a futuristic World State of genetically modified citizens and an intelligence-based social hierarchy, the novel anticipates hu<\\\\/span>\\\\n <span id=\\\\\"freeText9055299350856554090\\\\\" style=\\\\\"display:none\\\\\">Brave New World is a dystopian novel written in 1931 by English author Aldous Huxley, and published in 1932. Largely set in a futuristic World State of genetically modified citizens and an intelligence-based social hierarchy, the novel anticipates huge scientific developments in reproductive technology, sleep-learning, psychological manipulation, and classical conditioning that are combined to make a utopian society that goes challenged only by a single outsider.<\\\\/span>\\\\n <a data-text-id=\\\\\"9055299350856554090\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'15_book_5129\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"+xsg4085dRHmNPzESz8PWwYE7j6EsXeWfBegsW7g12kFXJgu1JGZcPc7e8Gb3DAXb7LIhQubRvfyXQC64ZqpHw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"5129\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"15_book_5129\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"gdN4jTd5qn9gk1YyPXsvJ9INnFfRrXlPcFDNjxvfvpp/lMBArNFGHnGc0TftmBBru7u67F6HSC7+Gm2ElKXA7A==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"15_book_5129\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"5129\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"5129\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/5129?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=15_book_5129\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_5129\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_5129\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_5129\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_5129\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_108171\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/108171.Coriolanus?from_choice=false&amp;from_home_module=false\\\\\">Coriolanus<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/947.William_Shakespeare?a=7&amp;origin=related_works\\\\\">William Shakespeare<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.71 avg rating &mdash; 10,793 ratings<\\\\/span> &mdash; published 1605\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer17832232775853433915\\\\\">Shakespeare\\\\\\'s last tragedy explores the career and death of a brilliant and arrogant Roman general. This is an ambitious and intriguing story of heroism.<\\\\/span>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'16_book_108171\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"UY5OvVwCv5/CEIv41E5TNzLlENHkSZPQgnJWErfAdLqvyfZwx6pT/tMfDP0ErWx7W1M2amtjorEMOPYZOLoKzA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"108171\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"16_book_108171\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"RabmNCuKZpmQhYyynGTWTm92GiVDOV/ZfDFipEXLFBe74V75sCKK+IGKC7dMh+kCBsA8nswTbrjye8KvyrFqYQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"16_book_108171\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"108171\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"108171\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/108171?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=16_book_108171\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_108171\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_108171\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_108171\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_108171\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_46114\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/46114.The_Waves?from_choice=false&amp;from_home_module=false\\\\\">The Waves<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/6765.Virginia_Woolf?a=7&amp;origin=related_works\\\\\">Virginia Woolf<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.14 avg rating &mdash; 22,098 ratings<\\\\/span> &mdash; published 1931\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer2264934213931566382\\\\\">Set on the coast of England against the vivid background of the sea, The Waves introduces six characters—three men and three women—who are grappling with the death of a beloved friend, Percival. Instead of describing their outward expressions of grie<\\\\/span>\\\\n <span id=\\\\\"freeText2264934213931566382\\\\\" style=\\\\\"display:none\\\\\">Set on the coast of England against the vivid background of the sea, The Waves introduces six characters—three men and three women—who are grappling with the death of a beloved friend, Percival. Instead of describing their outward expressions of grief, Virgina Woolf draws her characters from the inside, revealing them through their thoughts and interior soliloquies. As their understanding of nature's trials grows, the chorus of narrative voices blends together in miraculous harmony, remarking not only on the inevitable death of individuals but on the eternal connection of everyone. The novel that most epitomizes Virginia Woolf's theories of fiction in the working form, The Waves is an amazing book very much ahead of its time. It is a poetic dreamscape, visual, experimental, and thrilling.<\\\\/span>\\\\n <a data-text-id=\\\\\"2264934213931566382\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'17_book_46114\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"DCDyXjJwlunPX6qRDbLibNQW+Lb/2HJwyruBTg74jw3yZ0qTqdh6iN5QLZTdUd0gvaDeDXDyQxFE8SFFgYLxew==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"46114\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"17_book_46114\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"K5CBgUuzOsROfl9Bulc9KjekmtSUC14DGxe9WytefvrV1zlM0BvWpV9x2ERqtAJmXhK8bxshb2KVXR1QpCQAjA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"17_book_46114\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"46114\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"46114\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/46114?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=17_book_46114\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_46114\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_46114\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_46114\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_46114\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_45195\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/45195.A_Passage_to_India?from_choice=false&amp;from_home_module=false\\\\\">A Passage to India<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/86404.E_M_Forster?a=7&amp;origin=related_works\\\\\">E.M. Forster<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.68 avg rating &mdash; 59,199 ratings<\\\\/span> &mdash; published 1924\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer7147015393935946664\\\\\">When Adela Quested and her elderly companion Mrs Moore arrive in the Indian town of Chandrapore, they quickly feel trapped by its insular and prejudiced \\\\\\'Anglo-Indian\\\\\\' community. Determined to escape the parochial English enclave and explore the \\\\\\'rea<\\\\/span>\\\\n <span id=\\\\\"freeText7147015393935946664\\\\\" style=\\\\\"display:none\\\\\">When Adela Quested and her elderly companion Mrs Moore arrive in the Indian town of Chandrapore, they quickly feel trapped by its insular and prejudiced \\\\\\'Anglo-Indian\\\\\\' community. Determined to escape the parochial English enclave and explore the \\\\\\'real India\\\\\\', they seek the guidance of the charming and mercurial Dr Aziz, a cultivated Indian Muslim. But a mysterious incident occurs while they are exploring the Marabar caves with Aziz, and the well-respected doctor soon finds himself at the centre of a scandal that rouses violent passions among both the British and their Indian subjects. A masterly portrait of a society in the grip of imperialism, A Passage to India compellingly depicts the fate of individuals caught between the great political and cultural conflicts of the modern world. \\\\n\\\\nIn his introduction, Pankaj Mishra outlines Forster\\\\\\'s complex engagement with Indian society and culture. This edition reproduces the Abinger text and notes, and also includes four of Forster\\\\\\'s essays on India, a chronology and further reading.<\\\\/span>\\\\n <a data-text-id=\\\\\"7147015393935946664\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'18_book_45195\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"1GTlGxP2YPnPUY3zgM5GHXsJwy0G+BJC+DWYgu1CKs8qI13WiF6MmN5eCvZQLXlREr/llonSIyN2fziJYjhUuQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"45195\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"18_book_45195\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"Dhq8CGznC70GpV8yDfPCNT4gI2KUj7WgFe2B97B8QmzwXQTF90/n3Beq2DfdEP15V5YF2RulhMGbpyH8PwY8Gg==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"18_book_45195\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"45195\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"45195\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/45195?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=18_book_45195\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_45195\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_45195\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_45195\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_45195\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_480204\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/480204.The_Phantom_of_the_Opera?from_choice=false&amp;from_home_module=false\\\\\">The Phantom of the Opera<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/9057.Gaston_Leroux?a=7&amp;origin=related_works\\\\\">Gaston Leroux<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.97 avg rating &mdash; 174,960 ratings<\\\\/span> &mdash; published 1910\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer5401084729573069540\\\\\">First published in French as a serial in 1909, The Phantom of the Opera is a riveting story that revolves around the young, Swedish Christine Daaé. Her father, a famous musician, dies, and she is raised in the Paris Opera House with his dying promise<\\\\/span>\\\\n <span id=\\\\\"freeText5401084729573069540\\\\\" style=\\\\\"display:none\\\\\">First published in French as a serial in 1909, The Phantom of the Opera is a riveting story that revolves around the young, Swedish Christine Daaé. Her father, a famous musician, dies, and she is raised in the Paris Opera House with his dying promise of a protective angel of music to guide her. After a time at the opera house, she begins hearing a voice, who eventually teaches her how to sing beautifully. All goes well until Christine\\\\\\'s childhood friend Raoul comes to visit his parents, who are patrons of the opera, and he sees Christine when she begins successfully singing on the stage. The voice, who is the deformed, murderous \\\\\\'ghost\\\\\\' of the opera house named Erik, however, grows violent in his terrible jealousy, until Christine suddenly disappears. The phantom is in love, but it can only spell disaster.Leroux\\\\\\'s work, with characters ranging from the spoiled prima donna Carlotta to the mysterious Persian from Erik\\\\\\'s past, has been immortalized by memorable adaptations. Despite this, it remains a remarkable piece of Gothic horror literature in and of itself, deeper and darker than any version that follows.<\\\\/span>\\\\n <a data-text-id=\\\\\"5401084729573069540\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'19_book_480204\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"sTu+gxi28AobmomhVmUke53OQ0I4b6KfEz+QXRr56KVPfAZOgx4cawqVDqSGhhs39Hhl+bdFk/6ddTBWlYOW0w==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"480204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"19_book_480204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"tROjZt2JeSRz96p8Ai/oRuu51ofqcZa7bVUI5o8a57ZLVBurRiGVRWL4LXnSzNcKgg/wPGVbp9rjH6jtAGCZwA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"19_book_480204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"480204\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"480204\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/480204?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=19_book_480204\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_480204\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_480204\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_480204\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_480204\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_18630\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/18630.The_Player_of_Games?from_choice=false&amp;from_home_module=false\\\\\">The Player of Games (Culture, #2)<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/5807106.Iain_M_Banks?a=7&amp;origin=related_works\\\\\">Iain M. Banks<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.26 avg rating &mdash; 49,659 ratings<\\\\/span> &mdash; published 1988\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer14264589322956283983\\\\\">The Culture--a humanoid/machine symbiotic society--has thrown up many great Game Players. One of the best is Jernau Morat Gurgeh, Player of Games, master of every board, computer and strategy. Bored with success, Gurgeh travels to the Empire of Azad,<\\\\/span>\\\\n <span id=\\\\\"freeText14264589322956283983\\\\\" style=\\\\\"display:none\\\\\">The Culture--a humanoid/machine symbiotic society--has thrown up many great Game Players. One of the best is Jernau Morat Gurgeh, Player of Games, master of every board, computer and strategy. Bored with success, Gurgeh travels to the Empire of Azad, cruel &amp; incredibly wealthy, to try their fabulous game, a game so complex, so like life itself, that the winner becomes emperor. Mocked, blackmailed, almost murdered, Gurgeh accepts the game and with it the challenge of his life, and very possibly his death.<\\\\/span>\\\\n <a data-text-id=\\\\\"14264589322956283983\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'20_book_18630\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"acOnL0JrYT5a9Jj7druM6Dj58ISoxUMmbiDPUScDRvKXhB/i2cONX0v7H/6mWLOkUU/WPyfvckfgam9aqHk4hA==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"18630\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"20_book_18630\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"/iq+c7gM2YhLoJuFjt8Fcc8M0g/B0NswcvjP4iz8vfcAbQa+I6Q16VqvHIBePDo9prr0tE766lH8sm/po4bDgQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"20_book_18630\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"18630\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"18630\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/18630?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=20_book_18630\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_18630\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_18630\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_18630\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_18630\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_392566\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/392566.The_Space_Merchants?from_choice=false&amp;from_home_module=false\\\\\">The Space Merchants (The Space Merchants, #1)<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/22996.Frederik_Pohl?a=7&amp;origin=related_works\\\\\">Frederik Pohl<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.87 avg rating &mdash; 8,250 ratings<\\\\/span> &mdash; published 1952\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer10306622275791363427\\\\\">An alternate cover edition can be found here. It is the 22nd Century, an advertisement-drenched world in which the big ad agencies dominate governments and everything else. Now Schoken Associates, one of the big players, has a new challenge for star<\\\\/span>\\\\n <span id=\\\\\"freeText10306622275791363427\\\\\" style=\\\\\"display:none\\\\\">An alternate cover edition can be found here.\\\\n\\\\nIt is the 22nd Century, an advertisement-drenched world in which the big ad agencies dominate governments and everything else. Now Schoken Associates, one of the big players, has a new challenge for star copywriter Mitch Courtenay. Volunteers are needed to colonise Venus. It\\\\\\'s a hellhole, and nobody who knew anything about it would dream of signing up. But by the time Mitch has finished, they will be queuing to get on board the spaceships.\\\\n\\\\nBiographical Notes\\\\n\\\\nPohl and Kornbluth started writing together as early as 1940, although both authors produced a wide variety of stories separately, under their own names and pseudonyms.\\\\n\\\\nEach wrote sections, starting where the other left off, and through long experience they developed an almost telepathic awareness of each other\\\\\\'s intentions.<\\\\/span>\\\\n <a data-text-id=\\\\\"10306622275791363427\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'21_book_392566\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"njQYwU+OQElUpetPcwQzUydalM+VtRGsWomQko97r5pgc6AM1CasKEWqbEqj5wwfTuyydBqfIM3UwzCZAAHR7A==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"392566\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"21_book_392566\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"7xfxogDoup07EpI6x9TxZlNyDTTwbazFoMrN0ggqX40RUElvm0BW/CodFT8XN84qOsQrj39HnaQugG3Zh1Ah+w==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"21_book_392566\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"392566\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"392566\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/392566?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=21_book_392566\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_392566\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_392566\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_392566\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_392566\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_22417\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/22417.Transmetropolitan_Vol_2?from_choice=false&amp;from_home_module=false\\\\\">Transmetropolitan, Vol. 2: Lust for Life (Transmetropolitan, #2)<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/12772.Warren_Ellis?a=7&amp;origin=related_works\\\\\">Warren Ellis<\\\\/a><span title=\\\\\"Goodreads Author!\\\\\">*<\\\\/span>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.34 avg rating &mdash; 16,087 ratings<\\\\/span> &mdash; published 1999\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer13260940439900757111\\\\\">Outlaw journalist Spider Jerusalem has become a household name in the future City he calls home. This latest collection of twisted tales showcases Spider\\\\\\'s horrific yet funny screeds on subjects as diverse as religion, politics, and his ex-wife\\\\\\'s cry<\\\\/span>\\\\n <span id=\\\\\"freeText13260940439900757111\\\\\" style=\\\\\"display:none\\\\\">Outlaw journalist Spider Jerusalem has become a household name in the future City he calls home. This latest collection of twisted tales showcases Spider\\\\\\'s horrific yet funny screeds on subjects as diverse as religion, politics, and his ex-wife\\\\\\'s cryogenically frozen head (which has been stolen). &quot;Transmetropolitan&quot; has been called &quot;brilliant future-shock commentary&quot; (Spin), and this new volume shows why.<\\\\/span>\\\\n <a data-text-id=\\\\\"13260940439900757111\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'22_book_22417\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"tV9qa9i8z/+bJ8RLCPOQo8awh0753cEB7quRAVA6a5lLGNKmQxQjnoooQ07YEK/vrwah9Xb38GBg4TEK30AV7w==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"22417\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"22_book_22417\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"bmP2tkT4IM3VDtzivTi5Te0sAmkdGaxzpvItrkkvNpqQJE5731DMrMQBW+dt24YBhJok0pIznRIouI2lxlVI7A==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"22_book_22417\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"22417\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"22417\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/22417?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=22_book_22417\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_22417\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_22417\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_22417\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_22417\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_117833\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/117833.The_Master_and_Margarita?from_choice=false&amp;from_home_module=false\\\\\">The Master and Margarita<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/3873.Mikhail_Bulgakov?a=7&amp;origin=related_works\\\\\">Mikhail Bulgakov<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p3\\\\\"><\\\\/span><\\\\/span> 4.31 avg rating &mdash; 186,610 ratings<\\\\/span> &mdash; published 1967\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer994893403678381607\\\\\">THE FIRST COMPLETE, ANNOTATED ENGLISH TRANSLATION OF MIKHAIL BULGAKOV\\\\\\'S COMIC MASTERPIECE An audacious revision of the stories of Faust and Pontius Pilate, The Master and Margarita is recognized as one of the essential classics of modern Russian lite<\\\\/span>\\\\n <span id=\\\\\"freeText994893403678381607\\\\\" style=\\\\\"display:none\\\\\">THE FIRST COMPLETE, ANNOTATED ENGLISH TRANSLATION OF MIKHAIL BULGAKOV\\\\\\'S COMIC MASTERPIECE\\\\n\\\\nAn audacious revision of the stories of Faust and Pontius Pilate, The Master and Margarita is recognized as one of the essential classics of modern Russian literature. the novel\\\\\\'s vision of Soviet life in the 1930s is so ferociously accurate that it could not be published during its author\\\\\\'s lifetime and appeared only in a censored edition in the 1960s. Its truths are so enduring that its language has become part of the common Russian speech.\\\\n\\\\nOne hot spring, the devil arrives in Moscow, accompanied by a retinue that includes a beautiful naked witch and an immens talking black cat with a fondness for chess and vodka. The visitors quickly wreak havoc in a city that refuses to believe in either God or Satan. But they also bring peace to two unhappy Muscovites: one is the Master, a writer pilloried for daring to write a novel about Christ and Pontius Pilate; the other is Margarita, who loves the Master so deeply that she is willing literally to go to hell for him. What ensues is a novel of in exhaustible energy, humor, and philosophical depth, a work whose nuances emerge for the first time in Diana Burgin\\\\\\'s and Katherine Tiernan O\\\\\\'Connor\\\\\\'s splendid English version.\\\\n(back cover)<\\\\/span>\\\\n <a data-text-id=\\\\\"994893403678381607\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'23_book_117833\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"drSLLQy5LymT1V6mmwT/0EyDdBTZcVMLmCYYFOlF/ZCI8zPglxHDSILa2aNL58CcJTVSr1ZbYmoWbLgfZj+D5g==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"117833\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"23_book_117833\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"knI6yQONIUWP36fkt7K0e5dVVgm4X+S5sIcOf8yK3jVsNYIEmCXNJJ7QIOFnUYs3/uNwsjd11dg+za50Q/CgQw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"23_book_117833\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"117833\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"117833\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/117833?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=23_book_117833\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_117833\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_117833\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_117833\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_117833\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_19486\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/19486.In_the_Country_of_Last_Things?from_choice=false&amp;from_home_module=false\\\\\">In the Country of Last Things<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/296961.Paul_Auster?a=7&amp;origin=related_works\\\\\">Paul Auster<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.91 avg rating &mdash; 9,103 ratings<\\\\/span> &mdash; published 1987\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer15068554855542972405\\\\\">A dystopian epistolary novel. In the Country of Last Things takes the form of a letter from a young woman named Anna Blume to a childhood friend. Anna has ventured into an unnamed city that has collapsed into chaos and disorder. In this bleak environ<\\\\/span>\\\\n <span id=\\\\\"freeText15068554855542972405\\\\\" style=\\\\\"display:none\\\\\">A dystopian epistolary novel. In the Country of Last Things takes the form of a letter from a young woman named Anna Blume to a childhood friend. Anna has ventured into an unnamed city that has collapsed into chaos and disorder. In this bleak environment, no industry takes place and most of the population collects garbage or scavenges for objects to resell. City governments are unstable and are concerned only with collecting human waste and corpses for fuel. Anna has entered the city to search for her brother William, a journalist, and it is suggested that the Blumes come from a world to the East which has not collapsed.<\\\\/span>\\\\n <a data-text-id=\\\\\"15068554855542972405\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'24_book_19486\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"93az6vfqB2y1NoSBd2RMF/u5aUSOTFhQvFrA9atX5gkJMQsnbELrDaQ5A4Snh3Nbkg9P/wFmaTEyEGD+JC2Yfw==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"19486\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"24_book_19486\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"/Y0q1YKbMh3sGY4kExXqZnoFrw0O9c53RDUVsjC+M88DypIYGTPefP0WCSHD9tUqE7OJtoHf/xbKf7W5v8RNuQ==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"24_book_19486\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"19486\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"19486\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/19486?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=24_book_19486\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_19486\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_19486\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_19486\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_19486\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n var newTip = new Tip($(\\'bookCover_35743\\'), \"\\\\n\\\\n <h2><a class=\\\\\"readable bookTitle\\\\\" href=\\\\\"https://www.goodreads.com/book/show/35743.The_Tin_Drum?from_choice=false&amp;from_home_module=false\\\\\">The Tin Drum<\\\\/a><\\\\/h2>\\\\n\\\\n <div>\\\\n by <a class=\\\\\"authorName\\\\\" href=\\\\\"/author/show/749461.G_nter_Grass?a=7&amp;origin=related_works\\\\\">Günter Grass<\\\\/a>\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"smallText uitext darkGreyText\\\\\">\\\\n <span class=\\\\\"minirating\\\\\"><span class=\\\\\"stars staticStars\\\\\"><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p10\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p6\\\\\"><\\\\/span><span size=\\\\\"12x12\\\\\" class=\\\\\"staticStar p0\\\\\"><\\\\/span><\\\\/span> 3.96 avg rating &mdash; 34,387 ratings<\\\\/span> &mdash; published 1959\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\"addBookTipDescription\\\\\">\\\\n \\\\n<span id=\\\\\"freeTextContainer10783832300382338365\\\\\">On his third birthday Oskar decides to stop growing. Haunted by the deaths of his parents and wielding his tin drum Oskar recounts the events of his extraordinary life; from the long nightmare of the Nazi era to his anarchic adventures in post-war Ge<\\\\/span>\\\\n <span id=\\\\\"freeText10783832300382338365\\\\\" style=\\\\\"display:none\\\\\">On his third birthday Oskar decides to stop growing. Haunted by the deaths of his parents and wielding his tin drum Oskar recounts the events of his extraordinary life; from the long nightmare of the Nazi era to his anarchic adventures in post-war Germany.<\\\\/span>\\\\n <a data-text-id=\\\\\"10783832300382338365\\\\\" href=\\\\\"#\\\\\" onclick=\\\\\"swapContent($(this));; return false;\\\\\">...more<\\\\/a>\\\\n\\\\n <\\\\/div>\\\\n\\\\n <div class=\\\\\\'wtrButtonContainer wtrSignedOut\\\\\\' id=\\\\\\'25_book_35743\\\\\\'>\\\\n<div class=\\\\\\'wtrUp wtrLeft\\\\\\'>\\\\n<form action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"S+dbftXRz8Ei/9Z9yUpD/ryHqcac/BXrspxowBXr+xi1oOOzTnkjoDPwUXgZqXyy1TGPfRPWJIo81sjLmpGFbg==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"35743\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" value=\\\\\"to-read\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"25_book_35743\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"wtr_new\\\\\" id=\\\\\"wtr_new\\\\\" value=\\\\\"true\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"ref\\\\\" id=\\\\\"ref\\\\\" value=\\\\\"\\\\\" class=\\\\\"wtrLeftUpRef\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"existing_review\\\\\" id=\\\\\"existing_review\\\\\" value=\\\\\"false\\\\\" class=\\\\\"wtrExisting\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<button class=\\\\\\'wtrToRead\\\\\\' type=\\\\\\'submit\\\\\\'>\\\\n<span class=\\\\\\'progressTrigger\\\\\\'>Want to Read<\\\\/span>\\\\n<span class=\\\\\\'progressIndicator\\\\\\'>saving…<\\\\/span>\\\\n<\\\\/button>\\\\n<\\\\/form>\\\\n\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'wtrRight wtrUp\\\\\\'>\\\\n<form class=\\\\\"hiddenShelfForm\\\\\" action=\\\\\"/shelf/add_to_shelf\\\\\" accept-charset=\\\\\"UTF-8\\\\\" method=\\\\\"post\\\\\"><input name=\\\\\"utf8\\\\\" type=\\\\\"hidden\\\\\" value=\\\\\"&#x2713;\\\\\" /><input type=\\\\\"hidden\\\\\" name=\\\\\"authenticity_token\\\\\" value=\\\\\"BkNpZ/SDeUAy8nlpaXIh6/PFyvSIQnTPcfVsh6ndBIX4BNGqbyuVISP9/my5kR6nmnPsTwdoRa7/v8yMJqd68w==\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"unique_id\\\\\" id=\\\\\"unique_id\\\\\" value=\\\\\"25_book_35743\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_id\\\\\" id=\\\\\"book_id\\\\\" value=\\\\\"35743\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"a\\\\\" id=\\\\\"a\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"name\\\\\" id=\\\\\"name\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_choice\\\\\" id=\\\\\"from_choice\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"from_home_module\\\\\" id=\\\\\"from_home_module\\\\\" value=\\\\\"false\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"book_origin\\\\\" id=\\\\\"book_origin\\\\\" value=\\\\\"related_works\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_referrer\\\\\" id=\\\\\"page_referrer\\\\\" value=\\\\\"https://www.goodreads.com/\\\\\" />\\\\n<input type=\\\\\"hidden\\\\\" name=\\\\\"page_url\\\\\" id=\\\\\"page_url\\\\\" value=\\\\\"/book/show/5470.1984\\\\\" />\\\\n<\\\\/form>\\\\n\\\\n<button class=\\\\\\'wtrShelfButton\\\\\\'><\\\\/button>\\\\n<\\\\/div>\\\\n\\\\n<div class=\\\\\\'ratingStars wtrRating\\\\\\'>\\\\n<div class=\\\\\\'starsErrorTooltip hidden\\\\\\'>\\\\nError rating book. Refresh and try again.\\\\n<\\\\/div>\\\\n<div class=\\\\\\'myRating uitext greyText\\\\\\'>Rate this book<\\\\/div>\\\\n<div class=\\\\\\'clearRating uitext\\\\\\'>Clear rating<\\\\/div>\\\\n<div class=\\\\\"stars\\\\\" data-resource-id=\\\\\"35743\\\\\" data-user-id=\\\\\"0\\\\\" data-submit-url=\\\\\"/review/rate/35743?book_origin=related_works&page_referrer=https%3A%2F%2Fwww.goodreads.com%2F&page_url=%2Fbook%2Fshow%2F5470.1984&rate_books_page=false&stars_click=false&wtr_button_id=25_book_35743\\\\\" data-rating=\\\\\"0\\\\\"><a class=\\\\\"star off\\\\\" title=\\\\\"did not like it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">1 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was ok\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">2 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">3 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"really liked it\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">4 of 5 stars<\\\\/a><a class=\\\\\"star off\\\\\" title=\\\\\"it was amazing\\\\\" href=\\\\\"#\\\\\" ref=\\\\\"\\\\\">5 of 5 stars<\\\\/a><\\\\/div>\\\\n<\\\\/div>\\\\n\\\\n<\\\\/div>\\\\n\\\\n\\\\n\\\\n\\\\n\", { style: \\'addbook\\', stem: \\'topRight\\', hook: { tip: \\'topRight\\', target: \\'bottomMiddle\\' }, hideOn: false, width: 400, hideAfter: 0.05, delay: 0.35 });\\n $(\\'bookCover_35743\\').observe(\\'prototip:shown\\', function() {\\n if (this.up(\\'#box\\')) {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: $(\\'box\\').getStyle(\\'z-index\\')})});\\n } else {\\n $$(\\'div.prototip\\').each(function(i){i.setStyle({zIndex: 6000})});\\n }\\n });\\n\\n newTip[\\'wrapper\\'].addClassName(\\'prototipAllowOverflow\\');\\n\\n $(\\'bookCover_35743\\').observe(\\'prototip:shown\\', function () {\\n $$(\\'div.prototip\\').each(function (e) {\\n if ($(\\'bookCover_35743\\').hasClassName(\\'ignored\\')) {\\n e.setStyle({\\'display\\': \\'none\\'});\\n return;\\n }\\n e.setStyle({\\'overflow\\': \\'visible\\'});\\n });\\n });\\n $(\\'bookCover_35743\\').observe(\\'prototip:hidden\\', function () {\\n $$(\\'span.elementTwo\\').each(function (e) {\\n if (e.getStyle(\\'display\\') !== \\'none\\') {\\n var lessLink = e.next();\\n swapContent(lessLink);\\n }\\n });\\n });\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Videos About This Book\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n 5 comments\\n \\n \\n \\n \\n \\n \\n \\n \\n More videos...\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Genres\\n \\n \\n \\n \\n \\n \\n \\n \\n Classics\\n \\n \\n \\n \\n 27,534 users\\n \\n \\n \\n \\n \\n \\n \\n \\n Fiction\\n \\n \\n \\n \\n 17,246 users\\n \\n \\n \\n \\n \\n \\n \\n \\n Science Fiction\\n \\n \\n \\n \\n 8,812 users\\n \\n \\n \\n \\n \\n \\n \\n \\n Science Fiction\\n \\n >\\n \\n Dystopia\\n \\n \\n \\n \\n 7,216 users\\n \\n \\n \\n \\n \\n \\n See top shelves…\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n About George Orwell\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n George Orwell\\n \\n \\n \\n 26,745\\nfollowers\\n \\n \\n \\n \\n \\n \\n Eric Arthur Blair\\n \\n , better known by his pen name\\n \\n George Orwell\\n \\n , was an English author and journalist. His work is marked by keen intelligence and wit, a profound awareness of social injustice, an intense opposition to totalitarianism, a passion for clarity in language, and a belief in democratic socialism.\\n \\n \\n In addition to his literary career Orwell served as a police officer with the Indian Imperial\\n \\n \\n \\n \\n \\n Eric Arthur Blair\\n \\n , better known by his pen name\\n \\n George Orwell\\n \\n , was an English author and journalist. His work is marked by keen intelligence and wit, a profound awareness of social injustice, an intense opposition to totalitarianism, a passion for clarity in language, and a belief in democratic socialism.\\n \\n \\n In addition to his literary career Orwell served as a police officer with the Indian Imperial Police in Burma from 1922-1927 and fought with the Republicans in the Spanish Civil War from 1936-1937. Orwell was severely wounded when he was shot through his throat. Later the organization that he had joined when he joined the Republican cause, The Workers Party of Marxist Unification (POUM), was painted by the pro-Soviet Communists as a Trotskyist organization (Trotsky was Joseph Stalin\\'s enemy) and disbanded. Orwell and his wife were accused of \"rabid Trotskyism\" and tried in absentia in Barcelona, along with other leaders of the POUM, in 1938. However by then they had escaped from Spain and returned to England.\\n \\n \\n Between 1941 and 1943, Orwell worked on propaganda for the BBC. In 1943, he became literary editor of the Tribune, a weekly left-wing magazine. He was a prolific polemical journalist, article writer, literary critic, reviewer, poet and writer of fiction, and, considered perhaps the twentieth century\\'s best chronicler of English culture.\\n \\n \\n Orwell is best known for the dystopian novel\\n \\n Nineteen Eighty-Four\\n \\n (published in 1949) and the satirical novella\\n \\n Animal Farm\\n \\n (1945) — they have together sold more copies than any two books by any other twentieth-century author. His 1938 book\\n \\n Homage to Catalonia\\n \\n , an account of his experiences as a volunteer on the Republican side during the Spanish Civil War, together with numerous essays on politics, literature, language, and culture, are widely acclaimed.\\n \\n \\n Orwell\\'s influence on contemporary culture, popular and political, continues decades after his death. Several of his neologisms, along with the term \"Orwellian\" — now a byword for any oppressive or manipulative social phenomenon opposed to a free society — have entered the vernacular.\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ...more\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Books by George Orwell\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n More…\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Trivia About 1984\\n \\n \\n \\n \\n \\n \\n 217 trivia questions\\n \\n 9 quizzes\\n \\n \\n \\n More quizzes & trivia...\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Quotes from 1984\\n \\n \\n \\n \\n \\n \\n \\n \"Perhaps one did not want to be loved so much as to be understood.\"\\n \\n \\n —\\n \\n 12451 likes\\n \\n \\n \\n \\n \\n \\n \\n \"Who controls the past controls the future. Who controls the present controls the past.\"\\n \\n \\n —\\n \\n 8038 likes\\n \\n \\n \\n \\n \\n \\n More quotes…\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n renderRatingGraph([1103055, 800381, 366488, 97723, 48905]);\\n if ($(\\'rating_details\\')) {\\n $(\\'rating_details\\').insert({top: $(\\'rating_graph\\')})\\n }\\n \\n \\n \\n //<![CDATA[\\n(function (w, d, load) {\\n var script,\\n first = d.getElementsByTagName(\\'SCRIPT\\')[0],\\n n = load.length,\\n i = 0,\\n go = function () {\\n for (i = 0; i < n; i += 1) {\\n script = d.createElement(\\'SCRIPT\\');\\n script.type = \\'text/javascript\\';\\n script.async = true;\\n script.src = load[i];\\n first.parentNode.insertBefore(script, first);\\n }\\n }\\n if (w.attachEvent) {\\n w.attachEvent(\\'onload\\', go);\\n } else {\\n w.addEventListener(\\'load\\', go, false);\\n }\\n}(window, document,\\n [\\'//assets.pinterest.com/js/pinit.js\\',\\n \\'//apis.google.com/js/plusone.js\\'\\n ]\\n ));\\n\\n//]]>\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n ©\\n2018\\nGoodreads Inc\\n \\n \\n \\n \\n \\n about us\\n \\n \\n \\n \\n advertise\\n \\n \\n \\n \\n author program\\n \\n \\n \\n \\n jobs\\n \\n \\n \\n \\n api\\n \\n \\n \\n \\n our blog\\n \\n \\n \\n \\n authors & advertisers blog\\n \\n \\n \\n \\n terms\\n \\n \\n \\n \\n privacy\\n \\n \\n \\n \\n help\\n \\n \\n \\n \\n switch to:\\n \\n \\n mobile version\\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n \\n Welcome back. Just a moment while we sign you in to your Goodreads account.\\n \\n \\n \\n \\n \\n \\n //<![CDATA[\\n $grfb.initialize({\\n appId: \"2415071772\",\\n grSession: false,\\n serverFBUser: null,\\n suppressAutoLogin: false\\n });\\n//]]>\\n \\n \\n //<![CDATA[\\n qcdata = {} || qcdata;\\n (function(){\\n var elem = document.createElement(\\'script\\');\\n elem.src = (document.location.protocol == \"https:\" ? \"https://secure\" : \"http://pixel\") + \".quantserve.com/aquant.js?a=p-0dUe_kJAjvkoY\";\\n elem.async = true;\\n elem.type = \"text/javascript\";\\n var scpt = document.getElementsByTagName(\\'script\\')[0];\\n scpt.parentNode.insertBefore(elem,scpt);\\n }());\\n var qcdata = {qacct: \\'p-0dUe_kJAjvkoY\\', uid: \\'\\'};\\n //]]>\\n \\n \\n \\n \\n \\n //<![CDATA[\\n var _comscore = _comscore || [];\\n _comscore.push({ c1: \"2\", c2: \"6035830\", c3: \"\", c4: \"\", c5: \"\", c6: \"\", c15: \"\"});\\n (function() {\\n var s = document.createElement(\"script\"), el = document.getElementsByTagName(\"script\")[0]; s.async = true;\\n s.src = (document.location.protocol == \"https:\" ? \"https://sb\" : \"http://b\") + \".scorecardresearch.com/beacon.js\";\\n el.parentNode.insertBefore(s, el);\\n })();\\n //]]>\\n \\n \\n \\n \\n \\n \\n\\n \\n' In [14]: d.select(\"meta[property='og:title']\")[0]['content'] Out[14]: '1984' Lets get everything we want... In [15]: d=BeautifulSoup(fstuff.text, 'html.parser') print( \"title\", d.select_one(\"meta[property='og:title']\")['content'],\"\\n\", \"isbn\", d.select(\"meta[property='books:isbn']\")[0]['content'],\"\\n\", \"type\", d.select(\"meta[property='og:type']\")[0]['content'],\"\\n\", \"author\", d.select(\"meta[property='books:author']\")[0]['content'],\"\\n\", \"average rating\", d.select_one(\"span.average\").text,\"\\n\", \"ratingCount\", d.select(\"meta[itemprop='ratingCount']\")[0][\"content\"],\"\\n\", \"reviewCount\", d.select_one(\"span.count\")[\"title\"] ) title 1984 isbn 9780451524935 type books.book author https://www.goodreads.com/author/show/3706.George_Orwell average rating 4.16 ratingCount 2402209 reviewCount 53335 Ok, now that we know what to do, lets wrap our fetching into a proper script. So that we dont overwhelm their servers, we will only fetch 5 from each page, but you get the idea... We'll segue of a bit to explore new style format strings. See https://pyformat.info for more info. In [16]: \"list{:0>2}.txt\".format(3) Out[16]: 'list03.txt' In [17]: a = \"4\" b = 4 class Four: def __str__(self): return \"Fourteen\" c=Four() In [18]: \"The hazy cat jumped over the {} and {} and {}\".format(a, b, c) Out[18]: 'The hazy cat jumped over the 4 and 4 and Fourteen' 4. Set up a pipeline for fetching and parsing Ok lets get back to the fetching... In [19]: fetched=[] for i in range(1,3): with open(\"files/list{:0>2}.txt\".format(i)) as fd: counter=0 for bookurl_line in fd: if counter > 4: break bookurl=bookurl_line.strip() stuff=requests.get(URLSTART+bookurl) filetowrite=bookurl.split('/')[-1] filetowrite=\"files/\"+str(i)+\"_\"+filetowrite+\".html\" print(\"FTW\", filetowrite) fd=open(filetowrite,\"w\", encoding='utf-8') fd.write(stuff.text) fd.close() fetched.append(filetowrite) time.sleep(2) counter=counter+1 print(fetched) FTW files/1_2767052-the-hunger-games.html FTW files/1_2.Harry_Potter_and_the_Order_of_the_Phoenix.html FTW files/1_2657.To_Kill_a_Mockingbird.html FTW files/1_1885.Pride_and_Prejudice.html FTW files/1_41865.Twilight.html FTW files/2_5470.1984.html FTW files/2_4989.The_Red_Tent.html FTW files/2_37435.The_Secret_Life_of_Bees.html FTW files/2_5.Harry_Potter_and_the_Prisoner_of_Azkaban.html FTW files/2_7171637-clockwork-angel.html ['files/1_2767052-the-hunger-games.html', 'files/1_2.Harry_Potter_and_the_Order_of_the_Phoenix.html', 'files/1_2657.To_Kill_a_Mockingbird.html', 'files/1_1885.Pride_and_Prejudice.html', 'files/1_41865.Twilight.html', 'files/2_5470.1984.html', 'files/2_4989.The_Red_Tent.html', 'files/2_37435.The_Secret_Life_of_Bees.html', 'files/2_5.Harry_Potter_and_the_Prisoner_of_Azkaban.html', 'files/2_7171637-clockwork-angel.html'] Ok we are off to parse each one of the html pages we fetched. We have provided the skeleton of the code and the code to parse the year, since it is a bit more complex...see the difference in the screenshots above. In [20]: import re yearre = r'\\d{4}' def get_year(d): if d.select_one(\"nobr.greyText\"): return d.select_one(\"nobr.greyText\").text.strip().split()[-1][:-1] else: thetext=d.select(\"div#details div.row\")[1].text.strip() rowmatch=re.findall(yearre, thetext) if len(rowmatch) > 0: rowtext=rowmatch[0].strip() else: rowtext=\"NA\" return rowtext ExerciseYour job is to fill in the code to get the genres. In [21]: def get_genres(d): # your code here genres=d.select(\"div.elementList div.left a\") glist=[] for g in genres: glist.append(g['href']) return glist In [22]: listofdicts=[] for filetoread in fetched: print(filetoread) td={} with open(filetoread) as fd: datext = fd.read() d=BeautifulSoup(datext, 'html.parser') td['title']=d.select_one(\"meta[property='og:title']\")['content'] td['isbn']=d.select_one(\"meta[property='books:isbn']\")['content'] td['booktype']=d.select_one(\"meta[property='og:type']\")['content'] td['author']=d.select_one(\"meta[property='books:author']\")['content'] td['rating']=d.select_one(\"span.average\").text td['ratingCount']=d.select_one(\"meta[itemprop='ratingCount']\")[\"content\"] td['reviewCount']=d.select_one(\"span.count\")[\"title\"] td['year'] = get_year(d) td['file']=filetoread glist = get_genres(d) td['genres']=\"|\".join(glist) listofdicts.append(td) files/1_2767052-the-hunger-games.html files/1_2.Harry_Potter_and_the_Order_of_the_Phoenix.html files/1_2657.To_Kill_a_Mockingbird.html files/1_1885.Pride_and_Prejudice.html files/1_41865.Twilight.html files/2_5470.1984.html files/2_4989.The_Red_Tent.html files/2_37435.The_Secret_Life_of_Bees.html files/2_5.Harry_Potter_and_the_Prisoner_of_Azkaban.html files/2_7171637-clockwork-angel.html In [23]: listofdicts[0] Out[23]: {'title': 'The Hunger Games (The Hunger Games, #1)', 'isbn': '9780439023481', 'booktype': 'books.book', 'author': 'https://www.goodreads.com/author/show/153394.Suzanne_Collins', 'rating': '4.33', 'ratingCount': '5491176', 'reviewCount': '160373', 'year': '2008', 'file': 'files/1_2767052-the-hunger-games.html', 'genres': '/genres/young-adult|/genres/fiction|/genres/science-fiction|/genres/dystopia|/genres/fantasy|/genres/science-fiction'} Finally lets write all this stuff into a csv file which we will use to do analysis. In [24]: df = pd.DataFrame.from_records(listofdicts) df.head() Out[24]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } author booktype file genres isbn rating ratingCount reviewCount title year 0 https://www.goodreads.com/author/show/153394.S... books.book files/1_2767052-the-hunger-games.html /genres/young-adult|/genres/fiction|/genres/sc... 9780439023481 4.33 5491176 160373 The Hunger Games (The Hunger Games, #1) 2008 1 https://www.goodreads.com/author/show/1077326.... books.book files/1_2.Harry_Potter_and_the_Order_of_the_Ph... /genres/fantasy|/genres/young-adult|/genres/fi... 9780439358071 4.48 2030257 33033 Harry Potter and the Order of the Phoenix (Har... 2003 2 https://www.goodreads.com/author/show/1825.Har... books.book files/1_2657.To_Kill_a_Mockingbird.html /genres/classics|/genres/fiction|/genres/histo... 9780061120084 4.27 3722962 79058 To Kill a Mockingbird (To Kill a Mockingbird, #1) 1960 3 https://www.goodreads.com/author/show/1265.Jan... books.book files/1_1885.Pride_and_Prejudice.html /genres/classics|/genres/fiction|/genres/romance 9780679783268 4.25 2438138 54013 Pride and Prejudice 1813 4 https://www.goodreads.com/author/show/941441.S... books.book files/1_41865.Twilight.html /genres/young-adult|/genres/fantasy|/genres/ro... 9780316015844 3.58 4262416 97797 Twilight (Twilight, #1) 2005 In [25]: df.to_csv(\"files/meta.csv\", index=False, header=True) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-2/scraping/solutions/"},{"title":"Lab 2: BeautifulSoup for Scraping - Student Version","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 2 Scraping Harvard University Summer 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructors: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh and Pavlos Protopaps In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING from IPython.core.display import HTML def css_styling (): styles = open ( \"../../styles/cs109.css\" , \"r\" ) . read () return HTML ( styles ) css_styling () In [2]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn.apionly as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) In [3]: import time , requests In this lab, we'll scrape Goodread's Best Books list: https://www.goodreads.com/list/show/1.Best_Books_Ever?page=1 . We'll walk through scraping the list pages for the book names/urls Table of Contents Learning Goals Exploring the Web pages and downloading them Parse the page, extract book urls Parse a book page, extract book properties Set up a pipeline for fetching and parsing Learning Goals Understand the structure of a web page. Use Beautiful soup to scrape content from these web pages. This lab corresponds to lectures 2, 3 and 4 and maps on to homework 1 and further. 1. Exploring the web pages and downloading them We're going to see the structure of Goodread's best books list. We'll use the Developer tools in chrome, safari and firefox have similar tools available To getch this page we use the requests module. But are we allowed to do this? Lets check: https://www.goodreads.com/robots.txt Yes we are. In [4]: URLSTART = \"https://www.goodreads.com\" BESTBOOKS = \"/list/show/1.Best_Books_Ever?page=\" url = URLSTART + BESTBOOKS + '1' print ( url ) page = requests . get ( url ) We can see properties of the page. Most relevant are status_code and text . The former tells us if the web-page was found, and if found , ok. (See lecture notes.) In [5]: page . status_code # 200 is good In [6]: page . text [: 5000 ] Let us write a loop to fetch 2 pages of \"best-books\" from goodreads. Notice the use of a format string. This is an example of old-style python format strings In [7]: URLSTART = \"https://www.goodreads.com\" BESTBOOKS = \"/list/show/1.Best_Books_Ever?page=\" for i in range ( 1 , 3 ): bookpage = str ( i ) stuff = requests . get ( URLSTART + BESTBOOKS + bookpage ) filetowrite = \"files/page\" + ' %02d ' % i + \".html\" print ( \"FTW\" , filetowrite ) fd = open ( filetowrite , \"w\" ) fd . write ( stuff . text ) fd . close () time . sleep ( 2 ) 2. Parse the page, extract book urls Notice how we do file input-output, and use beautiful soup in the code below. The with construct ensures that the file being read is closed, something we do explicitly for the file being written. We look for the elements with class bookTitle , extract the urls, and write them into a file In [8]: from bs4 import BeautifulSoup In [9]: bookdict = {} for i in range ( 1 , 3 ): books = [] stri = ' %02d ' % i filetoread = \"files/page\" + stri + '.html' print ( \"FTW\" , filetoread ) with open ( filetoread ) as fdr : data = fdr . read () soup = BeautifulSoup ( data , 'html.parser' ) for e in soup . select ( '.bookTitle' ): books . append ( e [ 'href' ]) print ( books [: 10 ]) bookdict [ stri ] = books fd = open ( \"files/list\" + stri + \".txt\" , \"w\" ) fd . write ( \" \\n \" . join ( books )) fd . close () Here is George Orwell's 1984 In [10]: bookdict [ '02' ][ 0 ] Lets go look at the first URLs on both pages 3. Parse a book page, extract book properties Ok so now lets dive in and get one of these these files and parse them. In [11]: furl = URLSTART + bookdict [ '02' ][ 0 ] furl In [12]: fstuff = requests . get ( furl ) print ( fstuff . status_code ) In [13]: d = BeautifulSoup ( fstuff . text , 'html.parser' ) In [14]: d . select ( \"meta[property='og:title']\" )[ 0 ][ 'content' ] Lets get everything we want... In [15]: d = BeautifulSoup ( fstuff . text , 'html.parser' ) print ( \"title\" , d . select_one ( \"meta[property='og:title']\" )[ 'content' ], \" \\n \" , \"isbn\" , d . select ( \"meta[property='books:isbn']\" )[ 0 ][ 'content' ], \" \\n \" , \"type\" , d . select ( \"meta[property='og:type']\" )[ 0 ][ 'content' ], \" \\n \" , \"author\" , d . select ( \"meta[property='books:author']\" )[ 0 ][ 'content' ], \" \\n \" , \"average rating\" , d . select_one ( \"span.average\" ) . text , \" \\n \" , \"ratingCount\" , d . select ( \"meta[itemprop='ratingCount']\" )[ 0 ][ \"content\" ], \" \\n \" , \"reviewCount\" , d . select_one ( \"span.count\" )[ \"title\" ] ) Ok, now that we know what to do, lets wrap our fetching into a proper script. So that we dont overwhelm their servers, we will only fetch 5 from each page, but you get the idea... We'll segue of a bit to explore new style format strings. See https://pyformat.info for more info. In [16]: \"list {:0>2} .txt\" . format ( 3 ) In [17]: a = \"4\" b = 4 class Four : def __str__ ( self ): return \"Fourteen\" c = Four () In [18]: \"The hazy cat jumped over the {} and {} and {} \" . format ( a , b , c ) 4. Set up a pipeline for fetching and parsing Ok lets get back to the fetching... In [20]: fetched = [] for i in range ( 1 , 3 ): with open ( \"files/list {:0>2} .txt\" . format ( i )) as fd : counter = 0 for bookurl_line in fd : if counter > 4 : break bookurl = bookurl_line . strip () stuff = requests . get ( URLSTART + bookurl ) filetowrite = bookurl . split ( '/' )[ - 1 ] filetowrite = \"files/\" + str ( i ) + \"_\" + filetowrite + \".html\" print ( \"FTW\" , filetowrite ) fd = open ( filetowrite , \"w\" , encoding = 'utf-8' ) fd . write ( stuff . text ) fd . close () fetched . append ( filetowrite ) time . sleep ( 2 ) counter = counter + 1 print ( fetched ) Ok we are off to parse each one of the html pages we fetched. We have provided the skeleton of the code and the code to parse the year, since it is a bit more complex...see the difference in the screenshots above. In [21]: import re yearre = r '\\d {4} ' def get_year ( d ): if d . select_one ( \"nobr.greyText\" ): return d . select_one ( \"nobr.greyText\" ) . text . strip () . split ()[ - 1 ][: - 1 ] else : thetext = d . select ( \"div#details div.row\" )[ 1 ] . text . strip () rowmatch = re . findall ( yearre , thetext ) if len ( rowmatch ) > 0 : rowtext = rowmatch [ 0 ] . strip () else : rowtext = \"NA\" return rowtext Exercise Your job is to fill in the code to get the genres. In [22]: def get_genres ( d ): # your code here In [23]: listofdicts = [] for filetoread in fetched : print ( filetoread ) td = {} with open ( filetoread ) as fd : datext = fd . read () d = BeautifulSoup ( datext , 'html.parser' ) td [ 'title' ] = d . select_one ( \"meta[property='og:title']\" )[ 'content' ] td [ 'isbn' ] = d . select_one ( \"meta[property='books:isbn']\" )[ 'content' ] td [ 'booktype' ] = d . select_one ( \"meta[property='og:type']\" )[ 'content' ] td [ 'author' ] = d . select_one ( \"meta[property='books:author']\" )[ 'content' ] td [ 'rating' ] = d . select_one ( \"span.average\" ) . text td [ 'ratingCount' ] = d . select_one ( \"meta[itemprop='ratingCount']\" )[ \"content\" ] td [ 'reviewCount' ] = d . select_one ( \"span.count\" )[ \"title\" ] td [ 'year' ] = get_year ( d ) td [ 'file' ] = filetoread glist = get_genres ( d ) td [ 'genres' ] = \"|\" . join ( glist ) listofdicts . append ( td ) In [24]: listofdicts [ 0 ] Finally lets write all this stuff into a csv file which we will use to do analysis. In [25]: df = pd . DataFrame . from_records ( listofdicts ) df . head () In [26]: df . to_csv ( \"files/meta.csv\" , index = False , header = True ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-2/scraping/student/"},{"title":"Lecture 3: Lecture 3: EDA and Visualization Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lecture 3: EDA and Visualization Demo Harvard University Fall 2018 Instructors : Pavlos Protopapas and Kevin Rader Author : Rahul Dave In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } EDA and visualization In the last lecture we focussed on the machinery needed to get data into a tabular form. In this lecture we focus on the visualization part of Exploratory Data Analysis. This notebook accompanies the slides. It is strongly recommended that you see the lecture/read the slides and then work on this notebook. The textual descriptions are sparse here and the code will become much clearer in the context of visualization best practices. In [1]: # The %... is an iPython thing, and is not part of the Python language. # In this case we're just telling the plotting library to draw things on # the notebook, instead of on a separate window. % matplotlib inline #this line above prepares IPython notebook for working with matplotlib # See all the \"as ...\" contructs? They're just aliasing the package names. # That way we can call methods like plt.plot() instead of matplotlib.pyplot.plot(). import numpy as np # imports a fast numerical programming library import scipy as sp #imports stats functions, amongst other things import matplotlib as mpl # this actually imports matplotlib import matplotlib.cm as cm #allows us easy access to colormaps import matplotlib.pyplot as plt #sets up plotting under plt import pandas as pd #lets us handle data as dataframes #sets up pandas table display pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) The seaborn API is changing, and seaborn.apionly is being deprecated. The default will soon behave like apionly and not change the standard matplotlib color scheme and defaults. Here we choose apionly to make sure we have to do everything explicitly. In [2]: # versions below 0.8.1 import seaborn.apionly as sns #sets up styles and gives us more plotting options Getting the mtcars dataset into shape The documentation for this data is here but I have extracted some relevant parts below: Description The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models). Usage mtcars Format A data frame with 32 observations on 11 variables. [, 1] mpg Miles/(US) gallon [, 2] cyl Number of cylinders [, 3] disp Displacement (cu.in.) [, 4] hp Gross horsepower [, 5] drat Rear axle ratio [, 6] wt Weight (1000 lbs) [, 7] qsec 1/4 mile time [, 8] vs V/S [, 9] am Transmission (0 = automatic, 1 = manual) [,10] gear Number of forward gears [,11] carb Number of carburetors Source Henderson and Velleman (1981), Building multiple regression models interactively. Biometrics, 37, 391–411. In [3]: dfcars = pd . read_csv ( \"data/mtcars.csv\" ) dfcars . head () Out[3]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } Unnamed: 0 mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 There is an ugly poorly named column right here. Lets fix that. In [4]: dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () Out[4]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 In [5]: dfcars . shape Out[5]: (32, 12) We parse out a maker , which we shall lkater use to group cars. In [6]: dfcars [ 'maker' ] = dfcars . name . apply ( lambda x : x . split ()[ 0 ]) dfcars [ 'maker' ] Out[6]: 0 Mazda 1 Mazda 2 Datsun 3 Hornet 4 Hornet 5 Valiant 6 Duster 7 Merc 8 Merc 9 Merc 10 Merc 11 Merc 12 Merc 13 Merc 14 Cadillac 15 Lincoln 16 Chrysler 17 Fiat 18 Honda 19 Toyota 20 Toyota 21 Dodge 22 AMC 23 Camaro 24 Pontiac 25 Fiat 26 Porsche 27 Lotus 28 Ford 29 Ferrari 30 Maserati 31 Volvo Name: maker, dtype: object This is what the dataframe looks like now: In [8]: dfcars . head () Out[8]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } name mpg cyl disp hp drat wt qsec vs am gear carb maker 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 Mazda 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 Mazda 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 Datsun 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 Hornet 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Hornet We can construct the av_mpg series by using the \"split-apply-combine\" paradigm and summarizing within group data by a mean: In [9]: av_mpg = dfcars . groupby ( 'maker' ) . mpg . mean () av_mpg Out[9]: maker AMC 15.200000 Cadillac 10.400000 Camaro 13.300000 Chrysler 14.700000 Datsun 22.800000 Dodge 15.500000 Duster 14.300000 Ferrari 19.700000 Fiat 29.850000 Ford 15.800000 Honda 30.400000 Hornet 20.050000 Lincoln 10.400000 Lotus 30.400000 Maserati 15.000000 Mazda 21.000000 Merc 19.014286 Pontiac 19.200000 Porsche 26.000000 Toyota 27.700000 Valiant 18.100000 Volvo 21.400000 Name: mpg, dtype: float64 Simple EDA (as provided by Chris, a previous head-TF for cs109) He says: I'd like to suggest a basic rubric for the early stages of exploratory data analysis in Python. This isn't universally applicable, but it does cover many patterns which recur in several data analysis contexts. It's useful to keep this rubric in mind when encountering a new dataset. The basic workflow is as follows: Build a DataFrame from the data (ideally, put all data in this object) Clean the DataFrame. It should have the following properties: Each row describes a single object Each column describes a property of that object Columns are numeric whenever appropriate Columns contain atomic properties that cannot be further decomposed Explore global properties . Use histograms, scatter plots, and aggregation functions to summarize the data. Explore group properties . Use groupby and small multiples to compare subsets of the data. This process transforms your data into a format which is easier to work with, gives you a basic overview of the data's properties, and likely generates several questions for you to followup in subsequent analysis. So far we have built the dataframe, and carried out very minimal cleaning (renaming) in this dataframe. Exploring global properties So lets focus on visualizing global properties of the data set below. For now, we shall only focus on mpg to illustrate the concepts, but you want to be doing this for all the columns. It may identify interesting properties and even errors in the data. While we do this we shall see several examples of the matplotlib plotting experience. We first use seaborn to set the global matplotlib plotting context. Here we set it to notebook which makes for reasonable sized graphics. In [10]: sns . set_context ( \"notebook\" ) We ask what the defaukt color palette is. Since we imported sns.apionly , we get the default matplotlib color palette. In [11]: sns . color_palette () Out[11]: [(0.12156862745098039, 0.4666666666666667, 0.7058823529411765), (1.0, 0.4980392156862745, 0.054901960784313725), (0.17254901960784313, 0.6274509803921569, 0.17254901960784313), (0.8392156862745098, 0.15294117647058825, 0.1568627450980392), (0.5803921568627451, 0.403921568627451, 0.7411764705882353), (0.5490196078431373, 0.33725490196078434, 0.29411764705882354), (0.8901960784313725, 0.4666666666666667, 0.7607843137254902), (0.4980392156862745, 0.4980392156862745, 0.4980392156862745), (0.7372549019607844, 0.7411764705882353, 0.13333333333333333), (0.09019607843137255, 0.7450980392156863, 0.8117647058823529)] Now we see maplotlib's default color palette, 'viridis'. In [12]: sns . palplot ( sns . color_palette ()); We can choose other palettes. The default palette is for qualitative data. It creates a color cycle we use in our plots. In other words, as we plot multiple things in a plot, it will use these colors one-by-one. In [14]: output = sns . choose_colorbrewer_palette ( data_type = \"qualitative\" ) var element = $('#f02d94c6-4116-45af-8c84-cc647614614f'); {\"model_id\": \"4b4615c10ff74a36be2d1979420e7dc7\"} In [15]: sns . palplot ( output ) In [22]: sns . set_palette ( output ) Bar Charts We see that Pandas series very niftily give us bar graphs. In [23]: av_mpg . plot ( kind = \"barh\" ) Out[23]: In [24]: sns . reset_defaults () In [25]: av_mpg . plot ( kind = \"barh\" ) Out[25]: The default, which comes from matplotlib, is chart-junky (although not as much as matlab, or as much as it used to be in earlier versions of matplotlib). But lets clean it. In [26]: plt . figure ( figsize = ( 4 , 6 )) ax = plt . gca () av_mpg . plot ( kind = \"barh\" ) plt . grid ( axis = 'x' , color = 'white' , linestyle = '-' ) ax . tick_params ( axis = 'both' , which = 'both' , length = 0 ) sns . despine () And more.... In [27]: with sns . plotting_context ( \"poster\" ): ax = plt . gca () av_mpg . plot ( kind = \"barh\" ) plt . grid ( axis = 'x' , color = 'white' , linestyle = '-' ) ax . tick_params ( axis = 'both' , which = 'both' , length = 0 ) sns . despine ( left = True , bottom = True ) Its important to understand what is going on under the hood. Try and write sns.despine on your own by looking up the matplotlib documentation. In [28]: plt . figure ( figsize = ( 3 , 8 )) ax = plt . gca () av_mpg2 = av_mpg . sort_values () makes = av_mpg2 . index speeds = av_mpg2 . values nums = np . arange ( len ( av_mpg2 )) plt . barh ( nums , speeds ) for p , c , ch in zip ( nums , makes , speeds ): plt . annotate ( str ( ch ), xy = ( ch + 1 , p ), va = 'center' ) ticks = plt . yticks ( nums , makes ) xt = plt . xticks ()[ 0 ] plt . xticks ( xt , [ ' ' ] * len ( xt )) plt . grid ( axis = 'x' , color = 'white' , linestyle = '-' ) ax . tick_params ( axis = 'both' , which = 'both' , length = 0 ) sns . despine ( left = True , bottom = True ) Histograms Numerical data leads to distributions, and distributions to histograms. Here is the Pandas default In [29]: dfcars . mpg . hist () plt . xlabel ( \"mpg\" ); And matplotlib: In [30]: plt . hist ( dfcars . mpg . values ); Lets style it a bit with seaborn. The with syntax followed by indentation is a python construct called a \"context manager\". Here it sets up a while axes style only for the code that is inside the context (ie, indented). In [31]: with sns . axes_style ( \"white\" ): dfcars . mpg . hist ( alpha = 0.4 ) plt . xlabel ( \"mpg\" ); sns . despine () What if I wanted to get the benefit of the default seaborn style and colors? In [32]: sns . set () In [33]: dfcars . mpg . hist () plt . xlabel ( \"mpg\" ); sns . despine () I can reset_defaults back to the matplotlib defaults. In [34]: sns . reset_defaults () ax = plt . gca () dfcars . mpg . hist () plt . xlabel ( \"mpg\" ); plt . title ( \"Miles per Gallon\" ) ax . tick_params ( axis = 'both' , which = 'both' , length = 0 ) sns . despine ( bottom = True , left = True ) Here are the most commonly used matplotlib plotting routines. Here we use a white grid. We also illustrate how a series can be converted to a numpy array with the values method ( dfcars.mpg.values ) and how x and y limits can be set (the difference in the way xlim and ylim are called is on purpose and illustrates two ways you can set the limits). In the hist function you can also change the number of bins. We also show how to label a plot and obtain a legend from the plot. A vertical line is drawn at the mean. In [35]: with sns . axes_style ( \"whitegrid\" ): plt . hist ( dfcars . mpg . values , bins = 20 ) plt . xlim ( 5 , 40 ) plt . ylim ([ 0 , 8 ]) plt . axvline ( dfcars . mpg . mean (), 0 , 0.75 , color = 'r' , label = 'Mean' ) plt . xlabel ( \"mpg\" ) plt . ylabel ( \"Counts\" ) plt . title ( \"Cars Miles per gallon Histogram\" ) plt . legend () One can set bins using a list, and also label the histogram (not recommended but just for illustration). We also illustrate how to capture the color used and use it again In [36]: with sns . axes_style ( \"whitegrid\" ): color = sns . color_palette ()[ 0 ] plt . hist ( dfcars . mpg . values , bins = range ( 5 , 40 , 3 ), label = \"histogram\" , color = color ) plt . xlim ( 5 , 40 ) plt . ylim ([ 0 , 8 ]) plt . axvline ( dfcars . mpg . mean (), 0 , 1.0 , color = color , label = 'Mean' ) plt . xlabel ( \"mpg\" ) plt . ylabel ( \"Counts\" ) plt . title ( \"Cars Miles per gallon Histogram\" ) plt . legend () Seaborn very handily provides Kernel Density Estimates (KDE) which try to infer a probability distribution from the data. This is more useful when you have lots of data. In [37]: sns . set () In [38]: sns . kdeplot ( dfcars . mpg ); And a histogram and a kdeplot together: In [39]: sns . distplot ( dfcars . mpg ); Plotting features against other features Sometimes we want to see co-variation amongst our columns. A scatter-plot does this for us. In [40]: plt . scatter ( dfcars . wt , dfcars . mpg ); We can also use plot without lines: In [42]: plt . plot ( dfcars . wt , dfcars . mpg , marker = 'o' , linestyle = 'None' , color = 'k' ); Usually we use `plt.show()` at the end of every plot to show the plot. Out magic incantation `%matplotlib inline` takes care of this for us, and we dont have to doit in the jupyter notebook. But if you run your puthon program from a file, you will need to explicitly have a call to show. Does not hurt us to include it... In [43]: plt . plot ( dfcars . wt , dfcars . mpg , 'o' ) plt . show () But what if we want to save our figure into a file? The extension tells you how it will be saved..and note that the savefig needs to be in the same cell as the plotting commands. Go look at the files.. In [44]: plt . plot ( dfcars . wt , dfcars . mpg , 'o' , markersize = 4 , alpha = 0.5 ) plt . savefig ( 'foo1.pdf' ) plt . savefig ( 'foo2.png' , bbox_inches = 'tight' ) #less whitespace around image Trend The correlation that we saw might suggest a trend. We can capture it with a \"regression\". We'll learn more about regressions soon, but we show a quadratic fit here with a 1 standard deviation bar to show the graphics aspect of this. Also see sns.regplot . In [45]: x = dfcars . wt y = dfcars . mpg params = np . polyfit ( x , y , 2 ) xp = np . linspace ( x . min (), x . max (), 20 ) yp = np . polyval ( params , xp ) plt . plot ( xp , yp , 'k' , alpha = 0.8 , linewidth = 1 ) plt . plot ( dfcars . wt , dfcars . mpg , 'o' , markersize = 4 , alpha = 0.5 ) sig = np . std ( y - np . polyval ( params , x )) plt . fill_between ( xp , yp - sig , yp + sig , color = 'k' , alpha = 0.2 ) Out[45]: Group Properties Such \"co-variational\" plots, and for that matter, even single-variable plots, are even more interesting when we look at them conditional upon the value of a categorical variable. Such conditionality is behind the notion of grouping, where we group our data by various values of categorical variables, for example, whether our cars have an automatic transmission or not. Grouping of one outcome variable This notion of grouping based on combinations of factors is used by seaborn to make various easy-to-see exploratory visualizations for us. We shall first see how to make these plots quick-and-dirty using seaborn and then see how we make make these plots ourselves. First, we make a boxplot of mpg , grouped by transmission style In [47]: sns . boxplot ( x = 'am' , y = 'mpg' , data = dfcars ); The box shows the quartiles of the distribution This can also be done using a violin-plot, which uses KDE to show the distribution itself: In [49]: sns . violinplot ( x = 'am' , y = 'mpg' , data = dfcars ); Automatics surveyed have a higher range of mpg, with higher fuel efficiency significant at 1 sigma, and we may want to investigate if this is a selection effect or whether there is some true impact of an automatic transmission. Further subgrouping the data is one way to do this. Split violin plots can be used to do multiple categorical variables In [51]: sns . violinplot ( x = 'cyl' , y = 'mpg' , hue = 'am' , order = [ 4 , 6 , 8 ], data = dfcars , split = True ); One can see that the difference in mpg is starker between 6 and 8 cylinder cars, for manual transmissions. And that the large-range effect in automatics is coming almost entirely through 4-cylinder cars. What about the better mpg for automatics? Mostly in the 4 and 6 cyclinders. But we ought to see how representative these are in our sample. We'll show how to do this soon but a cross-tabulation, combined with the graph above, gives us some idea that the poor miles per gallon for manual transmission may be coming from the preponderance of 8-cylinder manual cars in our dataset. In [52]: pd . crosstab ( dfcars . am , dfcars . cyl ) Out[52]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } cyl 4 6 8 am 0 3 4 12 1 8 3 2 Faceting for general grouping Seaborn provides a nice construct: the FacetGrid . You decide what variables to facet over, and then decide the kind of plot you want. Here we want hue to be am , and different columns in the plot grid to be cylinders. We then ask for a facet plot of mpg against wt scatter. Such plots are often called small multiple plots. They repeat the same plot based on categories, making sure that all plotting parameters are the same so that we have direct comparability. In [73]: g = sns . FacetGrid ( dfcars , col = \"cyl\" , hue = \"am\" , palette = \"Set1\" ) g . map ( plt . scatter , \"mpg\" , \"wt\" , alpha = 0.5 , s = 10 ); Out[73]: We can see that the \"regression-like\" effect is cleanest for automatic transmissions in 4 cylinder cars. SPLOM, or Scatter Plot Matrix We'd get tired if we had to this on a 2-by-2 basis for every pair of continuously co-varying features. The PairGrid , colorable by transmission type, allows us to do this comparison for 5 continuous features here, with the diagonal being a kernel density estimate. In [53]: g = sns . PairGrid ( dfcars , vars = [ 'mpg' , 'hp' , 'wt' , 'qsec' , 'disp' ], hue = \"am\" ) g . map_diag ( sns . kdeplot ) g . map_offdiag ( plt . scatter , s = 15 ) Out[53]: In many places, for example mpg vs disp , there see to be two separate trends for the different transmissions. This will (as we shall see later in this course) suggest to us the addition of a transmission term as a indicator variable in regressions for mpg against various features. This changes the intercept of the regression. But the trends have different slopes as well, which suggests that disp may interact with am , the transmission indicator to create a varying slope as well. Correlation The SPLOM seems to suggest correlations. Well, so lets calculate it: In [53]: dfcars [[ 'mpg' , 'wt' , 'hp' , 'qsec' , 'disp' ]] . corr () Out[53]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } mpg wt hp qsec disp mpg 1.000000 -0.867659 -0.776168 0.418684 -0.847551 wt -0.867659 1.000000 0.658748 -0.174716 0.887980 hp -0.776168 0.658748 1.000000 -0.708223 0.790949 qsec 0.418684 -0.174716 -0.708223 1.000000 -0.433698 disp -0.847551 0.887980 0.790949 -0.433698 1.000000 Since correlations range from -1 to 1 through 0, a diverging palette is probably our best bet. In [54]: dpal = sns . choose_colorbrewer_palette ( 'diverging' , as_cmap = True ) var element = $('#70e4332e-ebd0-48c0-869d-cbf633666293'); {\"model_id\": \"e8847f7c5ea24c1db2b2a7f62614911f\"} We use maptplotlib s correlation plot. You'll land up doing plots like this for both EDA and do see misclassification from your machine learning algorithms. In other words, EDA is even useful at the analysis stage. In [56]: plt . matshow ( dfcars [[ 'mpg' , 'wt' , 'hp' , 'qsec' , 'disp' ]] . corr (), cmap = dpal ) ax = plt . gca () ax . tick_params ( axis = 'both' , which = 'both' , length = 0 ); plt . title ( \"Correlation Matrix\" ) plt . xticks ( range ( 4 ), [ 'mpg' , 'wt' , 'hp' , 'qsec' , 'disp' ]) plt . yticks ( range ( 4 ), [ 'mpg' , 'wt' , 'hp' , 'qsec' , 'disp' ]); KDE plots and sequential palettes. Here we make a KDE plot of a multivariate normal distribution. Since a probability density is strictly positive, with values near 0 not being so interesting, a sequential palette is our ticket. Seaborn will by default provide such a palette for KDE plots, but you can use your own! In [58]: mean , cov = [ 0 , 1 ], [( 1 , . 5 ), ( . 5 , 1 )] data = np . random . multivariate_normal ( mean , cov , 1000 ) df = pd . DataFrame ( data , columns = [ \"x\" , \"y\" ]) df . head () Out[58]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } x y 0 0.781939 2.436832 1 1.312489 0.759633 2 1.686334 0.516640 3 3.075545 3.689564 4 2.892708 3.752817 In [59]: seqpal = sns . choose_colorbrewer_palette ( \"sequential\" , as_cmap = True ) var element = $('#a12feb35-25fc-463b-897c-08bf91fab857'); {\"model_id\": \"be74ec38c70144cab341d3eca87f3cd2\"} In [60]: sns . kdeplot ( df . x , df . y , cmap = seqpal , shade = True ); Matplotlib and multiple plots: Small Multiples There are many cases where we want to see plots side by side. The SPLOMS and Facet grids that seaborn makes for us are an example.But we should know how to do this on our own. Here is a simple example of a plot with one column and 3 rows. It illustrates one way of doing this. In [61]: fig = plt . figure ( figsize = ( 5 , 9 )) ax1 = fig . add_subplot ( 311 ) ax1 . plot ([ 1 , 2 , 3 ], [ 1 , 2 , 3 ]) ax1 . set_xticklabels ([]) ax1 . set_ylim ([ 1.0 , 3.0 ]) ax2 = fig . add_subplot ( 312 ) ax2 . scatter ([ 1 , 2 , 3 ], [ 1 , 2 , 3 ]) ax2 . set_xticklabels ([]) ax2 . set_ylim ([ 1.0 , 3.0 ]) ax3 = fig . add_subplot ( 313 ) ax3 . plot ([ 1 , 2 , 3 ], [ 1 , 2 , 3 ]) ax3 . set_ylim ([ 1.0 , 3.0 ]) fig . tight_layout () Small multiples, youself Here is another way, which to me is far clearer that the add_subplot way. It basically creates an array of plots and zips this array up with the various data grouped by categories. In [62]: fig , axes = plt . subplots ( nrows = 2 , ncols = 2 , figsize = ( 12 , 12 )) print ( axes ) print ( axes . ravel ()) carbs = [ '==1' , '==2' , '==3' , '>=4' ] bins = np . arange ( 10 , 30 , 2 ) for ax , carb in zip ( axes . ravel (), carbs ): data = dfcars . query ( \"carb %s \" % carb ) print ( data . shape ) #ax.plot(data.wt, data.mpg, 'o', markersize=10, alpha=0.5) ax . hist ( data . mpg , bins = bins , histtype = 'stepfilled' , normed = True , color = 'r' , alpha =. 3 ) ax . annotate ( \"carb\" + str ( carb ), xy = ( 12 , 0.35 ), fontsize = 14 ) #ax.set_yticks([]) ax . set_ylim (( 0 , 0.4 )) ax . set_xlabel ( 'mpg' ); [[ ] [ ]] [ ] (7, 13) (10, 13) (3, 13) (12, 13) The Interest in Science Problem from lecture slides Dataframe construction: In [64]: science = { 'interest' : [ 'Excited' , 'Kind of interested' , 'OK' , 'Not great' , 'Bored' ], 'before' : [ 19 , 25 , 40 , 5 , 11 ], 'after' : [ 38 , 30 , 14 , 6 , 12 ] } dfscience = pd . DataFrame . from_dict ( science ) . set_index ( \"interest\" )[[ 'before' , 'after' ]] dfscience Out[64]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } before after interest Excited 19 38 Kind of interested 25 30 OK 40 14 Not great 5 6 Bored 11 12 Multiple Pie Charts In [65]: fig , axs = plt . subplots ( 1 , 2 , figsize = ( 8.5 , 4 )) dfscience . before . plot ( kind = \"pie\" , ax = axs [ 0 ], labels = None ); axs [ 0 ] . legend ( loc = \"upper left\" , ncol = 5 , labels = dfscience . index ) dfscience . after . plot ( kind = \"pie\" , ax = axs [ 1 ], labels = None ); Before and after bar charts In [66]: dfscience . plot ( kind = \"bar\" ); Stacked Charts In [67]: dfscience . plot ( kind = \"barh\" , stacked = True ); This is hard to read. We wznt to compare before and after easily. Sometimes the solution is a transpose!! In [68]: dfscience . transpose () Out[68]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } interest Excited Kind of interested OK Not great Bored before 19 25 40 5 11 after 38 30 14 6 12 We have to play some games to get the ordering right... In [69]: dfst = dfscience . transpose () dfst . iloc [[ 1 , 0 ],:] Out[69]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } interest Excited Kind of interested OK Not great Bored after 38 30 14 6 12 before 19 25 40 5 11 In [71]: dfscience . transpose () . loc [[ 'after' , 'before' ], :] . plot ( kind = \"barh\" , stacked = True ) plt . legend ( loc = 2 , ncol = 5 ); Now we see that the blue and greens have it. Try and improve this plot. It still has too much chartjunk. Difference Bar chart Sometimes a small data transformation makes the effect blindingly obvious. Here we just make a bar chart of the change! In [72]: ( dfscience . after - dfscience . before ) . plot ( kind = \"barh\" ); Bacteria Dataset For those want to play... In [91]: antibiotics = [ { \"bacteria\" : \"Mycobacterium tuberculosis\" , \"penicillin\" : 800 , \"streptomycin\" : 5 , \"neomycin\" : 2 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Salmonella schottmuelleri\" , \"penicillin\" : 10 , \"streptomycin\" : 0.8 , \"neomycin\" : 0.09 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Proteus vulgaris\" , \"penicillin\" : 3 , \"streptomycin\" : 0.1 , \"neomycin\" : 0.1 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Klebsiella pneumoniae\" , \"penicillin\" : 850 , \"streptomycin\" : 1.2 , \"neomycin\" : 1 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Brucella abortus\" , \"penicillin\" : 1 , \"streptomycin\" : 2 , \"neomycin\" : 0.02 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Pseudomonas aeruginosa\" , \"penicillin\" : 850 , \"streptomycin\" : 2 , \"neomycin\" : 0.4 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Escherichia coli\" , \"penicillin\" : 100 , \"streptomycin\" : 0.4 , \"neomycin\" : 0.1 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Salmonella (Eberthella) typhosa\" , \"penicillin\" : 1 , \"streptomycin\" : 0.4 , \"neomycin\" : 0.008 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Aerobacter aerogenes\" , \"penicillin\" : 870 , \"streptomycin\" : 1 , \"neomycin\" : 1.6 , \"gram\" : \"negative\" }, { \"bacteria\" : \"Brucella antracis\" , \"penicillin\" : 0.001 , \"streptomycin\" : 0.01 , \"neomycin\" : 0.007 , \"gram\" : \"positive\" }, { \"bacteria\" : \"Streptococcus fecalis\" , \"penicillin\" : 1 , \"streptomycin\" : 1 , \"neomycin\" : 0.1 , \"gram\" : \"positive\" }, { \"bacteria\" : \"Staphylococcus aureus\" , \"penicillin\" : 0.03 , \"streptomycin\" : 0.03 , \"neomycin\" : 0.001 , \"gram\" : \"positive\" }, { \"bacteria\" : \"Staphylococcus albus\" , \"penicillin\" : 0.007 , \"streptomycin\" : 0.1 , \"neomycin\" : 0.001 , \"gram\" : \"positive\" }, { \"bacteria\" : \"Streptococcus hemolyticus\" , \"penicillin\" : 0.001 , \"streptomycin\" : 14 , \"neomycin\" : 10 , \"gram\" : \"positive\" }, { \"bacteria\" : \"Streptococcus viridans\" , \"penicillin\" : 0.005 , \"streptomycin\" : 10 , \"neomycin\" : 40 , \"gram\" : \"positive\" }, { \"bacteria\" : \"Diplococcus pneumoniae\" , \"penicillin\" : 0.005 , \"streptomycin\" : 11 , \"neomycin\" : 10 , \"gram\" : \"positive\" } ] dfabio = pd . DataFrame . from_records ( antibiotics ) dfabio Out[91]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } bacteria gram neomycin penicillin streptomycin 0 Mycobacterium tuberculosis negative 2.000 800.000 5.00 1 Salmonella schottmuelleri negative 0.090 10.000 0.80 2 Proteus vulgaris negative 0.100 3.000 0.10 3 Klebsiella pneumoniae negative 1.000 850.000 1.20 4 Brucella abortus negative 0.020 1.000 2.00 5 Pseudomonas aeruginosa negative 0.400 850.000 2.00 6 Escherichia coli negative 0.100 100.000 0.40 7 Salmonella (Eberthella) typhosa negative 0.008 1.000 0.40 8 Aerobacter aerogenes negative 1.600 870.000 1.00 9 Brucella antracis positive 0.007 0.001 0.01 10 Streptococcus fecalis positive 0.100 1.000 1.00 11 Staphylococcus aureus positive 0.001 0.030 0.03 12 Staphylococcus albus positive 0.001 0.007 0.10 13 Streptococcus hemolyticus positive 10.000 0.001 14.00 14 Streptococcus viridans positive 40.000 0.005 10.00 15 Diplococcus pneumoniae positive 10.000 0.005 11.00 if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lecture-3/notebook/"},{"title":"Lecture 0: What is Data Science?","text":"Slides PDF | Lecture 0: What is Data Science? Jupyter Notebook Lecture 0: Data Science Demo","tags":"lectures","url":"lectures/lecture-0/"},{"title":"Lab 3: Scikit-learn for Regression","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 3: Scikit-learn for Regression Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Authors: David Sondak, Will Claybaugh, Eleni Kaxiras In [2]: # RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[2]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Array creation and reshape Some plotting Simple linear regression $k$-nearest neighbors Learning Goals Overall description and goal for the lab. By the end of this lab, you should be able to: Understand array reshaping Review how to make plots Feel comfortable with simple linear regression Feel comfortable with $k$ nearest neighbors This lab corresponds to lecture 4 and maps on to homework 2 (and beyond). In [8]: # import the necessary libraries import warnings warnings . filterwarnings ( 'ignore' ) % matplotlib inline import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd import time pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn as sns Simple Linear Regression Linear regression and its many extensions are a workhorse of the statistics and data science community, both in application and as a reference point for other models. Most of the major concepts in machine learning can be and often are discussed in terms of various linear regression models. Thus, this section will introduce you to building and fitting linear regression models and some of the process behind it, so that you can 1) fit models to data you encounter 2) experiment with different kinds of linear regression and observe their effects 3) see some of the technology that makes regression models work. Linear regression with a toy dataset We first examine a toy problem, focusing our efforts on fitting a linear model to a small dataset with three observations. Each observation consists of one predictor $x_i$ and one response $y_i$ for $i = 1, 2, 3$, \\begin{align*} (x , y) = \\{(x_1, y_1), (x_2, y_2), (x_3, y_3)\\}. \\end{align*} To be very concrete, let's set the values of the predictors and responses. \\begin{equation*} (x , y) = \\{(1, 2), (2, 2), (3, 4)\\} \\end{equation*} There is no line of the form $\\beta_0 + \\beta_1 x = y$ that passes through all three observations, since the data are not collinear. Thus our aim is to find the line that best fits these observations in the least-squares sense , as discussed in lecture. Exercise (10 min) Make two numpy arrays out of this data, x_train and y_train Check the dimentions of these arrays Try to reshape them into a different shape Make points into a very simple scatterplot Make a better scatterplot In [28]: # your code here x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 3 , 6 ]) type ( x_train ) Out[28]: numpy.ndarray In [12]: x_train . shape Out[12]: (3,) In [14]: x_train = x_train . reshape ( 3 , 1 ) x_train . shape Out[14]: (3, 1) In [15]: xx = np . array ([[ 1 , 3 , 5 ],[ 6 , 2 , 1 ]]) xx . shape Out[15]: (2, 3) In [18]: xx = xx . reshape ( 3 , - 1 ) xx Out[18]: array([[1, 3], [5, 6], [2, 1]]) In [29]: # make a simple scatterplot x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 2 , 4 ]) plt . scatter ( x_train , y_train ) # check dimensions print ( x_train . shape , y_train . shape ) (3,) (3,) In [38]: def nice_scatterplot ( x , y , title ): # font size f_size = 18 # make the figure fig , ax = plt . subplots ( 1 , 1 , figsize = ( 8 , 5 )) # Create figure object # set axes limits to make the scale nice ax . set_xlim ( np . min ( x ) - 1 , np . max ( x ) + 1 ) ax . set_ylim ( np . min ( y ) - 1 , np . max ( y ) + 1 ) # adjust size of tickmarks in axes ax . tick_params ( labelsize = f_size ) # remove tick labels ax . tick_params ( labelbottom = False , bottom = False ) # adjust size of axis label ax . set_xlabel ( r '$x$' , fontsize = f_size ) ax . set_ylabel ( r '$y$' , fontsize = f_size ) # set figure title label ax . set_title ( title , fontsize = f_size ) # you may set up grid with this ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.15 ) # make actual plot (Notice the label argument!) #ax.scatter(x, y, label=r'$my points$') #ax.scatter(x, y, label='$my points$') ax . scatter ( x , y , label = r '$my\\,points$' ) ax . legend ( loc = 'best' , fontsize = f_size ); return ax nice_scatterplot ( x_train , y_train , 'hello nice plot' ) Out[38]: Formulae Linear regression is special among the models we study beuase it can be solved explicitly. While most other models (and even some advanced versions of linear regression) must be solved itteratively, linear regression has a formula where you can simply plug in the data. For the single predictor case it is: \\begin{align} \\beta_1 &= \\frac{\\sum_{i=1}&#94;n{(x_i-\\bar{x})(y_i-\\bar{y})}}{\\sum_{i=1}&#94;n{(x_i-\\bar{x})&#94;2}}\\\\ \\beta_0 &= \\bar{y} - \\beta_1\\bar{x}\\ \\end{align} Where $\\bar{y}$ and $\\bar{x}$ are the mean of the y values and the mean of the x values, respectively. From the re-aranged second equation we can see that the best-fit line passes through $(\\bar{x},\\bar{y})$, the center of mass of the data From any of the first equations, we can see that the slope of the line has to do with whether or not an x value that is above/below the center of mass is typically paired with a y value that is likewise above/below, or typically paired with one that is opposite. Building a model from scratch In this part, we will solve the equations for simple linear regression and find the best fit solution to our toy problem. The snippets of code below implement the linear regression equations on the observed predictors and responses, which we'll call the training data set. Let's walk through the code. We have to reshape our arrrays to 2D. We will see later why. Exercise (5 min) make an array with shape (2,3) reshape it to a size that you want In [ ]: # your code here xx = np . array ([[ 1 , 2 , 3 ],[ 4 , 6 , 8 ]]) xxx = xx . reshape ( - 1 , 2 ) xxx . shape In [39]: # Reshape to be a proper 2D array x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) print ( x_train . shape ) (3, 1) In [40]: # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) print ( numerator . shape , denominator . shape ) #check shapes () () Why the empty brackets? (The numerator and denominator are scalars, as expected.) In [47]: #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar print ( \"The best-fit line is {0:3.2f} + {1:3.2f} * x\" . format ( beta_0 , beta_1 )) print ( f 'The best fit is {beta_0} ' ) The best-fit line is -0.33 + 2.00 * x The best fit is -0.3333333333333335 Exercise (5 min) Turn the code from the above cells into a function called simple_linear_regression_fit , that inputs the training data and returns beta0 and beta1 . To do this, copy and paste the code from the above cells below and adjust the code as needed, so that the training data becomes the input and the betas become the output. def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : return Check your function by calling it with the training data from above and printing out the beta values. In [50]: def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : \"\"\" Inputs: x_train: a (num observations by 1) array holding the values of the predictor variable y_train: a (num observations by 1) array holding the values of the response variable Returns: beta_vals: a (num_features by 1) array holding the intercept and slope coeficients \"\"\" # Check input array sizes if len ( x_train . shape ) < 2 : print ( \"Reshaping features array.\" ) x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) if len ( y_train . shape ) < 2 : print ( \"Reshaping observations array.\" ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar return np . array ([ beta_0 , beta_1 ]) Let's run this function and see the coefficients In [55]: x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 2 , 4 ]) betas = simple_linear_regression_fit ( x_train , y_train ) beta_0 = betas [ 0 ] beta_1 = betas [ 1 ] print ( \"The best-fit line is {0:8.6f} + {1:8.6f} * x\" . format ( beta_0 , beta_1 )) Reshaping features array. Reshaping observations array. The best-fit line is 0.666667 + 1.000000 * x Exercise (5 min) Do the values of beta0 and beta1 seem reasonable? Plot the training data using a scatter plot. Plot the best fit line with beta0 and beta1 together with the training data. In [65]: fig_scat , ax_scat = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Plot best-fit line x_train = np . array ([[ 1 , 2 , 3 ]]) . T best_fit = beta_0 + beta_1 * x_train ax_scat . scatter ( x_train , y_train , s = 300 , label = 'Training Data' ) ax_scat . plot ( x_train , best_fit , ls = '--' , label = 'Best Fit Line' ) ax_scat . set_xlabel ( r '$x_ {train} $' ) ax_scat . set_ylabel ( r '$y$' ); The values of beta0 and beta1 seem roughly reasonable. They capture the positive correlation. The line does appear to be trying to get as close as possible to all the points. Building a model with statsmodels and sklearn Now that we can concretely fit the training data from scratch, let's learn two python packages to do it all for us: statsmodels and scikit-learn (sklearn) . Our goal is to show how to implement simple linear regression with these packages. For an important sanity check, we compare the $\\beta$ values from statsmodels and sklearn to the $\\beta$ values that we found from above with our own implementation. For the purposes of this lab, statsmodels and sklearn do the same thing. More generally though, statsmodels tends to be easier for inference [finding the values of the slope and intercept and dicussing uncertainty in those values], whereas sklearn has machine-learning algorithms and is better for prediction [guessing y values for a given x value]. (Note that both packages make the same guesses, it's just a question of which activity they provide more support for. Note: statsmodels and sklearn are different packages! Unless we specify otherwise, you can use either one. Below is the code for statsmodels . Statsmodels does not by default include the column of ones in the $X$ matrix, so we include it manually with sm.add_constant . In [58]: import statsmodels.api as sm In [66]: # create the X matrix by appending a column of ones to x_train X = sm . add_constant ( x_train ) # this is the same matrix as in our scratch problem! print ( X ) # build the OLS model (ordinary least squares) from the training data toyregr_sm = sm . OLS ( y_train , X ) # do the fit and save regression info (parameters, etc) in results_sm results_sm = toyregr_sm . fit () # pull the beta parameters out from results_sm beta0_sm = results_sm . params [ 0 ] beta1_sm = results_sm . params [ 1 ] print ( \"The regression coefficients from the statsmodels package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_sm , beta1_sm )) [[ 1. 1.] [ 1. 2.] [ 1. 3.]] The regression coefficients from the statsmodels package are: beta_0 = 0.666667 and beta_1 = 1.000000 Besides the beta parameters, results_sm contains a ton of other potentially useful information. In [60]: import warnings warnings . filterwarnings ( 'ignore' ) print ( results_sm . summary ()) OLS Regression Results ============================================================================== Dep. Variable: y R-squared: 0.750 Model: OLS Adj. R-squared: 0.500 Method: Least Squares F-statistic: 3.000 Date: Fri, 21 Sep 2018 Prob (F-statistic): 0.333 Time: 11:31:12 Log-Likelihood: -2.0007 No. Observations: 3 AIC: 8.001 Df Residuals: 1 BIC: 6.199 Df Model: 1 Covariance Type: nonrobust ============================================================================== coef std err t P>|t| [0.025 0.975] ------------------------------------------------------------------------------ const 0.6667 1.247 0.535 0.687 -15.181 16.514 x1 1.0000 0.577 1.732 0.333 -6.336 8.336 ============================================================================== Omnibus: nan Durbin-Watson: 3.000 Prob(Omnibus): nan Jarque-Bera (JB): 0.531 Skew: -0.707 Prob(JB): 0.767 Kurtosis: 1.500 Cond. No. 6.79 ============================================================================== Warnings: [1] Standard Errors assume that the covariance matrix of the errors is correctly specified. Now let's turn our attention to the sklearn library. In [67]: from sklearn import linear_model In [68]: # build the least squares model toyregr = linear_model . LinearRegression () # save regression info (parameters, etc) in results_skl results = toyregr . fit ( x_train , y_train ) # pull the beta parameters out from results_skl beta0_skl = toyregr . intercept_ beta1_skl = toyregr . coef_ [ 0 ] print ( \"The regression coefficients from the sklearn package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_skl , beta1_skl )) The regression coefficients from the sklearn package are: beta_0 = 0.666667 and beta_1 = 1.000000 We should feel pretty good about ourselves now, and we're ready to move on to a real problem! The shape of things in scikit-learn Before diving right in to a \"real\" problem, we really ought to discuss more of the details of sklearn . We do this now. Along the way, we'll import the real-world dataset. Scikit-learn is the main python machine learning library. It consists of many learners which can learn models from data, as well as a lot of utility functions such as train_test_split . It can be used in python by the incantation import sklearn . In scikit-learn, an estimator is a Python object that implements the methods fit(X, y) and predict(T) Let's see the structure of scikit-learn needed to make these fits. .fit always takes two arguments: estimator . fit ( Xtrain , ytrain ) We will consider two estimators in this lab: LinearRegression and KNeighborsRegressor . Critically, Xtrain must be in the form of an array of arrays (or a 2x2 array) with the inner arrays each corresponding to one sample, and whose elements correspond to the feature values for that sample (visuals coming in a moment). ytrain on the other hand is a simple array of responses. These are continuous for regression problems. Practice with sklearn We begin by loading up the mtcars dataset and cleaning it up a little bit. In [73]: import pandas as pd #load mtcars dfcars = pd . read_csv ( \"data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"car name\" }) dfcars . head () Out[73]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } car name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Next, let's split the dataset into a training set and test set. In [74]: # split into training set and testing set from sklearn.model_selection import train_test_split #set random_state to get the same split every time traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) In [75]: # testing set is around 20% of the total data; training set is around 80% print ( \"Shape of full dataset is: {0} \" . format ( dfcars . shape )) print ( \"Shape of training dataset is: {0} \" . format ( traindf . shape )) print ( \"Shape of test dataset is: {0} \" . format ( testdf . shape )) Shape of full dataset is: (32, 12) Shape of training dataset is: (25, 12) Shape of test dataset is: (7, 12) Now we have training and test data. We still need to select a predictor and a response from this dataset. Keep in mind that we need to choose the predictor and response from both the training and test set. You will do this in the exercises below. However, we provide some starter code for you to get things going. In [76]: # Extract the response variable that we're interested in y_train = traindf . mpg Notice the shape of y_train . In [77]: np . shape ( y_train ) Out[77]: (25,) Another way to see the shape is to use the shape method. In [78]: y_train . shape Out[78]: (25,) This is not an \"array of arrays\". That's okay! Remember, sklearn requires an array of arrays only for the predictor array! You will have to pay close attention to this in the exercises later. For now, let's discuss two ways out of this debacle. All we'll do is get y_train to be an array of arrays. This doesn't hurt anything because sklearn doesn't care too much about the shape of y_train . First, let's reshape y_train to be an array of arrays using the reshape method. We want the first dimension of y_train to be size $25$ and the second dimension to be size $1$. In [79]: y_train_reshape = y_train . values . reshape ( y_train . shape [ 0 ], 1 ) In [80]: y_train_reshape . shape Out[80]: (25, 1) Notice that y_train.shape[0] gives the size of the first dimension. There's an even easier way to get the correct shape right from the beginning. In [ ]: y_train_reshape = traindf [[ 'mpg' ]] In [ ]: y_train_reshape . shape Finally, there is a nice shortcut to reshaping an array. numpy can infer a dimension based on the other dimensions specified. In [ ]: y_train_reshape = y_train . values . reshape ( - 1 , 1 ) y_train_reshape . shape In this case, we said the second dimension should be size $1$. Since the requirement of the reshape() method is that the requested dimensions be compatible, numpy decides the the first dimension must be size $25$. What would the .shape return if we did y_train.values.reshape(-1,5) ? Okay, enough of that. The whole reason we went through that whole process was to show you how to reshape your data into the correct format. IMPORTANT: Remember that your response variable ytrain can be a vector but your predictor variable xtrain must be an array! Simple linear regression with automobile data We will now use sklearn to predict automobile mileage per gallon (mpg) and evaluate these predictions. We already loaded the data and split them into a training set and a test set. We need to choose the variables that we think will be good predictors for the dependent variable mpg . Exercise (10 min) Pick one variable to use as a predictor for simple linear regression. Create a markdown cell below and discuss your reasons. Justify your choice with some visualizations. Is there a second variable you'd like to use? For example, we're not doing multiple linear regression here, but if we were, is there another variable you'd like to include if we were using two predictors? In [ ]: # Your code here In [82]: y_mpg = dfcars . mpg x_wt = dfcars . wt x_hp = dfcars . hp fig_wt , ax_wt = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax_wt . scatter ( x_wt , y_mpg ) ax_wt . set_xlabel ( r 'Car Weight' ) ax_wt . set_ylabel ( r 'Car MPG' ) fig_hp , ax_hp = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax_hp . scatter ( x_hp , y_mpg ) ax_hp . set_xlabel ( r 'Car HP' ) ax_hp . set_ylabel ( r 'Car MPG' ) Out[82]: Exercise Use sklearn to fit the training data using simple linear regression. Use the model to make mpg predictions on the test set. Plot the data and the prediction. Print out the mean squared error for the training set and the test set and compare. Hints: Use the following to perform the analysis: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error In [83]: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error dfcars = pd . read_csv ( \"data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () Out[83]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 In [84]: traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) y_train = np . array ( traindf . mpg ) X_train = np . array ( traindf . wt ) X_train = X_train . reshape ( X_train . shape [ 0 ], 1 ) In [85]: y_test = np . array ( testdf . mpg ) X_test = np . array ( testdf . wt ) X_test = X_test . reshape ( X_test . shape [ 0 ], 1 ) #create linear model regression = LinearRegression () #fit linear model regression . fit ( X_train , y_train ) predicted_y = regression . predict ( X_test ) r2 = regression . score ( X_test , y_test ) print ( r2 ) 0.68797618576 In [86]: print ( regression . score ( X_train , y_train )) print ( mean_squared_error ( predicted_y , y_test )) print ( mean_squared_error ( y_train , regression . predict ( X_train ))) print ( 'Coefficients: \\n ' , regression . coef_ [ 0 ], regression . intercept_ ) 0.770137990979 12.4759856599 7.77369776639 Coefficients: -5.33694140056 36.9373103135 In [87]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( y_test , predicted_y , 'o' ) grid = np . linspace ( np . min ( dfcars . mpg ), np . max ( dfcars . mpg ), 100 ) ax . plot ( grid , grid , color = \"black\" ) # 45 degree line ax . set_xlabel ( \"actual y\" ) ax . set_ylabel ( \"predicted y\" ) fig1 , ax1 = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax1 . plot ( dfcars . wt , dfcars . mpg , 'o' ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) ax1 . plot ( xgrid , regression . predict ( xgrid . reshape ( 100 , 1 ))) Out[87]: [ ] $k$-nearest neighbors Great, so we did a simple linear regression on the car data. Now that you're familiar with sklearn , you're ready to do a KNN regression. Let's use $5$ nearest neighbors. In [ ]: from sklearn.neighbors import KNeighborsRegressor knnreg = KNeighborsRegressor ( n_neighbors = 5 ) In [ ]: knnreg . fit ( X_train , y_train ) r2 = knnreg . score ( X_test , y_test ) r2 Exercise What is the $R&#94;{2}$ score on the training set? In [ ]: # Your code here In [ ]: # solution knnreg . score ( X_train , y_train ) Lets vary the number of neighbors and see what we get. In [ ]: regdict = {} # Do a bunch of KNN regressions for k in [ 1 , 2 , 4 , 6 , 8 , 10 , 15 ]: knnreg = KNeighborsRegressor ( n_neighbors = k ) knnreg . fit ( X_train , y_train ) regdict [ k ] = knnreg # Store the regressors in a dictionary In [ ]: # Now let's plot it all fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( dfcars . wt , dfcars . mpg , 'o' , label = \"data\" ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) for k in [ 1 , 2 , 6 , 10 , 15 ]: predictions = regdict [ k ] . predict ( xgrid . reshape ( 100 , 1 )) if k in [ 1 , 6 , 15 ]: ax . plot ( xgrid , predictions , label = \" {} -NN\" . format ( k )) ax . legend (); Notice how the $1$-NN goes through every point on the training set but utterly fails elsewhere. Lets look at the scores on the training set. In [ ]: ks = range ( 1 , 15 ) # Grid of k's scores_train = [] # R2 scores for k in ks : knnreg = KNeighborsRegressor ( n_neighbors = k ) # Create KNN model knnreg . fit ( X_train , y_train ) # Fit the model to training data score_train = knnreg . score ( X_train , y_train ) # Calculate R&#94;2 score scores_train . append ( score_train ) # Plot fig , ax = plt . subplots ( 1 , 1 , figsize = ( 12 , 8 )) ax . plot ( ks , scores_train , 'o-' ) ax . set_xlabel ( r '$k$' ) ax . set_ylabel ( r '$R&#94; {2} $' ) Why do we get a perfect $R&#94;2$ at k=1? Exercise (5 min) Make the same plot as above on the test set. What is the best $k$? In [ ]: ks = range ( 1 , 15 ) # Grid of k's scores_test = [] # R2 scores for k in ks : knnreg = KNeighborsRegressor ( n_neighbors = k ) # Create KNN model knnreg . fit ( X_train , y_train ) # Fit the model to training data score_test = knnreg . score ( X_test , y_test ) # Calculate R&#94;2 score scores_test . append ( score_test ) # Plot fig , ax = plt . subplots ( 1 , 1 , figsize = ( 12 , 8 )) ax . plot ( ks , scores_test , 'o-' , ms = 12 ) ax . set_xlabel ( r '$k$' ) ax . set_ylabel ( r '$R&#94; {2} $' ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-3/solutions/"},{"title":"Lab 3: Scikit-learn for Regression","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A/STAT121A Introduction to Data Science Lab 3: KNN Regression, Simple Linear Regression Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Material Preparation: David Sondak, Will Claybaugh, Eleni Kaxiras. Run the cell below to properly highlight the exercises In [ ]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Table of Contents Array creation and reshape Some plotting Simple linear regression $k$-nearest neighbors Learning Goals Overall description and goal for the lab. By the end of this lab, you should be able to: Understand array reshaping Review how to make plots Feel comfortable with simple linear regression Feel comfortable with $k$ nearest neighbors This lab corresponds to lecture 4 and maps on to homework 2 (and beyond). In [8]: # import the necessary libraries import warnings warnings . filterwarnings ( 'ignore' ) % matplotlib inline import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd import time pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn as sns Simple Linear Regression Linear regression and its many extensions are a workhorse of the statistics and data science community, both in application and as a reference point for other models. Most of the major concepts in machine learning can be and often are discussed in terms of various linear regression models. Thus, this section will introduce you to building and fitting linear regression models and some of the process behind it, so that you can 1) fit models to data you encounter 2) experiment with different kinds of linear regression and observe their effects 3) see some of the technology that makes regression models work. Linear regression with a toy dataset We first examine a toy problem, focusing our efforts on fitting a linear model to a small dataset with three observations. Each observation consists of one predictor $x_i$ and one response $y_i$ for $i = 1, 2, 3$, \\begin{align*} (x , y) = \\{(x_1, y_1), (x_2, y_2), (x_3, y_3)\\}. \\end{align*} To be very concrete, let's set the values of the predictors and responses. \\begin{equation*} (x , y) = \\{(1, 2), (2, 2), (3, 4)\\} \\end{equation*} There is no line of the form $\\beta_0 + \\beta_1 x = y$ that passes through all three observations, since the data are not collinear. Thus our aim is to find the line that best fits these observations in the least-squares sense , as discussed in lecture. Exercise (10 min) Make two numpy arrays out of this data, x_train and y_train Check the dimentions of these arrays Try to reshape them into a different shape Make points into a very simple scatterplot Make a better scatterplot In [28]: # your code here x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 3 , 6 ]) type ( x_train ) Out[28]: numpy.ndarray In [12]: x_train . shape Out[12]: (3,) In [14]: x_train = x_train . reshape ( 3 , 1 ) x_train . shape Out[14]: (3, 1) In [15]: xx = np . array ([[ 1 , 3 , 5 ],[ 6 , 2 , 1 ]]) xx . shape Out[15]: (2, 3) In [18]: xx = xx . reshape ( 3 , - 1 ) xx Out[18]: array([[1, 3], [5, 6], [2, 1]]) In [29]: # %load solutions/simple_scatterplot.py # Make a simple scatterplot plt . scatter ( x_train , y_train ) # check dimensions print ( x_train . shape , y_train . shape ) (3,) (3,) In [38]: # %load solutions/nice_scatterplot.py def nice_scatterplot ( x , y , title ): # font size f_size = 18 # make the figure fig , ax = plt . subplots ( 1 , 1 , figsize = ( 8 , 5 )) # Create figure object # set axes limits to make the scale nice ax . set_xlim ( np . min ( x ) - 1 , np . max ( x ) + 1 ) ax . set_ylim ( np . min ( y ) - 1 , np . max ( y ) + 1 ) # adjust size of tickmarks in axes ax . tick_params ( labelsize = f_size ) # remove tick labels ax . tick_params ( labelbottom = False , bottom = False ) # adjust size of axis label ax . set_xlabel ( r '$x$' , fontsize = f_size ) ax . set_ylabel ( r '$y$' , fontsize = f_size ) # set figure title label ax . set_title ( title , fontsize = f_size ) # you may set up grid with this ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.15 ) # make actual plot (Notice the label argument!) #ax.scatter(x, y, label=r'$my points$') #ax.scatter(x, y, label='$my points$') ax . scatter ( x , y , label = r '$my\\,points$' ) ax . legend ( loc = 'best' , fontsize = f_size ); return ax nice_scatterplot ( x_train , y_train , 'hello nice plot' ) Out[38]: Formulae Linear regression is special among the models we study beuase it can be solved explicitly. While most other models (and even some advanced versions of linear regression) must be solved itteratively, linear regression has a formula where you can simply plug in the data. For the single predictor case it is: \\begin{align} \\beta_1 &= \\frac{\\sum_{i=1}&#94;n{(x_i-\\bar{x})(y_i-\\bar{y})}}{\\sum_{i=1}&#94;n{(x_i-\\bar{x})&#94;2}}\\\\ \\beta_0 &= \\bar{y} - \\beta_1\\bar{x}\\ \\end{align} Where $\\bar{y}$ and $\\bar{x}$ are the mean of the y values and the mean of the x values, respectively. From the re-aranged second equation we can see that the best-fit line passes through $(\\bar{x},\\bar{y})$, the center of mass of the data From any of the first equations, we can see that the slope of the line has to do with whether or not an x value that is above/below the center of mass is typically paired with a y value that is likewise above/below, or typically paired with one that is opposite. Building a model from scratch In this part, we will solve the equations for simple linear regression and find the best fit solution to our toy problem. The snippets of code below implement the linear regression equations on the observed predictors and responses, which we'll call the training data set. Let's walk through the code. We have to reshape our arrrays to 2D. We will see later why. Exercise (5 min) make an array with shape (2,3) reshape it to a size that you want In [ ]: # your code here xx = np . array ([[ 1 , 2 , 3 ],[ 4 , 6 , 8 ]]) xxx = xx . reshape ( - 1 , 2 ) xxx . shape In [39]: # Reshape to be a proper 2D array x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) print ( x_train . shape ) (3, 1) In [40]: # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) print ( numerator . shape , denominator . shape ) #check shapes () () Why the empty brackets? (The numerator and denominator are scalars, as expected.) In [47]: #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar print ( \"The best-fit line is {0:3.2f} + {1:3.2f} * x\" . format ( beta_0 , beta_1 )) print ( f 'The best fit is {beta_0} ' ) The best-fit line is -0.33 + 2.00 * x The best fit is -0.3333333333333335 Exercise (5 min) Turn the code from the above cells into a function called simple_linear_regression_fit , that inputs the training data and returns beta0 and beta1 . To do this, copy and paste the code from the above cells below and adjust the code as needed, so that the training data becomes the input and the betas become the output. def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : return Check your function by calling it with the training data from above and printing out the beta values. In [ ]: # Your code here In [50]: # %load solutions/simple_linear_regression_fit.py def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : \"\"\" Inputs: x_train: a (num observations by 1) array holding the values of the predictor variable y_train: a (num observations by 1) array holding the values of the response variable Returns: beta_vals: a (num_features by 1) array holding the intercept and slope coeficients \"\"\" # Check input array sizes if len ( x_train . shape ) < 2 : print ( \"Reshaping features array.\" ) x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) if len ( y_train . shape ) < 2 : print ( \"Reshaping observations array.\" ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar return np . array ([ beta_0 , beta_1 ]) Let's run this function and see the coefficients In [55]: x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 2 , 4 ]) betas = simple_linear_regression_fit ( x_train , y_train ) beta_0 = betas [ 0 ] beta_1 = betas [ 1 ] print ( \"The best-fit line is {0:8.6f} + {1:8.6f} * x\" . format ( beta_0 , beta_1 )) Reshaping features array. Reshaping observations array. The best-fit line is 0.666667 + 1.000000 * x Exercise (5 min) Do the values of beta0 and beta1 seem reasonable? Plot the training data using a scatter plot. Plot the best fit line with beta0 and beta1 together with the training data. In [ ]: # Your code here In [65]: # %load solutions/best_fit_scatterplot.py fig_scat , ax_scat = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Plot best-fit line x_train = np . array ([[ 1 , 2 , 3 ]]) . T best_fit = beta_0 + beta_1 * x_train ax_scat . scatter ( x_train , y_train , s = 300 , label = 'Training Data' ) ax_scat . plot ( x_train , best_fit , ls = '--' , label = 'Best Fit Line' ) ax_scat . set_xlabel ( r '$x_ {train} $' ) ax_scat . set_ylabel ( r '$y$' ); The values of beta0 and beta1 seem roughly reasonable. They capture the positive correlation. The line does appear to be trying to get as close as possible to all the points. Building a model with statsmodels and sklearn Now that we can concretely fit the training data from scratch, let's learn two python packages to do it all for us: statsmodels and scikit-learn (sklearn) . Our goal is to show how to implement simple linear regression with these packages. For an important sanity check, we compare the $\\beta$ values from statsmodels and sklearn to the $\\beta$ values that we found from above with our own implementation. For the purposes of this lab, statsmodels and sklearn do the same thing. More generally though, statsmodels tends to be easier for inference [finding the values of the slope and intercept and dicussing uncertainty in those values], whereas sklearn has machine-learning algorithms and is better for prediction [guessing y values for a given x value]. (Note that both packages make the same guesses, it's just a question of which activity they provide more support for. Note: statsmodels and sklearn are different packages! Unless we specify otherwise, you can use either one. Below is the code for statsmodels . Statsmodels does not by default include the column of ones in the $X$ matrix, so we include it manually with sm.add_constant . In [58]: import statsmodels.api as sm In [66]: # create the X matrix by appending a column of ones to x_train X = sm . add_constant ( x_train ) # this is the same matrix as in our scratch problem! print ( X ) # build the OLS model (ordinary least squares) from the training data toyregr_sm = sm . OLS ( y_train , X ) # do the fit and save regression info (parameters, etc) in results_sm results_sm = toyregr_sm . fit () # pull the beta parameters out from results_sm beta0_sm = results_sm . params [ 0 ] beta1_sm = results_sm . params [ 1 ] print ( \"The regression coefficients from the statsmodels package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_sm , beta1_sm )) [[ 1. 1.] [ 1. 2.] [ 1. 3.]] The regression coefficients from the statsmodels package are: beta_0 = 0.666667 and beta_1 = 1.000000 Besides the beta parameters, results_sm contains a ton of other potentially useful information. In [60]: import warnings warnings . filterwarnings ( 'ignore' ) print ( results_sm . summary ()) OLS Regression Results ============================================================================== Dep. Variable: y R-squared: 0.750 Model: OLS Adj. R-squared: 0.500 Method: Least Squares F-statistic: 3.000 Date: Fri, 21 Sep 2018 Prob (F-statistic): 0.333 Time: 11:31:12 Log-Likelihood: -2.0007 No. Observations: 3 AIC: 8.001 Df Residuals: 1 BIC: 6.199 Df Model: 1 Covariance Type: nonrobust ============================================================================== coef std err t P>|t| [0.025 0.975] ------------------------------------------------------------------------------ const 0.6667 1.247 0.535 0.687 -15.181 16.514 x1 1.0000 0.577 1.732 0.333 -6.336 8.336 ============================================================================== Omnibus: nan Durbin-Watson: 3.000 Prob(Omnibus): nan Jarque-Bera (JB): 0.531 Skew: -0.707 Prob(JB): 0.767 Kurtosis: 1.500 Cond. No. 6.79 ============================================================================== Warnings: [1] Standard Errors assume that the covariance matrix of the errors is correctly specified. Now let's turn our attention to the sklearn library. In [67]: from sklearn import linear_model In [68]: # build the least squares model toyregr = linear_model . LinearRegression () # save regression info (parameters, etc) in results_skl results = toyregr . fit ( x_train , y_train ) # pull the beta parameters out from results_skl beta0_skl = toyregr . intercept_ beta1_skl = toyregr . coef_ [ 0 ] print ( \"The regression coefficients from the sklearn package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_skl , beta1_skl )) The regression coefficients from the sklearn package are: beta_0 = 0.666667 and beta_1 = 1.000000 We should feel pretty good about ourselves now, and we're ready to move on to a real problem! The shape of things in scikit-learn Before diving right in to a \"real\" problem, we really ought to discuss more of the details of sklearn . We do this now. Along the way, we'll import the real-world dataset. Scikit-learn is the main python machine learning library. It consists of many learners which can learn models from data, as well as a lot of utility functions such as train_test_split . It can be used in python by the incantation import sklearn . In scikit-learn, an estimator is a Python object that implements the methods fit(X, y) and predict(T) Let's see the structure of scikit-learn needed to make these fits. .fit always takes two arguments: estimator . fit ( Xtrain , ytrain ) We will consider two estimators in this lab: LinearRegression and KNeighborsRegressor . Critically, Xtrain must be in the form of an array of arrays (or a 2x2 array) with the inner arrays each corresponding to one sample, and whose elements correspond to the feature values for that sample (visuals coming in a moment). ytrain on the other hand is a simple array of responses. These are continuous for regression problems. Practice with sklearn We begin by loading up the mtcars dataset and cleaning it up a little bit. In [73]: import pandas as pd #load mtcars dfcars = pd . read_csv ( \"data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"car name\" }) dfcars . head () Out[73]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } car name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Next, let's split the dataset into a training set and test set. In [74]: # split into training set and testing set from sklearn.model_selection import train_test_split #set random_state to get the same split every time traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) In [75]: # testing set is around 20% of the total data; training set is around 80% print ( \"Shape of full dataset is: {0} \" . format ( dfcars . shape )) print ( \"Shape of training dataset is: {0} \" . format ( traindf . shape )) print ( \"Shape of test dataset is: {0} \" . format ( testdf . shape )) Shape of full dataset is: (32, 12) Shape of training dataset is: (25, 12) Shape of test dataset is: (7, 12) Now we have training and test data. We still need to select a predictor and a response from this dataset. Keep in mind that we need to choose the predictor and response from both the training and test set. You will do this in the exercises below. However, we provide some starter code for you to get things going. In [76]: # Extract the response variable that we're interested in y_train = traindf . mpg Notice the shape of y_train . In [77]: np . shape ( y_train ) Out[77]: (25,) Another way to see the shape is to use the shape method. In [78]: y_train . shape Out[78]: (25,) This is not an \"array of arrays\". That's okay! Remember, sklearn requires an array of arrays only for the predictor array! You will have to pay close attention to this in the exercises later. For now, let's discuss two ways out of this debacle. All we'll do is get y_train to be an array of arrays. This doesn't hurt anything because sklearn doesn't care too much about the shape of y_train . First, let's reshape y_train to be an array of arrays using the reshape method. We want the first dimension of y_train to be size $25$ and the second dimension to be size $1$. In [79]: y_train_reshape = y_train . values . reshape ( y_train . shape [ 0 ], 1 ) In [80]: y_train_reshape . shape Out[80]: (25, 1) Notice that y_train.shape[0] gives the size of the first dimension. There's an even easier way to get the correct shape right from the beginning. In [ ]: y_train_reshape = traindf [[ 'mpg' ]] In [ ]: y_train_reshape . shape Finally, there is a nice shortcut to reshaping an array. numpy can infer a dimension based on the other dimensions specified. In [ ]: y_train_reshape = y_train . values . reshape ( - 1 , 1 ) y_train_reshape . shape In this case, we said the second dimension should be size $1$. Since the requirement of the reshape() method is that the requested dimensions be compatible, numpy decides the the first dimension must be size $25$. What would the .shape return if we did y_train.values.reshape(-1,5) ? Okay, enough of that. The whole reason we went through that whole process was to show you how to reshape your data into the correct format. IMPORTANT: Remember that your response variable ytrain can be a vector but your predictor variable xtrain must be an array! Simple linear regression with automobile data We will now use sklearn to predict automobile mileage per gallon (mpg) and evaluate these predictions. We already loaded the data and split them into a training set and a test set. We need to choose the variables that we think will be good predictors for the dependent variable mpg . Exercise (10 min) Pick one variable to use as a predictor for simple linear regression. Create a markdown cell below and discuss your reasons. Justify your choice with some visualizations. Is there a second variable you'd like to use? For example, we're not doing multiple linear regression here, but if we were, is there another variable you'd like to include if we were using two predictors? In [ ]: # Your code here In [82]: # %load solutions/cars_simple_EDA.py y_mpg = dfcars . mpg x_wt = dfcars . wt x_hp = dfcars . hp fig_wt , ax_wt = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax_wt . scatter ( x_wt , y_mpg ) ax_wt . set_xlabel ( r 'Car Weight' ) ax_wt . set_ylabel ( r 'Car MPG' ) fig_hp , ax_hp = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax_hp . scatter ( x_hp , y_mpg ) ax_hp . set_xlabel ( r 'Car HP' ) ax_hp . set_ylabel ( r 'Car MPG' ) Out[82]: Exercise Use sklearn to fit the training data using simple linear regression. Use the model to make mpg predictions on the test set. Plot the data and the prediction. Print out the mean squared error for the training set and the test set and compare. Hints: Use the following to perform the analysis: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error In [83]: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error dfcars = pd . read_csv ( \"data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () Out[83]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 In [84]: traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) y_train = np . array ( traindf . mpg ) X_train = np . array ( traindf . wt ) X_train = X_train . reshape ( X_train . shape [ 0 ], 1 ) In [85]: y_test = np . array ( testdf . mpg ) X_test = np . array ( testdf . wt ) X_test = X_test . reshape ( X_test . shape [ 0 ], 1 ) #create linear model regression = LinearRegression () #fit linear model regression . fit ( X_train , y_train ) predicted_y = regression . predict ( X_test ) r2 = regression . score ( X_test , y_test ) print ( r2 ) 0.68797618576 In [86]: print ( regression . score ( X_train , y_train )) print ( mean_squared_error ( predicted_y , y_test )) print ( mean_squared_error ( y_train , regression . predict ( X_train ))) print ( 'Coefficients: \\n ' , regression . coef_ [ 0 ], regression . intercept_ ) 0.770137990979 12.4759856599 7.77369776639 Coefficients: -5.33694140056 36.9373103135 In [87]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( y_test , predicted_y , 'o' ) grid = np . linspace ( np . min ( dfcars . mpg ), np . max ( dfcars . mpg ), 100 ) ax . plot ( grid , grid , color = \"black\" ) # 45 degree line ax . set_xlabel ( \"actual y\" ) ax . set_ylabel ( \"predicted y\" ) fig1 , ax1 = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax1 . plot ( dfcars . wt , dfcars . mpg , 'o' ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) ax1 . plot ( xgrid , regression . predict ( xgrid . reshape ( 100 , 1 ))) Out[87]: [ ] $k$-nearest neighbors Great, so we did a simple linear regression on the car data. Now that you're familiar with sklearn , you're ready to do a KNN regression. Let's use $5$ nearest neighbors. In [ ]: from sklearn.neighbors import KNeighborsRegressor knnreg = KNeighborsRegressor ( n_neighbors = 5 ) In [ ]: knnreg . fit ( X_train , y_train ) r2 = knnreg . score ( X_test , y_test ) r2 Exercise What is the $R&#94;{2}$ score on the training set? In [ ]: # Your code here In [ ]: # solution knnreg . score ( X_train , y_train ) Lets vary the number of neighbors and see what we get. In [ ]: regdict = {} # Do a bunch of KNN regressions for k in [ 1 , 2 , 4 , 6 , 8 , 10 , 15 ]: knnreg = KNeighborsRegressor ( n_neighbors = k ) knnreg . fit ( X_train , y_train ) regdict [ k ] = knnreg # Store the regressors in a dictionary In [ ]: # Now let's plot it all fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( dfcars . wt , dfcars . mpg , 'o' , label = \"data\" ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) for k in [ 1 , 2 , 6 , 10 , 15 ]: predictions = regdict [ k ] . predict ( xgrid . reshape ( 100 , 1 )) if k in [ 1 , 6 , 15 ]: ax . plot ( xgrid , predictions , label = \" {} -NN\" . format ( k )) ax . legend (); Notice how the $1$-NN goes through every point on the training set but utterly fails elsewhere. Lets look at the scores on the training set. In [ ]: ks = range ( 1 , 15 ) # Grid of k's scores_train = [] # R2 scores for k in ks : knnreg = KNeighborsRegressor ( n_neighbors = k ) # Create KNN model knnreg . fit ( X_train , y_train ) # Fit the model to training data score_train = knnreg . score ( X_train , y_train ) # Calculate R&#94;2 score scores_train . append ( score_train ) # Plot fig , ax = plt . subplots ( 1 , 1 , figsize = ( 12 , 8 )) ax . plot ( ks , scores_train , 'o-' ) ax . set_xlabel ( r '$k$' ) ax . set_ylabel ( r '$R&#94; {2} $' ) Why do we get a perfect $R&#94;2$ at k=1? Exercise (5 min) Make the same plot as above on the test set. What is the best $k$? In [ ]: # Your code here In [ ]: # %load solutions/knn_regression.py if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-3/student/"},{"title":"Lab 4: Multiple and Polynomial Linear Regression","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 4: Multiple and Polynomial Regression Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Learning Goals Polynomial Regression, and Revisiting the Cab Data Multiple regression and exploring the Football data A nice trick for forward-backwards Learning Goals After this lab, you should be able to Implement arbitrary multiple regression models in both SK-learn and Statsmodels Interpret the coefficent estimates produced by each model, including transformed and dummy variables In [2]: import numpy as np import pandas as pd import matplotlib.pyplot as plt import statsmodels.api as sm from statsmodels.api import OLS from sklearn import preprocessing from sklearn.preprocessing import PolynomialFeatures from sklearn.metrics import r2_score from sklearn.model_selection import train_test_split from pandas.plotting import scatter_matrix import seaborn as sns % matplotlib inline statsmodels is focused on the inference task: guess good values for the betas and discuss how certain you are in those answers. sklearn is focused on the prediction task: given [new] data, guess what the response value is. As a result, statsmodels has lots of tools to discuss confidence, but isn't great at dealing with test sets. Sklearn is great at test sets and validations, but can't really discuss uncertainty in the parameters or predictions. In short: sklearn is about putting a line through it and predicting new values using that line. If the line gives good predictions on the test set, who cares about anything else? statsmodels assumes more about how the data were generated, and (if the assumptions are correct) can tell you about uncertainty in the results Some terms R-squared : An interpretable summary of how well the model did. 1 is perfect, 0 is a trivial baseline model, negative is worse than the trivial model F-statistic : A value testing whether we're likely to see these results (or even stronger ones) if none of the predictors actually mattered. Prob (F-statistic) : The probability that we'd see these results (or even stronger ones) if none of the predictors actually mattered. If this probability is small then either A) some combination of predictors actually matters or B) something rather unlikely has happened coef : The estimate of each beta. This has several sub-components: std err : The amount we'd expect this value to wiggle if we re-did the data collection and re-ran our model. More data tends to make this wiggle smaller, but sometimes the collected data just isn't enough to pin down a particular value. t and P>|t| : similar to the F-statistic, these measure the probability of seeing coefficients this big (or even bigger) if the given variable didn't actually matter. Small probability doesn't necessarily mean the value matters [0.025 0.975] : Endpoints of the 95% confidence interval. This is a interval drawn in a clever way and which gives an idea of where the true beta value might plausibly live. (If you want to understand why \"there's a 95% chance the true beta is in the interval\" is wrong , start a chat with Will : ) Part 1: Polynomial Regression, and Revisiting the Cab Data In [3]: # read in the data, break into train and test cab_df = pd . read_csv ( \"data/dataset_1.txt\" ) train_data , test_data = train_test_split ( cab_df , test_size =. 2 , random_state = 42 ) cab_df . head () Out[3]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } TimeMin PickupCount 0 860.0 33.0 1 17.0 75.0 2 486.0 13.0 3 300.0 5.0 4 385.0 10.0 In [4]: cab_df . shape Out[4]: (1250, 2) In [7]: # do some data cleaning X_train = train_data [ 'TimeMin' ] . values . reshape ( - 1 , 1 ) / 60 y_train = train_data [ 'PickupCount' ] . values X_test = test_data [ 'TimeMin' ] . values . reshape ( - 1 , 1 ) / 60 y_test = test_data [ 'PickupCount' ] . values def plot_cabs ( cur_model , poly_transformer = None ): # build the x values for the prediction line x_vals = np . arange ( 0 , 24 , . 1 ) . reshape ( - 1 , 1 ) # if needed, build the design matrix if poly_transformer : design_mat = poly_transformer . fit_transform ( x_vals ) else : design_mat = x_vals # make the prediction at each x value prediction = cur_model . predict ( design_mat ) # plot the prediction line, and the test data plt . plot ( x_vals , prediction , '.-' , color = 'k' , label = \"Prediction\" ) plt . scatter ( X_test , y_test , label = \"Test Data\" ) # label your plots plt . ylabel ( \"Number of Taxi Pickups\" ) plt . xlabel ( \"Time of Day (Hours Past Midnight)\" ) plt . legend () plt . show () In [8]: from sklearn.linear_model import LinearRegression fitted_cab_model0 = LinearRegression () . fit ( X_train , y_train ) plot_cabs ( fitted_cab_model0 ) In [9]: fitted_cab_model0 . score ( X_test , y_test ) Out[9]: 0.240661535615741 We can see that there's still a lot of variation in cab pickups that's not being caught by a linear fit. And the linear fit is predicting massively more pickups at 11:59pm than at 12:00am. However, we can add columns to our design matrix for $TimeMin&#94;2$ and $TimeMin&#94;3$ and so on, allowing a wigglier polynomial that will better fit the data. We'll be using sklearn's PolynomialFeatures to take some of the tedium out of building the new design matrix. In fact, if all we want is a formula like $y \\approx \\beta_0 + \\beta_1 x + \\beta_2 x&#94;2 + ...$ it will directly return the new design matrix. In [23]: tra = PolynomialFeatures ( 3 , include_bias = True ) xx1 = np . linspace ( 0 , 1 , 5 ) xx2 = np . linspace ( 9 , 10 , 5 ) xx1 , xx2 Out[23]: (array([ 0. , 0.25, 0.5 , 0.75, 1. ]), array([ 9. , 9.25, 9.5 , 9.75, 10. ])) In [28]: xx3 = np . concatenate ([ xx1 . reshape ( - 1 , 1 ), xx2 . reshape ( - 1 , 1 )], axis = 1 ) xx3 Out[28]: array([[ 0. , 9. ], [ 0.25, 9.25], [ 0.5 , 9.5 ], [ 0.75, 9.75], [ 1. , 10. ]]) In [29]: tra = PolynomialFeatures ( 2 , include_bias = False ) tra . fit_transform ( xx3 ) Out[29]: array([[ 0.00000000e+00, 9.00000000e+00, 0.00000000e+00, 0.00000000e+00, 8.10000000e+01], [ 2.50000000e-01, 9.25000000e+00, 6.25000000e-02, 2.31250000e+00, 8.55625000e+01], [ 5.00000000e-01, 9.50000000e+00, 2.50000000e-01, 4.75000000e+00, 9.02500000e+01], [ 7.50000000e-01, 9.75000000e+00, 5.62500000e-01, 7.31250000e+00, 9.50625000e+01], [ 1.00000000e+00, 1.00000000e+01, 1.00000000e+00, 1.00000000e+01, 1.00000000e+02]]) In [22]: transformer_3 = PolynomialFeatures ( 3 , include_bias = False ) new_features = transformer_3 . fit_transform ( X_train ) new_features Out[22]: array([[ 6.73333333e+00, 4.53377778e+01, 3.05274370e+02], [ 2.18333333e+00, 4.76694444e+00, 1.04078287e+01], [ 1.41666667e+00, 2.00694444e+00, 2.84317130e+00], ..., [ 1.96666667e+01, 3.86777778e+02, 7.60662963e+03], [ 1.17333333e+01, 1.37671111e+02, 1.61534104e+03], [ 1.42000000e+01, 2.01640000e+02, 2.86328800e+03]]) A few notes on PolynomialFeatures : The interface is a bit strange. PolynomialFeatures is a 'transformer' in sklearn. We'll be using several transformers that learn a transformation on the training data and then apply that transformation on future data. On these (more typical) transformers it makes sense to have a .fit() and a separate .transform() . With PolynomialFeatures, the .fit() is pretty trivial, and we often fit and transform in one command, as seen above. You rarely want to include_bias (a column of all 1s), since sklearn will add it automatically and statsmodels can just add_constant right before you fit to the design matrix If you want polynomial features for a several different variables, you should call .fit_transform() separately on each column and append all the results to the design matrix (unless you also want interaction terms between the newly-created features). See np.concatenate for joining arrays. In [ ]: fitted_cab_model3 = LinearRegression () . fit ( new_features , y_train ) plot_cabs ( fitted_cab_model3 , transformer_3 ) Exercise Questions : Calculate the polynomial model's $R&#94;2$ performance on the test set. Does the polynomial model improve on the purely linear model? Make a residual plot for the polynomial model. What does this plot tell us about the model? your answer here See code below Yes, the test set $R&#94;2$ is higher, and the visual fit to both data sets is much better. It even looks like the predicted number of pickups at 11:59 pm and 12:00 am are nearly equal. See the code below. The residuals are much more evenly spread than with the linear model [not shown, but trust us], but they still don't look like an even spread of gaussian noise. This makes it unlikely that the statsmodel assumptions are valid, and we might want to be careful about trusting confidence intervals, etc, and we may want to search for other models entirely. In [ ]: # your code here # test r-squared print ( \"Test R-squared:\" , fitted_cab_model3 . score ( transformer_3 . fit_transform ( X_test ), y_test )) In [ ]: # your code here design_mat = transformer_3 . fit_transform ( X_train ) prediction = fitted_cab_model3 . predict ( design_mat ) residual = y_train - prediction plt . scatter ( X_train , residual , label = \"Residual\" ) plt . axhline ( 0 , color = 'k' ) plt . title ( \"Residuals for the Cubic Model\" ) plt . ylabel ( \"Residual Number of Taxi Pickups\" ) plt . xlabel ( \"Time of Day (Hours Past Midnight)\" ) plt . legend () In [ ]: # your code here design_mat = X_train prediction = fitted_cab_model0 . predict ( design_mat ) residual = y_train - prediction plt . scatter ( X_train , residual , label = \"Residual\" ) plt . axhline ( 0 , color = 'k' ) plt . title ( \"Residuals for the Linear Model\" ) plt . ylabel ( \"Residual Number of Taxi Pickups\" ) plt . xlabel ( \"Time of Day (Hours Past Midnight)\" ) plt . legend () Other features Polynomial features are not the only constucted features that help fit the data. Because these data have a 24 hour cycle, we may want to build features that follow such a cycle. For example, $sin(24\\frac{x}{2\\pi})$, $sin(12\\frac{x}{2\\pi})$, $sin(8\\frac{x}{2\\pi})$. Other feature transformations are appropriate to other types of data. For instance certain feature transformations have been developed for geographical data. Part 2: Multiple regression and exploring the Football data Let's move on to a truly interesting dataset. The data imported below were scraped by Shubham Maurya and record various facts about players in the English Premier League. Our goal will be to fit models that predict the players' market value (what the player could earn when hired by a new team), as estimated by transfermrkt.com. name : Name of the player club : Club of the player age : Age of the player position : The usual position on the pitch position_cat : 1 for attackers, 2 for midfielders, 3 for defenders, 4 for goalkeepers market_value : As on transfermrkt.com on July 20th, 2017 page_views : Average daily Wikipedia page views from September 1, 2016 to May 1, 2017 fpl_value : Value in Fantasy Premier League as on July 20th, 2017 fpl_sel : % of FPL players who have selected that player in their team fpl_points : FPL points accumulated over the previous season region : 1 for England, 2 for EU, 3 for Americas, 4 for Rest of World nationality : Player's nationality new_foreign : Whether a new signing from a different league, for 2017/18 (till 20th July) age_cat : a categorical version of the Age feature club_id : a numerical version of the Club feature big_club : Whether one of the Top 6 clubs new_signing : Whether a new signing for 2017/18 (till 20th July) As always, we first import, verify, split, and explore the data. Part 2.1: Import and verification and grouping In [30]: league_df = pd . read_csv ( \"data/league_data.txt\" ) print ( league_df . dtypes ) league_df . head () name object club object age int64 position object position_cat int64 market_value float64 page_views int64 fpl_value float64 fpl_sel object fpl_points int64 region float64 nationality object new_foreign int64 age_cat int64 club_id int64 big_club int64 new_signing int64 dtype: object Out[30]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name club age position position_cat market_value page_views fpl_value fpl_sel fpl_points region nationality new_foreign age_cat club_id big_club new_signing 0 Alexis Sanchez Arsenal 28 LW 1 65.0 4329 12.0 17.10% 264 3.0 Chile 0 4 1 1 0 1 Mesut Ozil Arsenal 28 AM 1 50.0 4395 9.5 5.60% 167 2.0 Germany 0 4 1 1 0 2 Petr Cech Arsenal 35 GK 4 7.0 1529 5.5 5.90% 134 2.0 Czech Republic 0 6 1 1 0 3 Theo Walcott Arsenal 28 RW 1 20.0 2393 7.5 1.50% 122 1.0 England 0 4 1 1 0 4 Laurent Koscielny Arsenal 31 CB 3 22.0 912 6.0 0.70% 121 2.0 France 0 4 1 1 0 In [31]: league_df . shape Out[31]: (461, 17) In [32]: league_df . describe () Out[32]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } age position_cat market_value page_views fpl_value fpl_points region new_foreign age_cat club_id big_club new_signing count 461.000000 461.000000 461.000000 461.000000 461.000000 461.000000 460.000000 461.000000 461.000000 461.000000 461.000000 461.000000 mean 26.804772 2.180043 11.012039 763.776573 5.447939 57.314534 1.993478 0.034707 3.206074 10.334056 0.303688 0.145336 std 3.961892 1.000061 12.257403 931.805757 1.346695 53.113811 0.957689 0.183236 1.279795 5.726475 0.460349 0.352822 min 17.000000 1.000000 0.050000 3.000000 4.000000 0.000000 1.000000 0.000000 1.000000 1.000000 0.000000 0.000000 25% 24.000000 1.000000 3.000000 220.000000 4.500000 5.000000 1.000000 0.000000 2.000000 6.000000 0.000000 0.000000 50% 27.000000 2.000000 7.000000 460.000000 5.000000 51.000000 2.000000 0.000000 3.000000 10.000000 0.000000 0.000000 75% 30.000000 3.000000 15.000000 896.000000 5.500000 94.000000 2.000000 0.000000 4.000000 15.000000 1.000000 0.000000 max 38.000000 4.000000 75.000000 7664.000000 12.500000 264.000000 4.000000 1.000000 6.000000 20.000000 1.000000 1.000000 (Stratified) train/test split We want to make sure that the training and test data have appropriate representation of each region; it would be bad for the training data to entirely miss a region. This is especially important because some regions are rather rare. Exercise Questions : Use the train_test_split function to and its 'stratify' argument to split the data, keeping equal representation of each region (This will not work out of the box on this data. Deal with the resulting issue). Deal with the issue you encountered above. How did you deal with the error generated by train_test_split ? How did you justify your action? your answer here : See below. We pass the stratify argument the data that we want to keep even across train and test sets. See below. Since only one data point has a missing value, we just drop it. +/- one point doesn't seem like it would impact the analysis too much. Of course, someone who knew the premier league might be able to tell which region this player should be in and simply correct the missing value. In [33]: # your code here try : # Doesn't work: a value is missing train_data , test_data = train_test_split ( league_df , test_size = 0.2 , stratify = league_df [ 'region' ]) except : # Count the missing lines and drop them missing_rows = np . isnan ( league_df [ 'region' ]) print ( \"Uh oh, {} lines missing data! Dropping them\" . format ( np . sum ( missing_rows ))) league_df = league_df . dropna ( subset = [ 'region' ]) train_data , test_data = train_test_split ( league_df , test_size = 0.2 , stratify = league_df [ 'region' ]) Uh oh, 1 lines missing data! Dropping them In [34]: train_data . shape , test_data . shape Out[34]: ((368, 17), (92, 17)) Now that we won't be peeking at the test set, let's explore and look for patterns! We'll introduce a number of useful pandas and numpy functions along the way. Groupby Pandas' .groupby() function is a wonderful tool for data analysis. It allows us to analyze each of several subgroups. Many times, .groupby() is combined with .agg() to get a summary statistic for each subgroup. For instance: What is the average market value, median page views, and maximum fpl for each player position? In [35]: train_data . groupby ( 'position' ) . agg ({ 'market_value' : np . mean , 'page_views' : np . median , 'fpl_points' : np . max }) Out[35]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } market_value page_views fpl_points position AM 25.711538 1413.0 218 CB 9.476923 338.0 178 CF 13.852041 781.0 224 CM 11.361111 420.5 225 DM 13.339286 477.0 131 GK 6.237097 402.0 149 LB 8.490741 345.0 177 LM 4.375000 325.5 99 LW 14.243548 474.0 264 RB 7.824074 215.0 170 RM 10.600000 566.0 105 RW 10.972222 454.0 162 SS 7.300000 473.0 178 In [38]: train_data . position . unique () Out[38]: array(['CF', 'CM', 'CB', 'GK', 'RW', 'DM', 'RB', 'LB', 'LW', 'AM', 'LM', 'SS', 'RM'], dtype=object) In [39]: train_data . groupby ([ 'big_club' , 'position' ]) . agg ({ 'market_value' : np . mean , 'page_views' : np . mean , 'fpl_points' : np . mean }) Out[39]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } market_value page_views fpl_points big_club position 0 AM 13.208333 563.166667 68.666667 CB 4.771739 298.652174 41.152174 CF 8.878571 886.828571 55.428571 CM 5.687500 355.775000 38.325000 DM 7.777778 465.111111 42.722222 GK 4.137500 379.100000 44.900000 LB 5.065789 247.578947 51.526316 LM 4.375000 370.500000 52.833333 LW 6.309524 441.619048 45.523810 RB 4.750000 260.190476 51.904762 RM 4.333333 280.333333 1.666667 RW 7.967391 543.173913 48.695652 SS 7.300000 1969.000000 55.800000 1 AM 36.428571 2473.857143 142.857143 CB 20.868421 1016.789474 72.526316 CF 26.285714 2390.714286 84.714286 CM 27.571429 2158.142857 93.714286 DM 23.350000 1340.600000 63.300000 GK 10.054545 769.909091 52.909091 LB 16.625000 914.875000 70.500000 LW 30.905000 2150.100000 116.900000 RB 18.583333 994.166667 102.833333 RM 20.000000 2028.000000 94.000000 RW 28.250000 1415.750000 78.000000 Part 2.2: Linear regression on the football data This section of the lab focuses on fitting a model to the football data and interpreting the model results. The model we'll use is $$\\text{market_value} \\approx \\beta_0 + \\beta_1\\text{fpl_points} + \\beta_2\\text{age} + \\beta_3\\text{age}&#94;2 + \\beta_4log_2\\left(\\text{page_views}\\right) + \\beta_5\\text{new_signing} +\\beta_6\\text{big_club} + \\beta_7\\text{position_cat}$$ We're including a 2nd degree polynomial in age because we expect pay to increase as a player gains experience, but then decrease as they continue aging. We're taking the log of page views because they have such a large, skewed range and the transformed variable will have fewer outliers that could bias the line. We choose the base of the log to be 2 just to make interpretation cleaner. Exercise Questions : Build a design matrix function and fit this model to the training data. How good is the overall model? Interpret the regression model. What is the meaning of the coefficient for: age and age$&#94;2$ $log_2($page_views$)$ big_club What should a player do in order to improve their market value? How many page views should a player go get to increase their market value by 10? In [ ]: # your code here # building design matrices happens after explore y_train = train_data [ 'market_value' ] y_test = test_data [ 'market_value' ] def build_model2_design ( df ): design_mat = df [[ 'fpl_points' , 'age' , 'new_signing' , 'big_club' , 'position_cat' ]] . copy () design_mat [ 'log_views' ] = np . log2 ( df [ 'page_views' ]) design_mat [ 'age_squared' ] = df [ 'age' ] ** 2 #reindex so variables are in a pretty order design_mat = design_mat [[ 'fpl_points' , 'age' , 'age_squared' , 'log_views' , 'new_signing' , 'big_club' , 'position_cat' ]] design_mat = sm . add_constant ( design_mat ) return design_mat train_design = build_model2_design ( train_data ) test_design = build_model2_design ( test_data ) fitted_model_1 = OLS ( endog = y_train , exog = train_design , hasconst = True ) . fit () fitted_model_1 . summary () In [ ]: # your code here # test set r-squared r2_score ( y_test , fitted_model_1 . predict ( test_design )) your answer here The model is reasonably good. We're capturing about 67% of the variation in market values, and the test set confirms that we're not overfitting too badly. Look at the coefficients, depends upon your split.. Linear regression on non-experimental data can't determine causation, so we can't prove that a given relationship runs in the direction we might think. For instance, doing whatever it takes to get more page views probably doesn't meaningfully increase market value; it's likely the causation runs in the other direction and great players get more views. Even so, we can use page views to help us tell who is a great player and thus likely to be paid well. In [ ]: agecoef = fitted_model_1 . params . age age2coef = fitted_model_1 . params . age_squared In [ ]: x_vals = np . linspace ( - 100 , 100 , 1000 ) y_vals = agecoef * x_vals + age2coef * x_vals ** 2 plt . plot ( x_vals , y_vals ) plt . title ( \"Effect of Age\" ) plt . xlabel ( \"Age\" ) plt . ylabel ( \"Contribution to Predicted Market Value\" ) plt . show () Part 2.3: Turning Categorical Variables into multiple binary variables Of course, we have an error in how we've included player position. Even though the variable is numeric (1,2,3,4) and the model runs without issue, the value we're getting back is garbage. The interpretation, such as it is, is that there is an equal effect of moving from position category 1 to 2, from 2 to 3, and from 3 to 4, and that this effect is about -.61. In reality, we don't expect moving from one position category to another to be equivalent, nor for a move from category 1 to category 3 to be twice as important as a move from category 1 to category 2. We need to introduce better features to model this variable. We'll use pd.get_dummies to do the work for us. In [ ]: train_design_recoded = pd . get_dummies ( train_design , columns = [ 'position_cat' ], drop_first = True ) test_design_recoded = pd . get_dummies ( test_design , columns = [ 'position_cat' ], drop_first = True ) train_design_recoded . head () We've removed the original position_cat column and created three new ones. Why only three new columns? Why does pandas give us the option to drop the first category? Exercise Questions : If we're fitting a model without a constant, should we have three dummy columns or four dummy columns? Fit a model and interpret the coefficient of position_cat_2 . In [ ]: resu = OLS ( y_train , train_design_recoded ) . fit () resu . summary () In [ ]: r2_score ( y_test , resu . predict ( test_design_recoded )) In [ ]: train_design_recoded . shape , y_train . shape Answers : If our model does not have a constant, we must include all four dummy variable columns. If we drop one, we're not modeling any effect of being in that category, and effectively assuming the dropped category's effect is 0. Being in position 2 (instead of position 1) has an impact between -1.54 and +2.38 on a player's market value. Since we're using an intercept, the dropped category becomes the baseline and the effect of any dummy variable is the effect of being in that category instead of the baseline category. Part 3: A nice trick for forward-backwards XOR (operator &#94;) is a logical operation that only returns true when input differ. We can use it to implement forward-or-backwards selection when we want to keep track of whet predictors are \"left\" from a given list of predictors. The set analog is \"symmetric difference\". From the python docs: s.symmetric_difference(t) s &#94; t new set with elements in either s or t but not both In [ ]: set () &#94; set ([ 1 , 2 , 3 ]) In [ ]: set ([ 1 ]) &#94; set ([ 1 , 2 , 3 ]) In [ ]: set ([ 1 , 2 ]) &#94; set ([ 1 , 2 , 3 ]) Exercise Outline a step-forwards algorithm which uses this idea your answer here Start with no predictors in a set, selected_predictors . Then the \"xor\" will give the set of all predictors. Go through them 1-by -1, seeing which has the highest score/ OR lowestaic/bic. Add this predictor to the selected_predictors . Now repeat. The xor will eliminate this predictor from the remaining predictors. In the next iteration we will pick the next predictor which when combined with the first one gibes the lowest aic/bic of all 2-predictor models. We repeat. We finally chose the best bic model from the 1 -predictor models, 2-predictor models, 3-predictor models and so on... if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-4/solutions/"},{"title":"Lab 4: Multiple and Polynomial Linear Regression","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 4: Multiple and Polynomial Regression Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Rahul Dave Authors: Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas In [142]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Table of Contents Learning Goals Polynomial Regression, and Revisiting the Cab Data Multiple regression and exploring the Football data A nice trick for forward-backwards Learning Goals After this lab, you should be able to Implement arbitrary multiple regression models in both SK-learn and Statsmodels Interpret the coefficent estimates produced by each model, including transformed and dummy variables In [33]: import numpy as np import pandas as pd import matplotlib.pyplot as plt import statsmodels.api as sm from statsmodels.api import OLS from sklearn import preprocessing from sklearn.preprocessing import PolynomialFeatures from sklearn.metrics import r2_score from sklearn.model_selection import train_test_split from pandas.plotting import scatter_matrix import seaborn as sns % matplotlib inline statsmodels is focused on the inference task: guess good values for the betas and discuss how certain you are in those answers. sklearn is focused on the prediction task: given [new] data, guess what the response value is. As a result, statsmodels has lots of tools to discuss confidence, but isn't great at dealing with test sets. Sklearn is great at test sets and validations, but can't really discuss uncertainty in the parameters or predictions. In short: sklearn is about putting a line through it and predicting new values using that line. If the line gives good predictions on the test set, who cares about anything else? statsmodels assumes more about how the data were generated, and (if the assumptions are correct) can tell you about uncertainty in the results Some terms R-squared : An interpretable summary of how well the model did. 1 is perfect, 0 is a trivial baseline model, negative is worse than the trivial model F-statistic : A value testing whether we're likely to see these results (or even stronger ones) if none of the predictors actually mattered. Prob (F-statistic) : The probability that we'd see these results (or even stronger ones) if none of the predictors actually mattered. If this probability is small then either A) some combination of predictors actually matters or B) something rather unlikely has happened coef : The estimate of each beta. This has several sub-components: std err : The amount we'd expect this value to wiggle if we re-did the data collection and re-ran our model. More data tends to make this wiggle smaller, but sometimes the collected data just isn't enough to pin down a particular value. t and P>|t| : similar to the F-statistic, these measure the probability of seeing coefficients this big (or even bigger) if the given variable didn't actually matter. Small probability doesn't necessarily mean the value matters [0.025 0.975] : Endpoints of the 95% confidence interval. This is a interval drawn in a clever way and which gives an idea of where the true beta value might plausibly live. (If you want to understand why \"there's a 95% chance the true beta is in the interval\" is wrong , start a chat with Will : ) Part 1: Polynomial Regression, and Revisiting the Cab Data In [34]: # read in the data, break into train and test cab_df = pd . read_csv ( \"data/dataset_1.txt\" ) train_data , test_data = train_test_split ( cab_df , test_size =. 2 , random_state = 42 ) cab_df . head () In [35]: cab_df . shape In [36]: # do some data cleaning X_train = train_data [ 'TimeMin' ] . values . reshape ( - 1 , 1 ) / 60 y_train = train_data [ 'PickupCount' ] . values X_test = test_data [ 'TimeMin' ] . values . reshape ( - 1 , 1 ) / 60 y_test = test_data [ 'PickupCount' ] . values def plot_cabs ( cur_model , poly_transformer = None ): # build the x values for the prediction line x_vals = np . arange ( 0 , 24 , . 1 ) . reshape ( - 1 , 1 ) # if needed, build the design matrix if poly_transformer : design_mat = poly_transformer . fit_transform ( x_vals ) else : design_mat = x_vals # make the prediction at each x value prediction = cur_model . predict ( design_mat ) # plot the prediction line, and the test data plt . plot ( x_vals , prediction , color = 'k' , label = \"Prediction\" ) plt . scatter ( X_test , y_test , label = \"Test Data\" ) # label your plots plt . ylabel ( \"Number of Taxi Pickups\" ) plt . xlabel ( \"Time of Day (Hours Past Midnight)\" ) plt . legend () plt . show () In [37]: from sklearn.linear_model import LinearRegression fitted_cab_model0 = LinearRegression () . fit ( X_train , y_train ) plot_cabs ( fitted_cab_model0 ) In [39]: fitted_cab_model0 . score ( X_test , y_test ) We can see that there's still a lot of variation in cab pickups that's not being caught by a linear fit. And the linear fit is predicting massively more pickups at 11:59pm than at 12:00am. However, we can add columns to our design matrix for $TimeMin&#94;2$ and $TimeMin&#94;3$ and so on, allowing a wigglier polynomial that will better fit the data. We'll be using sklearn's PolynomialFeatures to take some of the tedium out of building the new design matrix. In fact, if all we want is a formula like $y \\approx \\beta_0 + \\beta_1 x + \\beta_2 x&#94;2 + ...$ it will directly return the new design matrix. In [38]: transformer_3 = PolynomialFeatures ( 3 , include_bias = False ) new_features = transformer_3 . fit_transform ( X_train ) new_features A few notes on PolynomialFeatures : The interface is a bit strange. PolynomialFeatures is a 'transformer' in sklearn. We'll be using several transformers that learn a transformation on the training data and then apply that transformation on future data. On these (more typical) transformers it makes sense to have a .fit() and a separate .transform() . With PolynomialFeatures, the .fit() is pretty trivial, and we often fit and transform in one command, as seen above. You rarely want to include_bias (a column of all 1s), since sklearn will add it automatically and statsmodels can just add_constant right before you fit to the design matrix If you want polynomial features for a several different variables, you should call .fit_transform() separately on each column and append all the results to the design matrix (unless you also want interaction terms between the newly-created features). See np.concatenate for joining arrays. In [8]: fitted_cab_model3 = LinearRegression () . fit ( new_features , y_train ) plot_cabs ( fitted_cab_model3 , transformer_3 ) Exercise Questions : Calculate the polynomial model's $R&#94;2$ performance on the test set. Does the polynomial model improve on the purely linear model? Make a residual plot for the polynomial model. What does this plot tell us about the model? your answer here In [9]: # your code here In [40]: # your code here In [41]: # your code here Other features Polynomial features are not the only constucted features that help fit the data. Because these data have a 24 hour cycle, we may want to build features that follow such a cycle. For example, $sin(24\\frac{x}{2\\pi})$, $sin(12\\frac{x}{2\\pi})$, $sin(8\\frac{x}{2\\pi})$. Other feature transformations are appropriate to other types of data. For instance certain feature transformations have been developed for geographical data. Part 2: Multiple regression and exploring the Football data Let's move on to a truly interesting dataset. The data imported below were scraped by Shubham Maurya and record various facts about players in the English Premier League. Our goal will be to fit models that predict the players' market value (what the player could earn when hired by a new team), as estimated by transfermrkt.com. name : Name of the player club : Club of the player age : Age of the player position : The usual position on the pitch position_cat : 1 for attackers, 2 for midfielders, 3 for defenders, 4 for goalkeepers market_value : As on transfermrkt.com on July 20th, 2017 page_views : Average daily Wikipedia page views from September 1, 2016 to May 1, 2017 fpl_value : Value in Fantasy Premier League as on July 20th, 2017 fpl_sel : % of FPL players who have selected that player in their team fpl_points : FPL points accumulated over the previous season region : 1 for England, 2 for EU, 3 for Americas, 4 for Rest of World nationality : Player's nationality new_foreign : Whether a new signing from a different league, for 2017/18 (till 20th July) age_cat : a categorical version of the Age feature club_id : a numerical version of the Club feature big_club : Whether one of the Top 6 clubs new_signing : Whether a new signing for 2017/18 (till 20th July) As always, we first import, verify, split, and explore the data. Part 2.1: Import and verification and grouping In [85]: league_df = pd . read_csv ( \"data/league_data.txt\" ) print ( league_df . dtypes ) league_df . head () In [86]: league_df . shape In [87]: league_df . describe () (Stratified) train/test split We want to make sure that the training and test data have appropriate representation of each region; it would be bad for the training data to entirely miss a region. This is especially important because some regions are rather rare. Exercise Questions : Use the train_test_split function to and its 'stratify' argument to split the data, keeping equal representation of each region (This will not work out of the box on this data. Deal with the resulting issue). Deal with the issue you encountered above. How did you deal with the error generated by train_test_split ? How did you justify your action? your answer here : In [88]: # your code here In [89]: train_data . shape , test_data . shape Now that we won't be peeking at the test set, let's explore and look for patterns! We'll introduce a number of useful pandas and numpy functions along the way. Groupby Pandas' .groupby() function is a wonderful tool for data analysis. It allows us to analyze each of several subgroups. Many times, .groupby() is combined with .agg() to get a summary statistic for each subgroup. For instance: What is the average market value, median page views, and maximum fpl for each player position? In [90]: train_data . groupby ( 'position' ) . agg ({ 'market_value' : np . mean , 'page_views' : np . median , 'fpl_points' : np . max }) In [91]: train_data . position . unique () In [92]: train_data . groupby ([ 'big_club' , 'position' ]) . agg ({ 'market_value' : np . mean , 'page_views' : np . mean , 'fpl_points' : np . mean }) Part 2.2: Linear regression on the football data This section of the lab focuses on fitting a model to the football data and interpreting the model results. The model we'll use is $$\\text{market_value} \\approx \\beta_0 + \\beta_1\\text{fpl_points} + \\beta_2\\text{age} + \\beta_3\\text{age}&#94;2 + \\beta_4log_2\\left(\\text{page_views}\\right) + \\beta_5\\text{new_signing} +\\beta_6\\text{big_club} + \\beta_7\\text{position_cat}$$ We're including a 2nd degree polynomial in age because we expect pay to increase as a player gains experience, but then decrease as they continue aging. We're taking the log of page views because they have such a large, skewed range and the transformed variable will have fewer outliers that could bias the line. We choose the base of the log to be 2 just to make interpretation cleaner. Exercise Questions : Build a design matrix function and fit this model to the training data. How good is the overall model? Interpret the regression model. What is the meaning of the coefficient for: age and age$&#94;2$ $log_2($page_views$)$ big_club What should a player do in order to improve their market value? How many page views should a player go get to increase their market value by 10? In [93]: # your code here In [94]: # your code here your answer here In [95]: agecoef = fitted_model_1 . params . age age2coef = fitted_model_1 . params . age_squared In [96]: x_vals = np . linspace ( - 100 , 100 , 1000 ) y_vals = agecoef * x_vals + age2coef * x_vals ** 2 plt . plot ( x_vals , y_vals ) plt . title ( \"Effect of Age\" ) plt . xlabel ( \"Age\" ) plt . ylabel ( \"Contribution to Predicted Market Value\" ) plt . show () Part 2.3: Turning Categorical Variables into multiple binary variables Of course, we have an error in how we've included player position. Even though the variable is numeric (1,2,3,4) and the model runs without issue, the value we're getting back is garbage. The interpretation, such as it is, is that there is an equal effect of moving from position category 1 to 2, from 2 to 3, and from 3 to 4, and that this effect is about -.61. In reality, we don't expect moving from one position category to another to be equivalent, nor for a move from category 1 to category 3 to be twice as important as a move from category 1 to category 2. We need to introduce better features to model this variable. We'll use pd.get_dummies to do the work for us. In [97]: train_design_recoded = pd . get_dummies ( train_design , columns = [ 'position_cat' ], drop_first = True ) test_design_recoded = pd . get_dummies ( test_design , columns = [ 'position_cat' ], drop_first = True ) train_design_recoded . head () We've removed the original position_cat column and created three new ones. Why only three new columns? Why does pandas give us the option to drop the first category? Exercise Questions : If we're fitting a model without a constant, should we have three dummy columns or four dummy columns? Fit a model and interpret the coefficient of position_cat_2 . In [109]: resu = OLS ( y_train , train_design_recoded ) . fit () resu . summary () In [110]: r2_score ( y_test , resu . predict ( test_design_recoded )) In [99]: train_design_recoded . shape , y_train . shape Answers : If our model does not have a constant, we must include all four dummy variable columns. If we drop one, we're not modeling any effect of being in that category, and effectively assuming the dropped category's effect is 0. Being in position 2 (instead of position 1) has an impact between -1.54 and +2.38 on a player's market value. Since we're using an intercept, the dropped category becomes the baseline and the effect of any dummy variable is the effect of being in that category instead of the baseline category. Part 3: A nice trick for forward-backwards XOR (operator &#94;) is a logical operation that only returns true when input differ. We can use it to implement forward-or-backwards selection when we want to keep track of whet predictors are \"left\" from a given list of predictors. The set analog is \"symmetric difference\". From the python docs: s.symmetric_difference(t) s &#94; t new set with elements in either s or t but not both In [1]: set () &#94; set ([ 1 , 2 , 3 ]) Out[1]: {1, 2, 3} In [2]: set ([ 1 ]) &#94; set ([ 1 , 2 , 3 ]) Out[2]: {2, 3} In [3]: set ([ 1 , 2 ]) &#94; set ([ 1 , 2 , 3 ]) Out[3]: {3} Exercise Outline a step-forwards algorithm which uses this idea your answer here if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-4/student/"},{"title":"Lab 5: Regularization and Cross-Validation - Solutions","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 5: Regularization and Cross-Validation Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Rahul Dave Authors: Kevin Rader, Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas Table of Contents Learning Goals Review of regularized regression Ridge regression with one predictor on a grid Ridge regression with polynomial features on a grid Cross-validation --- Multiple Estimates Cross-validation --- Finding the best regularization parameter Learning Goals In this lab, you will work with some noisy data. You will use simple linear and ridge regressions to fit linear, high-order polynomial features to the dataset. You will attempt to figure out what degree polynomial fits the dataset the best and ultimately use cross validation to determine the best polynomial order. Finally, you will automate the cross validation process using sklearn in order to determine the best regularization paramter for the ridge regression analysis on your dataset. By the end of this lab, you should: Really understand regularized regression principles. Have a good grasp of working with ridge regression through the sklearn API Understand the effects of the regularization (a.k.a penalization) parameter on fits from ridge regression Understand the ideas behind cross-validation Why is it necessary? Why is it important? Basic implementation details. Be able to use sklearn objects to automate the cross validation process. This lab corresponds to lectures 4 and 5 and maps on to homework 4 (and beyond). In [1]: % matplotlib inline import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn.apionly as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"poster\" ) Part 1: Review of regularized regression We briefly review the idea of regularization as introduced in lecture. Recall that in the ordinary least squares problem we find the regression coefficients $\\boldsymbol{\\beta}\\in\\mathbb{R}&#94;{m}$ that minimize the loss function \\begin{align*} L(\\boldsymbol{\\beta}) = \\frac{1}{n} \\sum_{i=1}&#94;n \\|y_i - \\boldsymbol{\\beta}&#94;T \\mathbf{x}_i\\|&#94;2. \\end{align*} Recall that we have $n$ observations. Here $y_i$ is the response variable for observation $i$ and $\\mathbf{x}_i\\in\\mathbb{R}&#94;{m}$ is a vector from the predictor matrix corresponding to observation $i$. The general idea behind regularization is to penalize the loss function to account for possibly very large values of the coefficients $\\boldsymbol{\\beta}$. Instead of minimizing $L(\\boldsymbol{\\beta})$, we minimize the regularized loss function \\begin{align*} L_{\\text{reg}}(\\boldsymbol{\\beta}) = L(\\boldsymbol{\\beta}) + \\lambda R(\\boldsymbol{\\beta}) \\end{align*} where $R(\\boldsymbol{\\beta})$ is a penalty function and $\\lambda$ is a scalar that weighs the relative importance of this penalty. In this lab we will explore one regularized regression model: ridge regression. In ridge regression, the penalty function is the sum of the squares of the parameters, which is written as \\begin{align*} L_{\\text{ridge}}(\\boldsymbol{\\beta}) = \\frac{1}{n} \\sum_{i=1}&#94;n \\|y_i - \\boldsymbol{\\beta}&#94;T \\mathbf{x}_i\\|&#94;2 + \\lambda \\sum_{j=1}&#94;m \\beta_{j}&#94;{2}. \\end{align*} In lecture, you also learned about LASSO regression in which the penalty function is the sum of the absolute values of the parameters. This is written as, \\begin{align*} L_{\\text{LASSO}}(\\boldsymbol{\\beta}) = \\frac{1}{n} \\sum_{i=1}&#94;n \\|y_i - \\boldsymbol{\\beta}&#94;T \\mathbf{x}_i\\|&#94;2 + \\lambda \\sum_{j=1}&#94;m |\\beta_j|. \\end{align*} In this lab, we will show how these optimization problems can be solved with sklearn to determine the model parameters $\\boldsymbol{\\beta}$. We will also show how to choose $\\lambda$ appropriately via cross-validation. Dataset You will work with a synthetic dataset contained in data/noisypopulation.csv . The data were generated from a specific function $f\\left(x\\right)$ (the actual form will not be revealed to you in this lab). Noise was added to the function to generate synthetic, noisy observations via $y = f\\left(x\\right) + \\epsilon$ where $\\epsilon$ was drawn from a random distribution. The idea here is that in real life the data you are working with often comes with noise. Even if you could make observations at every single value of $x$, the true function may still be obscured. Of course, the samples you actually take are usually a subset of all the possible observations. In this lab, we will refer to observations at every single value of $x$ as the population and the subset of observations as in-sample y or simply the observations . The dataset contains three columns: f is the true function value x is the predictor y is the measured response. In [2]: df = pd . read_csv ( \"data/noisypopulation.csv\" ) df . head () Out[2]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } f x y 0 0.047790 0.00 0.011307 1 0.051199 0.01 0.010000 2 0.054799 0.02 0.007237 3 0.058596 0.03 0.000056 4 0.062597 0.04 0.010000 In this lab, we will try out some regression methods to fit the data and see how well our model matches the true function f . In [3]: # Convert f, x, y to numpy array f = df . f . values x = df . x . values y = df . y . values df . shape Out[3]: (200, 3) Let's take a quick look at the dataset. We will plot the true function value and the population. In [4]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( x , y , '.' , alpha = 0.8 , label = r 'Population' ) ax . plot ( x , f , lw = 4 , label = 'True Response' ) ax . legend ( loc = 'upper left' ) ax . set_xlabel ( r '$x$' ) ax . set_ylabel ( r '$y$' ) fig . tight_layout () It is often the case that you just can't make observations at every single value of $x$. We will simulate this situation by making a random choice of $60$ points from the full $200$ points. We do it by choosing the indices randomly and then using these indices as a way of getting the appropriate samples. In [5]: indexes = np . sort ( np . random . choice ( x . shape [ 0 ], size = 60 , replace = False )) # Using sort to make plotting easier later indexes Out[5]: array([ 1, 2, 6, 9, 11, 16, 18, 24, 30, 41, 42, 44, 47, 49, 52, 53, 55, 59, 62, 65, 69, 76, 79, 85, 86, 95, 96, 99, 102, 103, 106, 107, 109, 111, 113, 122, 123, 127, 135, 139, 146, 149, 151, 152, 157, 160, 161, 162, 164, 165, 166, 168, 169, 171, 176, 177, 178, 182, 185, 199]) Note: If you are not familiar with the numpy sort method or the numpy random.choice() method, then please take a moment to look them up in the numpy documentation. Moving on, let's get the $60$ random samples from our dataset. In [6]: # Create a new dataframe from the random points sample_df = pd . DataFrame ( dict ( x = x [ indexes ], f = f [ indexes ], y = y [ indexes ])) # New dataframe sample_df . head () Out[6]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } f x y 0 0.051199 0.01 0.010000 1 0.054799 0.02 0.007237 2 0.071233 0.06 0.048360 3 0.085865 0.09 0.050510 4 0.096800 0.11 0.183821 Let's take one more look at our data to see which points we've selected. In [7]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( sample_df [ 'x' ], sample_df [ 'y' ], 's' , alpha = 0.4 , ms = 10 , label = \"in-sample y (observed)\" ) ax . plot ( x , y , '.' , label = r 'Population $y$' ) ax . plot ( x , f , lw = 4 , label = 'True Response' ) ax . legend ( loc = 'upper left' ) ax . set_xlabel ( r '$x$' ) ax . set_ylabel ( r '$y$' ) fig . tight_layout () Now we do our favorite thing and split the sample data into training and testing sets. Note that here we are actually getting indices instead of the actual training and test set. This is okay and is another way of generating train-test splits. In [8]: from sklearn.model_selection import train_test_split datasize = sample_df . shape [ 0 ] #split dataset using the index, as we have x, f, and y that we want to split. itrain , itest = train_test_split ( np . arange ( 60 ), train_size = 0.8 ) xtrain = sample_df . x [ itrain ] . values ftrain = sample_df . f [ itrain ] . values ytrain = sample_df . y [ itrain ] . values xtest = sample_df . x [ itest ] . values ftest = sample_df . f [ itest ] . values ytest = sample_df . y [ itest ] . values Great! At this point we've explored our data a little bit, selected a sample of the dataset, and done a train-test split on the sample dataset. Let's move on to the data analysis. We'll begin with ridge regression. In particular we'll do ridge regression on a single predictor and compare it with simple linear regression. To start, let's fit the old classic, linear regression. In [9]: from sklearn.linear_model import LinearRegression # fit the model to training data simp_reg = LinearRegression () . fit ( xtrain . reshape ( - 1 , 1 ), ytrain ) # save the beta coefficients beta0_sreg = simp_reg . intercept_ beta1_sreg = simp_reg . coef_ [ 0 ] print ( \"(beta0, beta1) = ( {0:8.6f} , {1:8.6f} )\" . format ( beta0_sreg , beta1_sreg )) (beta0, beta1) = (-0.011628, 1.083937) Part 2: Bootstrapping But wait! Unlike statsmodels , we don't get confidence intervals for the betas. Fortunately, we can bootstrap to build the confidence intervals Exercise 1 In the code below, two key steps of bootstrapping are missing. Fill in the code to draw sample indices with replacement and to fit the model to the bootstrap sample. You'll need numpy 's np.random.choice . Here's the function documentation in case you need it. Visualize the results, and use numpy 's np.percentile : function documentation . In [10]: N = 1000 bootstrap_beta1s = np . zeros ( N ) for cur_bootstrap_rep in range ( N ): # select indices that are in the resample (easiest way to be sure we grab y values that match the x values) inds_to_sample = np . random . choice ( xtrain . shape [ 0 ], size = xtrain . shape [ 0 ], replace = True ) # take the sample x_train_resample = xtrain [ inds_to_sample ] y_train_resample = ytrain [ inds_to_sample ] # fit the model bootstrap_model = LinearRegression () . fit ( x_train_resample . reshape ( - 1 , 1 ), y_train_resample ) # extract the beta1 and append bootstrap_beta1s [ cur_bootstrap_rep ] = bootstrap_model . coef_ [ 0 ] ## display the results # calculate 5th and 95th percentiles lower_limit , upper_limit = np . percentile ( bootstrap_beta1s ,[ 5 , 95 ]) # plot histogram and bounds fig , ax = plt . subplots ( 1 , 1 , figsize = ( 20 , 10 )) ax . hist ( bootstrap_beta1s , 20 , alpha = 0.6 , label = r \"Bootstrapped $\\beta_ {1} $ values\" ) ax . axvline ( lower_limit , color = 'red' , label = r \"$5$th Percentile ( {:.2f} )\" . format ( lower_limit )) ax . axvline ( upper_limit , color = 'black' , label = r \"$95$th Percentile ( {:.2f} )\" . format ( upper_limit )) # good plots have labels ax . set_xlabel ( r \"$\\beta_ {1} $ Values\" ) ax . set_ylabel ( \"Count (out of 1000 Bootstrap Replications)\" ) plt . title ( r \"Bootstrapped Values of $\\beta_ {1} $\" ) plt . legend (); From the above, we find that the bootstrap $90\\%$ confidence interval is well away from $0$. We can confidently say that $\\beta_{1}$ is not secretly $0$ and we're being fooled by randomness. Next we'll dive into ridge regression! Part 3: Ridge regression for Simple Linear Regression To begin, we'll use sklearn to do simple linear regression on the sampled training data. We'll then do ridge regression with the same data, setting the penalty parameter $\\lambda$ to zero. Setting $\\lambda = 0$ reduces the ridge problem to the simple ordinary least squares problem, so we expect the results of these models to be identical. We will store the regression coefficients in a dataframe for easy comparison. The cell below provides some code to set up the dataframe ahead of time. Notice that we don't know the actual values in the pandas series, so we just set them to NaN . We will overwrite these later. In [36]: regression_coeffs = dict () # Store regression coefficients from each model in a dictionary regression_coeffs [ 'OLS' ] = [ np . nan ] * 2 # Initialize to NaN regression_coeffs [ r 'Ridge $\\lambda = 0$' ] = [ np . nan ] * 2 dfResults = pd . DataFrame ( regression_coeffs ) # Create dataframe dfResults . rename ({ 0 : r '$\\beta_ {0} $' , 1 : r '$\\beta_ {1} $' }, inplace = True ) # Rename rows dfResults Out[36]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } OLS Ridge $\\lambda = 0$ $\\beta_{0}$ NaN NaN $\\beta_{1}$ NaN NaN We start with simple linear regression to get the ball rolling. In [52]: simp_reg = LinearRegression () # build the the ordinary least squares model simp_reg . fit ( xtrain . reshape ( - 1 , 1 ), ytrain ) # fit the model to training data # save the beta coefficients beta0_sreg = simp_reg . intercept_ beta1_sreg = simp_reg . coef_ [ 0 ] dfResults [ 'OLS' ][:] = [ beta0_sreg , beta1_sreg ] dfResults Out[52]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } OLS Ridge $\\lambda = 0$ $\\beta_{0}$ -0.011628 -0.011628 $\\beta_{1}$ 1.083937 1.083937 In [45]: #y_predict = lambda x : beta0_sreg + beta1_sreg*x # make predictions ypredict_ols = simp_reg . predict ( x . reshape ( - 1 , 1 )) ypredict_ols . shape Out[45]: (200,) We will use the above $\\boldsymbol\\beta$ coefficients as a benchmark for comparision to the ridge method. The same coefficients can be obtained with ridge regression, which we demonstrate now. For reference, here is the ridge regression documentation: sklearn.linear_model.Ridge . In [14]: from sklearn.linear_model import Ridge The snippet of code below implements the ridge regression with $\\lambda = 0$. Note: The weight $\\lambda$ is referred to as alpha in the documentation. Remark: $\\lambda$ goes by many names including, but not limited to: regularization parameter, penalization parameter, shrinking parameter, and weight. Regardless of these names, it is a hyperparameter. That is, you set it before you begin the training process. An algorithm can be very sensitive to its hyperparameters and we will discuss how a method for selecting the \"correct\" hyperparameter values later in this lab. In [51]: ridge_reg = Ridge ( alpha = 0 ) # build the ridge regression model with specified lambda, i.e. alpha ridge_reg . fit ( xtrain . reshape ( - 1 , 1 ), ytrain ) # fit the model to training data # save the beta coefficients beta0_ridge = ridge_reg . intercept_ beta1_ridge = ridge_reg . coef_ [ 0 ] ypredict_ridge = ridge_reg . predict ( x . reshape ( - 1 , 1 )) # make predictions everywhere dfResults [ r 'Ridge $\\lambda = 0$' ][:] = [ beta0_ridge , beta1_ridge ] dfResults Out[51]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } OLS Ridge $\\lambda = 0$ $\\beta_{0}$ NaN -0.011628 $\\beta_{1}$ NaN 1.083937 The beta coefficients for linear and ridge regressions coincide for $\\lambda = 0$, as expected. We plot the data and fits. In [47]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( xtrain , ytrain , 's' , alpha = 0.3 , ms = 10 , label = \"in-sample y (observed)\" ) # plot in-sample training data ax . plot ( x , y , '.' , alpha = 0.4 , label = \"population y\" ) # plot population data ax . plot ( x , f , ls = '-' , alpha = 0.4 , lw = 4 , label = \"True function\" ) ax . plot ( x , ypredict_ols , ls = '--' , lw = 4 , label = \"OLS\" ) # plot simple linear regression fit ax . plot ( x , ypredict_ridge , ls = '-.' , lw = 4 , label = \"Ridge\" ) # plot ridge regression fit ax . set_xlabel ( '$x$' ) ax . set_ylabel ( '$y$' ) ax . legend ( loc = 4 ); fig . tight_layout () Exercise 2 Explore the effect of $\\lambda$ on ridge regression. Make a plot with of the ridge regression predictions with $\\lambda = 0, 5, 10, 100$. Be sure to include a legend. What happens for very large $\\lambda$ (e.g. $\\lambda \\to \\infty$)? Your plot should look something like the following plot (doesn't have to be exact): In [17]: # Your code here fig , ax = plt . subplots ( 1 , 1 , figsize = ( 20 , 10 )) pen_params = [ 0 , 1 , 5 , 10 , 100 ] ax . plot ( x , f , ls = '-' , lw = 6 , alpha = 0.5 , label = \"True function\" ) ax . plot ( xtrain , ytrain , 's' , alpha = 0.5 , ms = 10 , label = \"in-sample y (observed)\" ) # plot in-sample training data for alpha in pen_params : ridge_reg = Ridge ( alpha = alpha ) # build the ridge regression model with specified lambda, i.e. alpha ridge_reg . fit ( xtrain . reshape ( - 1 , 1 ), ytrain ) # fit the model to training data ypredict_ridge = ridge_reg . predict ( x . reshape ( - 1 , 1 )) ax . plot ( x , ypredict_ridge , ls = '-.' , lw = 4 , label = r \"$\\lambda = {} $\" . format ( alpha )) # plot ridge regression fit ax . set_xlabel ( '$x$' ) ax . set_ylabel ( '$y$' ) ax . legend ( loc = 4 , fontsize = 24 ); fig . tight_layout () fig . savefig ( 'ridge_lambda.png' ) Part 3 Recap That was nice, but we were just doing simple linear regression. We really want to do more interesting regression problems like multilinear regression. We will do so in the next section. Part 4: Ridge regression with polynomial features on a grid Now we'll make a more complex model by adding polynomial features. Instead of building the linear model $y = \\beta_0 + \\beta_1 x$, we build a polynomial model $y = \\beta_0 + \\beta_1 x + \\beta_2 x&#94;2 + \\ldots \\beta_d x&#94;d$ for some $d$ to be determined. This regression will be linear though, since we'll be treating $x&#94;2, \\ldots, x&#94;d$ themselves as predictors in the linear model. The design matrix $\\mathbf{X}$ contains columns corresponding to $1, x, x&#94;2, \\ldots, x&#94;d$. To build it, we use sklearn . (The particular design matrix is also known as the Vandermonde matrix ). For example, if we have three observations \\begin{align*} \\left\\{\\left(x_{1}, y_{1}\\right), \\left(x_{2}, y_{2}\\right), \\left(x_{3}, y_{3}\\right)\\right\\} \\end{align*} and we want polynomial features up to and including degree $4$, the design matrix looks like \\begin{align*} X = \\begin{bmatrix} x_1&#94;0 & x_1&#94;1 & x_1&#94;2 & x_1&#94;3 & x_1&#94;4\\\\ x_2&#94;0 & x_2&#94;1 & x_2&#94;2 & x_2&#94;3 & x_2&#94;4\\\\ x_3&#94;0 & x_3&#94;1 & x_3&#94;2 & x_3&#94;3 & x_3&#94;4\\\\ \\end{bmatrix} = \\begin{bmatrix} 1& x_1&#94;1 & x_1&#94;2 & x_1&#94;3 & x_1&#94;4\\\\ 1 & x_2&#94;1 & x_2&#94;2 & x_2&#94;3 & x_2&#94;4\\\\ 1 & x_3&#94;1 & x_3&#94;2 & x_3&#94;3 & x_3&#94;4\\\\ \\end{bmatrix}. \\end{align*} Exercise 3 Make a toy vector called toy , where \\begin{align*} \\mathrm{toy} = \\begin{bmatrix} 0 \\\\ 2 \\\\ 5 \\\\ \\end{bmatrix}. \\end{align*} Build the feature matrix up to (and including) degree $4$. Confirm that the entries in the matrix are what you'd expect based on the above discussion. Note: You may use sklearn to build the matrix using PolynomialFeatures() . In [18]: from sklearn.preprocessing import PolynomialFeatures In [19]: # your code here toy = np . array ([ 0 , 2 , 5 ]) PolynomialFeatures ( 4 ) . fit_transform ( toy . reshape ( - 1 , 1 )) Out[19]: array([[ 1., 0., 0., 0., 0.], [ 1., 2., 4., 8., 16.], [ 1., 5., 25., 125., 625.]]) We now continue working with our data. We write a function to make polynomial features of given degrees and we store the features in a dictionary. Exercise 4 The code provided below is missing a few lines and it's missing many comments. Do the following: Comment every line of the code Normally, you won't do such excessive commenting. In this case, we want to make sure you understand every single line since you didn't actually write this code. Fill in the missing lines Create a ridge regression object at each $\\lambda$ value in the list Perform the ridge regression using the fit method from the newly created ridge regression object Make a prediction on the grid and store the results in ypredict_ridge . Note: We're not giving you an example figure here since we gave you most of the code. Warning! Make sure you understand the entire code! There are many nice things in there. In [48]: d = 20 # Maximum polynomial degree # You will create a grid of plots of this size (7 x 2) rows = 7 cols = 2 lambdas = [ 0. , 1e-6 , 1e-3 , 1e-2 , 1e-1 , 1 , 10 ] # Various penalization parameters to try grid_to_predict = np . arange ( 0 , 1 , . 01 ) # Predictions will be made on this grid # Create training set and test set Xtrain = PolynomialFeatures ( d ) . fit_transform ( xtrain . reshape ( - 1 , 1 )) test_set = PolynomialFeatures ( d ) . fit_transform ( grid_to_predict . reshape ( - 1 , 1 )) fig , axs = plt . subplots ( rows , cols , sharex = 'col' , figsize = ( 12 , 24 )) # Set up plotting objects for i , lam in enumerate ( lambdas ): # your code here ridge_reg = Ridge ( alpha = lam ) # Create regression object ridge_reg . fit ( Xtrain , ytrain ) # Fit on regression object ypredict_ridge = ridge_reg . predict ( test_set ) # Do a prediction on the test set ### Provided code axs [ i , 0 ] . plot ( xtrain , ytrain , 's' , alpha = 0.4 , ms = 10 , label = \"in-sample y\" ) # Plot sample observations axs [ i , 0 ] . plot ( grid_to_predict , ypredict_ridge , 'k-' , label = r \"$\\lambda = {0} $\" . format ( lam )) # Ridge regression prediction axs [ i , 0 ] . set_ylabel ( '$y$' ) # y axis label axs [ i , 0 ] . set_ylim (( 0 , 1 )) # y axis limits axs [ i , 0 ] . set_xlim (( 0 , 1 )) # x axis limits axs [ i , 0 ] . legend ( loc = 'best' ) # legend coef = ridge_reg . coef_ . ravel () # Unpack the coefficients from the regression axs [ i , 1 ] . semilogy ( np . abs ( coef ), ls = ' ' , marker = 'o' , label = r \"$\\lambda = {0} $\" . format ( lam )) # plot coefficients axs [ i , 1 ] . set_ylim (( 1e-04 , 1e+15 )) # Set y axis limits axs [ i , 1 ] . set_xlim ( 1 , 20 ) # Set y axis limits axs [ i , 1 ] . yaxis . set_label_position ( \"right\" ) # Move y-axis label to right axs [ i , 1 ] . set_ylabel ( r '$\\left|\\beta_ {j} \\right|$' ) # Label y-axis axs [ i , 1 ] . legend ( loc = 'best' ) # Legend # Label x axes axs [ - 1 , 0 ] . set_xlabel ( \"x\" ) axs [ - 1 , 1 ] . set_xlabel ( r \"$j$\" ); As you can see, as we increase $\\lambda$ from 0 to 1, we start out overfitting, then doing well, and then our fits develop a mind of their own irrespective of data, as the penalty term dominates. Exercise 5 What would you expect if you compared a performance metric between these models on a grid? What performance metric should you use? YOUR DISCUSSION HERE Part 4 Recap We did a ridge regression on our dataset where the features were polynomial features. We also assessed the impact of the regularization parameter on the solution. Part 5: Cross-validation --- Finding the best penalization parameter Let's use cross-validation to determine the critical value of $\\lambda$, which we'll refer to as $\\lambda&#94;*$. To do this we use the concept of a meta-estimator from scikit-learn . Model selection is supported by two distinct meta-estimators: GridSearchCV RandomizedSearchCV The input to these meta-estimators is an estimator, which has some hyperparameters (e.g. $\\lambda$) that need to be optimized, and a set of hyperparameter settings to search through. The concept of a meta-estimator allows us to wrap, for example, cross-validation, or methods that build and combine simpler models or schemes. For example: est = Ridge () parameters = { \"alpha\" : [ 1e-8 , 1e-6 , 1e-5 , 5e-5 , 1e-4 , 5e-4 , 1e-3 , 1e-2 , 1e-1 , 1.0 ]} gridclassifier = GridSearchCV ( est , param_grid = parameters , cv = 4 , scoring = \"neg_mean_squared_error\" ) The GridSearchCV replaces the manual iteration over the folds using KFolds and the averaging we just did, doing it all for us. It takes a hyperparameter grid in the shape of a dictionary as input, and sets $\\lambda$ to the values you want to try, one by one. It then trains the model using cross-validation, and gets the error for each value of the hyperparameter $\\lambda$. Finally it compares the errors for the different $\\lambda$'s, and picks the best choice model. Here is a helper function that we will use to get the best Ridge regression. In [21]: from sklearn.model_selection import GridSearchCV def cv_optimize_ridge ( x : np . ndarray , y : np . ndarray , list_of_lambdas : list , n_folds : int = 4 ): est = Ridge () parameters = { 'alpha' : list_of_lambdas } # the scoring parameter below is the default one in ridge, but you can use a different one # in the cross-validation phase if you want. gs = GridSearchCV ( est , param_grid = parameters , cv = n_folds , scoring = \"neg_mean_squared_error\" ) gs . fit ( x , y ) return gs Exercise 6 Use the function above to fit the model on the training set with $4$-fold cross validation. Save the fit as the variable fitmodel . In [22]: lambs = [ 1e-8 , 1e-6 , 1e-5 , 5e-5 , 1e-4 , 5e-4 , 1e-3 , 1e-2 , 1e-1 , 1.0 , 10.0 ] # your code here fitmodel = cv_optimize_ridge ( Xtrain , ytrain , lambs , n_folds = 4 ) In [23]: print ( fitmodel . best_estimator_ , \" \\n \" ) print ( fitmodel . best_params_ , \" \\n \" ) print ( fitmodel . best_score_ , \" \\n \" ) Ridge(alpha=0.01, copy_X=True, fit_intercept=True, max_iter=None, normalize=False, random_state=None, solver='auto', tol=0.001) {'alpha': 0.01} -0.00428219133737 We also output the mean cross-validation error at different $\\lambda$ (with a negative sign, as scikit-learn likes to maximize negative error which is equivalent to minimizing error). In [24]: fitmodel . cv_results_ Out[24]: {'mean_fit_time': array([ 0.00076169, 0.0005492 , 0.00093275, 0.00092494, 0.00065297, 0.00775427, 0.00097436, 0.0007785 , 0.000678 , 0.00085598, 0.00073111]), 'mean_score_time': array([ 0.00022036, 0.00016773, 0.00028032, 0.00021076, 0.00020701, 0.00030631, 0.00032443, 0.00027955, 0.00023168, 0.00035763, 0.0002166 ]), 'mean_test_score': array([ -1.04422066e+02, -2.03879402e+00, -2.12533115e-02, -2.17426118e-02, -3.83217458e-02, -5.34829454e-02, -4.16644096e-02, -4.28219134e-03, -1.10864000e-02, -1.17298708e-02, -3.53276125e-02]), 'mean_train_score': array([-0.002438 , -0.00281841, -0.00288214, -0.00292148, -0.00295017, -0.00303469, -0.00307988, -0.00331017, -0.00390718, -0.00959672, -0.03183083]), 'param_alpha': masked_array(data = [1e-08 1e-06 1e-05 5e-05 0.0001 0.0005 0.001 0.01 0.1 1.0 10.0], mask = [False False False False False False False False False False False], fill_value = ?), 'params': ({'alpha': 1e-08}, {'alpha': 1e-06}, {'alpha': 1e-05}, {'alpha': 5e-05}, {'alpha': 0.0001}, {'alpha': 0.0005}, {'alpha': 0.001}, {'alpha': 0.01}, {'alpha': 0.1}, {'alpha': 1.0}, {'alpha': 10.0}), 'rank_test_score': array([11, 10, 4, 5, 7, 9, 8, 1, 2, 3, 6], dtype=int32), 'split0_test_score': array([-0.00210461, -0.00153636, -0.00135964, -0.00133985, -0.00135094, -0.00136229, -0.00137233, -0.0015771 , -0.00260748, -0.0128935 , -0.0498873 ]), 'split0_train_score': array([-0.00318839, -0.00369436, -0.00372455, -0.0037415 , -0.00374972, -0.00379193, -0.00383477, -0.00403662, -0.00462982, -0.01021204, -0.02983906]), 'split1_test_score': array([-0.00610722, -0.00633563, -0.00549197, -0.00473789, -0.00448339, -0.00432257, -0.00439472, -0.0048511 , -0.00712679, -0.01946326, -0.05587429]), 'split1_train_score': array([-0.00263924, -0.00279383, -0.00284313, -0.00291326, -0.00296615, -0.00308399, -0.00311842, -0.00320436, -0.00373486, -0.00851105, -0.02806184]), 'split2_test_score': array([-0.00823306, -0.00862512, -0.00842519, -0.00802683, -0.00779534, -0.00737807, -0.00726763, -0.00702939, -0.00706486, -0.0094168 , -0.0235004 ]), 'split2_train_score': array([-0.00136817, -0.001625 , -0.00164389, -0.00168626, -0.00173432, -0.00189061, -0.0019627 , -0.00224233, -0.00290861, -0.00891591, -0.03392184]), 'split3_test_score': array([ -4.17671818e+02, -8.13867896e+00, -6.97364430e-02, -7.28658796e-02, -1.39657311e-01, -2.00868856e-01, -1.53622963e-01, -3.67117515e-03, -2.75464611e-02, -5.14591715e-03, -1.20484595e-02]), 'split3_train_score': array([-0.00255619, -0.00316047, -0.003317 , -0.00334489, -0.0033505 , -0.00337222, -0.00340363, -0.00375736, -0.00435544, -0.01074789, -0.0355006 ]), 'std_fit_time': array([ 1.41258368e-04, 8.99215039e-05, 2.09890586e-04, 1.97631494e-04, 7.88685227e-05, 6.55120547e-03, 8.90124478e-05, 1.66172394e-04, 4.72181285e-05, 1.70332795e-04, 6.98077019e-05]), 'std_score_time': array([ 4.28389077e-05, 4.75195203e-06, 4.87682202e-05, 1.77032819e-05, 7.94934703e-06, 8.44413135e-05, 3.23465461e-05, 1.17804536e-04, 2.55688642e-05, 2.12778731e-04, 6.24114996e-06]), 'std_test_score': array([ 1.80854829e+02, 3.52177114e+00, 2.81040598e-02, 2.96105746e-02, 5.85504759e-02, 8.51198741e-02, 6.46729039e-02, 1.97240858e-03, 9.67828661e-03, 5.24066122e-03, 1.81380300e-02]), 'std_train_score': array([ 0.00066372, 0.00075979, 0.00077999, 0.00077096, 0.00075467, 0.00070687, 0.00069359, 0.00068542, 0.00066144, 0.0009146 , 0.0030005 ])} In [25]: fit_lambdas = [ d [ 'alpha' ] for d in fitmodel . cv_results_ [ 'params' ]] fit_scores = fitmodel . cv_results_ [ 'mean_test_score' ] Now we make a log-log plot of -fit_scores versus fit_lambdas . In [26]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( fit_lambdas , - fit_scores , ls = '-' , marker = 'o' ) ax . set_xscale ( 'log' ) ax . set_yscale ( 'log' ) ax . set_xlabel ( '$\\lambda$' ) ax . set_ylabel ( 'scores' ); SK-learn's cross_val_score : Easier Cross Validation GridSearchCV is an important tool when you are searching over many hyperparameters (and believe us, you will be), but when you only need to get CV scores for a particular model, some students find cross_val_score more intuitive. In [27]: from sklearn.model_selection import cross_val_score lr_object = Ridge ( alpha = 0 ) cross_val_score ( lr_object , Xtrain , ytrain , cv = 5 ) Out[27]: array([ -9.18613926e+06, -2.48009195e+01, -7.33851988e+01, 7.96497457e-01, -2.43993256e+09]) We can loop over particular models and get scores for each (equivalent to GridSearchCV over the given parameter settings). In [28]: for cur_alpha in [ 1e-8 , 1e-4 , 1e-2 , 1.0 , 10.0 ]: lr_object = Ridge ( alpha = cur_alpha ) scores = cross_val_score ( lr_object , Xtrain , ytrain , cv = 5 ) print ( \"lambda {0} \\t R&#94;2 scores: {1} \\t Mean R&#94;2: {2} \" . format ( cur_alpha , scores , np . mean ( scores ))) lambda 1e-08 R&#94;2 scores: [ 9.77939901e-01 9.32466926e-01 9.25087958e-01 7.70596878e-01 -1.01789793e+04] Mean R&#94;2: -2035.0746438893307 lambda 0.0001 R&#94;2 scores: [ 0.9856221 0.94641854 0.93300439 0.81490007 -3.77073188] Mean R&#94;2: -0.018157356572625627 lambda 0.01 R&#94;2 scores: [ 0.98186179 0.94562163 0.93554936 0.82937296 0.87111868] Mean R&#94;2: 0.9127048848528474 lambda 1.0 R&#94;2 scores: [ 0.85221091 0.82714737 0.80963734 0.88260439 0.89951329] Mean R&#94;2: 0.8542226608760588 lambda 10.0 R&#94;2 scores: [ 0.43557116 0.504026 0.48162533 0.64633357 0.7117304 ] Mean R&#94;2: 0.5558572925115726 Built-in Cross Validation: RidgeCV and LassoCV Some sklearn models have built-in, automated cross validation to tune their hyper parameters. In [29]: from sklearn.linear_model import RidgeCV ridgeCV_object = RidgeCV ( alphas = ( 1e-8 , 1e-4 , 1e-2 , 1.0 , 10.0 ), cv = 5 ) ridgeCV_object . fit ( Xtrain , ytrain ) print ( \"Best model searched: \\n alpha = {} \\n intercept = {} \\n betas = {} , \" . format ( ridgeCV_object . alpha_ , ridgeCV_object . intercept_ , ridgeCV_object . coef_ ) ) Best model searched: alpha = 0.01 intercept = -0.004754717116992713 betas = [ 0. 0.69341921 0.7422217 0.27075073 -0.09947963 -0.28256995 -0.32780739 -0.29382772 -0.22355048 -0.14377357 -0.06935955 -0.00731663 0.04012127 0.07338884 0.09423722 0.10491372 0.10769605 0.10465274 0.09754117 0.0877851 0.07649451], Important note: For any tool more automated than literally using k_fold, just setting cv=5 will NOT shuffle your data by default. This can be a problem with time-series data! To force shuffling, explicitly pass a KFold object (with shuffling turned on) to the cv argument You may prefer a strategy where you shuffle the rows of your data at the outset of analysis In [30]: # declare and pass a KFold object to properly shuffle the training data, and/or set the random state from sklearn.model_selection import KFold splitter = KFold ( 5 , random_state = 42 , shuffle = True ) ridgeCV_object = RidgeCV ( alphas = ( 1e-8 , 1e-4 , 1e-2 , 1.0 , 10.0 ), cv = splitter ) ridgeCV_object . fit ( Xtrain , ytrain ) print ( \"Best model searched: \\n alpha = {} \\n intercept = {} \\n betas = {} , \" . format ( ridgeCV_object . alpha_ , ridgeCV_object . intercept_ , ridgeCV_object . coef_ ) ) Best model searched: alpha = 0.01 intercept = -0.004754717116992713 betas = [ 0. 0.69341921 0.7422217 0.27075073 -0.09947963 -0.28256995 -0.32780739 -0.29382772 -0.22355048 -0.14377357 -0.06935955 -0.00731663 0.04012127 0.07338884 0.09423722 0.10491372 0.10769605 0.10465274 0.09754117 0.0877851 0.07649451], Part 5b: Refitting on full training set At this point, we have determined the best penalization parameter for the ridge regression on our current dataset using cross validation. Let's refit the estimator on the training set and calculate and plot the test set error and the polynomial coefficients. Notice how many of these coefficients have been pushed to lower values or 0. Exercise 7 Assign to variable est the classifier obtained by fitting the entire training set using the best $\\lambda$ found above. Assign the predictions to the variable ypredict_ridge_best . In [31]: # your code here best_lambda = fitmodel . best_params_ [ 'alpha' ] est = Ridge ( alpha = best_lambda ) . fit ( Xtrain , ytrain ) ypredict_ridge_best = est . predict ( test_set ) est . coef_ Out[31]: array([ 0. , 0.69341921, 0.7422217 , 0.27075073, -0.09947963, -0.28256995, -0.32780739, -0.29382772, -0.22355048, -0.14377357, -0.06935955, -0.00731663, 0.04012127, 0.07338884, 0.09423722, 0.10491372, 0.10769605, 0.10465274, 0.09754117, 0.0877851 , 0.07649451]) In [32]: # code provided from here on fig , axs = plt . subplots ( 1 , 2 , figsize = ( 12 , 4 )) left = 0 right = 1 axs [ left ] . plot ( x , f , lw = 4 , label = 'True Response' ) axs [ left ] . plot ( xtrain , ytrain , 's' , alpha = 0.3 , ms = 10 , label = \"in-sample y (observed)\" ) axs [ left ] . plot ( x , y , '.' , alpha = 0.8 , label = \"population y\" ) axs [ left ] . plot ( grid_to_predict , ypredict_ridge_best , 'k--' , label = r \"$\\lambda = {{ {0:1.4f} }}$\" . format ( best_lambda )) axs [ left ] . set_ylabel ( '$y$' ) axs [ left ] . set_ylim (( 0 , 1 )) axs [ left ] . set_xlim (( 0 , 1 )) axs [ left ] . legend ( loc = 2 ) coef = est . coef_ . ravel () axs [ right ] . semilogy ( np . abs ( coef ), marker = 'o' , label = r \"$\\lambda = {0} $\" . format ( best_lambda )) axs [ right ] . set_ylim (( 1e-04 , 1.0e+11 )) axs [ right ] . set_xlim ( 1 , 20 ) axs [ right ] . yaxis . set_label_position ( \"right\" ) axs [ right ] . set_ylabel ( r '$\\left|\\beta_ {j} \\right|$' ) axs [ right ] . legend ( loc = 'best' ) axs [ left ] . set_xlabel ( \"x\" ) axs [ right ] . set_xlabel ( r '$j$' ); In [49]: #One more nice plot: from sklearn.linear_model import Lasso ridge_coef = [] lasso_coef = [] for lamb in lambs : ridge_coef . append ( Ridge ( alpha = lamb ) . fit ( Xtrain , ytrain ) . coef_ ) lasso_coef . append ( Lasso ( alpha = lamb ) . fit ( Xtrain , ytrain ) . coef_ ) ridge_coef [ 0 : 2 ] /Users/krader/anaconda/lib/python3.6/site-packages/sklearn/linear_model/coordinate_descent.py:484: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations. Fitting data with very small alpha may cause precision problems. ConvergenceWarning) Out[49]: [array([ 0. , 1.01959051, -5.53929429, 29.44150715, -53.93355665, 20.47365746, 41.04441284, 1.75859441, -34.3729342 , -37.24889075, -13.5862036 , 16.23323089, 35.26279047, 36.26794064, 21.08634855, -2.72753881, -25.44040864, -37.78836324, -32.52401814, -5.0392544 , 46.64706122]), array([ 0. , 0.69137493, -0.83581145, 4.9179027 , -4.15650457, 1.50908912, 2.03157442, -2.29221713, -5.17735279, -4.15884132, -0.49733387, 3.3806434 , 5.63291862, 5.57230418, 3.52299763, 0.41783499, -2.60029392, -4.46734047, -4.36167693, -1.76571866, 3.54100409])] In [50]: fig , axs = plt . subplots ( 1 , 2 , figsize = ( 16 , 6 )) left = 0 right = 1 axs [ left ] . plot ( lambs , ridge_coef ) axs [ left ] . set_xscale ( \"log\" ) axs [ left ] . set_title ( \"Ridge polynomial coefficients as a function of lambda\" ) #axs[left].legend(loc='best') axs [ right ] . plot ( lambs , lasso_coef ) axs [ right ] . set_xscale ( \"log\" ) axs [ right ] . set_title ( \"Lasso polynomial coefficients as a function of lambda\" ) Out[50]: There are Kevin's favorite plots depicting how the $\\hat{\\beta}$s are affected with an increasing penalty factor. They need better labels, but there are too many to be labeled nicely. Presumably the orange line in the Lasso plot is for the linear term (it becomes important as the other terms \"drop out\"). if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-5/solutions/"},{"title":"Lab 5: Regularization and Cross-Validation - Student Version","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 5: Regularization and Cross-Validation Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Keivn Rader (today at least) Authors: Kevin Rader, Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas Table of Contents Learning Goals Review of regularized regression Bootstrapped Sampling Distributions and Confidence Intervals Ridge regression for Simple Regression Ridge regression with polynomial features on a grid Cross-validation --- Multiple Estimates Cross-validation --- Finding the best regularization parameter Learning Goals In this lab, you will work with some noisy data. You will use simple linear and ridge regressions to fit linear, high-order polynomial features to the dataset. You will attempt to figure out what degree polynomial fits the dataset the best and ultimately use cross validation to determine the best polynomial order. Finally, you will automate the cross validation process using sklearn in order to determine the best regularization paramter for the ridge regression analysis on your dataset. By the end of this lab, you should: Really understand regularized regression principles. Have a good grasp of working with ridge regression through the sklearn API Understand the effects of the regularization (a.k.a penalization or tuning) parameter on fits from ridge regression Understand the ideas behind cross-validation Why is it necessary? Why is it important? Basic implementation details. Be able to use sklearn objects to automate the cross validation process. This lab corresponds to lectures 5, 6, and 7 and maps to homework 4 (and beyond). In [ ]: % matplotlib inline import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn.apionly as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"poster\" ) Part 1: Review of regularized regression We briefly review the idea of regularization as introduced in lecture. Recall that in the ordinary least squares problem we find the regression coefficients $\\boldsymbol{\\beta}\\in\\mathbb{R}&#94;{m}$ that minimize the loss function \\begin{align*} L(\\boldsymbol{\\beta}) = \\frac{1}{n} \\sum_{i=1}&#94;n \\|y_i - \\boldsymbol{\\beta}&#94;T \\mathbf{x}_i\\|&#94;2. \\end{align*} Recall that we have $n$ observations. Here $y_i$ is the response variable for observation $i$ and $\\mathbf{x}_i\\in\\mathbb{R}&#94;{m}$ is a vector from the predictor matrix corresponding to observation $i$. The general idea behind regularization is to penalize the loss function to account for possibly very large values of the coefficients $\\boldsymbol{\\beta}$. Instead of minimizing $L(\\boldsymbol{\\beta})$, we minimize the regularized loss function \\begin{align*} L_{\\text{reg}}(\\boldsymbol{\\beta}) = L(\\boldsymbol{\\beta}) + \\lambda R(\\boldsymbol{\\beta}) \\end{align*} where $R(\\boldsymbol{\\beta})$ is a penalty function and $\\lambda$ is a scalar that weighs the relative importance of this penalty. In this lab we will explore one regularized regression model: ridge regression. In ridge regression, the penalty function is the sum of the squares of the parameters, which is written as \\begin{align*} L_{\\text{ridge}}(\\boldsymbol{\\beta}) = \\frac{1}{n} \\sum_{i=1}&#94;n \\|y_i - \\boldsymbol{\\beta}&#94;T \\mathbf{x}_i\\|&#94;2 + \\lambda \\sum_{j=1}&#94;m \\beta_{j}&#94;{2}. \\end{align*} In lecture, you also learned about LASSO regression in which the penalty function is the sum of the absolute values of the parameters. This is written as, \\begin{align*} L_{\\text{LASSO}}(\\boldsymbol{\\beta}) = \\frac{1}{n} \\sum_{i=1}&#94;n \\|y_i - \\boldsymbol{\\beta}&#94;T \\mathbf{x}_i\\|&#94;2 + \\lambda \\sum_{j=1}&#94;m |\\beta_j|. \\end{align*} In this lab, we will show how these optimization problems can be solved with sklearn to determine the model parameters $\\boldsymbol{\\beta}$. We will also show how to choose $\\lambda$ appropriately via cross-validation. Dataset We will work with a synthetic dataset contained in data/noisypopulation.csv . The data were generated from a specific function $f\\left(x\\right)$ (the actual mathematical form will remain a mystery). Noise was added to the function to generate synthetic, noisy (aka, real) observations via $y = f\\left(x\\right) + \\epsilon$ where $\\epsilon$ was drawn from a random distribution. Even if you could make observations at every single value of $x$, the true function may still be obscured. Of course, the data you actually observe are a subset of all the possible observations in the population. In this lab, we will refer to observations at every single value of $x$ as the population and the subset of observations as in-sample y or simply the observations . The dataset contains three columns: f is the true function value x is the predictor y is the measured response. In [ ]: df = pd . read_csv ( \"data/noisypopulation.csv\" ) df . head () In this lab, we will try out some regression methods to fit the data and see how well our model matches the true function f . In [ ]: # Convert f, x, y to numpy array f = df . f . values x = df . x . values y = df . y . values df . shape Let's take a quick look at the dataset. We will plot the true function value and the population. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( x , y , '.' , alpha = 0.8 , label = r 'Population' ) ax . plot ( x , f , lw = 4 , label = 'True Response' ) ax . legend ( loc = 'upper left' ) ax . set_xlabel ( r '$x$' ) ax . set_ylabel ( r '$y$' ) fig . tight_layout () It is often the case that you just can't make observations at every single value of $x$. We will simulate this situation by making a random choice of $60$ points from the full $200$ points. We do it by choosing the indices randomly and then using these indices as a way of getting the appropriate samples. In [ ]: #np.random.seed(12345) indexes = np . sort ( np . random . choice ( x . shape [ 0 ], size = 60 , replace = False )) # Note: using sort to make plotting easier later indexes Note: If you are not familiar with the numpy sort method or the numpy random.choice() method, then please take a moment to look them up in the numpy documentation. Moving on, let's get the $60$ random samples from our dataset. In [ ]: # Create a new dataframe from the random points sample_df = pd . DataFrame ( dict ( x = x [ indexes ], f = f [ indexes ], y = y [ indexes ])) # New dataframe sample_df . head () Let's take one more look at our data to see which points we've selected. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( sample_df [ 'x' ], sample_df [ 'y' ], 's' , alpha = 0.4 , ms = 10 , label = \"in-sample y (observed)\" ) ax . plot ( x , y , '.' , label = r 'Population $y$' ) ax . plot ( x , f , lw = 4 , label = 'True Response' ) ax . legend ( loc = 'upper left' ) ax . set_xlabel ( r '$x$' ) ax . set_ylabel ( r '$y$' ) fig . tight_layout () Now we do our favorite thing and split the sample data into training and testing sets. Note that here we are actually getting indices instead of the actual training and test set. This is okay and is another way of generating train-test splits. In [ ]: from sklearn.model_selection import train_test_split datasize = sample_df . shape [ 0 ] #split dataset using the index, as we have x, f, and y that we want to split. itrain , itest = train_test_split ( np . arange ( 60 ), train_size = 0.8 ) xtrain = sample_df . x [ itrain ] . values ftrain = sample_df . f [ itrain ] . values ytrain = sample_df . y [ itrain ] . values xtest = sample_df . x [ itest ] . values ftest = sample_df . f [ itest ] . values ytest = sample_df . y [ itest ] . values Great! At this point we've explored our data a little bit, selected a sample of the dataset, and done a train-test split on the sample dataset. Let's move on to the data analysis. We'll begin with ridge regression. In particular we'll do ridge regression on a single predictor and compare it with simple linear regression. To start, let's fit the old classic, linear regression. In [ ]: from sklearn.linear_model import LinearRegression # fit the model to training data simp_reg = LinearRegression () . fit ( xtrain . reshape ( - 1 , 1 ), ytrain ) # save the beta coefficients beta0_sreg = simp_reg . intercept_ beta1_sreg = simp_reg . coef_ [ 0 ] print ( \"(beta0, beta1) = ( {0:8.6f} , {1:8.6f} )\" . format ( beta0_sreg , beta1_sreg )) Part 2: Bootstrapping But wait! Unlike statsmodels , we don't get confidence intervals for the betas. Fortunately, we can bootstrap to build the confidence intervals **Exercise 1** In the code below, two key steps of bootstrapping are missing. Fill in the code to draw sample indices with replacement and to fit the model to the bootstrap sample. You'll need numpy 's np.random.choice . Here's the function documentation in case you need it. Visualize the results, and use numpy 's np.percentile : function documentation . In [ ]: N = 1000 bootstrap_beta1s = np . zeros ( N ) for cur_bootstrap_rep in range ( N ): # use np.random.choice to select 48 indices ranging from 0 to 47, with replacement, # and store them in inds_to_sample (48 is the size of our training set) ########### # your code here ########### # take the sample x_train_resample = xtrain [ inds_to_sample ] y_train_resample = ytrain [ inds_to_sample ] # refit the model ########### # your code here ########### # extract the beta1 and append bootstrap_beta1s [ cur_bootstrap_rep ] = bootstrap_model . coef_ [ 0 ] In [ ]: ## calculate 5th and 95th percentiles & display the results ########### # your code here ########### From the above, we find that the bootstrap $90\\%$ confidence interval is well away from $0$. We can confidently say that $\\beta_{1}$ is not secretly $0$ and we're being fooled by randomness. Part 3: Ridge regression for Simple Regression To begin, we'll use sklearn to do simple linear regression on the sampled training data. We'll then do ridge regression with the same data, setting the penalty parameter $\\lambda$ to zero. What happens when we set $\\lambda = 0$ for Ridge's Penalty factor? We will store the regression coefficients in a dataframe for easy comparison. The cell below provides some code to set up the dataframe ahead of time. Notice that we don't know the actual values in the pandas series, so we just set them to NaN . We will overwrite these later. In [ ]: regression_coeffs = dict () # Store regression coefficients from each model in a dictionary regression_coeffs [ 'OLS' ] = [ np . nan ] * 2 # Initialize to 0 regression_coeffs [ r 'Ridge $\\lambda = 0$' ] = [ np . nan ] * 2 dfResults = pd . DataFrame ( regression_coeffs ) # Create dataframe dfResults . rename ({ 0 : r '$\\hat{\\beta}_ {0} $' , 1 : r '$\\hat{\\beta}_ {1} $' }, inplace = True ) # Rename rows dfResults We start with simple linear regression to get the ball rolling. In [ ]: simp_reg = LinearRegression () # build the the ordinary least squares model simp_reg . fit ( xtrain . reshape ( - 1 , 1 ), ytrain ) # fit the model to training data # save the beta coefficients beta0_sreg = simp_reg . intercept_ beta1_sreg = simp_reg . coef_ [ 0 ] dfResults [ 'OLS' ][:] = [ beta0_sreg , beta1_sreg ] dfResults In [ ]: #y_predict = lambda x : beta0_sreg + beta1_sreg*x # a user function to make predictions ypredict_ols = simp_reg . predict ( x . reshape ( - 1 , 1 )) We will use the above $\\boldsymbol\\beta$ coefficients as a benchmark for comparision to the ridge method. The same coefficients can be obtained with ridge regression, which we demonstrate now. For reference, here is the ridge regression documentation: sklearn.linear_model.Ridge . In [ ]: from sklearn.linear_model import Ridge The snippet of code below implements the ridge regression with $\\lambda = 0$. Note: The weight $\\lambda$ is referred to as alpha in the documentation. Remark: $\\lambda$ goes by many names including, but not limited to: regularization parameter, penalization parameter, penalty factor, tuning parameter, shrinking parameter, and weight. Regardless of these names, it is a hyperparameter. That is, you set it before you begin the training process. An algorithm can be very sensitive to its hyperparameters and we will discuss how a method for selecting the \"correct\" hyperparameter values later in this lab. In [ ]: ridge_reg = Ridge ( alpha = 0 ) # build the ridge regression model with specified lambda, i.e. alpha ridge_reg . fit ( xtrain . reshape ( - 1 , 1 ), ytrain ) # fit the model to training data # save the beta coefficients beta0_ridge = ridge_reg . intercept_ beta1_ridge = ridge_reg . coef_ [ 0 ] ypredict_ridge = ridge_reg . predict ( x . reshape ( - 1 , 1 )) # make predictions everywhere dfResults [ r 'Ridge $\\lambda = 0$' ][:] = [ beta0_ridge , beta1_ridge ] dfResults The beta coefficients for linear and ridge regressions coincide for $\\lambda = 0$, as expected. We plot the data and fits. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( xtrain , ytrain , 's' , alpha = 0.3 , ms = 10 , label = \"in-sample y (observed)\" ) # plot in-sample training data ax . plot ( x , y , '.' , alpha = 0.4 , label = \"population y\" ) # plot population data ax . plot ( x , f , ls = '-' , alpha = 0.4 , lw = 4 , label = \"True function\" ) ax . plot ( x , y_predict ( x ), ls = '--' , lw = 4 , label = \"OLS\" ) # plot simple linear regression fit ax . plot ( x , ypredict_ridge , ls = '-.' , lw = 4 , label = \"Ridge\" ) # plot ridge regression fit ax . set_xlabel ( '$x$' ) ax . set_ylabel ( '$y$' ) ax . legend ( loc = 4 ); fig . tight_layout () Exercise 2 Explore the effect of $\\lambda$ on ridge regression. Make a plot with of the ridge regression predictions with $\\lambda = 0, 5, 10, 100$. Be sure to include a legend. What happens for very large $\\lambda$ (e.g. $\\lambda \\to \\infty$)? Your plot should look something like the following plot (doesn't have to be exact): In [ ]: # Your code here Part 3 Recap That was nice, but we were just doing simple linear regression. We really want to do more interesting regression problems like multilinear regression. We will do so in the next section. Part 4: Ridge regression with polynomial features on a grid Now we'll make a more complex model by adding polynomial features. Instead of building the linear model $y = \\beta_0 + \\beta_1 x$, we build a polynomial model $y = \\beta_0 + \\beta_1 x + \\beta_2 x&#94;2 + \\ldots \\beta_d x&#94;d$ for some $d$ to be determined. This regression will be linear though, since we'll be treating $x&#94;2, \\ldots, x&#94;d$ themselves as predictors in the linear model. The design matrix $\\mathbf{X}$ contains columns corresponding to $1, x, x&#94;2, \\ldots, x&#94;d$. To build it, we use sklearn . (The particular design matrix is also known as the Vandermonde matrix ). For example, if we have three observations \\begin{align*} \\left\\{\\left(x_{1}, y_{1}\\right), \\left(x_{2}, y_{2}\\right), \\left(x_{3}, y_{3}\\right)\\right\\} \\end{align*} and we want polynomial features up to and including degree $4$, the design matrix looks like \\begin{align*} X = \\begin{bmatrix} x_1&#94;0 & x_1&#94;1 & x_1&#94;2 & x_1&#94;3 & x_1&#94;4\\\\ x_2&#94;0 & x_2&#94;1 & x_2&#94;2 & x_2&#94;3 & x_2&#94;4\\\\ x_3&#94;0 & x_3&#94;1 & x_3&#94;2 & x_3&#94;3 & x_3&#94;4\\\\ \\end{bmatrix} = \\begin{bmatrix} 1& x_1&#94;1 & x_1&#94;2 & x_1&#94;3 & x_1&#94;4\\\\ 1 & x_2&#94;1 & x_2&#94;2 & x_2&#94;3 & x_2&#94;4\\\\ 1 & x_3&#94;1 & x_3&#94;2 & x_3&#94;3 & x_3&#94;4\\\\ \\end{bmatrix}. \\end{align*} Exercise 3 Make a toy vector called toy , where \\begin{align*} \\mathrm{toy} = \\begin{bmatrix} 0 \\\\ 2 \\\\ 5 \\\\ \\end{bmatrix}. \\end{align*} Build the feature matrix up to (and including) degree $4$. Confirm that the entries in the matrix are what you'd expect based on the above discussion. Note: You may use sklearn to build the matrix using PolynomialFeatures() . In [ ]: from sklearn.preprocessing import PolynomialFeatures In [ ]: # your code here We now continue working with our data. Exercise 4 The code provided below is missing a few lines and it's missing many comments. Do the following: Comment every line of the code Normally, you won't do such excessive commenting. In this case, we want to make sure you understand every single line since you didn't actually write this code. Fill in the missing lines Create a ridge regression object at each $\\lambda$ value in the list Perform the ridge regression using the fit method from the newly created ridge regression object Make a prediction on the grid and store the results in ypredict_ridge . Note: We're not giving you an example figure here since we gave you most of the code. Warning! Make sure you understand the entire code! There are many nice things in there. In [ ]: d = 20 # You will create a grid of plots of this size (7 x 2) rows = 7 cols = 2 lambdas = [ 0. , 1e-6 , 1e-3 , 1e-2 , 1e-1 , 1 , 10 ] grid_to_predict = np . arange ( 0 , 1 , . 01 ) Xtrain = PolynomialFeatures ( d ) . fit_transform ( xtrain . reshape ( - 1 , 1 )) test_set = PolynomialFeatures ( d ) . fit_transform ( grid_to_predict . reshape ( - 1 , 1 )) fig , axs = plt . subplots ( rows , cols , sharex = 'col' , figsize = ( 12 , 24 )) # Set up plotting objects for i , lam in enumerate ( lambdas ): # your code here # Create regression object # Fit on regression object # Do a prediction on the test set ### Provided code axs [ i , 0 ] . plot ( xtrain , ytrain , 's' , alpha = 0.4 , ms = 10 , label = \"in-sample y\" ) axs [ i , 0 ] . plot ( grid_to_predict , ypredict_ridge , 'k-' , label = r \"$\\lambda = {0} $\" . format ( lam )) axs [ i , 0 ] . set_ylabel ( '$y$' ) axs [ i , 0 ] . set_ylim (( 0 , 1 )) axs [ i , 0 ] . set_xlim (( 0 , 1 )) axs [ i , 0 ] . legend ( loc = 'best' ) coef = ridge_reg . coef_ . ravel () axs [ i , 1 ] . semilogy ( np . abs ( coef ), ls = ' ' , marker = 'o' , label = r \"$\\lambda = {0} $\" . format ( lam )) axs [ i , 1 ] . set_ylim (( 1e-04 , 1e+15 )) axs [ i , 1 ] . set_xlim ( 1 , 20 ) axs [ i , 1 ] . yaxis . set_label_position ( \"right\" ) axs [ i , 1 ] . set_ylabel ( r '$\\left|\\beta_ {j} \\right|$' ) axs [ i , 1 ] . legend ( loc = 'best' ) axs [ - 1 , 0 ] . set_xlabel ( \"x\" ) axs [ - 1 , 1 ] . set_xlabel ( r \"$j$\" ); As you can see, as we increase $\\lambda$ from 0 to 1, we start out overfitting, then doing well, and then our fits develop a mind of their own irrespective of data, as the penalty term dominates. Exercise 5 What would you expect if you compared a performance metric between these models on a grid? What performance metric should you use? YOUR DISCUSSION HERE Part 4 Recap We did a ridge regression on our dataset where the features were the polynomial terms. We also assessed the impact of the regularization parameter on the solution. Part 5: Cross-validation --- Finding the best penalization parameter In order to determine the critical value of $\\lambda$ that gives us our best predictive model, which we'll refer to as $\\lambda&#94;*$, we will assess this via cross-validation. To do this we use the concept of a meta-estimator from scikit-learn . Model selection is supported by two distinct meta-estimators: GridSearchCV RandomizedSearchCV The input to these meta-estimators is an estimator, which has some hyperparameters (e.g. $\\lambda$) that need to be optimized, and a set of hyperparameter settings to search through. The concept of a meta-estimator allows us to wrap, for example, cross-validation, or methods that build and combine simpler models or schemes. For example: est = Ridge () parameters = { \"alpha\" : [ 1e-8 , 1e-6 , 1e-5 , 5e-5 , 1e-4 , 5e-4 , 1e-3 , 1e-2 , 1e-1 , 1.0 ]} gridclassifier = GridSearchCV ( est , param_grid = parameters , cv = 4 , scoring = \"neg_mean_squared_error\" ) The GridSearchCV replaces the manual iteration over the folds using KFolds and the averaging we just did, doing it all for us. It takes a hyperparameter grid in the shape of a dictionary as input, and sets $\\lambda$ to the values you want to try, one by one. It then trains the model using cross-validation, and gets the error for each value of the hyperparameter $\\lambda$. Finally it compares the errors for the different $\\lambda$'s, and picks the best choice model. Here is a helper function that we will use to get the best Ridge regression. In [ ]: from sklearn.model_selection import GridSearchCV def cv_optimize_ridge ( x : np . ndarray , y : np . ndarray , list_of_lambdas : list , n_folds : int = 4 ): est = Ridge () parameters = { 'alpha' : list_of_lambdas } # the scoring parameter below is the default one in ridge, but you can use a different one # in the cross-validation phase if you want. gs = GridSearchCV ( est , param_grid = parameters , cv = n_folds , scoring = \"neg_mean_squared_error\" ) gs . fit ( x , y ) return gs Exercise 6 Use the function above to fit the model on the training set with $4$-fold cross validation. Save the fit as the variable fitmodel . In [ ]: lambs = [ 1e-7 , 1e-6 , 1e-5 , 5e-5 , 1e-4 , 5e-4 , 1e-3 , 1e-2 , 1e-1 , 1.0 , 10.0 ] # your code here In [ ]: print ( fitmodel . best_estimator_ , \" \\n \" ) print ( fitmodel . best_params_ , \" \\n \" ) print ( fitmodel . best_score_ , \" \\n \" ) We also output the mean cross-validation error at different $\\lambda$ (with a negative sign, as scikit-learn likes to maximize negative error which is equivalent to minimizing error). In [ ]: fitmodel . cv_results_ In [ ]: fit_lambdas = [ d [ 'alpha' ] for d in fitmodel . cv_results_ [ 'params' ]] fit_scores = fitmodel . cv_results_ [ 'mean_test_score' ] Now we make a log-log plot of -fit_scores versus fit_lambdas . In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( fit_lambdas , - fit_scores , ls = '-' , marker = 'o' ) ax . set_xscale ( 'log' ) ax . set_yscale ( 'log' ) ax . set_xlabel ( '$\\lambda$' ) ax . set_ylabel ( 'scores' ); SK-learn's cross_val_score : Easier Cross Validation GridSearchCV is an important tool when you are searching over many hyperparameters (and believe us, you will be), but when you only need to get CV scores for a particular model, some students find cross_val_score more intuitive. In [ ]: from sklearn.model_selection import cross_val_score lr_object = Ridge ( alpha = 0 ) cross_val_score ( lr_object , Xtrain , ytrain , cv = 5 ) We can loop over particular models and get scores for each (equivalent to GridSearchCV over the given parameter settings). In [ ]: for cur_alpha in [ 1e-8 , 1e-4 , 1e-2 , 1.0 , 10.0 ]: lr_object = Ridge ( alpha = cur_alpha ) scores = cross_val_score ( lr_object , Xtrain , ytrain , cv = 5 ) print ( \"lambda {0} \\t R&#94;2 scores: {1} \\t Mean R&#94;2: {2} \" . format ( cur_alpha , scores , np . mean ( scores ))) Built-in Cross Validation: RidgeCV and LassoCV Some sklearn models have built-in, automated cross validation to tune their hyper parameters. In [ ]: from sklearn.linear_model import RidgeCV ridgeCV_object = RidgeCV ( alphas = lambs , cv = 5 ) ridgeCV_object . fit ( Xtrain , ytrain ) print ( \"Best model searched: \\n alpha = {} \\n intercept = {} \\n betas = {} , \" . format ( ridgeCV_object . alpha_ , ridgeCV_object . intercept_ , ridgeCV_object . coef_ ) ) Important note: For any tool more automated than literally using k_fold, just setting cv=5 will NOT shuffle your data by default. To force shuffling, explicitly pass a KFold object (with shuffling turned on) to the cv argument You may prefer a strategy where you shuffle the rows of your data at the outset of analysis In [ ]: # declare and pass a KFold object to properly shuffle the training data, and/or set the random state splitter = KFold ( 5 , random_state = 42 , shuffle = True ) ridgeCV_object = RidgeCV ( alphas = ( 1e-8 , 1e-4 , 1e-2 , 1.0 , 10.0 ), cv = splitter ) ridgeCV_object . fit ( Xtrain , ytrain ) print ( \"Best model searched: \\n alpha = {} \\n intercept = {} \\n betas = {} , \" . format ( ridgeCV_object . alpha_ , ridgeCV_object . intercept_ , ridgeCV_object . coef_ ) ) Part 5b: Refitting on full training set At this point, we have determined the best penalization parameter for the ridge regression on our current dataset using cross validation. Let's refit the estimator on the training set and calculate and plot the test set error and the polynomial coefficients. Notice how many of these coefficients have been pushed to lower values or 0. Exercise 7 Assign to variable est the classifier obtained by fitting the entire training set using the best $\\lambda$ found above. Assign the predictions to the variable ypredict_ridge_best . In [ ]: # your code here In [ ]: # code provided from here on fig , axs = plt . subplots ( 1 , 2 , figsize = ( 12 , 4 )) left = 0 right = 1 axs [ left ] . plot ( x , f , lw = 4 , label = 'True Response' ) axs [ left ] . plot ( xtrain , ytrain , 's' , alpha = 0.3 , ms = 10 , label = \"in-sample y (observed)\" ) axs [ left ] . plot ( x , y , '.' , alpha = 0.8 , label = \"population y\" ) axs [ left ] . plot ( grid_to_predict , ypredict_ridge_best , 'k--' , label = r \"$\\lambda = {{ {0:1.4f} }}$\" . format ( best_lambda )) axs [ left ] . set_ylabel ( '$y$' ) axs [ left ] . set_ylim (( 0 , 1 )) axs [ left ] . set_xlim (( 0 , 1 )) axs [ left ] . legend ( loc = 2 ) coef = est . coef_ . ravel () axs [ right ] . semilogy ( np . abs ( coef ), marker = 'o' , label = r \"$\\lambda = {0} $\" . format ( best_lambda )) axs [ right ] . set_ylim (( 1e-04 , 1.0e+11 )) axs [ right ] . set_xlim ( 1 , 20 ) axs [ right ] . yaxis . set_label_position ( \"right\" ) axs [ right ] . set_ylabel ( r '$\\left|\\beta_ {j} \\right|$' ) axs [ right ] . legend ( loc = 'best' ) axs [ left ] . set_xlabel ( \"x\" ) axs [ right ] . set_xlabel ( r '$j$' ); if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-5/student/"},{"title":"Lab 3: KNN Regression, Simple Linear Regression","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A/STAT121A Introduction to Data Science Lab 3: numpy , plotting, K-NN Regression, Simple Linear Regression PRE-LAB : DO THIS PART BEFORE COMING TO LAB Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Material prepared by : David Sondak, Will Claybaugh and Pavlos Protopapas In [ ]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Table of Contents A revision of `numpy` A revision of matplotlib - Creating plots 1 - Numerical Python: numpy Review the concepts on numpy: Scientific Python code uses a fast array structure, called the numpy array. Those who have worked in Matlab will find this very natural. For reference, the numpy documention can be found here: numpy . Let's make a numpy array. In [ ]: import numpy as np In [ ]: my_array = np . array ([ 1 , 4 , 9 , 16 ]) my_array Numpy arrays support the same operations as lists! Below we compute length, slice, and iterate. In [ ]: print ( \"len(array):\" , len ( my_array )) # Length of array print ( \"array[2:4]:\" , my_array [ 2 : 4 ]) # A slice of the array # Iterate over the array for ele in my_array : print ( \"element:\" , ele ) In general you should manipulate numpy arrays by using numpy module functions (e.g. np.mean ). This is for efficiency purposes, and a discussion follows below this section. You can calculate the mean of the array elements either by calling the method .mean on a numpy array or by applying the function np.mean with the numpy array as an argument. In [ ]: # Two ways of calculating the mean print ( my_array . mean ()) print ( np . mean ( my_array )) The way we constructed the numpy array above seems redundant. After all we already had a regular python list. Indeed, it is the other ways we have to construct numpy arrays that make them super useful. There are many such numpy array constructors . Here are some commonly used constructors. Look them up in the documentation. In [ ]: zeros = np . zeros ( 10 ) # generates 10 floating point zeros zeros Numpy gains a lot of its efficiency from being strongly typed. That is, all elements in the array have the same type, such as integer or floating point. The default type, as can be seen above, is a float of size appropriate for the machine (64 bit on a 64 bit machine). In [ ]: zeros . dtype In [ ]: np . ones ( 10 , dtype = 'int' ) # generates 10 integer ones If the elements of an array are of a different type, numpy will force them into the same type (the longest in terms of bytes) In [ ]: mixed = np . array ([ 1 , 2.3 , 'eleni' , True ]) #elements are of different type print ( type ( 1 ), type ( 2.3 ), type ( 'eleni' ), type ( True )) # all elements will become strings mixed Often you will want random numbers. Use the random constructor! In [ ]: np . random . rand ( 10 ) # uniform on [0,1] You can generate random numbers from a normal distribution with mean $0$ and variance $1$ using np.random.randn : In [ ]: normal_array = np . random . randn ( 10000 ) print ( \"The sample mean and standard devation are {0:17.16f} and {1:17.16f} , respectively.\" . format ( np . mean ( normal_array ), np . std ( normal_array ))) numpy supports vector operations What does this mean? It means that to add two arrays instead of looping ovr each element (e.g. via a list comprehension as in base Python) you get to simply put a plus sign between the two arrays. In [ ]: ones_array = np . ones ( 5 ) twos_array = 2 * np . ones ( 5 ) ones_array + twos_array Note that this behavior is very different from python lists, which just get longer when you try to + them. In [ ]: first_list = [ 1. , 1. , 1. , 1. , 1. ] second_list = [ 2. , 2. , 2. , 2. , 2. ] first_list + second_list # not what you want On some computer chips nunpy's addition actually happens in parallel, so speedups can be high. But even on regular chips, the advantage of greater readability is important. Numpy supports a concept known as broadcasting , which dictates how arrays of different sizes are combined together. There are too many rules to list all of them here. Here are two important rules: Multiplying an array by a number multiplies each element by the number Adding a number adds the number to each element. In [ ]: ones_array + 1 In [ ]: 5 * ones_array This means that if you wanted the distribution $N(5, 7)$ you could do: In [ ]: normal_5_7 = 5.0 + 7.0 * normal_array np . mean ( normal_5_7 ), np . std ( normal_5_7 ) Now you have seen how to create and work with simple one dimensional arrays in numpy . You have also been introduced to some important numpy functionality (e.g. mean and std ). Next, we push ahead to two-dimensional arrays and begin to dive into some of the deeper aspects of numpy . 2D arrays We can create two-dimensional arrays without too much fuss. In [ ]: # create a 2d-array by handing a list of lists my_array2d = np . array ([ [ 1 , 2 , 3 , 4 ], [ 5 , 6 , 7 , 8 ], [ 9 , 10 , 11 , 12 ] ]) # you can do the same without the pretty formatting (decide which style you like better) my_array2d = np . array ([ [ 1 , 2 , 3 , 4 ], [ 5 , 6 , 7 , 8 ], [ 9 , 10 , 11 , 12 ] ]) # 3 x 4 array of ones ones_2d = np . ones ([ 3 , 4 ]) print ( ones_2d , \" \\n \" ) # 3 x 4 array of ones with random noise ones_noise = ones_2d + 0.01 * np . random . randn ( 3 , 4 ) print ( ones_noise , \" \\n \" ) # 3 x 3 identity matrix my_identity = np . eye ( 3 ) print ( my_identity , \" \\n \" ) Like lists, numpy arrays are $0$-indexed. Thus we can access the $n$th row and the $m$th column of a two-dimensional array with the indices $[n - 1, m - 1]$. In [ ]: print ( my_array2d ) print ( \"element [2,3] is:\" , my_array2d [ 2 , 3 ]) Numpy arrays can be sliced, and can be iterated over with loops. Below is a schematic illustrating slicing two-dimensional arrays. Notice that the list slicing syntax still works! array[2:,3] says \"in the array, get rows 2 through the end, column 3]\" array[3,:] says \"in the array, get row 3, all columns\". Numpy functions will by default work on the entire array: In [ ]: np . sum ( ones_2d ) The axis 0 is the one going downwards (i.e. the rows), whereas axis 1 is the one going across (the columns). You will often use functions such as mean or sum along a particular axis. If you sum along axis 0 you are summing across the rows and will end up with one value per column. As a rule, any axis you list in the axis argument will dissapear. In [ ]: np . sum ( ones_2d , axis = 0 ) In [ ]: np . sum ( ones_2d , axis = 1 ) Exercise Create a two-dimensional array of size $3\\times 5$ and do the following: Print out the array Print out the shape of the array Create two slices of the array: The first slice should be the last row and the third through last column The second slice should be rows $1-3$ and columns $3-5$ Square each element in the array and print the result In [ ]: # your code here A = np . array ([ [ 5 , 4 , 3 , 2 , 1 ], [ 1 , 2 , 3 , 4 , 5 ], [ 1.1 , 2.2 , 3.3 , 4.4 , 5.5 ] ]) print ( A , \" \\n \" ) # set length(shape) dims = A . shape print ( dims , \" \\n \" ) # slicing print ( A [ - 1 , 2 :], \" \\n \" ) print ( A [ 1 : 3 , 3 : 5 ], \" \\n \" ) # squaring A2 = A * A print ( A2 ) numpy supports matrix operations 2d arrays are numpy's way of representing matrices. As such there are lots of built-in methods for manipulating them Earlier when we generated the one-dimensional arrays of ones and random numbers, we gave ones and random the number of elements we wanted in the arrays. In two dimensions, we need to provide the shape of the array, i.e., the number of rows and columns of the array. In [ ]: three_by_four = np . ones ([ 3 , 4 ]) three_by_four You can transpose the array: In [ ]: three_by_four . shape In [ ]: four_by_three = three_by_four . T In [ ]: four_by_three . shape Matrix multiplication is accomplished by np.dot . The * operator will do element-wise multiplication. In [ ]: print ( np . dot ( three_by_four , four_by_three )) # 3 x 3 matrix np . dot ( four_by_three , three_by_four ) # 4 x 4 matrix Numpy has functions to do the difficult matrix operations that are awful to do by hand. In [ ]: matrix = np . random . rand ( 4 , 4 ) # a 4 by 4 matrix matrix Let's get the eigenvalues and eigenvectors! In [ ]: np . linalg . eig ( matrix ) How about inverses? In [ ]: inv_matrix = np . linalg . inv ( matrix ) # the invert matrix print ( inv_matrix ) #prove it's the inverse np . dot ( matrix , inv_matrix ) Notice that there is a bit of 'rounding error' in the inverse calculation. This is becuase the computer can't store the exact values the inverse matrix asks for (they have more decimal places than the computer can hold). Built-in numpy routines manage these errors, which is why it's very important to use pre-built tools whenever possible, and to be very cautious when writing your own. (It happens that there are even more advanced numpy functions like np.linalg.solve which are more accurate than just taking the naked inverse) See the documentation to learn more about numpy functions as needed. Numpy's layout in the computer's memory Advanced coders : You should notice that access is row-by-row and one dimensional iteration gives a row. This is because numpy lays out memory row-wise. Starting coders : If you really need a particular section of numpy to run faster, ask an advanced coder to point out improvements in your code. They may have you transpose your arrays. But if your code is fast enough, then it's fast enough. (from https://aaronbloomfield.github.io ) An often seen idiom allocates a two-dimensional array, and then fills in one-dimensional arrays from some function. We will discuss why this is a bad design pattern. In [ ]: # allocate a 2D array twod = np . zeros ([ 5 , 2 ]) print ( twod , \" \\n \" ) # Fill in with random numbers for i in range ( twod . shape [ 0 ]): twod [ i , :] = np . random . random ( 2 ) print ( twod ) In this and many other cases, it is faster to simply do: In [ ]: twod = np . random . random ( size = ( 5 , 2 )) twod Numpy Arrays vs. Python Lists? Why the need for numpy arrays? Can't we just use Python lists? Iterating over numpy arrays is slow. Slicing is faster. Python lists may contain items of different types. This flexibility comes at a price: Python lists store pointers to memory locations. On the other hand, numpy arrays are typed, where the default type is floating point. Because of this, the system knows how much memory to allocate, and if you ask for an array of size $100$, it will allocate one hundred contiguous spots in memory, where the size of each spot is based on the type. This makes access extremely fast. (image from Jake Vanderplas's Data Science Handbook) Unfortunately, looping over an array slows things down. In general you should not access numpy array elements by iteration. This is because of type conversion. Numpy stores integers and floating points in C -language format. When you operate on array elements through iteration, Python needs to convert that element to a Python int or float , which is a more complex beast (a struct in C jargon). This has a cost. (image from Jake Vanderplas's Data Science Handbook) If you want to know more, we will suggest that you read Jake Vanderplas's Data Science Handbook . Wes McKinney's Python for Data Analysis (HOLLIS) You will find them both incredible resources for this class. Why is slicing faster? The reason is technical: slicing provides a view onto the memory occupied by a numpy array, instead of creating a new array. That is the reason the code above this cell works nicely as well. However, if you iterate over a slice, then you have gone back to the slow access. By contrast, functions such as np.dot are implemented at C -level, do not do this type conversion, and access contiguous memory. If you want this kind of access in Python , use the struct module or Cython . Indeed many fast algorithms in numpy , pandas , and C are either implemented at the C -level, or employ Cython . Concept Check: Answer these questions and see the bottom of the lab to check your answers. What is the major benefit of working in numpy ? Why is it vital to use built-in numpy functions whenever possible? You need to find the running total of each element in a numpy array. For example, the input [2,5,3,2] should give the output [2,7,10,12]. Rather than writing your own code, think of at least two google querrys to find a relevant numpy function. What numpy function does the job above? 2 - Plotting with matplot lib (and beyond) Conveying your findings convincingly is an absolutely crucial part of any analysis. Therefore, you must be able to write well and make compelling visuals. Creating informative visuals is an involved process and we won't cover that in this lab. However, part of creating informative data visualizations means generating readable figures. If people can't read your figures or have a difficult time interpreting them, they won't understand the results of your work. Here are some non-negotiable commandments for any plot: Label $x$ and $y$ axes Axes labels should be informative Axes labels should be large enough to read Make tick labels large enough Include a legend if necessary Include a title if necessary Use appropriate line widths Use different line styles for different lines on the plot Use different markers for different lines There are other important elements, but that list should get you started on your way. Here is the anatomy of a figure: taken from showcase example code: anatomy.py . We will work with matplotlib and seaborn for plotting in this class. Today's lab will focus on matplotlib , which is a very powerful python library for making scientific plots. seaborn is a little more specialized in that it was developed for statistical data visualization. We will put in a little bit of seaborn at the end, but if you are comfortable with matplotlib then seaborn will be a breeze. Before diving in, one more note should be made. We will not focus on the internal aspects of matplotlib . Today's lab will really only focus on the basics and developing good plotting practices. There are many excellent tutorials out there for matplotlib . For example, matplotlib homepage matplotlib tutorial Okay, let's get started! matplotlib First, let's generate some data. Exercise Use the following three functions to make some plots: Logistic function: \\begin{align*} f\\left(z\\right) = \\dfrac{1}{1 + be&#94;{-az}} \\end{align*} where $a$ and $b$ are parameters. Hyperbolic tangent: \\begin{align*} g\\left(z\\right) = b\\tanh\\left(az\\right) + c \\end{align*} where $a$, $b$, and $c$ are parameters. Rectified Linear Unit: \\begin{align*} h\\left(z\\right) = \\left{ \\begin{array}{lr} z, \\quad z > 0 \\\\ \\epsilon z, \\quad z\\leq 0 \\end{array} \\right. \\end{align*} where $\\epsilon < 0$ is a small, positive parameter. You are given the code for the first two functions. Notice that $z$ is passed in as a numpy array and that the functions are returned as numpy arrays. Parameters are passed in as floats. You should write a function to compute the rectified linear unit. The input should be a numpy array for $z$ and a positive float for $\\epsilon$. In [ ]: # Your code here import numpy as np def logistic ( z : np . ndarray , a : float , b : float ) -> np . ndarray : \"\"\" Compute logistic function Inputs: a: exponential parameter b: exponential prefactor z: numpy array; domain Outputs: f: numpy array of floats, logistic function \"\"\" den = 1.0 + b * np . exp ( - a * z ) return 1.0 / den def stretch_tanh ( z : np . ndarray , a : float , b : float , c : float ) -> np . ndarray : \"\"\" Compute stretched hyperbolic tangent Inputs: a: horizontal stretch parameter (a>1 implies a horizontal squish) b: vertical stretch parameter c: vertical shift parameter z: numpy array; domain Outputs: g: numpy array of floats, stretched tanh \"\"\" return b * np . tanh ( a * z ) + c def relu ( z : np . ndarray , eps : float = 0.01 ) -> np . ndarray : \"\"\" Compute rectificed linear unit Inputs: eps: small positive parameter z: numpy array; domain Outputs: h: numpy array; relu \"\"\" return np . fmax ( z , eps * z ) Now let's make some plots. First, let's just warm up and plot the logistic function. In [ ]: x = np . linspace ( - 5.0 , 5.0 , 100 ) # Equally spaced grid of 100 pts between -5 and 5 f = logistic ( x , 1.0 , 1.0 ) # Generate data In [ ]: import matplotlib.pyplot as plt # This is only needed in Jupyter notebooks! Displays the plots for us. % matplotlib inline plt . plot ( x , f ); # Use the semicolon to suppress some iPython output (not needed in real Python scripts) Wonderful! We have a plot. It's terribly ugly and uninformative. Let's clean it up a bit by putting some labels on it. In [ ]: plt . plot ( x , f ) plt . xlabel ( 'x' ) plt . ylabel ( 'f' ) plt . title ( 'Logistic Function' ); Okay, it's getting better. Still super ugly. I see these kinds of plots at conferences all the time. Unreadable. We can do better. Much, much better. First, let's throw on a grid. In [ ]: plt . plot ( x , f ) plt . xlabel ( 'x' ) plt . ylabel ( 'f' ) plt . title ( 'Logistic Function' ) plt . grid ( True ) At this point, our plot is starting to get a little better but also a little crowded. A note on gridlines Gridlines can be very helpful in many scientific disciplines. They help the reader quickly pick out important points and limiting values. On the other hand, they can really clutter the plot. Some people recommend never using gridlines, while others insist on them being present. The correct approach is probably somewhere in between. Use gridlines when necessary, but dispense with them when they take away more than they provide. Ask yourself if they help bring out some important conclusion from the plot. If not, then best just keep them away. Before proceeding any further, I'm going to change notation. The plotting interface we've been working with so far is okay, but not as flexible as it can be. In fact, I don't usually generate my plots with this interface. I work with slightly lower-level methods, which I will introduce to you now. The reason I need to make a big deal about this is because the lower-level methods have a slightly different API. This will become apparent in my next example. In [ ]: fig , ax = plt . subplots ( 1 , 1 ) # Get figure and axes objects ax . plot ( x , f ) # Make a plot # Create some labels ax . set_xlabel ( 'x' ) ax . set_ylabel ( 'f' ) ax . set_title ( 'Logistic Function' ) # Grid ax . grid ( True ) Wow, it's exactly the same plot! Notice, however, the use of ax.set_xlabel() instead of plt.xlabel() . The difference is tiny, but you should be aware of it. I will use this plotting syntax from now on. What else do we need to do to make this figure better? Here are some options: Make labels bigger! Make line fatter Make tick mark labels bigger Make the grid less pronounced Make figure bigger Let's get to it. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger ax . plot ( x , f , lw = 4 ) # Linewidth bigger ax . set_xlabel ( 'x' , fontsize = 24 ) # Fontsize bigger ax . set_ylabel ( 'f' , fontsize = 24 ) # Fontsize bigger ax . set_title ( 'Logistic Function' , fontsize = 24 ) # Fontsize bigger ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) # Update grid Notice: lw stands for linewidth . We could also write ax.plot(x, f, linewidth=4) ls stands for linestyle . alpha stands for transparency. Things are looking good now! Unfortunately, people still can't read the tick mark labels. Let's remedy that presently. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger # Make line plot ax . plot ( x , f , lw = 4 ) # Update ticklabel size ax . tick_params ( labelsize = 24 ) # Make labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_ylabel ( r '$f(x)$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_title ( 'Logistic Function' , fontsize = 24 ) ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) The only thing remaining to do is to change the $x$ limits. Clearly these should go from $-5$ to $5$. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger # Make line plot ax . plot ( x , f , lw = 4 ) # Set axes limits ax . set_xlim ( x . min (), x . max ()) # Update ticklabel size ax . tick_params ( labelsize = 24 ) # Make labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_ylabel ( r '$f(x)$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_title ( 'Logistic Function' , fontsize = 24 ) ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) You can play around with figures forever making them perfect. At this point, everyone can read and interpret this figure just fine. Don't spend your life making the perfect figure. Make it good enough so that you can convey your point to your audience. Then save if it for later. In [ ]: fig . savefig ( 'logistic.png' ) Done! Let's take a look. Resources If you want to see all the styles available, please take a look at the documentation. Line styles Marker styles Everything you could ever want We haven't discussed it yet, but you can also put a legend on a figure. You'll do that in the next exercise. Here are some additional resources: Legend Grid Exercise Do the following: Make a figure with the logistic function, hyperbolic tangent, and rectified linear unit. Use different line styles for each plot Put a legend on your figure Here's an example of a figure: You don't need to make the exact same figure, but it should be just as nice and readable. In [ ]: # your code here # First get the data f = logistic ( x , 2.0 , 1.0 ) g = stretch_tanh ( x , 2.0 , 0.5 , 0.5 ) h = relu ( x ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Create figure object # Make actual plots # (Notice the label argument!) ax . plot ( x , f , lw = 4 , ls = '-' , label = r '$L(x;1)$' ) ax . plot ( x , g , lw = 4 , ls = '--' , label = r '$\\tanh(2x)$' ) ax . plot ( x , h , lw = 4 , ls = '-.' , label = r '$relu(x; 0.01)$' ) # Make the tick labels readable ax . tick_params ( labelsize = 24 ) # Set axes limits to make the scale nice ax . set_xlim ( x . min (), x . max ()) ax . set_ylim ( h . min (), 1.1 ) # Make readable labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) ax . set_ylabel ( r '$h(x)$' , fontsize = 24 ) ax . set_title ( 'Activation Functions' , fontsize = 24 ) # Set up grid ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.75 ) # Put legend on figure ax . legend ( loc = 'best' , fontsize = 24 ); fig . savefig ( 'nice_plots.png' ) There a many more things you can do to the figure to spice it up. Remember, there must be a tradeoff between making a figure look good and the time you put into it. The guiding principle should be that your audience needs to easily read and understand your figure. There are of course other types of figures including, but not limited to, Scatter plots (you will use these all the time) Bar charts Histograms Contour plots Surface plots Heatmaps There is documentation on each one of these. You should feel comforatable enough with the plotting API now to dig in and make readable, understandable plots. Before moving on, we will discuss another way to make your plots look good without all the hassle. I'll make a beautiful plot without having to specify annoying arguments every single time. In [ ]: import config # User-defined config file plt . rcParams . update ( config . pars ) # Update rcParams to make nice plots # First get the data f1 = logistic ( x , 1.0 , 1.0 ) f2 = logistic ( x , 2.0 , 1.0 ) f3 = logistic ( x , 3.0 , 1.0 ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Create figure object # Make actual plots # (Notice the label argument!) ax . plot ( x , f1 , ls = '-' , label = r '$L(x;-1)$' ) ax . plot ( x , f2 , ls = '--' , label = r '$L(x;-2)$' ) ax . plot ( x , f3 , ls = '-.' , label = r '$L(x;-3)$' ) # Set axes limits to make the scale nice ax . set_xlim ( x . min (), x . max ()) ax . set_ylim ( h . min (), 1.1 ) # Make readable labels ax . set_xlabel ( r '$x$' ) ax . set_ylabel ( r '$h(x)$' ) ax . set_title ( 'Logistic Functions' ) # Set up grid ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.75 ) # Put legend on figure ax . legend ( loc = 'best' ) That's a good-looking plot! Notice that we didn't need to have all those annoying fontsize specifications floating around. If you want to reset the defaults, just use plt.rcdefaults() . Now, how in the world did this work? Obviously, there is something special about the config file. I didn't give you a config file, but the next exercise requires you to create one. Exercise Read the matplotlib rcParams section at the following page: Customizing matplotlib Create your very own config.py file. It should have the following structure: pars = {} You must fill in the pars dictionary yourself. All the possible parameters can be found at the link above. For example, if you want to set a default line width of 4 , then you would have pars = { 'lines.linewidth' : 4 } in your config.py file. Make sure your config.py file is in the same directory as your lab notebook. Make a plot (similar to the one I made above) using your config file. seaborn Early on in this plotting section, we mentioned seaborn . You can use seaborn to make very nice plots of statistical data. Here is the main website: seaborn: statistical data visualization . We won't dive deep into seaborn here. It is quite popular in the data science community, but it is ultimately up to you whether or not you choose to use it. seaborn works great with pandas . It can also be customized easily. Here is the basic seaborn tutorial: Seaborn tutorial . No Excuses With all of these resourses, there is no reason to have a bad figure. We will take this into account for homework. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab3/notebook/"},{"title":"Lab 10: Neural Networks using keras","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } EDA In [1]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) Italian Olives I found this data set in the RGGobi book ( http://www.ggobi.org/book/ ), from which the above diagram is taken. It has \"the percentage composition of fatty acids found in the lipid fraction of Italian olive oils', with oils from 3 regions of Italy: the North, the South, and Sardinia. The regions themselves are subdivided into areas as shown in the map above. The source for this data is: Forina, M., Armanino, C., Lanteri, S. & Tiscornia, E. (1983), Classification of Olive Oils from their Fatty Acid Composition, in Martens, H. and Russwurm Jr., H., eds, Food Research and Data Analysis, Applied Science Publishers, London, pp. 189–214. Exploratory Viz In [4]: df = pd . read_csv ( \"local-olives-cleaned.csv\" ) df . head () Out[4]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South exploring globally In [5]: pd . crosstab ( df . areastring , df . regionstring ) Out[5]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } regionstring North Sardinia South areastring Calabria 0 0 56 Coast-Sardinia 0 33 0 East-Liguria 50 0 0 Inland-Sardinia 0 65 0 North-Apulia 0 0 25 Sicily 0 0 36 South-Apulia 0 0 206 Umbria 51 0 0 West-Liguria 50 0 0 In [6]: pd . value_counts ( df . areastring , sort = False ) . plot ( kind = \"bar\" ); In [7]: pd . value_counts ( df . regionstring , sort = False ) . plot ( kind = \"barh\" ); In [9]: acidlist = [ 'palmitic' , 'palmitoleic' , 'stearic' , 'oleic' , 'linoleic' , 'linolenic' , 'arachidic' , 'eicosenoic' ] df [ acidlist ] . median () . plot ( kind = \"bar\" ); Or one can use aggregate to pass an arbitrary function of to the sub-dataframe. The function is applied columnwise. In [10]: dfbymean = df . groupby ( \"regionstring\" ) . aggregate ( np . mean ) dfbymean . head () Out[10]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring North 3.0 8.006623 10.948013 0.837351 2.308013 77.930530 7.270331 0.217881 0.375762 0.019735 Sardinia 2.0 5.336735 11.113469 0.967449 2.261837 72.680204 11.965306 0.270918 0.731735 0.019388 South 1.0 2.783282 13.322879 1.548019 2.287740 71.000093 10.334985 0.380650 0.631176 0.273220 In [11]: with sns . axes_style ( \"white\" , { 'grid' : False }): dfbymean [ acidlist ] . plot ( kind = 'barh' , stacked = True ); sns . despine () Figuring the dataset by Region In [12]: g = sns . FacetGrid ( df , col = \"region\" ) g . map ( plt . scatter , \"eicosenoic\" , \"linoleic\" ); Clearly, region 1 or the South can visually be separated out by eicosenoic fraction itself. In [13]: with sns . axes_style ( \"white\" ): g = sns . FacetGrid ( df , col = \"region\" ) g . map ( sns . distplot , \"eicosenoic\" ) We make a SPLOM using seaborn to see in what space the regions may be separated. Note that linoleic and oleic seem promising. And perhaps arachidic paired with eicosenoic. In [14]: sns . pairplot ( df , vars = acidlist , hue = \"regionstring\" , size = 2.5 , diag_kind = 'kde' ); Pandas supports conditional indexing: documentation . Lets use it to follow up on the clear pattern of Southern oils seeeming to be separable by just the eicosenoic feature. Indeed this is the case! Can also be seen using parallel co-ordinates: In [40]: from pandas.tools.plotting import parallel_coordinates dfna = df [ acidlist ] #normalizing by range dfna_norm = ( dfna - dfna . mean ()) / ( dfna . max () - dfna . min ()) with sns . axes_style ( \"white\" ): parallel_coordinates ( df [[ 'regionstring' ]] . join ( dfna_norm ), 'regionstring' , alpha = 0.3 ) Figuring the South of Italy by Area In [15]: dfsouth = df [ df . regionstring == 'South' ] dfsouth . head () Out[15]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South We make a couple of SPLOM's, one with sicily and one without sicily, to see whats separable. Sicily seems to be a problem. As before, see the KDE's first to see if separability exists and then let the eye look for patterns. In [16]: sns . pairplot ( dfsouth , hue = \"areastring\" , size = 2.5 , vars = acidlist , diag_kind = 'kde' ); In [17]: sns . pairplot ( dfsouth [ dfsouth . areastring != \"Sicily\" ], hue = \"areastring\" , size = 2.5 , vars = acidlist , diag_kind = 'kde' ); Seems that combinations of oleic, palmitic, palmitoleic might be useful? if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-11/note/"},{"title":"Lab 10: Neural Networks using keras","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } Models In [ ]: #!pip install seaborn % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) In [1]: In [2]: df = pd . read_csv ( \"local-olives-cleaned.csv\" ) df . head () Out[2]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South In [3]: acidlist = [ 'palmitic' , 'palmitoleic' , 'stearic' , 'oleic' , 'linoleic' , 'linolenic' , 'arachidic' , 'eicosenoic' ] In [4]: dfsouth = df [ df . regionstring == 'South' ] dfsouth . head () Out[4]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 0 North-Apulia 1 1 10.75 0.75 2.26 78.23 6.72 0.36 0.60 0.29 South 1 North-Apulia 1 1 10.88 0.73 2.24 77.09 7.81 0.31 0.61 0.29 South 2 North-Apulia 1 1 9.11 0.54 2.46 81.13 5.49 0.31 0.63 0.29 South 3 North-Apulia 1 1 9.66 0.57 2.40 79.52 6.19 0.50 0.78 0.35 South 4 North-Apulia 1 1 10.51 0.67 2.59 77.71 6.72 0.50 0.80 0.46 South Predicting via SVM In [46]: dfnew = df [[ 'eicosenoic' , 'region' , 'regionstring' ]] dfnew [ 'linoarch' ] = ( 0.969 / 1022.0 ) * df . linoleic + ( 0.245 / 105.0 ) * df . arachidic dfnew . head () Out[46]: eicosenoic region regionstring linoarch 0 0.29 1 South 0.007772 1 0.29 1 South 0.008828 2 0.29 1 South 0.006675 3 0.35 1 South 0.007689 4 0.46 1 South 0.008238 In [5]: dfnosouth = df [ df . regionstring != 'South' ] dfnosouth . head () Out[5]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } areastring region area palmitic palmitoleic stearic oleic linoleic linolenic arachidic eicosenoic regionstring 323 Inland-Sardinia 2 5 11.29 1.20 2.22 72.72 11.12 0.43 0.98 0.02 Sardinia 324 Inland-Sardinia 2 5 10.42 1.35 2.10 73.76 11.16 0.35 0.90 0.03 Sardinia 325 Inland-Sardinia 2 5 11.03 0.96 2.10 73.80 10.85 0.32 0.94 0.03 Sardinia 326 Inland-Sardinia 2 5 11.18 0.97 2.21 72.79 11.54 0.35 0.94 0.02 Sardinia 327 Inland-Sardinia 2 5 10.52 0.95 2.15 73.88 11.26 0.31 0.92 0.01 Sardinia In [7]: plt . scatter ( dfnosouth . linoleic , dfnosouth . arachidic , c = dfnosouth . region , s = 50 ); In [20]: from sklearn.cross_validation import train_test_split from sklearn.metrics import confusion_matrix from sklearn.svm import SVC # \"Support Vector Classifier\" def plot_svc_decision_function ( clf , ax = None ): \"\"\"Plot the decision function for a 2D SVC\"\"\" if ax is None : ax = plt . gca () x = np . linspace ( plt . xlim ()[ 0 ], plt . xlim ()[ 1 ], 30 ) y = np . linspace ( plt . ylim ()[ 0 ], plt . ylim ()[ 1 ], 30 ) Y , X = np . meshgrid ( y , x ) P = np . zeros_like ( X ) for i , xi in enumerate ( x ): for j , yj in enumerate ( y ): P [ i , j ] = clf . decision_function ([[ xi , yj ]]) return ax . contour ( X , Y , P , colors = 'k' , levels = [ - 1 , 0 , 1 ], alpha = 0.5 , linestyles = [ '--' , '-' , '--' ]) In [23]: X = dfnosouth [[ 'linoleic' , 'arachidic' ]] y = ( dfnosouth . regionstring . values == 'Sardinia' ) * 1 Xtrain , Xtest , ytrain , ytest = train_test_split ( X . values , y ) clf = SVC ( kernel = \"linear\" ) clf . fit ( Xtrain , ytrain ) plt . scatter ( Xtrain [:, 0 ], Xtrain [:, 1 ], c = ytrain , s = 50 , cmap = 'spring' , alpha = 0.3 ) plot_svc_decision_function ( clf , plt . gca ()) plt . scatter ( clf . support_vectors_ [:, 0 ], clf . support_vectors_ [:, 1 ], s = 200 , facecolors = 'none' ) plt . scatter ( Xtest [:, 0 ], Xtest [:, 1 ], c = ytest , s = 50 , marker = \"s\" , cmap = 'spring' , alpha = 0.5 ); In [24]: clf . score ( Xtest , ytest ) Out[24]: 1.0 In [57]: confusion_matrix ( clf . predict ( Xtest ), ytest ) Out[57]: array([[31, 0], [ 0, 32]]) Allowing for crossovers In [28]: from sklearn.model_selection import GridSearchCV def cv_optimize_svm ( X , y , n_folds = 10 , num_p = 50 ): #clf = SVC() #parameters = {\"C\": np.logspace(-4, 3, num=num_p), \"gamma\": np.logspace(-4, 3, num=10)} clf = SVC ( kernel = \"linear\" , probability = True ) parameters = { \"C\" : np . logspace ( - 4 , 3 , num = num_p )} gs = GridSearchCV ( clf , param_grid = parameters , cv = n_folds ) gs . fit ( X , y ) return gs def get_optim_classifier_svm ( indf , inacidlist , clon , clonval ): subdf = indf [ inacidlist ] subdfstd = ( subdf - subdf . mean ()) / subdf . std () X = subdfstd . values y = ( indf [ clon ] . values == clonval ) * 1 Xtrain , Xtest , ytrain , ytest = train_test_split ( X , y , train_size = 0.8 ) #Xtrain, Xtest, ytrain, ytest=X,X,y,y fitted = cv_optimize_svm ( Xtrain , ytrain ) return fitted , Xtrain , ytrain , Xtest , ytest In [29]: thesvcfit , Xtr , ytr , Xte , yte = get_optim_classifier_svm ( dfnosouth , [ 'linoleic' , 'arachidic' ], 'regionstring' , \"Sardinia\" ) #thesvcfit, Xtr, ytr, Xte, yte = get_optim_classifier_binary(dfsouthns, ['palmitic','palmitoleic'],'area', 3) thesvcfit . best_estimator_ , thesvcfit . best_params_ , thesvcfit . best_score_ Out[29]: (SVC(C=0.071968567300115138, cache_size=200, class_weight=None, coef0=0.0, decision_function_shape=None, degree=3, gamma='auto', kernel='linear', max_iter=-1, probability=True, random_state=None, shrinking=True, tol=0.001, verbose=False), {'C': 0.071968567300115138}, 1.0) In [45]: def plot_svm_new ( clf , Xtr , ytr , Xte , yte ): plt . scatter ( Xtr [:, 0 ], Xtr [:, 1 ], c = ytr , s = 50 , cmap = 'spring' , alpha = 0.5 ) plt . scatter ( Xte [:, 0 ], Xte [:, 1 ], marker = 's' , c = yte , s = 50 , cmap = 'spring' , alpha = 0.5 ) #plt.xlim(-1, 4) #plt.ylim(-1, 6) plot_svc_decision_function ( clf , plt . gca ()) plt . scatter ( clf . support_vectors_ [:, 0 ], clf . support_vectors_ [:, 1 ], s = 100 , facecolors = None , lw = 2 , alpha = 0.4 ) print ( dict ( kernel = \"linear\" , ** thesvcfit . best_params_ )) clsvc = SVC ( ** dict ( kernel = \"linear\" , ** thesvcfit . best_params_ )) . fit ( Xtr , ytr ) plot_svm_new ( clsvc , Xtr , ytr , Xte , yte ) {'kernel': 'linear', 'C': 0.071968567300115138} The best fit allows for a bigger margin by allowing some inbetween penalization. If we use the standard C=1 in scikit-learn you see that we are allowing for less penalization. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-11/note1/"},{"title":"Lab 9: Random Forest and Boosting","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting - Solutions Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Kevin Rader (today at least) Authors: Kevin Rader, Rahul Dave In [1]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } We will look here into the practicalities of fitting regression trees, random forests, and boosted trees. These involve out-of-bound estmates and cross-validation, and how you might want to deal with hyperparameters in these models. Along the way we will play a little bit with different loss functions, so that you start thinking about what goes in general into cooking up a machine learning model. In [2]: % matplotlib inline import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn.apionly as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"poster\" ) /anaconda3/lib/python3.7/site-packages/matplotlib/__init__.py:855: MatplotlibDeprecationWarning: examples.directory is deprecated; in the future, examples will be found relative to the 'datapath' directory. \"found relative to the 'datapath' directory.\".format(key)) /anaconda3/lib/python3.7/site-packages/matplotlib/__init__.py:846: MatplotlibDeprecationWarning: The text.latex.unicode rcparam was deprecated in Matplotlib 2.2 and will be removed in 3.1. \"2.2\", name=key, obj_type=\"rcparam\", addendum=addendum) /anaconda3/lib/python3.7/site-packages/seaborn/apionly.py:9: UserWarning: As seaborn no longer sets a default style on import, the seaborn.apionly module is deprecated. It will be removed in a future version. warnings.warn(msg, UserWarning) Dataset First, the data. We will be attempting to predict the presidential election results (at the county level) from 2016, measured as 'votergap' = (trump - clinton) in percentage points, based mostly on demographic features of those counties. Let's quick take a peak at the data: In [5]: elect_df = pd . read_csv ( \"data/county_level_election.csv\" ) elect_df . head () Out[5]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } state fipscode county population hispanic minority female unemployed income nodegree bachelor inactivity obesity density cancer votergap trump clinton 0 Colorado 8117 Summit County 27239 15.173 4.918 45.996 2.5 68352 5.4 48.1 8.1 13.1 46.0 46.2 -27.632 31.530 59.162 1 Colorado 8037 Eagle County 53653 30.040 5.169 47.231 3.1 76661 10.1 47.3 9.4 11.8 31.0 47.1 -19.897 36.058 55.955 2 Idaho 16067 Minidoka County 19226 34.070 5.611 49.318 3.7 46332 24.1 11.8 18.3 34.2 80.0 61.8 54.148 71.135 16.987 3 Colorado 8113 San Miguel County 7558 10.154 4.747 46.808 3.7 59603 4.7 54.4 12.4 16.7 5.7 62.6 -44.769 23.892 68.662 4 Utah 49051 Wasatch County 21600 13.244 4.125 48.812 3.4 65207 9.5 34.4 13.9 23.0 257.8 68.3 25.357 50.471 25.114 In [6]: from sklearn.model_selection import train_test_split In [7]: # split 80/20 train-test X = elect_df [[ 'population' , 'hispanic' , 'minority' , 'female' , 'unemployed' , 'income' , 'nodegree' , 'bachelor' , 'inactivity' , 'obesity' , 'density' , 'cancer' ]] response = elect_df [ 'votergap' ] Xtrain , Xtest , ytrain , ytest = train_test_split ( X , response , test_size = 0.2 ) In [8]: plt . hist ( ytrain ) Xtrain . hist ( column = [ 'minority' , 'population' , 'hispanic' , 'female' ]); How would you describe these variables? In [9]: print ( elect_df . shape ) print ( Xtrain . shape ) print ( Xtest . shape ) (3066, 18) (2452, 12) (614, 12) General Trees We could use a simple Decision Tree regressor to predict votergap. Thats not the aim of this lab, so we'll run a few of these models without any cross-validation or 'regularization' just to illustrate what is going on. This is what you ought to keep in mind about decision trees. from the docs: max_depth : int or None, optional (default=None) The maximum depth of the tree. If None, then nodes are expanded until all leaves are pure or until all leaves contain less than min_samples_split samples. min_samples_split : int, float, optional (default=2) The deeper the tree, the more prone you are to overfitting. The smaller min_samples_split , the more the overfitting. One may use min_samples_leaf instead. More samples per leaf, the higher the bias. In [10]: from sklearn.tree import DecisionTreeRegressor #x = np.arange(0, 2*np.pi, 0.1) #y = np.sin(x) + 0.1*np.random.normal(size=x.shape[0]) x = Xtrain [ 'minority' ] . values o = np . argsort ( x ) x = x [ o ] y = ytrain . values y = y [ o ] In [11]: plt . plot ( x , y , '.' ); In [12]: plt . plot ( np . log ( x ), y , '.' ); **Exercise 0** Which of the two versions of 'minority' would be a better choice to use as a predictor for inference? For prediction? In [13]: plt . plot ( np . log ( x ), y , '.' ) xx = np . log ( x ) . reshape ( - 1 , 1 ) for i in [ 1 , 2 ]: dtree = DecisionTreeRegressor ( max_depth = i ) dtree . fit ( xx , y ) plt . plot ( np . log ( x ), dtree . predict ( xx ), label = str ( i ), alpha = 1 - i / 10 , lw = 4 ) plt . legend (); In [14]: plt . plot ( np . log ( x ), y , '.' ) xx = np . log ( x ) . reshape ( - 1 , 1 ) for i in [ 500 , 200 , 100 , 20 ]: dtree = DecisionTreeRegressor ( min_samples_split = i ) dtree . fit ( xx , y ) plt . plot ( np . log ( x ), dtree . predict ( xx ), label = str ( i ), alpha = 0.8 , lw = 4 ) plt . legend (); In [15]: plt . plot ( np . log ( x ), y , '.' ) xx = np . log ( x ) . reshape ( - 1 , 1 ) for i in [ 500 , 200 , 100 , 20 ]: dtree = DecisionTreeRegressor ( max_depth = 6 , min_samples_split = i ) dtree . fit ( xx , y ) plt . plot ( np . log ( x ), dtree . predict ( xx ), label = str ( i ), alpha = 0.8 , lw = 4 ) plt . legend (); In [16]: #let's also include logminority as a predictor going forward xtemp = np . log ( Xtrain [ 'minority' ] . values ) Xtrain = Xtrain . assign ( logminority = xtemp ) Xtest = Xtest . assign ( logminority = np . log ( Xtest [ 'minority' ] . values )) Xtrain . head () Out[16]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } population hispanic minority female unemployed income nodegree bachelor inactivity obesity density cancer logminority 1569 17792 11.214 10.165 49.393 7.2 47781 11.0 22.4 17.0 24.4 12.6 231.8 2.318950 306 34410 2.767 24.961 49.938 5.3 64533 14.4 22.3 22.3 31.2 79.5 154.3 3.217315 1153 13736 5.875 2.856 49.122 5.7 51285 14.2 9.1 32.4 35.3 170.5 213.1 1.049422 934 769644 22.427 50.419 51.923 6.7 54603 16.2 32.3 25.6 28.7 324.4 202.5 3.920368 1415 8882 1.793 3.118 50.663 4.3 43178 8.9 14.0 30.1 32.8 23.0 224.3 1.137192 **Exercise 1** Perform 5-fold cross-validation to determine what the best max_depth would be for a single regression tree using the entire 'Xtrain' feature set. Visualize the results with mean +/- 2 sd's across the validation sets. In [17]: from sklearn.model_selection import cross_val_score # your code here depths = list ( range ( 1 , 21 )) train_scores = [] cvmeans = [] cvstds = [] cv_scores = [] for depth in depths : dtree = DecisionTreeRegressor ( max_depth = depth ) # Perform 5-fold cross validation and store results train_scores . append ( dtree . fit ( Xtrain , ytrain ) . score ( Xtrain , ytrain )) scores = cross_val_score ( estimator = dtree , X = Xtrain , y = ytrain , cv = 5 ) cvmeans . append ( scores . mean ()) cvstds . append ( scores . std ()) cvmeans = np . array ( cvmeans ) cvstds = np . array ( cvstds ) In [18]: # your code here # plot means and shade the 2 SD interval plt . plot ( depths , cvmeans , '*-' , label = \"Mean CV\" ) plt . fill_between ( depths , cvmeans - 2 * cvstds , cvmeans + 2 * cvstds , alpha = 0.3 ) ylim = plt . ylim () plt . plot ( depths , train_scores , '-+' , label = \"Train\" ) plt . legend () plt . ylabel ( \"Accuracy\" ) plt . xlabel ( \"Max Depth\" ) plt . xticks ( depths ); Based on the plot above, it's clear that the training $R&#94;2$ increases towards zero as max_depth increases, while the test set's $R&#94;2$ maxes out around 62-63% around a max_depth of 7-9. Any of those values would be reasonable to choose for a best predictive model. To prevent overfitting and for parsimony, Iwould choose a max_depth of 7. Ok with this discussion in mind, lets improve this model by Bagging. Bootstrap-Aggregating (called Bagging) Whats the basic idea? A Single Decision tree is likely to overfit. So lets introduce replication through Bootstrap sampling. Bagging uses bootstrap resampling to create different training datasets. This way each training will give us a different tree. Added bonus: the left off points can be used to as a natural \"validation\" set, so no need to Since we have many trees that we will average over for prediction , we can choose a large max_depth and we are ok as we will rely on the law of large numbers to shrink this large variance, low bias approach for each individual tree. In [19]: from sklearn.utils import resample ntrees = 500 estimators = [] R2s = [] yhats_test = np . zeros (( Xtest . shape [ 0 ], ntrees )) plt . plot ( np . log ( x ), y , '.' ) for i in range ( ntrees ): simpletree = DecisionTreeRegressor ( max_depth = 3 ) boot_xx , boot_y = resample ( Xtrain [[ 'logminority' ]], ytrain ) estimators = np . append ( estimators , simpletree . fit ( boot_xx , boot_y )) R2s = np . append ( R2s , simpletree . score ( Xtest [[ 'logminority' ]], ytest )) yhats_test [:, i ] = simpletree . predict ( Xtest [[ 'logminority' ]]) plt . plot ( np . log ( x ), simpletree . predict ( np . log ( x ) . reshape ( - 1 , 1 )), 'red' , alpha = 0.05 ) In [20]: yhats_test . shape Out[20]: (614, 500) **Exercise 2** Edit the code below (which is just copied from above) to refit many bagged trees on the entire Xtrain feature set (without the plot...lots of predictors now so difficult to plot). Summarize how each of the separate trees performed (both numerically and visually) using $R&#94;2$ as the metric. How do they perform on average? Combine the trees into one prediction and evaluate it using $R&#94;2$. Briefly discuss the results. How will the results above change if 'max_depth' is increased? What if it is decreased? In [21]: from sklearn.metrics import r2_score ntrees = 500 estimators = [] R2s = [] yhats_test = np . zeros (( Xtest . shape [ 0 ], ntrees )) for i in range ( ntrees ): simpletree = DecisionTreeRegressor ( max_depth = 4 ) boot_xx , boot_y = resample ( Xtrain , ytrain ) estimators = np . append ( estimators , simpletree . fit ( boot_xx , boot_y )) R2s = np . append ( R2s , simpletree . score ( Xtest , ytest )) yhats_test [:, i ] = simpletree . predict ( Xtest ) # your code here #let's look at how the bagging does: plt . hist ( R2s ); print ( \"Average R-squared score of the individual trees:\" , np . mean ( R2s )) bagged_test_predictions = np . mean ( yhats_test , axis = 1 ) print ( \"R-squared score of the aggregated trees:\" , r2_score ( ytest , bagged_test_predictions )) Average R-squared score of the individual trees: 0.552367431975 R-squared score of the aggregated trees: 0.631678199922 Notice that the aggregated results, by averaging the predictions across the 500 different Regression Tree models, scores and $R&#94;2$ in the test set of 64.9% which outperforms all of the separate individual models. We would expect this to improve further for larger values of max_depth , and in fact should imrpove quite a lot. This Bagging improves the variability of 'high variance' models by leveraging the law of large numbers, but does not improve bias nearly as much. Essentially, it is an indirect way of 'smoothing' these discretized step function by essentially jittering where those jumps occur. See the visual above. If we do change max_depth to something larger in the code above, we do see quite an improvement in predictive ability in the test set. A max_depth of 20 led to a test $R&#94;2$ of 78.5%, for example. Random Forests What's the basic idea? Bagging alone is not enough randomization, because even after bootstrapping, we are mainly training on the same data points using the same variablesn, and will retain much of the overfitting. So we will build each tree by splitting on \"random\" subset of predictors at each split (hence, each is a 'random tree'). This can't be done in with just one predcitor, but with more predictors we can choose what predictors to split on randomly and how many to do this on. Then we combine many 'random trees' together by averaging their predictions, and this gets us a forest of random trees: a random forest . Below we create a hyper-param Grid. We are preparing to use the bootstrap points not used in training for validation. max_features : int, float, string or None, optional (default=\"auto\") - The number of features to consider when looking for the best split. max_features : Default splits on all the features and is probably prone to overfitting. You'll want to validate on this. You can \"validate\" on the trees n_estimators as well but many a times you will just look for the plateau in the trees as seen below. From decision trees you get the max_depth , min_samples_split , and min_samples_leaf as well but you might as well leave those at defaults to get a maximally expanded tree. In [22]: from sklearn.ensemble import RandomForestRegressor In [23]: # code from # Adventures in scikit-learn's Random Forest by Gregory Saunders from itertools import product from collections import OrderedDict param_dict = OrderedDict ( n_estimators = [ 400 , 600 , 800 ], max_features = [ 0.2 , 0.4 , 0.6 , 0.8 ] ) param_dict . values () Out[23]: odict_values([[400, 600, 800], [0.2, 0.4, 0.6, 0.8]]) Using the OOB score. We have been putting \"validate\" in quotes. This is because the bootstrap gives us left-over points! So we'll now engage in our very own version of a grid-search, done over the out-of-bag scores that sklearn gives us for free In [24]: from itertools import product In [25]: #make sure ytrain is the correct data type...in case you have warnings #print(yytrain.shape,ytrain.shape,Xtrain.shape) #ytrain = np.ravel(ytrain) #Let's Cross-val. on the two 'hyperparameters' we based our grid on earlier results = {} estimators = {} for ntrees , maxf in product ( * param_dict . values ()): params = ( ntrees , maxf ) est = RandomForestRegressor ( oob_score = True , n_estimators = ntrees , max_features = maxf , max_depth = 50 , n_jobs =- 1 ) est . fit ( Xtrain , ytrain ) results [ params ] = est . oob_score_ estimators [ params ] = est outparams = max ( results , key = results . get ) outparams Out[25]: (800, 0.6) In [26]: rf1 = estimators [ outparams ] In [27]: results Out[27]: {(400, 0.2): 0.75545034159631475, (400, 0.4): 0.76904520627814343, (400, 0.6): 0.7714063389285728, (400, 0.8): 0.77093228908586808, (600, 0.2): 0.75389417406993875, (600, 0.4): 0.77059680071750347, (600, 0.6): 0.77163543964275172, (600, 0.8): 0.77293158741686452, (800, 0.2): 0.75642142962369552, (800, 0.4): 0.77153354385823691, (800, 0.6): 0.77302008538924816, (800, 0.8): 0.77211871587521286} In [28]: rf1 . score ( Xtest , ytest ) Out[28]: 0.77953336933057904 Finally you can find the feature importance of each predictor in this random forest model. Whenever a feature is used in a tree in the forest, the algorithm will log the decrease in the splitting criterion (such as gini). This is accumulated over all trees and reported in est.feature_importances_ In [29]: pd . Series ( rf1 . feature_importances_ , index = list ( Xtrain )) . sort_values () . plot ( kind = \"barh\" ) Out[29]: Since our response isn't very symmetric, we may want to suppress outliers by using the mean_absolute_error instead. In [30]: from sklearn.metrics import mean_absolute_error mean_absolute_error ( ytest , rf1 . predict ( Xtest )) Out[30]: 11.606474552117264 **Bonus Exercise (we will likely skip this)** Tune the 'RandomForestRegressor' above to minimize 'mean_absolute_error' instead of the default __ Note: sklearn supports this ( criterion='mae' ) since v0.18, but does not have completely arbitrary loss functions for Random Forests. In [31]: # your code here # Note: there were estimation/convergence issues using MAE with CV, # so just one example is provided below. rf_mae = RandomForestRegressor ( oob_score = True , criterion = 'mae' , n_estimators = 400 , max_features = 0.4 , max_depth = 20 , n_jobs =- 1 ) rf_mae . fit ( Xtrain , ytrain ) Out[31]: RandomForestRegressor(bootstrap=True, criterion='mae', max_depth=20, max_features=0.4, max_leaf_nodes=None, min_impurity_split=1e-07, min_samples_leaf=1, min_samples_split=2, min_weight_fraction_leaf=0.0, n_estimators=400, n_jobs=-1, oob_score=True, random_state=None, verbose=0, warm_start=False) In [43]: #rf_mae = estimators[outparams] print ( mean_absolute_error ( ytest , rf_mae . predict ( Xtest ))) print ( rf_mae . score ( Xtest , ytest )) 11.7608364149 0.772670131678 This model would be expected to perform better in the test set when measuring mean absolute error, but not as good at mean squared error (but this is not guaranteed). Here, we do not cross-validate, so that might explain why mean absolute error is worse. Note: instead of using oob scoring, we could do cross-validation (with GridSearchCV), and a cv of 3 will roughly be comparable (same approximate train-vs.-validation set sizes). But this will take much more time as you are doing the fit 3 times plus the bootstraps. So at least three times as long! In [51]: param_dict2 = OrderedDict ( n_estimators = [ 400 , 600 , 800 ], max_features = [ 0.2 , 0.4 , 0.6 , 0.8 ] ) In [52]: from sklearn.model_selection import GridSearchCV est2 = RandomForestRegressor ( oob_score = False ) gs = GridSearchCV ( est2 , param_grid = param_dict2 , cv = 3 , n_jobs =- 1 ) gs . fit ( Xtrain , ytrain ) Out[52]: GridSearchCV(cv=3, error_score='raise', estimator=RandomForestRegressor(bootstrap=True, criterion='mse', max_depth=None, max_features='auto', max_leaf_nodes=None, min_impurity_split=1e-07, min_samples_leaf=1, min_samples_split=2, min_weight_fraction_leaf=0.0, n_estimators=10, n_jobs=1, oob_score=False, random_state=None, verbose=0, warm_start=False), fit_params={}, iid=True, n_jobs=-1, param_grid=OrderedDict([('n_estimators', [400, 600, 800]), ('max_features', [0.2, 0.4, 0.6, 0.8])]), pre_dispatch='2*n_jobs', refit=True, return_train_score=True, scoring=None, verbose=0) In [53]: rf2 = gs . best_estimator_ rf2 Out[53]: RandomForestRegressor(bootstrap=True, criterion='mse', max_depth=None, max_features=0.6, max_leaf_nodes=None, min_impurity_split=1e-07, min_samples_leaf=1, min_samples_split=2, min_weight_fraction_leaf=0.0, n_estimators=800, n_jobs=1, oob_score=False, random_state=None, verbose=0, warm_start=False) In [54]: gs . best_score_ Out[54]: 0.7624526002930303 **Exercise 3: thinking questions** What are the 3 hyperparameters for a random forest (one of the hyperparameters come in many flavors )? Which hyperparameters need to be tuned? Answers The 3 hyperparameters are max_features , max_depth (or something related, like min_samples_split , so control the complexity of each tree), and n_estimators (in classification, the splitting criteria is another one you could consider) max_features and max_depth need to be tuned, while the higher n_estimators the better (though there is clearly diminishing return, so just use someting 'largish' in the hundreds). The best tuned max_features and max_depth will depend on the number of predictors you are considering, the number of observations in the training set, and whether it is a regression or a classification problem. There are lots of rules of thumb out there, but cross-validate if you can. Seeing error as a function of the proportion of predictors at each split Let's look to see how max_features affects performance on the training set. In [55]: # from http://scikit-learn.org/stable/auto_examples/ensemble/plot_ensemble_oob.html feats = param_dict [ 'max_features' ] # error_rate = OrderedDict (( label , []) for label in feats ) # Range of `n_estimators` values to explore. min_estimators = 200 step_estimators = 100 num_steps = 6 max_estimators = min_estimators + step_estimators * num_steps for label in feats : for i in range ( min_estimators , max_estimators + 1 , step_estimators ): clf = RandomForestRegressor ( oob_score = True , max_features = label ) clf . set_params ( n_estimators = i ) clf . fit ( Xtrain , ytrain ) # Record the OOB error for each `n_estimators=i` setting. oob_error = 1 - clf . oob_score_ error_rate [ label ] . append (( i , oob_error )) In [56]: print ( feats ) [0.2, 0.4, 0.6, 0.8] In [57]: # Generate the \"OOB error rate\" vs. \"n_estimators\" plot. for label , clf_err in error_rate . items (): xs , ys = zip ( * clf_err ) plt . plot ( xs , ys , label = label ) plt . xlim ( min_estimators , max_estimators ) plt . xlabel ( \"n_estimators\" ) plt . ylabel ( \"OOB error rate\" ) plt . legend ( loc = \"upper right\" ) plt . show () Boosting Regression Trees Adaboost Classification, which you will be doing in your homework, is a special case of a gradient-boosted algorithm. Gradient Bossting is very state of the art, and has major connections to logistic regression, gradient descent in a functional space, and search in information space. See Schapire and Freund's MIT Press book for details (Google is a wonderful thing). But briefly, let us cover the idea here. The idea is that we will use a bunch of weak 'learners' (aka, models) which are fit sequentially. The first one fits the signal, the second one the first model's residual, the third the second model's residual, and so on. At each stage we upweight the places that our previous model did badly on. First let us illustrate. In [153]: from sklearn.ensemble import AdaBoostRegressor estab = AdaBoostRegressor ( base_estimator = DecisionTreeRegressor ( max_depth = 1 ), n_estimators = 500 , learning_rate = 1 ) estab . fit ( xx , y ) staged_predict_generator = estab . staged_predict ( xx ) In [59]: # code from http://nbviewer.jupyter.org/github/pprett/pydata-gbrt-tutorial/blob/master/gbrt-tutorial.ipynb import time from IPython import display plt . plot ( xx , y , '.' ); counter = 0 for stagepred in staged_predict_generator : counter = counter + 1 if counter in [ 1 , 2 , 4 , 8 , 10 , 50 , 100 , 200 ]: plt . plot ( xx , stagepred , alpha = 0.7 , label = str ( counter ), lw = 4 ) plt . legend (); display . display ( plt . gcf ()) display . clear_output ( wait = True ) time . sleep ( 1 ) In [160]: estab2 = AdaBoostRegressor ( base_estimator = DecisionTreeRegressor ( max_depth = 2 ), n_estimators = 1000 , learning_rate = 0.3 ) estab2 . fit ( Xtrain , ytrain ) print ( estab2 . score ( Xtrain , ytrain )) print ( estab2 . score ( Xtest , ytest )) staged_scores = estab2 . staged_score ( Xtest , ytest ) i = 1 scores = [] for stagesc in staged_scores : scores = np . append ( scores , stagesc ) i = i + 1 plt . plot ( scores ); 0.574891322117 0.533152494119 Ok, so this demonstration helps us understand some things about boosting. n_estimators is the number of trees, and thus the stage in the fitting. It also controls the complexity for us. The more trees we have the more we fit to the tiny details. staged_predict gives us the prediction at each step once again max_depth from the underlying decision tree tells us the depth of the tree. But here it tells us the amount of features interactions we have, not just the scale of our fit. But clearly it increases the variance again. Ideas from decision trees remain. For example, increase min_samples_leaf or decrease max_depth to reduce variance and increase the bias. **Exercise 4** What do you expect to happen if you increase max_depth to 5? Edit the code above to explore the result. What do you expect to happen if you put max_depth back to 1 and decrease the learning_rate to 0.1? Edit the code above to explore the result. Do a little work to find some sort of 'best' values of max_depth and learning_rate . Does this result make sense? Answers Increasing max_depth for each model does not really improve things. It will make each model more complex, which may not be a good thing. We want lots of little models that each are not overfit, so allowing any single model to have a lot of complexity (and thus overfit) could be a problem. The model will progress much more slowly to fitting to the data well. This may be a good thing: this is essentially a form of 'regularization' in each model and will help prevent overfitting to any one model. It allows future models to have more 'error' to be able to explain. See code below. In [163]: # your code here param_dict3 = OrderedDict ( n_estimators = [ 200 ], learning_rate = [ 0.2 , 0.4 , 0.6 , 0.8 ] ) best_scores = [] max_depths = [ 5 , 10 , 15 ] for depth in max_depths : estab = AdaBoostRegressor ( base_estimator = DecisionTreeRegressor ( max_depth = depth )) gs = GridSearchCV ( estab , param_grid = param_dict3 , cv = 3 , n_jobs =- 1 ) gs . fit ( Xtrain , ytrain ) best_scores = np . append ( best_scores , gs . best_score_ ) In [164]: best_scores Out[164]: array([ 0.73579725, 0.76361808, 0.76487793]) Note: what's the relationship between residuals and the gradient? Pavlos showed in class that for the squared loss, taking the gradient in the \"data point functional space\", ie a N-d space for N data points with each variable being $f(x_i)$ just gives us the residuals. It turns out that the gradient descent is a more general idea, and one can use this for different losses. And the upweighting of poorly fit points in AdaBoost is simply a weighing by gradient. If the gradient (or residual) is high it means you are far away from optimum in this functional space, and if you are at 0, you have a flat gradient! The ideas from the general theory of gradient descent tell us this: we can slow the learning by shrinking the predictions of each tree by some small number, which is called the learning_rate (learning_rate). This \"shrinkage\" helps us not overshoot, but for a finite number of iterations also simultaneously ensures we dont overfit by being in the neighboorhood of the minimum rather than just at it! But we might need to increase the iterations some to get into the minimum area. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-9/solutions/"},{"title":"Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 9: Decision Trees, Bagged Trees, Random Forests and Boosting - Student Version Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Kevin Rader (today at least) Authors: Kevin Rader, Rahul Dave In [2]: ## RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[2]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } We will look here into the practicalities of fitting regression trees, random forests, and boosted trees. These involve out-of-bound estmates and cross-validation, and how you might want to deal with hyperparameters in these models. Along the way we will play a little bit with different loss functions, so that you start thinking about what goes in general into cooking up a machine learning model. In [15]: % matplotlib inline import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"poster\" ) Dataset First, the data. We will be attempting to predict the presidential election results (at the county level) from 2016, measured as 'votergap' = (trump - clinton) in percentage points, based mostly on demographic features of those counties. Let's quick take a peak at the data: In [16]: elect_df = pd . read_csv ( \"county_level_election.csv\" ) elect_df . head () Out[16]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } state fipscode county population hispanic minority female unemployed income nodegree bachelor inactivity obesity density cancer votergap trump clinton 0 Colorado 8117 Summit County 27239 15.173 4.918 45.996 2.5 68352 5.4 48.1 8.1 13.1 46.0 46.2 -27.632 31.530 59.162 1 Colorado 8037 Eagle County 53653 30.040 5.169 47.231 3.1 76661 10.1 47.3 9.4 11.8 31.0 47.1 -19.897 36.058 55.955 2 Idaho 16067 Minidoka County 19226 34.070 5.611 49.318 3.7 46332 24.1 11.8 18.3 34.2 80.0 61.8 54.148 71.135 16.987 3 Colorado 8113 San Miguel County 7558 10.154 4.747 46.808 3.7 59603 4.7 54.4 12.4 16.7 5.7 62.6 -44.769 23.892 68.662 4 Utah 49051 Wasatch County 21600 13.244 4.125 48.812 3.4 65207 9.5 34.4 13.9 23.0 257.8 68.3 25.357 50.471 25.114 In [4]: from sklearn.model_selection import train_test_split In [5]: # split 80/20 train-test X = elect_df [[ 'population' , 'hispanic' , 'minority' , 'female' , 'unemployed' , 'income' , 'nodegree' , 'bachelor' , 'inactivity' , 'obesity' , 'density' , 'cancer' ]] response = elect_df [ 'votergap' ] Xtrain , Xtest , ytrain , ytest = train_test_split ( X , response , test_size = 0.2 ) In [6]: plt . hist ( ytrain ) Xtrain . hist ( column = [ 'minority' , 'population' , 'hispanic' , 'female' ]); How would you describe these variables? In [7]: print ( elect_df . shape ) print ( Xtrain . shape ) print ( Xtest . shape ) (3066, 18) (2452, 12) (614, 12) Regression Trees We will start by using a simple Decision Tree Regressor to predict votergap. Thats not the aim of this lab, so we'll run a few of these models without any cross-validation or 'regularization' just to illustrate what is going on. This is what you ought to keep in mind about decision trees. from the docs: max_depth : int or None, optional (default=None) The maximum depth of the tree. If None, then nodes are expanded until all leaves are pure or until all leaves contain less than min_samples_split samples. min_samples_split : int, float, optional (default=2) The deeper the tree, the more prone you are to overfitting. The smaller min_samples_split , the more the overfitting. One may use min_samples_leaf instead. More samples per leaf, the higher the bias. In [8]: from sklearn.tree import DecisionTreeRegressor #x = np.arange(0, 2*np.pi, 0.1) #y = np.sin(x) + 0.1*np.random.normal(size=x.shape[0]) x = Xtrain [ 'minority' ] . values o = np . argsort ( x ) x = x [ o ] y = ytrain . values y = y [ o ] In [9]: plt . plot ( x , y , '.' ); In [10]: plt . plot ( np . log ( x ), y , '.' ); **Exercise 0** Which of the two versions of 'minority' would be a better choice to use as a predictor for inference? For prediction? In [11]: plt . plot ( np . log ( x ), y , '.' ) xx = np . log ( x ) . reshape ( - 1 , 1 ) for i in [ 1 , 2 ]: dtree = DecisionTreeRegressor ( max_depth = i ) dtree . fit ( xx , y ) plt . plot ( np . log ( x ), dtree . predict ( xx ), label = str ( i ), alpha = 1 - i / 10 , lw = 4 ) plt . legend (); In [12]: plt . plot ( np . log ( x ), y , '.' ) xx = np . log ( x ) . reshape ( - 1 , 1 ) for i in [ 500 , 200 , 100 , 20 ]: dtree = DecisionTreeRegressor ( min_samples_split = i ) dtree . fit ( xx , y ) plt . plot ( np . log ( x ), dtree . predict ( xx ), label = str ( i ), alpha = 0.8 , lw = 4 ) plt . legend (); In [13]: plt . plot ( np . log ( x ), y , '.' ) xx = np . log ( x ) . reshape ( - 1 , 1 ) for i in [ 500 , 200 , 100 , 20 ]: dtree = DecisionTreeRegressor ( max_depth = 6 , min_samples_split = i ) dtree . fit ( xx , y ) plt . plot ( np . log ( x ), dtree . predict ( xx ), label = str ( i ), alpha = 0.8 , lw = 4 ) plt . legend (); In [14]: #let's also include logminority as a predictor going forward xtemp = np . log ( Xtrain [ 'minority' ] . values ) Xtrain = Xtrain . assign ( logminority = xtemp ) Xtest = Xtest . assign ( logminority = np . log ( Xtest [ 'minority' ] . values )) Xtrain . head () Out[14]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } population hispanic minority female unemployed income nodegree bachelor inactivity obesity density cancer logminority 521 37907 1.867 5.811 49.366 4.6 44077 12.7 14.5 32.4 32.3 435.8 175.9 1.759753 2933 15884 1.669 8.167 48.987 7.1 41810 9.3 16.8 23.8 28.7 18.8 324.1 2.100102 1462 1547297 13.974 54.930 52.731 6.9 39037 18.6 24.5 25.7 29.8 83.4 226.3 4.006060 307 62574 4.702 7.572 46.402 4.4 48681 11.7 14.2 20.6 38.0 505.1 154.3 2.024457 972 1789900 28.182 25.267 51.074 4.2 58127 15.3 29.7 24.0 29.1 8.8 204.1 3.229499 **Exercise 1** Perform 5-fold cross-validation to determine what the best max_depth would be for a single regression tree using the entire 'Xtrain' feature set. Visualize the results with mean +/- 2 sd's across the validation sets. In [ ]: from sklearn.model_selection import cross_val_score # your code here depths = list ( range ( 1 , 21 )) train_scores = [] cvmeans = [] cvstds = [] cv_scores = [] for depth in depths : dtree = DecisionTreeRegressor ( max_depth = depth ) # Perform 5-fold cross validation and store results cv_scores = cross_val_score ( dtree , Xtrain , ytrain , cv = 5 ) cvmeans = append () cvmeans = np . array ( cvmeans ) cvstds = np . array ( cvstds ) In [ ]: # your code here # plot means and shade the 2 SD interval #plt.fill_between(depths, cvmeans - 2*cvstds, cvmeans + 2*cvstds, alpha=0.3); Ok with this discussion in mind, lets improve this model by Bagging. Bootstrap-Aggregating (called Bagging) Whats the basic idea? A Single Decision tree is likely to overfit. So lets introduce replication through Bootstrap sampling. Bagging uses bootstrap resampling to create different training datasets. This way each training will give us a different tree. Added bonus: the left off points can be used to as a natural \"validation\" set, so no need to Since we have many trees that we will average over for prediction , we can choose a large max_depth and we are ok as we will rely on the law of large numbers to shrink this large variance, low bias approach for each individual tree. In [ ]: from sklearn.utils import resample ntrees = 500 estimators = [] R2s = [] yhats_test = np . zeros (( Xtest . shape [ 0 ], ntrees )) plt . plot ( np . log ( x ), y , '.' ) for i in range ( ntrees ): simpletree = DecisionTreeRegressor ( max_depth = 3 ) boot_xx , boot_y = resample ( Xtrain [[ 'logminority' ]], ytrain ) estimators = np . append ( estimators , simpletree . fit ( boot_xx , boot_y )) R2s = np . append ( R2s , simpletree . score ( Xtest [[ 'logminority' ]], ytest )) yhats_test [:, i ] = simpletree . predict ( Xtest [[ 'logminority' ]]) plt . plot ( np . log ( x ), simpletree . predict ( np . log ( x ) . reshape ( - 1 , 1 )), 'red' , alpha = 0.05 ) In [ ]: yhats_test . shape **Exercise 2** Edit the code below (which is just copied from above) to refit many bagged trees on the entire xtrain feature set (without the plot...lots of predictors now so difficult to plot). Summarize how each of the separate trees performed (both numerically and visually) using $R&#94;2$ as the metric. How do they perform on average? Combine the trees into one prediction and evaluate it using $R&#94;2$. Briefly discuss the results. How will the results above change if 'max_depth=4' is increased? What if it is decreased? In [ ]: from sklearn.metrics import r2_score ntrees = 500 estimators = [] R2s = [] yhats_test = np . zeros (( Xtest . shape [ 0 ], ntrees )) for i in range ( ntrees ): dtree = DecisionTreeRegressor ( max_depth = 3 ) boot_xx , boot_y = resample ( Xtrain [[ 'logminority' ]], ytrain ) estimators = np . append ( estimators , dtree . fit ( boot_xx , boot_y )) R2s = np . append ( R2s , dtree . score ( Xtest [[ 'logminority' ]], ytest )) yhats_test [:, i ] = dtree . predict ( Xtest [[ 'logminority' ]]) # your code here Your answer here Random Forests What's the basic idea? Bagging alone is not enough randomization, because even after bootstrapping, we are mainly training on the same data points using the same variablesn, and will retain much of the overfitting. So we will build each tree by splitting on \"random\" subset of predictors at each split (hence, each is a 'random tree'). This can't be done in with just one predcitor, but with more predictors we can choose what predictors to split on randomly and how many to do this on. Then we combine many 'random trees' together by averaging their predictions, and this gets us a forest of random trees: a random forest . Below we create a hyper-param Grid. We are preparing to use the bootstrap points not used in training for validation. max_features : int, float, string or None, optional (default=\"auto\") - The number of features to consider when looking for the best split. max_features : Default splits on all the features and is probably prone to overfitting. You'll want to validate on this. You can \"validate\" on the trees n_estimators as well but many a times you will just look for the plateau in the trees as seen below. From decision trees you get the max_depth , min_samples_split , and min_samples_leaf as well but you might as well leave those at defaults to get a maximally expanded tree. In [ ]: from sklearn.ensemble import RandomForestRegressor In [ ]: # code from # Adventures in scikit-learn's Random Forest by Gregory Saunders from itertools import product from collections import OrderedDict param_dict = OrderedDict ( n_estimators = [ 400 , 600 , 800 ], max_features = [ 0.2 , 0.4 , 0.6 , 0.8 ] ) param_dict . values () Using the OOB score. We have been putting \"validate\" in quotes. This is because the bootstrap gives us left-over points! So we'll now engage in our very own version of a grid-search, done over the out-of-bag scores that sklearn gives us for free In [ ]: from itertools import product In [ ]: #make sure ytrain is the correct data type...in case you have warnings #print(yytrain.shape,ytrain.shape,Xtrain.shape) #ytrain = np.ravel(ytrain) #Let's Cross-val. on the two 'hyperparameters' we based our grid on earlier results = {} estimators = {} for ntrees , maxf in product ( * param_dict . values ()): params = ( ntrees , maxf ) est = RandomForestRegressor ( oob_score = True , n_estimators = ntrees , max_features = maxf , max_depth = 50 , n_jobs =- 1 ) est . fit ( Xtrain , ytrain ) results [ params ] = est . oob_score_ estimators [ params ] = est outparams = max ( results , key = results . get ) outparams In [ ]: rf1 = estimators [ outparams ] In [ ]: results In [ ]: rf1 . score ( Xtest , ytest ) Finally you can find the feature importance of each predictor in this random forest model. Whenever a feature is used in a tree in the forest, the algorithm will log the decrease in the splitting criterion (such as gini). This is accumulated over all trees and reported in est.feature_importances_ In [ ]: pd . Series ( rf1 . feature_importances_ , index = list ( Xtrain )) . sort_values () . plot ( kind = \"barh\" ) Since our response isn't very symmetric, we may want to suppress outliers by using the mean_absolute_error instead. In [ ]: from sklearn.metrics import mean_absolute_error mean_absolute_error ( ytest , rf1 . predict ( Xtest )) **Bonus Exercise (we will likely skip this)** Tune the 'RandomForestRegressor' above to minimize 'mean_absolute_error' instead of the default __ Note: sklearn supports this ( criterion='mae' ) since v0.18, but does not have completely arbitrary loss functions for Random Forests. In [ ]: # your code here Note: instead of using oob scoring, we could do cross-validation, and a cv of 3 will roughly be comparable (same approximate train-vs.-validation set sizes). But this will take much more time as you are doing the fit 3 times plus the bootstraps. So at least three times as long! In [ ]: param_dict2 = OrderedDict ( n_estimators = [ 600 ], max_features = [ 0.2 , 0.4 , 0.6 , 0.8 ] ) In [ ]: from sklearn.model_selection import GridSearchCV est2 = RandomForestRegressor ( oob_score = False ) gs = GridSearchCV ( est2 , param_grid = param_dict2 , cv = 3 , n_jobs =- 1 ) gs . fit ( Xtrain , ytrain ) In [ ]: rf2 = gs . best_estimator_ rf2 In [ ]: gs . best_score_ **Exercise 3: thinking questions** What are the 3 hyperparameters for a random forest (one of the hyperparameters come in many flavors )? Which hyperparameters need to be tuned? How would you go about tuning these hyperparemeters? Your answer here Seeing error as a function of the proportion of predictors at each split Let's look to see how max_features affects performance on the training set. In [ ]: # from http://scikit-learn.org/stable/auto_examples/ensemble/plot_ensemble_oob.html feats = param_dict [ 'max_features' ] # error_rate = OrderedDict (( label , []) for label in feats ) # Range of `n_estimators` values to explore. min_estimators = 200 step_estimators = 100 num_steps = 3 max_estimators = min_estimators + step_estimators * num_steps for label in feats : for i in range ( min_estimators , max_estimators + 1 , step_estimators ): clf = RandomForestRegressor ( oob_score = True , max_features = label ) clf . set_params ( n_estimators = i ) clf . fit ( Xtrain , ytrain ) # Record the OOB error for each `n_estimators=i` setting. oob_error = 1 - clf . oob_score_ error_rate [ label ] . append (( i , oob_error )) In [ ]: print ( feats ) In [ ]: # Generate the \"OOB error rate\" vs. \"n_estimators\" plot. for label , clf_err in error_rate . items (): xs , ys = zip ( * clf_err ) plt . plot ( xs , ys , label = label ) plt . xlim ( min_estimators , max_estimators ) plt . xlabel ( \"n_estimators\" ) plt . ylabel ( \"OOB error rate\" ) plt . legend ( loc = \"upper right\" ) plt . show () Boosting Regression Trees Adaboost Classification, which you will be doing in your homework, is a special case of a gradient-boosted algorithm. Gradient Bossting is very state of the art, and has major connections to logistic regression, gradient descent in a functional space, and search in information space. See Schapire and Freund's MIT Press book for details (Google is a wonderful thing). But briefly, let us cover the idea here. The idea is that we will use a bunch of weak 'learners' (aka, models) which are fit sequentially. The first one fits the signal, the second one the first model's residual, the third the second model's residual, and so on. At each stage we upweight the places that our previous model did badly on. First let us illustrate. In [ ]: from sklearn.ensemble import AdaBoostRegressor estab = AdaBoostRegressor ( base_estimator = DecisionTreeRegressor ( max_depth = 1 ), n_estimators = 200 , learning_rate = 1.0 ) estab . fit ( xx , y ) staged_predict_generator = estab . staged_predict ( xx ) In [ ]: # code from http://nbviewer.jupyter.org/github/pprett/pydata-gbrt-tutorial/blob/master/gbrt-tutorial.ipynb import time from IPython import display plt . plot ( xx , y , '.' ); counter = 0 for stagepred in staged_predict_generator : counter = counter + 1 if counter in [ 1 , 2 , 4 , 8 , 10 , 50 , 100 , 200 ]: plt . plot ( xx , stagepred , alpha = 0.7 , label = str ( counter ), lw = 4 ) plt . legend (); display . display ( plt . gcf ()) display . clear_output ( wait = True ) time . sleep ( 1 ) In [ ]: print ( counter , i ) Ok, so this demonstration helps us understand some things about boosting. n_estimators is the number of trees, and thus the stage in the fitting. It also controls the complexity for us. The more trees we have the more we fit to the tiny details. staged_predict gives us the prediction at each step once again max_depth from the underlying decision tree tells us the depth of the tree. But here it tells us the amount of features interactions we have, not just the scale of our fit. But clearly it increases the variance again. Ideas from decision trees remain. For example, increase min_samples_leaf or decrease max_depth to reduce variance and increase the bias. **Exercise 4** What do you expect to happen if you increase max_depth to 5? Edit the code above to explore the result. What do you expect to happen if you put max_depth back to 1 and decrease the learning_rate to 0.1? Edit the code above to explore the result. Do a little work to find some sort of 'best' values of max_depth and learning_rate . Does this result make sense? In [ ]: # your code here Note: what's the relationship between residuals and the gradient? Pavlos showed in class that for the squared loss, taking the gradient in the \"data point functional space\", ie a N-d space for N data points with each variable being $f(x_i)$ just gives us the residuals. It turns out that the gradient descent is a more general idea, and one can use this for different losses. And the upweighting of poorly fit points in AdaBoost is simply a weighing by gradient. If the gradient (or residual) is high it means you are far away from optimum in this functional space, and if you are at 0, you have a flat gradient! The ideas from the general theory of gradient descent tell us this: we can slow the learning by shrinking the predictions of each tree by some small number, which is called the learning_rate (learning_rate). This \"shrinkage\" helps us not overshoot, but for a finite number of iterations also simultaneously ensures we dont overfit by being in the neighboorhood of the minimum rather than just at it! But we might need to increase the iterations some to get into the minimum area. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-9/student/"},{"title":"Lab 10: Neural Networks using keras","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 10: Keras for Artificial Neural Networks Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Lab Instructor: Eleni Kaxiras Authors: David Sondak, Eleni Kaxiras, and Pavlos Protopapas In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get \\ ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [ ]: import numpy as np import matplotlib.pyplot as plt plt . rcParams [ 'axes.labelsize' ] = 14 plt . rcParams [ 'xtick.labelsize' ] = 12 plt . rcParams [ 'ytick.labelsize' ] = 12 % matplotlib inline Anatomy of an Artificial Neural Network In a previous lab we created our own neural network by writing some simple python functions. We focused on a regression problem where we tried to learn a function. We practiced using the logistic activation function in a network with multiple nodes, but a single or two hidden layers. Some of the key observations were: Increasing the number of nodes allows us to represent more complicated functions The weights and biases have a very big impact on the solution Finding the \"correct\" weights and biases is really hard to do manually There must be a better method for determining the weights and biases automatically We also didn't assess the effects of different activation functions or different network depths. The 3 parts of an ANN Part 1: the input layer (dimentions are determined from our dataset) Part 2: the internal architecture or hidden layers (the number of layers, the activation functions, the learnable parameters and other hyperparameters) Part 3: the output layer (what we want from the network) A word about .npy files Numpy arrays are faster than plain python lists, as we know. Numpy also offers a file format called .npy, which, when it comes to reading the same data multiple times from disk storage, is a lot faster than reading from a csv file. You can save any list or array into this format. In [ ]: np . save ( '/tmp/123' , np . array ([[ 1 , 2 , 3 ], [ 4 , 5 , 6 ]])) hello = np . load ( '/tmp/123.npy' ) In [ ]: hello Keras Basics https://keras.io/ Machine learning computations can be quite demanding. TensorFlow is a framework for representing complicated ML algorithms and executing them in any platform, from a phone to a distributed system using GPUs. Developed by Google Brain, TensorFlow is used very broadly today. keras , is a high-level API used for fast prototyping, advanced research, and production. We will use tf.keras which is TensorFlow's implementation of the keras API. Models are assemblies of layers The core data structure of Keras is a model , a way to organize layers. A model is understood as a sequence or a graph of standalone, fully-configurable modules that can be plugged together with as few restrictions as possible. In particular, neural layers, cost functions, optimizers, initialization schemes, activation functions, regularization schemes are all standalone modules that you can combine to create new models. The simplest type of model is the Sequential model, a linear stack of layers. For more complex architectures, one can use the Keras Functional API, which allows to build arbitrary graphs of layers. https://keras.io/models/model/ Everything you need to know about the Sequential model is here: https://keras.io/models/sequential/ Keras Installation If you haven't already, install Keras using the instructions found at https://keras.io/#installation Choose the TensorFlow installation instructions (found at https://www.tensorflow.org/install/ ). Example: Approximating a Gaussian using keras Let's try to redo the problem from last week. Recall that we had a function $$ \\begin{aligned} f\\left(x\\right) = e&#94;{-x&#94;{2}} \\end{aligned} $$ and we wanted to use a neural network to approximate that function. This week, we will use keras to do the true optimization. First, we import the necessary keras modules. In [ ]: import tensorflow as tf from tensorflow.keras import layers from tensorflow.keras import models from tensorflow.keras.layers import Dense from tensorflow.keras.models import Sequential from tensorflow.keras.regularizers import l2 print ( tf . VERSION ) print ( tf . keras . __version__ ) In [ ]: # Checking if our machine has GPUs. Mine does not.. with tf . Session () as sess : devices = sess . list_devices () print ( devices ) Before we get started, we need to create some data . We will generate data points from an underlying function (here the Guassian). Then we will use the sklearn train_test_split method to split the dataset into training and testing portions. Remember that we train a machine learning algorithm on the training set and then assess the algorithm's performance on the test set. In [ ]: from sklearn.model_selection import train_test_split n_samples = 1050 # set the number of samples to take for each dataset test_size = 0.3 # set the proportion of data to hold out for testing # define the function and add noise def f_gauss ( x ): return np . exp ( - x * x ) + np . random . normal ( loc = 0 , scale =. 1 , size = x . shape [ 0 ]) X = np . random . permutation ( np . linspace ( - 10 , 10 , n_samples )) # choose some points from the function Y = f_gauss ( X ) # create training and testing data from this set of points X_train , X_test , Y_train , Y_test = train_test_split ( X , Y , test_size = test_size ) Let's plot the data In [ ]: import matplotlib.pyplot as plt plt . scatter ( X_train , Y_train ) Building a keras network Now we will create a neural network model with keras. We're going to use a single layer and just 2 neurons in that layer. We will start with the sigmoid activation function. We also choose a linear output layer since we are doing regression. The loss function is selected to be the mean squared error (MSE) . In addition to these choices we must also specify our initial weights as well as the optimization method that will be used to minimize the loss function. The keras interface has many choises as to those hyperparameters. Part 1: First we start by defining the number of nodes in a layer and the input dimensions. If we have more than one layer we might need to define a value for the number of nodes (H) for each layer. H = input_dim = Then we instantiate the model model = models.Sequential() Part 2: Then we add the hidden layers. Adding layers and stacking them is done using .add() model.add(layers.Dense(H, input_dim=input_dim, activation='sigmoid')) An alternative way model = Sequential([ Dense(200, input_shape=(X_train.shape[1],), activation='relu'), Dense(100, activation='relu'), Dense(50, activation='relu'), Dense(4, activation='linear') ]) Part 3: We end with the final layer (output) model.add(layers.Dense(1, activation='linear')) Our model is not ready yet. We need to configure its learning process with .compile(): model.compile(loss='mean_squared_error', optimizer='sgd') If you need to, you can further configure your optimizer. A core principle of Keras is to make things reasonably simple, while allowing the user to be fully in control when they need to (the ultimate control being the easy extensibility of the source code) model.compile(loss=keras.losses.categorical_crossentropy, optimizer=keras.optimizers.SGD(lr=0.01)) Our model is now ready to use. We haven't trained it yet, but we'll do that now using the fit method. Notice that we also need to specify the batch size for the stochastic gradient decent algorithm as well as the number of epochs to run. model.fit(X_train, Y_train, batch_size=100, epochs=100)#, verbose=1) Exercise 1: Build a NN with one hidden layer with 2 neurons . Use the tanh activation function. Train the model using the X_train dataset from above (train the model in this case means run .compile and .fit ). In [ ]: # your code here In [ ]: # %load solutions/NN_1_layer_2_nodes.py Great! We've trained a model. Now it's time to explore the results. Notice the loss function. In [ ]: # Some constants for our plots FIG_SIZE = ( 10 , 5 ) FONT_SIZE = 10 LABEL_SIZE = 15 In [ ]: # use our model to predict in the range we want X_range = np . linspace ( - 10 , 10 , 1000 ) y_pred = model . predict ( X_range ) In [ ]: # Plot the results fig , ax = plt . subplots ( 1 , 1 , figsize = FIG_SIZE ) ax . scatter ( X_train , Y_train , label = 'Training data' ) ax . plot ( X_range , y_pred , lw = 4 , color = 'r' , label = f 'MLP with one hidden layer and {H} nodes' ) ax . set_xlabel ( r '$X$' , fontsize = FONT_SIZE ) ax . set_ylabel ( r '$Y$' , fontsize = FONT_SIZE ) ax . set_title ( f 'NN with {len(model_history.model.layers)-1} layers, {H} nodes in each layer' , fontsize = LABEL_SIZE ) ax . tick_params ( labelsize = LABEL_SIZE ) ax . legend ( loc = 0 , fontsize = FONT_SIZE ) plt . show () Exercise 2: Change the number of neurons in the layer. Try changing the activation function to reLU . Can you get better results? What worked the best? In [ ]: # your code here In [ ]: # %load solutions/NN_1_layer_16_nodes.py Is the loss smaller now? You may access the results in a model by its .history In [ ]: model2_history . history [ 'loss' ][ - 1 ] Again let's use the new model to predict: In [ ]: # use our model to predict in the range we want X_range = np . linspace ( - 10 , 10 , 1000 ) y_pred = model2 . predict ( X_range ) fig , ax = plt . subplots ( 1 , 1 , figsize = FIG_SIZE ) ax . scatter ( X_train , Y_train , label = 'Training data' , alpha = 0.3 ) ax . scatter ( X_test , Y_test , label = 'Testing data' , alpha = 0.3 ) ax . plot ( X_range , y_pred , lw = 4 , color = 'r' , label = f 'NN with one hidden layer and {H} nodes' ) ax . set_xlabel ( r '$X$' , fontsize = FONT_SIZE ) ax . set_ylabel ( r '$Y$' , fontsize = FONT_SIZE ) ax . set_title ( f 'NN with {len(model2_history.model.layers)-1} layers, {H} nodes in each layer' , fontsize = LABEL_SIZE ) ax . tick_params ( labelsize = LABEL_SIZE ) ax . legend ( loc = 0 , fontsize = FONT_SIZE ) plt . show () Exercise 3: Plot the loss function as a function of the epochs. Hint: You can access the loss function values with the command: model_history.history['loss'] In [ ]: # your code here In [ ]: # %load solutions/print_history.py How good is the model? We can compute the $R&#94;{2}$ score to get a sense of the model performance. In [ ]: # evaluate the training and testing performance of your model # note: you should extract and check both the loss function and your evaluation metric from sklearn.metrics import r2_score as r2 train_score = model . evaluate ( X_train , Y_train , verbose = 1 ) print ( 'Train loss:' , train_score ) print ( 'Train R2:' , r2 ( Y_train , model . predict ( X_train ))) test_score = model . evaluate ( X_test , Y_test , verbose = 1 ) print ( 'Test loss:' , test_score ) print ( 'Test R2:' , r2 ( Y_test , model . predict ( X_test ))) Exercise 4 Let's add more layers. Fix the width $H$ and fit a MLP network with multiple hidden layers, each with the same width. Start with logistic or hyperbolic-tan activation functions for the hidden nodes and linear activation for the output. Experiment with the number of layers and observe the effect of this on the quality of the fit. In [ ]: # your code here In [ ]: # %load solutions/NN_10_layers_100_nodes.py In [ ]: # configure the model model3 . compile ( loss = 'mean_squared_error' , optimizer = 'adam' ) In [ ]: # fit the model - INTENSIVE model3_history = model3 . fit ( X_train , Y_train , batch_size = 256 , epochs = 1500 , verbose = 1 , \\ shuffle = True , validation_split = 0.3 ) In [ ]: len ( model3_history . model . layers ) In [ ]: # use our model to predict in the range we want num_epochs = f '{len(model2_history.epoch)}' X_range = np . linspace ( - 10 , 10 , 500 ) y_pred = model3 . predict ( X_range ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . scatter ( X_train , Y_train , label = 'Training data' ) ax . plot ( X_range , y_pred , lw = 4 , color = 'r' , label = f 'NN ( {num_epochs} epochs)' ) ax . set_xlabel ( r '$X$' , fontsize = 20 ) ax . set_ylabel ( r '$Y$' , fontsize = 20 ) ax . set_title ( f 'NN with {len(model3_history.model.layers)} layers, {H} nodes in each layer' , fontsize = LABEL_SIZE ) ax . tick_params ( labelsize = 20 ) ax . legend ( loc = 0 ) plt . show () In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( np . sqrt ( model2_history . history [ 'loss' ]), 'r' ) ax . plot ( np . sqrt ( model2_history . history [ 'val_loss' ]), 'b' , label = 'Val' ) ax . set_xlabel ( r 'Epoch' , fontsize = 20 ) ax . set_ylabel ( r 'Loss' , fontsize = 20 ) ax . legend () ax . tick_params ( labelsize = 20 ) In [ ]: # evaluate the training and testing performance of your model # note: you should extract and check both the loss function and your evaluation metric score = model2 . evaluate ( X_train , Y_train , verbose = 1 ) print ( 'Train loss:' , score ) print ( 'Train R2:' , r2 ( Y_train , model2 . predict ( X_train ))) In [ ]: score = model2 . evaluate ( X_test , Y_test , verbose = 1 ) print ( 'Test loss:' , score ) print ( 'Test R2:' , r2 ( Y_test , model2 . predict ( X_test ))) We got a better score this time. Overfitting the model Exercise 5 Usually we want to avoid overfitting of the data to our model. But here we want to achive overfitting! So we can regularize! There are a few reasons why a model overfits. One is the lack of data. So we will try to overfit by reducing the data. Try that with model3 and see if it overfits. In [ ]: # Having very few points in our data from sklearn.model_selection import train_test_split In [ ]: n_samples = 50 # set the number of samples to take for each dataset test_size = 0.3 # set the proportion of data to hold out for testing # define the function and add noise def f_gauss ( x ): return np . exp ( - x * x ) + np . random . normal ( loc = 0 , scale =. 1 , size = x . shape [ 0 ]) X = np . random . permutation ( np . linspace ( - 10 , 10 , n_samples )) # choose some points from the function Y = f_gauss ( X ) # create training and testing data from this set of points X_train , X_test , Y_train , Y_test = train_test_split ( X , Y , test_size = test_size ) In [ ]: import matplotlib.pyplot as plt plt . scatter ( X_train , Y_train ) In [ ]: # number of hidden nodes H = 100 # input dimension input_dim = 1 # create sequential multi-layer perceptron model4 = models . Sequential () # layer 0 model4 . add ( layers . Dense ( H , input_dim = input_dim , activation = 'tanh' )) # layer 1 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 2 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 3 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 4 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 5 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 6 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 7 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 8 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 9 model4 . add ( layers . Dense ( H , activation = 'tanh' )) # layer 10 - output model4 . add ( layers . Dense ( 1 , activation = 'linear' )) In [ ]: # configure the model model4 . compile ( loss = 'mean_squared_error' , optimizer = 'adam' ) In [ ]: # fit the model - INTENSIVE model4_history = model4 . fit ( X_train , Y_train , batch_size = 256 , epochs = 1500 , verbose = 1 , \\ shuffle = True , validation_split = 0.2 ) In [ ]: # use our model to predict in the range we want num_epochs = f '{len(model4_history.epoch)}' X_range = np . linspace ( - 10 , 10 , 500 ) y_pred = model4 . predict ( X_range ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . scatter ( X_train , Y_train , label = 'Training data' ) ax . plot ( X_range , y_pred , lw = 4 , color = 'r' , label = f 'NN ( {num_epochs} epochs)' ) ax . set_xlabel ( r '$X$' , fontsize = 20 ) ax . set_ylabel ( r '$Y$' , fontsize = 20 ) ax . set_title ( f 'NN with {len(model4_history.model.layers)} layers, {H} nodes in each layer' , fontsize = LABEL_SIZE ) ax . tick_params ( labelsize = 20 ) ax . legend ( loc = 0 ) plt . show () In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( np . sqrt ( model4_history . history [ 'loss' ]), 'r' ) ax . plot ( np . sqrt ( model4_history . history [ 'val_loss' ]), 'b' , label = 'Val' ) ax . set_xlabel ( r 'Epoch' , fontsize = 20 ) ax . set_ylabel ( r 'Loss' , fontsize = 20 ) ax . legend () ax . tick_params ( labelsize = 20 ) Regularization Let's try adding a regularizer in our model: kernel_regularizer=regularizers.l2(l2) . Also let's create a function that takes the number of layers and the l2 value as the input and creates the model. Usage: def create_dense([10, 20], l2=0.01) will create a model with two hidden layers of 10 and 20 nodes each, l2=0.01 regularization and num_classes output nodes. In [ ]: from keras import regularizers In [ ]: H = 100 # number of hidden nodes input_dim = 1 model5 = models . Sequential () # Input layer of the neural network with ReLU activation function and L2 regularization model5 . add ( layers . Dense ( H , input_dim = input_dim , activation = 'tanh' , kernel_regularizer = regularizers . l2 ( 0.01 ))) # hidden layers model5 . add ( layers . Dense ( H , activation = 'tanh' , kernel_regularizer = regularizers . l2 ( 0.01 ))) model5 . add ( layers . Dense ( H , activation = 'tanh' , kernel_regularizer = regularizers . l2 ( 0.01 ))) model5 . add ( layers . Dense ( H , activation = 'tanh' , kernel_regularizer = regularizers . l2 ( 0.01 ))) model5 . add ( layers . Dense ( H , activation = 'tanh' , kernel_regularizer = regularizers . l2 ( 0.01 ))) model5 . add ( layers . Dense ( H , activation = 'tanh' , kernel_regularizer = regularizers . l2 ( 0.01 ))) model5 . add ( layers . Dense ( H , activation = 'tanh' , kernel_regularizer = regularizers . l2 ( 0.01 ))) # output layer model5 . add ( layers . Dense ( 1 , activation = 'linear' )) In [ ]: # configure the model model5 . compile ( loss = 'mean_squared_error' , optimizer = 'adam' ) In [ ]: # fit the model - INTENSIVE model5_history = model5 . fit ( X_train , Y_train , batch_size = 256 , epochs = 1500 , verbose = 1 , \\ shuffle = True , validation_split = 0.2 ) In [ ]: # use our model to predict in the range we want num_epochs = f '{len(model5_history.epoch)}' X_range = np . linspace ( - 10 , 10 , 500 ) y_pred = model5 . predict ( X_range ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . scatter ( X_train , Y_train , label = 'Training data' ) ax . plot ( X_range , y_pred , lw = 4 , color = 'r' , label = f 'NN ( {num_epochs} epochs)' ) ax . set_xlabel ( r '$X$' , fontsize = 20 ) ax . set_ylabel ( r '$Y$' , fontsize = 20 ) ax . set_title ( f 'NN with {len(model5_history.model.layers)} layers, {H} nodes in each layer' , fontsize = LABEL_SIZE ) ax . tick_params ( labelsize = 20 ) ax . legend ( loc = 0 ) plt . show () That seems very good. Let's see the $R&#94;2$ In [ ]: from sklearn.metrics import r2_score as r2 In [ ]: score = model5 . evaluate ( X_test , Y_test , verbose = 1 ) print ( 'Test loss:' , score ) print ( 'Test R2:' , r2 ( Y_test , model5 . predict ( X_test ))) In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( np . sqrt ( model5_history . history [ 'loss' ]), 'r' ) ax . plot ( np . sqrt ( model5_history . history [ 'val_loss' ]), 'b' , label = 'Val' ) ax . set_xlabel ( r 'Epoch' , fontsize = 20 ) ax . set_ylabel ( r 'Loss' , fontsize = 20 ) ax . legend () ax . tick_params ( labelsize = 20 ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab10/notebook/"}]}